webpackJsonp([0],[
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = __webpack_require__(30);\n\nvar _reactRouter = __webpack_require__(163);\n\nvar _App = __webpack_require__(226);\n\nvar _App2 = _interopRequireDefault(_App);\n\nvar _RawOutput = __webpack_require__(357);\n\nvar _RawOutput2 = _interopRequireDefault(_RawOutput);\n\nvar _SystemMap = __webpack_require__(360);\n\nvar _SystemMap2 = _interopRequireDefault(_SystemMap);\n\nvar _debug = __webpack_require__(368);\n\nvar _debug2 = _interopRequireDefault(_debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nif (false) {\n  (function () {\n    _debug2.default.enable('dev');\n    (0, _debug2.default)('dev')('Starting app...');\n\n    var cssFileName = 'styles.css';\n    var originalCallback = window.webpackHotUpdate;\n\n    window.webpackHotUpdate = function () {\n      var links = document.getElementsByTagName('link');\n      for (var i = 0; i < links.length; i++) {\n        var link = links[i];\n        if (link.href.search(cssFileName) !== -1) {\n          var linkHref = link.href;\n          link.href = 'about:blank';\n          link.href = linkHref;\n          originalCallback.apply(undefined, arguments);\n          return;\n        }\n      }\n    };\n  })();\n}\n\n// <Route path=\"*\" component={NoMatch}/>\n\n(0, _reactDom.render)(_react2.default.createElement(\n  _reactRouter.Router,\n  { history: _reactRouter.browserHistory },\n  _react2.default.createElement(\n    _reactRouter.Route,\n    { path: '/', component: _App2.default },\n    _react2.default.createElement(_reactRouter.Route, { path: 'map', component: _SystemMap2.default }),\n    _react2.default.createElement(_reactRouter.IndexRoute, { component: _RawOutput2.default })\n  )\n), document.getElementById('root'));//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvaW5kZXguanM/MWZkZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCB7IFJvdXRlciwgUm91dGUsIEluZGV4Um91dGUsIExpbmssIGJyb3dzZXJIaXN0b3J5IH0gZnJvbSAncmVhY3Qtcm91dGVyJ1xuXG5pbXBvcnQgQXBwIGZyb20gJy4vY29tcG9uZW50cy9BcHAnO1xuaW1wb3J0IFJhd091dHB1dCBmcm9tICcuL2NvbXBvbmVudHMvUmF3T3V0cHV0JztcbmltcG9ydCBTeXN0ZW1NYXAgZnJvbSAnLi9jb21wb25lbnRzL1N5c3RlbU1hcCc7XG5cbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgZGVidWcuZW5hYmxlKCdkZXYnKTtcbiAgZGVidWcoJ2RldicpKCdTdGFydGluZyBhcHAuLi4nKTtcblxuICBjb25zdCBjc3NGaWxlTmFtZSA9ICdzdHlsZXMuY3NzJztcbiAgY29uc3Qgb3JpZ2luYWxDYWxsYmFjayA9IHdpbmRvdy53ZWJwYWNrSG90VXBkYXRlO1xuXG4gIHdpbmRvdy53ZWJwYWNrSG90VXBkYXRlID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xpbmsnKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBsaW5rID0gbGlua3NbaV07XG4gICAgICAgICAgaWYgKGxpbmsuaHJlZi5zZWFyY2goY3NzRmlsZU5hbWUpICE9PSAtMSkge1xuICAgICAgICAgICAgICBsZXQgbGlua0hyZWYgPSBsaW5rLmhyZWY7XG4gICAgICAgICAgICAgIGxpbmsuaHJlZiA9ICdhYm91dDpibGFuayc7XG4gICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGxpbmtIcmVmO1xuICAgICAgICAgICAgICBvcmlnaW5hbENhbGxiYWNrKC4uLmFyZ3MpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgfVxuICB9XG59XG5cbi8vIDxSb3V0ZSBwYXRoPVwiKlwiIGNvbXBvbmVudD17Tm9NYXRjaH0vPlxuXG5yZW5kZXIoKFxuICA8Um91dGVyIGhpc3Rvcnk9e2Jyb3dzZXJIaXN0b3J5fT5cbiAgICA8Um91dGUgcGF0aD1cIi9cIiBjb21wb25lbnQ9e0FwcH0+XG4gICAgICA8Um91dGUgcGF0aD1cIm1hcFwiIGNvbXBvbmVudD17U3lzdGVtTWFwfSAvPlxuICAgICAgPEluZGV4Um91dGUgY29tcG9uZW50PXtSYXdPdXRwdXR9IC8+XG4gICAgPC9Sb3V0ZT5cbiAgPC9Sb3V0ZXI+XG4pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvaW5kZXguanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7OztBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CQTtBQW9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQURBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 1 */,
/* 2 */,
/* 3 */,
/* 4 */,
/* 5 */,
/* 6 */,
/* 7 */,
/* 8 */,
/* 9 */,
/* 10 */,
/* 11 */,
/* 12 */,
/* 13 */,
/* 14 */,
/* 15 */,
/* 16 */,
/* 17 */,
/* 18 */,
/* 19 */,
/* 20 */,
/* 21 */,
/* 22 */,
/* 23 */,
/* 24 */,
/* 25 */,
/* 26 */,
/* 27 */,
/* 28 */,
/* 29 */,
/* 30 */,
/* 31 */,
/* 32 */,
/* 33 */,
/* 34 */,
/* 35 */,
/* 36 */,
/* 37 */,
/* 38 */,
/* 39 */,
/* 40 */,
/* 41 */,
/* 42 */,
/* 43 */,
/* 44 */,
/* 45 */,
/* 46 */,
/* 47 */,
/* 48 */,
/* 49 */,
/* 50 */,
/* 51 */,
/* 52 */,
/* 53 */,
/* 54 */,
/* 55 */,
/* 56 */,
/* 57 */,
/* 58 */,
/* 59 */,
/* 60 */,
/* 61 */,
/* 62 */,
/* 63 */,
/* 64 */,
/* 65 */,
/* 66 */,
/* 67 */,
/* 68 */,
/* 69 */,
/* 70 */,
/* 71 */,
/* 72 */,
/* 73 */,
/* 74 */,
/* 75 */,
/* 76 */,
/* 77 */,
/* 78 */,
/* 79 */,
/* 80 */,
/* 81 */,
/* 82 */,
/* 83 */,
/* 84 */,
/* 85 */,
/* 86 */,
/* 87 */,
/* 88 */,
/* 89 */,
/* 90 */,
/* 91 */,
/* 92 */,
/* 93 */,
/* 94 */,
/* 95 */,
/* 96 */,
/* 97 */,
/* 98 */,
/* 99 */,
/* 100 */,
/* 101 */,
/* 102 */,
/* 103 */,
/* 104 */,
/* 105 */,
/* 106 */,
/* 107 */,
/* 108 */,
/* 109 */,
/* 110 */,
/* 111 */,
/* 112 */,
/* 113 */,
/* 114 */,
/* 115 */,
/* 116 */,
/* 117 */,
/* 118 */,
/* 119 */,
/* 120 */,
/* 121 */,
/* 122 */,
/* 123 */,
/* 124 */,
/* 125 */,
/* 126 */,
/* 127 */,
/* 128 */,
/* 129 */,
/* 130 */,
/* 131 */,
/* 132 */,
/* 133 */,
/* 134 */,
/* 135 */,
/* 136 */,
/* 137 */,
/* 138 */,
/* 139 */,
/* 140 */,
/* 141 */,
/* 142 */,
/* 143 */,
/* 144 */,
/* 145 */,
/* 146 */,
/* 147 */,
/* 148 */,
/* 149 */,
/* 150 */,
/* 151 */,
/* 152 */,
/* 153 */,
/* 154 */,
/* 155 */,
/* 156 */,
/* 157 */,
/* 158 */,
/* 159 */,
/* 160 */,
/* 161 */,
/* 162 */,
/* 163 */,
/* 164 */,
/* 165 */,
/* 166 */,
/* 167 */,
/* 168 */,
/* 169 */,
/* 170 */,
/* 171 */,
/* 172 */,
/* 173 */,
/* 174 */,
/* 175 */,
/* 176 */,
/* 177 */,
/* 178 */,
/* 179 */,
/* 180 */,
/* 181 */,
/* 182 */,
/* 183 */,
/* 184 */,
/* 185 */,
/* 186 */,
/* 187 */,
/* 188 */,
/* 189 */,
/* 190 */,
/* 191 */,
/* 192 */,
/* 193 */,
/* 194 */,
/* 195 */,
/* 196 */,
/* 197 */,
/* 198 */,
/* 199 */,
/* 200 */,
/* 201 */,
/* 202 */,
/* 203 */,
/* 204 */,
/* 205 */,
/* 206 */,
/* 207 */,
/* 208 */,
/* 209 */,
/* 210 */,
/* 211 */,
/* 212 */,
/* 213 */,
/* 214 */,
/* 215 */,
/* 216 */,
/* 217 */,
/* 218 */,
/* 219 */,
/* 220 */,
/* 221 */,
/* 222 */,
/* 223 */,
/* 224 */,
/* 225 */,
/* 226 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class;\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactRouter = __webpack_require__(163);\n\nvar _Planets = __webpack_require__(313);\n\nvar _Planets2 = _interopRequireDefault(_Planets);\n\nvar _Ships = __webpack_require__(350);\n\nvar _Ships2 = _interopRequireDefault(_Ships);\n\nvar _widget = __webpack_require__(343);\n\nvar _widget2 = _interopRequireDefault(_widget);\n\nvar _connectToStores = __webpack_require__(314);\n\nvar _connectToStores2 = _interopRequireDefault(_connectToStores);\n\nvar _game = __webpack_require__(316);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _game3 = __webpack_require__(319);\n\nvar _game4 = _interopRequireDefault(_game3);\n\nvar _title = __webpack_require__(353);\n\nvar _title2 = _interopRequireDefault(_title);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(355);\n\nvar App = (0, _connectToStores2.default)(_class = function (_Component) {\n  (0, _inherits3.default)(App, _Component);\n\n  function App() {\n    (0, _classCallCheck3.default)(this, App);\n    return (0, _possibleConstructorReturn3.default)(this, (0, _getPrototypeOf2.default)(App).apply(this, arguments));\n  }\n\n  (0, _createClass3.default)(App, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      _game4.default.connect();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement(\n        'div',\n        { className: 'app' },\n        _react2.default.createElement(\n          'section',\n          { className: 'content' },\n          _react2.default.createElement(\n            'header',\n            null,\n            _react2.default.createElement(\n              'h4',\n              null,\n              this.props.title\n            ),\n            _react2.default.createElement(\n              'div',\n              { className: 'action-status' },\n              _react2.default.createElement(\n                _reactRouter.Link,\n                { to: '/map' },\n                'Map'\n              ),\n              _react2.default.createElement(\n                _reactRouter.Link,\n                { to: '/' },\n                'Home'\n              ),\n              '|',\n              _react2.default.createElement(\n                'a',\n                { href: '#', onClick: _game4.default.start, title: 'Start Simulation' },\n                _react2.default.createElement('i', { className: 'fa fa-play' })\n              ),\n              _react2.default.createElement(\n                'a',\n                { href: '#', onClick: _game4.default.stop, title: 'Pause Simulation' },\n                _react2.default.createElement('i', { className: 'fa fa-pause' })\n              ),\n              _react2.default.createElement(\n                'a',\n                { href: '#', onClick: _game4.default.restart, title: 'Restart Simulation' },\n                _react2.default.createElement('i', { className: 'fa fa-refresh' })\n              ),\n              _react2.default.createElement(\n                'a',\n                { href: '#', onClick: _game4.default.generate, title: 'Regenerate Universe' },\n                _react2.default.createElement('i', { className: 'fa fa-balance-scale' })\n              ),\n              _react2.default.createElement(\n                'h4',\n                null,\n                'status: ',\n                this.props.status\n              )\n            )\n          ),\n          _react2.default.createElement(\n            'main',\n            { role: 'content' },\n            this.props.children\n          )\n        ),\n        _react2.default.createElement(\n          'section',\n          { className: 'widgets' },\n          _react2.default.createElement(_Planets2.default, null),\n          _react2.default.createElement(_Ships2.default, null),\n          _react2.default.createElement(_widget2.default, { name: 'goods' })\n        )\n      );\n    }\n  }], [{\n    key: 'getStores',\n    value: function getStores(props) {\n      return [_game2.default, _title2.default];\n    }\n  }, {\n    key: 'getPropsFromStores',\n    value: function getPropsFromStores(props) {\n      var _GameStore$getState = _game2.default.getState();\n\n      var status = _GameStore$getState.status;\n\n      var _TitleStore$getState = _title2.default.getState();\n\n      var title = _TitleStore$getState.title;\n\n      return {\n        status: status,\n        title: title\n      };\n    }\n  }]);\n  return App;\n}(_react.Component)) || _class;\n\nexports.default = App;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL0FwcC5qcz81N2FhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyJztcblxuaW1wb3J0IFBsYW5ldHMgZnJvbSAnLi93aWRnZXRzL1BsYW5ldHMnO1xuaW1wb3J0IFNoaXBzIGZyb20gJy4vd2lkZ2V0cy9TaGlwcyc7XG5pbXBvcnQgV2lkZ2V0IGZyb20gJy4vd2lkZ2V0JztcblxuaW1wb3J0IGNvbm5lY3RUb1N0b3JlcyBmcm9tICdhbHQtdXRpbHMvbGliL2Nvbm5lY3RUb1N0b3Jlcyc7XG5cbmltcG9ydCBHYW1lU3RvcmUgZnJvbSAnLi4vc3RvcmVzL2dhbWUnO1xuaW1wb3J0IEdhbWVBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvZ2FtZSc7XG5pbXBvcnQgVGl0bGVTdG9yZSBmcm9tICcuLi9zdG9yZXMvdGl0bGUnO1xuXG5yZXF1aXJlKCcuLi9zdHlsZXMvYXBwLmxlc3MnKTtcblxuQGNvbm5lY3RUb1N0b3Jlc1xuY2xhc3MgQXBwIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIGdldFN0b3Jlcyhwcm9wcykge1xuICAgIHJldHVybiBbR2FtZVN0b3JlLCBUaXRsZVN0b3JlXTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRQcm9wc0Zyb21TdG9yZXMocHJvcHMpIHtcbiAgICBjb25zdCB7c3RhdHVzfSA9IEdhbWVTdG9yZS5nZXRTdGF0ZSgpO1xuICAgIGNvbnN0IHt0aXRsZX0gPSBUaXRsZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1cyxcbiAgICAgIHRpdGxlXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIEdhbWVBY3Rpb25zLmNvbm5lY3QoKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhcHBcIj5cbiAgICAgICAgPHNlY3Rpb24gY2xhc3NOYW1lPVwiY29udGVudFwiPlxuICAgICAgICAgIDxoZWFkZXI+XG4gICAgICAgICAgICA8aDQ+e3RoaXMucHJvcHMudGl0bGV9PC9oND5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWN0aW9uLXN0YXR1c1wiPlxuICAgICAgICAgICAgICA8TGluayB0bz1cIi9tYXBcIj5NYXA8L0xpbms+XG4gICAgICAgICAgICAgIDxMaW5rIHRvPVwiL1wiPkhvbWU8L0xpbms+XG4gICAgICAgICAgICAgIHxcbiAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXtHYW1lQWN0aW9ucy5zdGFydH0gdGl0bGU9XCJTdGFydCBTaW11bGF0aW9uXCI+PGkgY2xhc3NOYW1lPVwiZmEgZmEtcGxheVwiPjwvaT48L2E+XG4gICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgb25DbGljaz17R2FtZUFjdGlvbnMuc3RvcH0gdGl0bGU9XCJQYXVzZSBTaW11bGF0aW9uXCI+PGkgY2xhc3NOYW1lPVwiZmEgZmEtcGF1c2VcIj48L2k+PC9hPlxuICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIG9uQ2xpY2s9e0dhbWVBY3Rpb25zLnJlc3RhcnR9IHRpdGxlPVwiUmVzdGFydCBTaW11bGF0aW9uXCI+PGkgY2xhc3NOYW1lPVwiZmEgZmEtcmVmcmVzaFwiPjwvaT48L2E+XG4gICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgb25DbGljaz17R2FtZUFjdGlvbnMuZ2VuZXJhdGV9IHRpdGxlPVwiUmVnZW5lcmF0ZSBVbml2ZXJzZVwiPjxpIGNsYXNzTmFtZT1cImZhIGZhLWJhbGFuY2Utc2NhbGVcIj48L2k+PC9hPlxuXG4gICAgICAgICAgICAgIDxoND5zdGF0dXM6IHt0aGlzLnByb3BzLnN0YXR1c308L2g0PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9oZWFkZXI+XG5cbiAgICAgICAgICA8bWFpbiByb2xlPVwiY29udGVudFwiPlxuICAgICAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgICAgPC9tYWluPlxuXG4gICAgICAgIDwvc2VjdGlvbj5cblxuICAgICAgICA8c2VjdGlvbiBjbGFzc05hbWU9XCJ3aWRnZXRzXCI+XG4gICAgICAgICAgPFBsYW5ldHMgLz5cbiAgICAgICAgICA8U2hpcHMgLz5cbiAgICAgICAgICA8V2lkZ2V0IG5hbWU9XCJnb29kc1wiIC8+XG4gICAgICAgIDwvc2VjdGlvbj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBwO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogc3JjL2NvbXBvbmVudHMvQXBwLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7O0FBY0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUZBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVRBO0FBRkE7QUFlQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBaEJBO0FBc0JBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBdkJBO0FBOEJBOzs7QUFqREE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7OztBQXlDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 227 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(228), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mLmpzPzJmOGUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZi5qc1xuICoqIG1vZHVsZSBpZCA9IDIyN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 228 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(229);\nmodule.exports = __webpack_require__(240).Object.getPrototypeOf;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZi5qcz8xNjJlIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Y7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1wcm90b3R5cGUtb2YuanNcbiAqKiBtb2R1bGUgaWQgPSAyMjhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 229 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject        = __webpack_require__(230)\n  , $getPrototypeOf = __webpack_require__(232);\n\n__webpack_require__(238)('getPrototypeOf', function(){\n  return function getPrototypeOf(it){\n    return $getPrototypeOf(toObject(it));\n  };\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjI5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZi5qcz9hMzg2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi45IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKVxudmFyIHRvT2JqZWN0ICAgICAgICA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpXG4gICwgJGdldFByb3RvdHlwZU9mID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdwbycpO1xuXG5yZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2dldFByb3RvdHlwZU9mJywgZnVuY3Rpb24oKXtcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KXtcbiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7XG4gIH07XG59KTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZi5qc1xuICoqIG1vZHVsZSBpZCA9IDIyOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 230 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 7.1.13 ToObject(argument)\nvar defined = __webpack_require__(231);\nmodule.exports = function(it){\n  return Object(defined(it));\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1vYmplY3QuanM/MzgwOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpXG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8tb2JqZWN0LmpzXG4gKiogbW9kdWxlIGlkID0gMjMwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 231 */
/***/ function(module, exports) {

	eval("// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZWZpbmVkLmpzP2M3MWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudClcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIFwiICsgaXQpO1xuICByZXR1cm4gaXQ7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2RlZmluZWQuanNcbiAqKiBtb2R1bGUgaWQgPSAyMzFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 232 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has         = __webpack_require__(233)\n  , toObject    = __webpack_require__(230)\n  , IE_PROTO    = __webpack_require__(234)('IE_PROTO')\n  , ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function(O){\n  O = toObject(O);\n  if(has(O, IE_PROTO))return O[IE_PROTO];\n  if(typeof O.constructor == 'function' && O instanceof O.constructor){\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ3BvLmpzP2VjZDYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcbnZhciBoYXMgICAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpXG4gICwgdG9PYmplY3QgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKVxuICAsIElFX1BST1RPICAgID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpXG4gICwgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXtcbiAgTyA9IHRvT2JqZWN0KE8pO1xuICBpZihoYXMoTywgSUVfUFJPVE8pKXJldHVybiBPW0lFX1BST1RPXTtcbiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7XG4gICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlO1xuICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ3BvLmpzXG4gKiogbW9kdWxlIGlkID0gMjMyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 233 */
/***/ function(module, exports) {

	eval("var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19oYXMuanM/ZDhhMyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7XG4gIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19oYXMuanNcbiAqKiBtb2R1bGUgaWQgPSAyMzNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 234 */
/***/ function(module, exports, __webpack_require__) {

	eval("var shared = __webpack_require__(235)('keys')\n  , uid    = __webpack_require__(237);\nmodule.exports = function(key){\n  return shared[key] || (shared[key] = uid(key));\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zaGFyZWQta2V5LmpzPzk3YWUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIHNoYXJlZCA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCdrZXlzJylcbiAgLCB1aWQgICAgPSByZXF1aXJlKCcuL191aWQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXtcbiAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2hhcmVkLWtleS5qc1xuICoqIG1vZHVsZSBpZCA9IDIzNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 235 */
/***/ function(module, exports, __webpack_require__) {

	eval("var global = __webpack_require__(236)\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zaGFyZWQuanM/ZDNlZiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJylcbiAgLCBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJ1xuICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3NoYXJlZC5qc1xuICoqIG1vZHVsZSBpZCA9IDIzNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 236 */
/***/ function(module, exports) {

	eval("// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19nbG9iYWwuanM/ZGUyOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxudmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoXG4gID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZ2xvYmFsLmpzXG4gKiogbW9kdWxlIGlkID0gMjM2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 237 */
/***/ function(module, exports) {

	eval("var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL191aWQuanM/NDMxMSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaWQgPSAwXG4gICwgcHggPSBNYXRoLnJhbmRvbSgpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpe1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL191aWQuanNcbiAqKiBtb2R1bGUgaWQgPSAyMzdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 238 */
/***/ function(module, exports, __webpack_require__) {

	eval("// most Object methods by ES6 should accept primitives\nvar $export = __webpack_require__(239)\n  , core    = __webpack_require__(240)\n  , fails   = __webpack_require__(249);\nmodule.exports = function(KEY, exec){\n  var fn  = (core.Object || {})[KEY] || Object[KEY]\n    , exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function(){ fn(1); }), 'Object', exp);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qtc2FwLmpzPzc3YzIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpXG4gICwgY29yZSAgICA9IHJlcXVpcmUoJy4vX2NvcmUnKVxuICAsIGZhaWxzICAgPSByZXF1aXJlKCcuL19mYWlscycpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVksIGV4ZWMpe1xuICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldXG4gICAgLCBleHAgPSB7fTtcbiAgZXhwW0tFWV0gPSBleGVjKGZuKTtcbiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qtc2FwLmpzXG4gKiogbW9kdWxlIGlkID0gMjM4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 239 */
/***/ function(module, exports, __webpack_require__) {

	eval("var global    = __webpack_require__(236)\n  , core      = __webpack_require__(240)\n  , ctx       = __webpack_require__(241)\n  , hide      = __webpack_require__(243)\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , IS_WRAP   = type & $export.W\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , expProto  = exports[PROTOTYPE]\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]\n    , key, own, out;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function(C){\n      var F = function(a, b, c){\n        if(this instanceof C){\n          switch(arguments.length){\n            case 0: return new C;\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if(IS_PROTO){\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if(type & $export.R && expProto && !expProto[key])hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library` \nmodule.exports = $export;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjM5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19leHBvcnQuanM/OTVmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZ2xvYmFsICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJylcbiAgLCBjb3JlICAgICAgPSByZXF1aXJlKCcuL19jb3JlJylcbiAgLCBjdHggICAgICAgPSByZXF1aXJlKCcuL19jdHgnKVxuICAsIGhpZGUgICAgICA9IHJlcXVpcmUoJy4vX2hpZGUnKVxuICAsIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7XG4gIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GXG4gICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HXG4gICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TXG4gICAgLCBJU19QUk9UTyAgPSB0eXBlICYgJGV4cG9ydC5QXG4gICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CXG4gICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XXG4gICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KVxuICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdXG4gICAgLCB0YXJnZXQgICAgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdXG4gICAgLCBrZXksIG93biwgb3V0O1xuICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTtcbiAgZm9yKGtleSBpbiBzb3VyY2Upe1xuICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZVxuICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7XG4gICAgaWYob3duICYmIGtleSBpbiBleHBvcnRzKWNvbnRpbnVlO1xuICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkXG4gICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTtcbiAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXNcbiAgICBleHBvcnRzW2tleV0gPSBJU19HTE9CQUwgJiYgdHlwZW9mIHRhcmdldFtrZXldICE9ICdmdW5jdGlvbicgPyBzb3VyY2Vba2V5XVxuICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0XG4gICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbClcbiAgICAvLyB3cmFwIGdsb2JhbCBjb25zdHJ1Y3RvcnMgZm9yIHByZXZlbnQgY2hhbmdlIHRoZW0gaW4gbGlicmFyeVxuICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7XG4gICAgICB2YXIgRiA9IGZ1bmN0aW9uKGEsIGIsIGMpe1xuICAgICAgICBpZih0aGlzIGluc3RhbmNlb2YgQyl7XG4gICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe1xuICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEM7XG4gICAgICAgICAgICBjYXNlIDE6IHJldHVybiBuZXcgQyhhKTtcbiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpO1xuICAgICAgICAgIH0gcmV0dXJuIG5ldyBDKGEsIGIsIGMpO1xuICAgICAgICB9IHJldHVybiBDLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgICAgRltQUk9UT1RZUEVdID0gQ1tQUk9UT1RZUEVdO1xuICAgICAgcmV0dXJuIEY7XG4gICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzXG4gICAgfSkob3V0KSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0O1xuICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5tZXRob2RzLiVOQU1FJVxuICAgIGlmKElTX1BST1RPKXtcbiAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDtcbiAgICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5wcm90b3R5cGUuJU5BTUUlXG4gICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTtcbiAgICB9XG4gIH1cbn07XG4vLyB0eXBlIGJpdG1hcFxuJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWRcbiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsXG4kZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpY1xuJGV4cG9ydC5QID0gODsgICAvLyBwcm90b1xuJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kXG4kZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXBcbiRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZVxuJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIFxubW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2V4cG9ydC5qc1xuICoqIG1vZHVsZSBpZCA9IDIzOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 240 */
/***/ function(module, exports) {

	eval("var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19jb3JlLmpzPzQxYzQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTtcbmlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NvcmUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNDBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 241 */
/***/ function(module, exports, __webpack_require__) {

	eval("// optional / simple context binding\nvar aFunction = __webpack_require__(242);\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19jdHguanM/ZDNhMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmdcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCB0aGF0LCBsZW5ndGgpe1xuICBhRnVuY3Rpb24oZm4pO1xuICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuO1xuICBzd2l0Y2gobGVuZ3RoKXtcbiAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbihhKXtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpO1xuICAgIH07XG4gICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24oYSwgYil7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTtcbiAgICB9O1xuICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uKGEsIGIsIGMpe1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG4gIH07XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2N0eC5qc1xuICoqIG1vZHVsZSBpZCA9IDI0MVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 242 */
/***/ function(module, exports) {

	eval("module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hLWZ1bmN0aW9uLmpzPzRjMTYiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7XG4gIHJldHVybiBpdDtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYS1mdW5jdGlvbi5qc1xuICoqIG1vZHVsZSBpZCA9IDI0MlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 243 */
/***/ function(module, exports, __webpack_require__) {

	eval("var dP         = __webpack_require__(244)\n  , createDesc = __webpack_require__(252);\nmodule.exports = __webpack_require__(248) ? function(object, key, value){\n  return dP.f(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19oaWRlLmpzPzkxYmQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRQICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKVxuICAsIGNyZWF0ZURlc2MgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpe1xuICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpO1xufSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7XG4gIG9iamVjdFtrZXldID0gdmFsdWU7XG4gIHJldHVybiBvYmplY3Q7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2hpZGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 244 */
/***/ function(module, exports, __webpack_require__) {

	eval("var anObject       = __webpack_require__(245)\n  , IE8_DOM_DEFINE = __webpack_require__(247)\n  , toPrimitive    = __webpack_require__(251)\n  , dP             = Object.defineProperty;\n\nexports.f = __webpack_require__(248) ? Object.defineProperty : function defineProperty(O, P, Attributes){\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if(IE8_DOM_DEFINE)try {\n    return dP(O, P, Attributes);\n  } catch(e){ /* empty */ }\n  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n  if('value' in Attributes)O[P] = Attributes.value;\n  return O;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZHAuanM/MDc0YyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYW5PYmplY3QgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKVxuICAsIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi9faWU4LWRvbS1kZWZpbmUnKVxuICAsIHRvUHJpbWl0aXZlICAgID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJylcbiAgLCBkUCAgICAgICAgICAgICA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxuZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpe1xuICBhbk9iamVjdChPKTtcbiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBhbk9iamVjdChBdHRyaWJ1dGVzKTtcbiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHtcbiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7XG4gIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH1cbiAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7XG4gIGlmKCd2YWx1ZScgaW4gQXR0cmlidXRlcylPW1BdID0gQXR0cmlidXRlcy52YWx1ZTtcbiAgcmV0dXJuIE87XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1kcC5qc1xuICoqIG1vZHVsZSBpZCA9IDI0NFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 245 */
/***/ function(module, exports, __webpack_require__) {

	eval("var isObject = __webpack_require__(246);\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hbi1vYmplY3QuanM/MGUxYSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTtcbiAgcmV0dXJuIGl0O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hbi1vYmplY3QuanNcbiAqKiBtb2R1bGUgaWQgPSAyNDVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 246 */
/***/ function(module, exports) {

	eval("module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1vYmplY3QuanM/M2JiNSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJztcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXMtb2JqZWN0LmpzXG4gKiogbW9kdWxlIGlkID0gMjQ2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 247 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = !__webpack_require__(248) && !__webpack_require__(249)(function(){\n  return Object.defineProperty(__webpack_require__(250)('div'), 'a', {get: function(){ return 7; }}).a != 7;\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pZTgtZG9tLWRlZmluZS5qcz82N2MyIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXF1aXJlKCcuL19kb20tY3JlYXRlJykoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3O1xufSk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faWU4LWRvbS1kZWZpbmUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNDdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 248 */
/***/ function(module, exports, __webpack_require__) {

	eval("// Thank's IE8 for his funny defineProperty\nmodule.exports = !__webpack_require__(249)(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZXNjcmlwdG9ycy5qcz8xOTJhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHlcbm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNztcbn0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2Rlc2NyaXB0b3JzLmpzXG4gKiogbW9kdWxlIGlkID0gMjQ4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 249 */
/***/ function(module, exports) {

	eval("module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19mYWlscy5qcz9hODE2Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7XG4gIHRyeSB7XG4gICAgcmV0dXJuICEhZXhlYygpO1xuICB9IGNhdGNoKGUpe1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2ZhaWxzLmpzXG4gKiogbW9kdWxlIGlkID0gMjQ5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 250 */
/***/ function(module, exports, __webpack_require__) {

	eval("var isObject = __webpack_require__(246)\n  , document = __webpack_require__(236).document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kb20tY3JlYXRlLmpzPzRjN2IiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JylcbiAgLCBkb2N1bWVudCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpLmRvY3VtZW50XG4gIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0J1xuICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2RvbS1jcmVhdGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNTBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 251 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = __webpack_require__(246);\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function(it, S){\n  if(!isObject(it))return it;\n  var fn, val;\n  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1wcmltaXRpdmUuanM/NDc4YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSlcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBTKXtcbiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7XG4gIHZhciBmbiwgdmFsO1xuICBpZihTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7XG4gIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDtcbiAgaWYoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDtcbiAgdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1wcmltaXRpdmUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNTFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 252 */
/***/ function(module, exports) {

	eval("module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19wcm9wZXJ0eS1kZXNjLmpzPzU3ZDciXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXtcbiAgcmV0dXJuIHtcbiAgICBlbnVtZXJhYmxlICA6ICEoYml0bWFwICYgMSksXG4gICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLFxuICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSxcbiAgICB2YWx1ZSAgICAgICA6IHZhbHVlXG4gIH07XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3Byb3BlcnR5LWRlc2MuanNcbiAqKiBtb2R1bGUgaWQgPSAyNTJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 253 */
/***/ function(module, exports) {

	eval("\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrLmpzP2FkNzMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2suanNcbiAqKiBtb2R1bGUgaWQgPSAyNTNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 254 */
/***/ function(module, exports, __webpack_require__) {

	eval("\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = __webpack_require__(255);\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzLmpzPzhmY2QiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5XCIpO1xuXG52YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlZmluZVByb3BlcnR5KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KCk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcy5qc1xuICoqIG1vZHVsZSBpZCA9IDI1NFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 255 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(256), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanM/OWJlMCJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eVwiKSwgX19lc01vZHVsZTogdHJ1ZSB9O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qc1xuICoqIG1vZHVsZSBpZCA9IDI1NVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 256 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(257);\nvar $Object = __webpack_require__(240).Object;\nmodule.exports = function defineProperty(it, key, desc){\n  return $Object.defineProperty(it, key, desc);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5LmpzPzc2MmUiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eScpO1xudmFyICRPYmplY3QgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXtcbiAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanNcbiAqKiBtb2R1bGUgaWQgPSAyNTZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 257 */
/***/ function(module, exports, __webpack_require__) {

	eval("var $export = __webpack_require__(239);\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !__webpack_require__(248), 'Object', {defineProperty: __webpack_require__(244).f});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5LmpzPzJkM2MiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbi8vIDE5LjEuMi40IC8gMTUuMi4zLjYgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mfSk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qc1xuICoqIG1vZHVsZSBpZCA9IDI1N1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 258 */
/***/ function(module, exports, __webpack_require__) {

	eval("\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = __webpack_require__(259);\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4uanM/Mjk2OCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF90eXBlb2YyID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvdHlwZW9mXCIpO1xuXG52YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHtcbiAgaWYgKCFzZWxmKSB7XG4gICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICB9XG5cbiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoY2FsbCkpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybi5qc1xuICoqIG1vZHVsZSBpZCA9IDI1OFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 259 */
/***/ function(module, exports, __webpack_require__) {

	eval("\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = __webpack_require__(260);\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = __webpack_require__(289);\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9oZWxwZXJzL3R5cGVvZi5qcz8xOTZiIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG52YXIgX2l0ZXJhdG9yID0gcmVxdWlyZShcIi4uL2NvcmUtanMvc3ltYm9sL2l0ZXJhdG9yXCIpO1xuXG52YXIgX2l0ZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2l0ZXJhdG9yKTtcblxudmFyIF9zeW1ib2wgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9zeW1ib2xcIik7XG5cbnZhciBfc3ltYm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N5bWJvbCk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgX2l0ZXJhdG9yMi5kZWZhdWx0ID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihvYmopO1xufSA6IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2Yob2JqKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvaGVscGVycy90eXBlb2YuanNcbiAqKiBtb2R1bGUgaWQgPSAyNTlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 260 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(261), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbC9pdGVyYXRvci5qcz81ZDdmIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3JcIiksIF9fZXNNb2R1bGU6IHRydWUgfTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbC9pdGVyYXRvci5qc1xuICoqIG1vZHVsZSBpZCA9IDI2MFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 261 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(262);\n__webpack_require__(284);\nmodule.exports = __webpack_require__(288).f('iterator');//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3IuanM/YjQwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3InKTtcbnJlcXVpcmUoJy4uLy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL193a3MtZXh0JykuZignaXRlcmF0b3InKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3IuanNcbiAqKiBtb2R1bGUgaWQgPSAyNjFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 262 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\nvar $at  = __webpack_require__(263)(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\n__webpack_require__(265)(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IuanM/NmVmOCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGF0ICA9IHJlcXVpcmUoJy4vX3N0cmluZy1hdCcpKHRydWUpO1xuXG4vLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5yZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXtcbiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKVxufSwgZnVuY3Rpb24oKXtcbiAgdmFyIE8gICAgID0gdGhpcy5fdFxuICAgICwgaW5kZXggPSB0aGlzLl9pXG4gICAgLCBwb2ludDtcbiAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTtcbiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpO1xuICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDtcbiAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTtcbn0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvci5qc1xuICoqIG1vZHVsZSBpZCA9IDI2MlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 263 */
/***/ function(module, exports, __webpack_require__) {

	eval("var toInteger = __webpack_require__(264)\n  , defined   = __webpack_require__(231);\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zdHJpbmctYXQuanM/NDczMSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpXG4gICwgZGVmaW5lZCAgID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xuLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0XG4vLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXRcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRoYXQsIHBvcyl7XG4gICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSlcbiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpXG4gICAgICAsIGwgPSBzLmxlbmd0aFxuICAgICAgLCBhLCBiO1xuICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7XG4gICAgYSA9IHMuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZlxuICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGFcbiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwO1xuICB9O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zdHJpbmctYXQuanNcbiAqKiBtb2R1bGUgaWQgPSAyNjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 264 */
/***/ function(module, exports) {

	eval("// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1pbnRlZ2VyLmpzP2MwNzkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCAgPSBNYXRoLmNlaWxcbiAgLCBmbG9vciA9IE1hdGguZmxvb3I7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3RvLWludGVnZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAyNjRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 265 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\nvar LIBRARY        = __webpack_require__(266)\n  , $export        = __webpack_require__(239)\n  , redefine       = __webpack_require__(267)\n  , hide           = __webpack_require__(243)\n  , has            = __webpack_require__(233)\n  , Iterators      = __webpack_require__(268)\n  , $iterCreate    = __webpack_require__(269)\n  , setToStringTag = __webpack_require__(282)\n  , getPrototypeOf = __webpack_require__(232)\n  , ITERATOR       = __webpack_require__(283)('iterator')\n  , BUGGY          = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR    = '@@iterator'\n  , KEYS           = 'keys'\n  , VALUES         = 'values';\n\nvar returnThis = function(){ return this; };\n\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED){\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function(kind){\n    if(!BUGGY && kind in proto)return proto[kind];\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG        = NAME + ' Iterator'\n    , DEF_VALUES = DEFAULT == VALUES\n    , VALUES_BUG = false\n    , proto      = Base.prototype\n    , $native    = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , $default   = $native || getMethod(DEFAULT)\n    , $entries   = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined\n    , $anyNative = NAME == 'Array' ? proto.entries || $native : $native\n    , methods, key, IteratorPrototype;\n  // Fix native\n  if($anyNative){\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base));\n    if(IteratorPrototype !== Object.prototype){\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if(!LIBRARY && !has(IteratorPrototype, ITERATOR))hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if(DEF_VALUES && $native && $native.name !== VALUES){\n    VALUES_BUG = true;\n    $default = function values(){ return $native.call(this); };\n  }\n  // Define iterator\n  if((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])){\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      values:  DEF_VALUES ? $default : getMethod(VALUES),\n      keys:    IS_SET     ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if(FORCED)for(key in methods){\n      if(!(key in proto))redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWRlZmluZS5qcz80YjU0Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZICAgICAgICA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKVxuICAsICRleHBvcnQgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JylcbiAgLCByZWRlZmluZSAgICAgICA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJylcbiAgLCBoaWRlICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2hpZGUnKVxuICAsIGhhcyAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJylcbiAgLCBJdGVyYXRvcnMgICAgICA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpXG4gICwgJGl0ZXJDcmVhdGUgICAgPSByZXF1aXJlKCcuL19pdGVyLWNyZWF0ZScpXG4gICwgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpXG4gICwgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJylcbiAgLCBJVEVSQVRPUiAgICAgICA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpXG4gICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YFxuICAsIEZGX0lURVJBVE9SICAgID0gJ0BAaXRlcmF0b3InXG4gICwgS0VZUyAgICAgICAgICAgPSAna2V5cydcbiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCl7XG4gICRpdGVyQ3JlYXRlKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KTtcbiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpe1xuICAgIGlmKCFCVUdHWSAmJiBraW5kIGluIHByb3RvKXJldHVybiBwcm90b1traW5kXTtcbiAgICBzd2l0Y2goa2luZCl7XG4gICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gICAgICBjYXNlIFZBTFVFUzogcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICAgIH0gcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgfTtcbiAgdmFyIFRBRyAgICAgICAgPSBOQU1FICsgJyBJdGVyYXRvcidcbiAgICAsIERFRl9WQUxVRVMgPSBERUZBVUxUID09IFZBTFVFU1xuICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlXG4gICAgLCBwcm90byAgICAgID0gQmFzZS5wcm90b3R5cGVcbiAgICAsICRuYXRpdmUgICAgPSBwcm90b1tJVEVSQVRPUl0gfHwgcHJvdG9bRkZfSVRFUkFUT1JdIHx8IERFRkFVTFQgJiYgcHJvdG9bREVGQVVMVF1cbiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKVxuICAgICwgJGVudHJpZXMgICA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWRcbiAgICAsICRhbnlOYXRpdmUgPSBOQU1FID09ICdBcnJheScgPyBwcm90by5lbnRyaWVzIHx8ICRuYXRpdmUgOiAkbmF0aXZlXG4gICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlO1xuICAvLyBGaXggbmF0aXZlXG4gIGlmKCRhbnlOYXRpdmUpe1xuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7XG4gICAgaWYoSXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUpe1xuICAgICAgLy8gU2V0IEBAdG9TdHJpbmdUYWcgdG8gbmF0aXZlIGl0ZXJhdG9yc1xuICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7XG4gICAgICAvLyBmaXggZm9yIHNvbWUgb2xkIGVuZ2luZXNcbiAgICAgIGlmKCFMSUJSQVJZICYmICFoYXMoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SKSloaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7XG4gICAgfVxuICB9XG4gIC8vIGZpeCBBcnJheSN7dmFsdWVzLCBAQGl0ZXJhdG9yfS5uYW1lIGluIFY4IC8gRkZcbiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXtcbiAgICBWQUxVRVNfQlVHID0gdHJ1ZTtcbiAgICAkZGVmYXVsdCA9IGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9O1xuICB9XG4gIC8vIERlZmluZSBpdGVyYXRvclxuICBpZigoIUxJQlJBUlkgfHwgRk9SQ0VEKSAmJiAoQlVHR1kgfHwgVkFMVUVTX0JVRyB8fCAhcHJvdG9bSVRFUkFUT1JdKSl7XG4gICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTtcbiAgfVxuICAvLyBQbHVnIGZvciBsaWJyYXJ5XG4gIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0O1xuICBJdGVyYXRvcnNbVEFHXSAgPSByZXR1cm5UaGlzO1xuICBpZihERUZBVUxUKXtcbiAgICBtZXRob2RzID0ge1xuICAgICAgdmFsdWVzOiAgREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKFZBTFVFUyksXG4gICAgICBrZXlzOiAgICBJU19TRVQgICAgID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoS0VZUyksXG4gICAgICBlbnRyaWVzOiAkZW50cmllc1xuICAgIH07XG4gICAgaWYoRk9SQ0VEKWZvcihrZXkgaW4gbWV0aG9kcyl7XG4gICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTtcbiAgICB9IGVsc2UgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoQlVHR1kgfHwgVkFMVUVTX0JVRyksIE5BTUUsIG1ldGhvZHMpO1xuICB9XG4gIHJldHVybiBtZXRob2RzO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWRlZmluZS5qc1xuICoqIG1vZHVsZSBpZCA9IDI2NVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 266 */
/***/ function(module, exports) {

	eval("module.exports = true;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19saWJyYXJ5LmpzPzY4OTgiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB0cnVlO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2xpYnJhcnkuanNcbiAqKiBtb2R1bGUgaWQgPSAyNjZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 267 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = __webpack_require__(243);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19yZWRlZmluZS5qcz8xYzE1Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9faGlkZScpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3JlZGVmaW5lLmpzXG4gKiogbW9kdWxlIGlkID0gMjY3XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 268 */
/***/ function(module, exports) {

	eval("module.exports = {};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyYXRvcnMuanM/YTA1YSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXJhdG9ycy5qc1xuICoqIG1vZHVsZSBpZCA9IDI2OFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 269 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\nvar create         = __webpack_require__(270)\n  , descriptor     = __webpack_require__(252)\n  , setToStringTag = __webpack_require__(282)\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\n__webpack_require__(243)(IteratorPrototype, __webpack_require__(283)('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = create(IteratorPrototype, {next: descriptor(1, next)});\n  setToStringTag(Constructor, NAME + ' Iterator');\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWNyZWF0ZS5qcz82NDQ5Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBjcmVhdGUgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKVxuICAsIGRlc2NyaXB0b3IgICAgID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpXG4gICwgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpXG4gICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcblxuLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKClcbnJlcXVpcmUoJy4vX2hpZGUnKShJdGVyYXRvclByb3RvdHlwZSwgcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCl7XG4gIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTtcbiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItY3JlYXRlLmpzXG4gKiogbW9kdWxlIGlkID0gMjY5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 270 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject    = __webpack_require__(245)\n  , dPs         = __webpack_require__(271)\n  , enumBugKeys = __webpack_require__(280)\n  , IE_PROTO    = __webpack_require__(234)('IE_PROTO')\n  , Empty       = function(){ /* empty */ }\n  , PROTOTYPE   = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function(){\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = __webpack_require__(250)('iframe')\n    , i      = enumBugKeys.length\n    , lt     = '<'\n    , gt     = '>'\n    , iframeDocument;\n  iframe.style.display = 'none';\n  __webpack_require__(281).appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties){\n  var result;\n  if(O !== null){\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty;\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtY3JlYXRlLmpzP2I5ZjgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG52YXIgYW5PYmplY3QgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKVxuICAsIGRQcyAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwcycpXG4gICwgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJylcbiAgLCBJRV9QUk9UTyAgICA9IHJlcXVpcmUoJy4vX3NoYXJlZC1rZXknKSgnSUVfUFJPVE8nKVxuICAsIEVtcHR5ICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfVxuICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGVcbnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXtcbiAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWdcbiAgdmFyIGlmcmFtZSA9IHJlcXVpcmUoJy4vX2RvbS1jcmVhdGUnKSgnaWZyYW1lJylcbiAgICAsIGkgICAgICA9IGVudW1CdWdLZXlzLmxlbmd0aFxuICAgICwgbHQgICAgID0gJzwnXG4gICAgLCBndCAgICAgPSAnPidcbiAgICAsIGlmcmFtZURvY3VtZW50O1xuICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgcmVxdWlyZSgnLi9faHRtbCcpLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIGlmcmFtZS5zcmMgPSAnamF2YXNjcmlwdDonOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNjcmlwdC11cmxcbiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDtcbiAgLy8gaHRtbC5yZW1vdmVDaGlsZChpZnJhbWUpO1xuICBpZnJhbWVEb2N1bWVudCA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7XG4gIGlmcmFtZURvY3VtZW50LndyaXRlKGx0ICsgJ3NjcmlwdCcgKyBndCArICdkb2N1bWVudC5GPU9iamVjdCcgKyBsdCArICcvc2NyaXB0JyArIGd0KTtcbiAgaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTtcbiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7XG4gIHdoaWxlKGktLSlkZWxldGUgY3JlYXRlRGljdFtQUk9UT1RZUEVdW2VudW1CdWdLZXlzW2ldXTtcbiAgcmV0dXJuIGNyZWF0ZURpY3QoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcyl7XG4gIHZhciByZXN1bHQ7XG4gIGlmKE8gIT09IG51bGwpe1xuICAgIEVtcHR5W1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTtcbiAgICByZXN1bHQgPSBuZXcgRW1wdHk7XG4gICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpO1xuICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZFBzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWNyZWF0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDI3MFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 271 */
/***/ function(module, exports, __webpack_require__) {

	eval("var dP       = __webpack_require__(244)\n  , anObject = __webpack_require__(245)\n  , getKeys  = __webpack_require__(272);\n\nmodule.exports = __webpack_require__(248) ? Object.defineProperties : function defineProperties(O, Properties){\n  anObject(O);\n  var keys   = getKeys(Properties)\n    , length = keys.length\n    , i = 0\n    , P;\n  while(length > i)dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZHBzLmpzPzMxMjEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGRQICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJylcbiAgLCBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpXG4gICwgZ2V0S2V5cyAgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7XG4gIGFuT2JqZWN0KE8pO1xuICB2YXIga2V5cyAgID0gZ2V0S2V5cyhQcm9wZXJ0aWVzKVxuICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGhcbiAgICAsIGkgPSAwXG4gICAgLCBQO1xuICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7XG4gIHJldHVybiBPO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZHBzLmpzXG4gKiogbW9kdWxlIGlkID0gMjcxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 272 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys       = __webpack_require__(273)\n  , enumBugKeys = __webpack_require__(280);\n\nmodule.exports = Object.keys || function keys(O){\n  return $keys(O, enumBugKeys);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qta2V5cy5qcz9jNTljIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKVxudmFyICRrZXlzICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwnKVxuICAsIGVudW1CdWdLZXlzID0gcmVxdWlyZSgnLi9fZW51bS1idWcta2V5cycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTyl7XG4gIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1rZXlzLmpzXG4gKiogbW9kdWxlIGlkID0gMjcyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 273 */
/***/ function(module, exports, __webpack_require__) {

	eval("var has          = __webpack_require__(233)\n  , toIObject    = __webpack_require__(274)\n  , arrayIndexOf = __webpack_require__(277)(false)\n  , IE_PROTO     = __webpack_require__(234)('IE_PROTO');\n\nmodule.exports = function(object, names){\n  var O      = toIObject(object)\n    , i      = 0\n    , result = []\n    , key;\n  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while(names.length > i)if(has(O, key = names[i++])){\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjczLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qta2V5cy1pbnRlcm5hbC5qcz83MTA5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBoYXMgICAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKVxuICAsIHRvSU9iamVjdCAgICA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKVxuICAsIGFycmF5SW5kZXhPZiA9IHJlcXVpcmUoJy4vX2FycmF5LWluY2x1ZGVzJykoZmFsc2UpXG4gICwgSUVfUFJPVE8gICAgID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgbmFtZXMpe1xuICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdClcbiAgICAsIGkgICAgICA9IDBcbiAgICAsIHJlc3VsdCA9IFtdXG4gICAgLCBrZXk7XG4gIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTtcbiAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5c1xuICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7XG4gICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qta2V5cy1pbnRlcm5hbC5qc1xuICoqIG1vZHVsZSBpZCA9IDI3M1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 274 */
/***/ function(module, exports, __webpack_require__) {

	eval("// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = __webpack_require__(275)\n  , defined = __webpack_require__(231);\nmodule.exports = function(it){\n  return IObject(defined(it));\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1pb2JqZWN0LmpzPzYzZWYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzXG52YXIgSU9iamVjdCA9IHJlcXVpcmUoJy4vX2lvYmplY3QnKVxuICAsIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1pb2JqZWN0LmpzXG4gKiogbW9kdWxlIGlkID0gMjc0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 275 */
/***/ function(module, exports, __webpack_require__) {

	eval("// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = __webpack_require__(276);\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pb2JqZWN0LmpzPzJlNjYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3NcbnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBjb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faW9iamVjdC5qc1xuICoqIG1vZHVsZSBpZCA9IDI3NVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 276 */
/***/ function(module, exports) {

	eval("var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19jb2YuanM/YjVkNCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NvZi5qc1xuICoqIG1vZHVsZSBpZCA9IDI3NlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 277 */
/***/ function(module, exports, __webpack_require__) {

	eval("// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = __webpack_require__(274)\n  , toLength  = __webpack_require__(278)\n  , toIndex   = __webpack_require__(279);\nmodule.exports = function(IS_INCLUDES){\n  return function($this, el, fromIndex){\n    var O      = toIObject($this)\n      , length = toLength(O.length)\n      , index  = toIndex(fromIndex, length)\n      , value;\n    // Array#includes uses SameValueZero equality algorithm\n    if(IS_INCLUDES && el != el)while(length > index){\n      value = O[index++];\n      if(value != value)return true;\n    // Array#toIndex ignores holes, Array#includes - not\n    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n      if(O[index] === el)return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hcnJheS1pbmNsdWRlcy5qcz80M2ZkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2Zcbi8vIHRydWUgIC0+IEFycmF5I2luY2x1ZGVzXG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpXG4gICwgdG9MZW5ndGggID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJylcbiAgLCB0b0luZGV4ICAgPSByZXF1aXJlKCcuL190by1pbmRleCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7XG4gIHJldHVybiBmdW5jdGlvbigkdGhpcywgZWwsIGZyb21JbmRleCl7XG4gICAgdmFyIE8gICAgICA9IHRvSU9iamVjdCgkdGhpcylcbiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpXG4gICAgICAsIGluZGV4ICA9IHRvSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpXG4gICAgICAsIHZhbHVlO1xuICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG1cbiAgICBpZihJU19JTkNMVURFUyAmJiBlbCAhPSBlbCl3aGlsZShsZW5ndGggPiBpbmRleCl7XG4gICAgICB2YWx1ZSA9IE9baW5kZXgrK107XG4gICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTtcbiAgICAvLyBBcnJheSN0b0luZGV4IGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90XG4gICAgfSBlbHNlIGZvcig7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspaWYoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTyl7XG4gICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7XG4gICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xO1xuICB9O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hcnJheS1pbmNsdWRlcy5qc1xuICoqIG1vZHVsZSBpZCA9IDI3N1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 278 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 7.1.15 ToLength\nvar toInteger = __webpack_require__(264)\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1sZW5ndGguanM/NzVlNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA3LjEuMTUgVG9MZW5ndGhcbnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJylcbiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MVxufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1sZW5ndGguanNcbiAqKiBtb2R1bGUgaWQgPSAyNzhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 279 */
/***/ function(module, exports, __webpack_require__) {

	eval("var toInteger = __webpack_require__(264)\n  , max       = Math.max\n  , min       = Math.min;\nmodule.exports = function(index, length){\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1pbmRleC5qcz81MTVlIl0sInNvdXJjZXNDb250ZW50IjpbInZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJylcbiAgLCBtYXggICAgICAgPSBNYXRoLm1heFxuICAsIG1pbiAgICAgICA9IE1hdGgubWluO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbmRleCwgbGVuZ3RoKXtcbiAgaW5kZXggPSB0b0ludGVnZXIoaW5kZXgpO1xuICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8taW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAyNzlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 280 */
/***/ function(module, exports) {

	eval("// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19lbnVtLWJ1Zy1rZXlzLmpzP2QxMDAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5c1xubW9kdWxlLmV4cG9ydHMgPSAoXG4gICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnXG4pLnNwbGl0KCcsJyk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZW51bS1idWcta2V5cy5qc1xuICoqIG1vZHVsZSBpZCA9IDI4MFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 281 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = __webpack_require__(236).document && document.documentElement;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19odG1sLmpzPzNjNTUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faHRtbC5qc1xuICoqIG1vZHVsZSBpZCA9IDI4MVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 282 */
/***/ function(module, exports, __webpack_require__) {

	eval("var def = __webpack_require__(244).f\n  , has = __webpack_require__(233)\n  , TAG = __webpack_require__(283)('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zZXQtdG8tc3RyaW5nLXRhZy5qcz81NDI0Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBkZWYgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mXG4gICwgaGFzID0gcmVxdWlyZSgnLi9faGFzJylcbiAgLCBUQUcgPSByZXF1aXJlKCcuL193a3MnKSgndG9TdHJpbmdUYWcnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXtcbiAgaWYoaXQgJiYgIWhhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSlkZWYoaXQsIFRBRywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZ30pO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zZXQtdG8tc3RyaW5nLXRhZy5qc1xuICoqIG1vZHVsZSBpZCA9IDI4MlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 283 */
/***/ function(module, exports, __webpack_require__) {

	eval("var store      = __webpack_require__(235)('wks')\n  , uid        = __webpack_require__(237)\n  , Symbol     = __webpack_require__(236).Symbol\n  , USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function(name){\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MuanM/ODkxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgc3RvcmUgICAgICA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCd3a3MnKVxuICAsIHVpZCAgICAgICAgPSByZXF1aXJlKCcuL191aWQnKVxuICAsIFN5bWJvbCAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5TeW1ib2xcbiAgLCBVU0VfU1lNQk9MID0gdHlwZW9mIFN5bWJvbCA9PSAnZnVuY3Rpb24nO1xuXG52YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpe1xuICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID1cbiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpO1xufTtcblxuJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MuanNcbiAqKiBtb2R1bGUgaWQgPSAyODNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 284 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(285);\nvar global        = __webpack_require__(236)\n  , hide          = __webpack_require__(243)\n  , Iterators     = __webpack_require__(268)\n  , TO_STRING_TAG = __webpack_require__(283)('toStringTag');\n\nfor(var collections = ['NodeList', 'DOMTokenList', 'MediaList', 'StyleSheetList', 'CSSRuleList'], i = 0; i < 5; i++){\n  var NAME       = collections[i]\n    , Collection = global[NAME]\n    , proto      = Collection && Collection.prototype;\n  if(proto && !proto[TO_STRING_TAG])hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUuanM/NzNkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpO1xudmFyIGdsb2JhbCAgICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKVxuICAsIGhpZGUgICAgICAgICAgPSByZXF1aXJlKCcuL19oaWRlJylcbiAgLCBJdGVyYXRvcnMgICAgID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJylcbiAgLCBUT19TVFJJTkdfVEFHID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvU3RyaW5nVGFnJyk7XG5cbmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspe1xuICB2YXIgTkFNRSAgICAgICA9IGNvbGxlY3Rpb25zW2ldXG4gICAgLCBDb2xsZWN0aW9uID0gZ2xvYmFsW05BTUVdXG4gICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTtcbiAgaWYocHJvdG8gJiYgIXByb3RvW1RPX1NUUklOR19UQUddKWhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpO1xuICBJdGVyYXRvcnNbTkFNRV0gPSBJdGVyYXRvcnMuQXJyYXk7XG59XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlLmpzXG4gKiogbW9kdWxlIGlkID0gMjg0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 285 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\nvar addToUnscopables = __webpack_require__(286)\n  , step             = __webpack_require__(287)\n  , Iterators        = __webpack_require__(268)\n  , toIObject        = __webpack_require__(274);\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = __webpack_require__(265)(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5hcnJheS5pdGVyYXRvci5qcz8yNjlhIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBhZGRUb1Vuc2NvcGFibGVzID0gcmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJylcbiAgLCBzdGVwICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faXRlci1zdGVwJylcbiAgLCBJdGVyYXRvcnMgICAgICAgID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJylcbiAgLCB0b0lPYmplY3QgICAgICAgID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xuXG4vLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpXG4vLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKVxuLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMoKVxuLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2l0ZXItZGVmaW5lJykoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKXtcbiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZFxuLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbigpe1xuICB2YXIgTyAgICAgPSB0aGlzLl90XG4gICAgLCBraW5kICA9IHRoaXMuX2tcbiAgICAsIGluZGV4ID0gdGhpcy5faSsrO1xuICBpZighTyB8fCBpbmRleCA+PSBPLmxlbmd0aCl7XG4gICAgdGhpcy5fdCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gc3RlcCgxKTtcbiAgfVxuICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTtcbiAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7XG4gIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTtcbn0sICd2YWx1ZXMnKTtcblxuLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KVxuSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTtcblxuYWRkVG9VbnNjb3BhYmxlcygna2V5cycpO1xuYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7XG5hZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYuYXJyYXkuaXRlcmF0b3IuanNcbiAqKiBtb2R1bGUgaWQgPSAyODVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 286 */
/***/ function(module, exports) {

	eval("module.exports = function(){ /* empty */ };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19hZGQtdG8tdW5zY29wYWJsZXMuanM/YjA5YiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYWRkLXRvLXVuc2NvcGFibGVzLmpzXG4gKiogbW9kdWxlIGlkID0gMjg2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 287 */
/***/ function(module, exports) {

	eval("module.exports = function(done, value){\n  return {value: value, done: !!done};\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLXN0ZXAuanM/OWUyMSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXtcbiAgcmV0dXJuIHt2YWx1ZTogdmFsdWUsIGRvbmU6ICEhZG9uZX07XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItc3RlcC5qc1xuICoqIG1vZHVsZSBpZCA9IDI4N1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 288 */
/***/ function(module, exports, __webpack_require__) {

	eval("exports.f = __webpack_require__(283);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZXh0LmpzPzRjNTYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fd2tzJyk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fd2tzLWV4dC5qc1xuICoqIG1vZHVsZSBpZCA9IDI4OFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 289 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(290), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjg5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbC5qcz9hNGI0Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2xcIiksIF9fZXNNb2R1bGU6IHRydWUgfTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL3N5bWJvbC5qc1xuICoqIG1vZHVsZSBpZCA9IDI4OVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 290 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(291);\n__webpack_require__(302);\n__webpack_require__(303);\n__webpack_require__(304);\nmodule.exports = __webpack_require__(240).Symbol;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaW5kZXguanM/YWNhYiJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5zeW1ib2wnKTtcbnJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmcnKTtcbnJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM3LnN5bWJvbC5hc3luYy1pdGVyYXRvcicpO1xucmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczcuc3ltYm9sLm9ic2VydmFibGUnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLlN5bWJvbDtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAyOTBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 291 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n// ECMAScript 6 symbols shim\nvar global         = __webpack_require__(236)\n  , has            = __webpack_require__(233)\n  , DESCRIPTORS    = __webpack_require__(248)\n  , $export        = __webpack_require__(239)\n  , redefine       = __webpack_require__(267)\n  , META           = __webpack_require__(292).KEY\n  , $fails         = __webpack_require__(249)\n  , shared         = __webpack_require__(235)\n  , setToStringTag = __webpack_require__(282)\n  , uid            = __webpack_require__(237)\n  , wks            = __webpack_require__(283)\n  , wksExt         = __webpack_require__(288)\n  , wksDefine      = __webpack_require__(293)\n  , keyOf          = __webpack_require__(294)\n  , enumKeys       = __webpack_require__(295)\n  , isArray        = __webpack_require__(298)\n  , anObject       = __webpack_require__(245)\n  , toIObject      = __webpack_require__(274)\n  , toPrimitive    = __webpack_require__(251)\n  , createDesc     = __webpack_require__(252)\n  , _create        = __webpack_require__(270)\n  , gOPNExt        = __webpack_require__(299)\n  , $GOPD          = __webpack_require__(301)\n  , $DP            = __webpack_require__(244)\n  , $keys          = __webpack_require__(272)\n  , gOPD           = $GOPD.f\n  , dP             = $DP.f\n  , gOPN           = gOPNExt.f\n  , $Symbol        = global.Symbol\n  , $JSON          = global.JSON\n  , _stringify     = $JSON && $JSON.stringify\n  , PROTOTYPE      = 'prototype'\n  , HIDDEN         = wks('_hidden')\n  , TO_PRIMITIVE   = wks('toPrimitive')\n  , isEnum         = {}.propertyIsEnumerable\n  , SymbolRegistry = shared('symbol-registry')\n  , AllSymbols     = shared('symbols')\n  , OPSymbols      = shared('op-symbols')\n  , ObjectProto    = Object[PROTOTYPE]\n  , USE_NATIVE     = typeof $Symbol == 'function'\n  , QObject        = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function(){\n  return _create(dP({}, 'a', {\n    get: function(){ return dP(this, 'a', {value: 7}).a; }\n  })).a != 7;\n}) ? function(it, key, D){\n  var protoDesc = gOPD(ObjectProto, key);\n  if(protoDesc)delete ObjectProto[key];\n  dP(it, key, D);\n  if(protoDesc && it !== ObjectProto)dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function(tag){\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function(it){\n  return typeof it == 'symbol';\n} : function(it){\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D){\n  if(it === ObjectProto)$defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if(has(AllSymbols, key)){\n    if(!D.enumerable){\n      if(!has(it, HIDDEN))dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if(has(it, HIDDEN) && it[HIDDEN][key])it[HIDDEN][key] = false;\n      D = _create(D, {enumerable: createDesc(0, false)});\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P){\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P))\n    , i    = 0\n    , l = keys.length\n    , key;\n  while(l > i)$defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P){\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key){\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if(this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key){\n  it  = toIObject(it);\n  key = toPrimitive(key, true);\n  if(it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return;\n  var D = gOPD(it, key);\n  if(D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key]))D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it){\n  var names  = gOPN(toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META)result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it){\n  var IS_OP  = it === ObjectProto\n    , names  = gOPN(IS_OP ? OPSymbols : toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true))result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif(!USE_NATIVE){\n  $Symbol = function Symbol(){\n    if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function(value){\n      if(this === ObjectProto)$set.call(OPSymbols, value);\n      if(has(this, HIDDEN) && has(this[HIDDEN], tag))this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if(DESCRIPTORS && setter)setSymbolDesc(ObjectProto, tag, {configurable: true, set: $set});\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString(){\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f   = $defineProperty;\n  __webpack_require__(300).f = gOPNExt.f = $getOwnPropertyNames;\n  __webpack_require__(297).f  = $propertyIsEnumerable;\n  __webpack_require__(296).f = $getOwnPropertySymbols;\n\n  if(DESCRIPTORS && !__webpack_require__(266)){\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function(name){\n    return wrap(wks(name));\n  }\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Symbol: $Symbol});\n\nfor(var symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), i = 0; symbols.length > i; )wks(symbols[i++]);\n\nfor(var symbols = $keys(wks.store), i = 0; symbols.length > i; )wksDefine(symbols[i++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function(key){\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key){\n    if(isSymbol(key))return keyOf(SymbolRegistry, key);\n    throw TypeError(key + ' is not a symbol!');\n  },\n  useSetter: function(){ setter = true; },\n  useSimple: function(){ setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function(){\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({a: S}) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it){\n    if(it === undefined || isSymbol(it))return; // IE8 returns string on undefined\n    var args = [it]\n      , i    = 1\n      , replacer, $replacer;\n    while(arguments.length > i)args.push(arguments[i++]);\n    replacer = args[1];\n    if(typeof replacer == 'function')$replacer = replacer;\n    if($replacer || !isArray(replacer))replacer = function(key, value){\n      if($replacer)value = $replacer.call(this, key, value);\n      if(!isSymbol(value))return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(243)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zeW1ib2wuanM/ZDViOSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltXG52YXIgZ2xvYmFsICAgICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKVxuICAsIGhhcyAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJylcbiAgLCBERVNDUklQVE9SUyAgICA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJylcbiAgLCAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpXG4gICwgcmVkZWZpbmUgICAgICAgPSByZXF1aXJlKCcuL19yZWRlZmluZScpXG4gICwgTUVUQSAgICAgICAgICAgPSByZXF1aXJlKCcuL19tZXRhJykuS0VZXG4gICwgJGZhaWxzICAgICAgICAgPSByZXF1aXJlKCcuL19mYWlscycpXG4gICwgc2hhcmVkICAgICAgICAgPSByZXF1aXJlKCcuL19zaGFyZWQnKVxuICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKVxuICAsIHVpZCAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fdWlkJylcbiAgLCB3a3MgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3drcycpXG4gICwgd2tzRXh0ICAgICAgICAgPSByZXF1aXJlKCcuL193a3MtZXh0JylcbiAgLCB3a3NEZWZpbmUgICAgICA9IHJlcXVpcmUoJy4vX3drcy1kZWZpbmUnKVxuICAsIGtleU9mICAgICAgICAgID0gcmVxdWlyZSgnLi9fa2V5b2YnKVxuICAsIGVudW1LZXlzICAgICAgID0gcmVxdWlyZSgnLi9fZW51bS1rZXlzJylcbiAgLCBpc0FycmF5ICAgICAgICA9IHJlcXVpcmUoJy4vX2lzLWFycmF5JylcbiAgLCBhbk9iamVjdCAgICAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpXG4gICwgdG9JT2JqZWN0ICAgICAgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JylcbiAgLCB0b1ByaW1pdGl2ZSAgICA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpXG4gICwgY3JlYXRlRGVzYyAgICAgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJylcbiAgLCBfY3JlYXRlICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKVxuICAsIGdPUE5FeHQgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4tZXh0JylcbiAgLCAkR09QRCAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJylcbiAgLCAkRFAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpXG4gICwgJGtleXMgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpXG4gICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mXG4gICwgZFAgICAgICAgICAgICAgPSAkRFAuZlxuICAsIGdPUE4gICAgICAgICAgID0gZ09QTkV4dC5mXG4gICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sXG4gICwgJEpTT04gICAgICAgICAgPSBnbG9iYWwuSlNPTlxuICAsIF9zdHJpbmdpZnkgICAgID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5XG4gICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJ1xuICAsIEhJRERFTiAgICAgICAgID0gd2tzKCdfaGlkZGVuJylcbiAgLCBUT19QUklNSVRJVkUgICA9IHdrcygndG9QcmltaXRpdmUnKVxuICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGVcbiAgLCBTeW1ib2xSZWdpc3RyeSA9IHNoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5JylcbiAgLCBBbGxTeW1ib2xzICAgICA9IHNoYXJlZCgnc3ltYm9scycpXG4gICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKVxuICAsIE9iamVjdFByb3RvICAgID0gT2JqZWN0W1BST1RPVFlQRV1cbiAgLCBVU0VfTkFUSVZFICAgICA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbidcbiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0O1xuLy8gRG9uJ3QgdXNlIHNldHRlcnMgaW4gUXQgU2NyaXB0LCBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMTczXG52YXIgc2V0dGVyID0gIVFPYmplY3QgfHwgIVFPYmplY3RbUFJPVE9UWVBFXSB8fCAhUU9iamVjdFtQUk9UT1RZUEVdLmZpbmRDaGlsZDtcblxuLy8gZmFsbGJhY2sgZm9yIG9sZCBBbmRyb2lkLCBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9Njg3XG52YXIgc2V0U3ltYm9sRGVzYyA9IERFU0NSSVBUT1JTICYmICRmYWlscyhmdW5jdGlvbigpe1xuICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7XG4gICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gZFAodGhpcywgJ2EnLCB7dmFsdWU6IDd9KS5hOyB9XG4gIH0pKS5hICE9IDc7XG59KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpe1xuICB2YXIgcHJvdG9EZXNjID0gZ09QRChPYmplY3RQcm90bywga2V5KTtcbiAgaWYocHJvdG9EZXNjKWRlbGV0ZSBPYmplY3RQcm90b1trZXldO1xuICBkUChpdCwga2V5LCBEKTtcbiAgaWYocHJvdG9EZXNjICYmIGl0ICE9PSBPYmplY3RQcm90bylkUChPYmplY3RQcm90bywga2V5LCBwcm90b0Rlc2MpO1xufSA6IGRQO1xuXG52YXIgd3JhcCA9IGZ1bmN0aW9uKHRhZyl7XG4gIHZhciBzeW0gPSBBbGxTeW1ib2xzW3RhZ10gPSBfY3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFXSk7XG4gIHN5bS5fayA9IHRhZztcbiAgcmV0dXJuIHN5bTtcbn07XG5cbnZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbihpdCl7XG4gIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7XG59IDogZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQgaW5zdGFuY2VvZiAkU3ltYm9sO1xufTtcblxudmFyICRkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIEQpe1xuICBpZihpdCA9PT0gT2JqZWN0UHJvdG8pJGRlZmluZVByb3BlcnR5KE9QU3ltYm9scywga2V5LCBEKTtcbiAgYW5PYmplY3QoaXQpO1xuICBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpO1xuICBhbk9iamVjdChEKTtcbiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpe1xuICAgIGlmKCFELmVudW1lcmFibGUpe1xuICAgICAgaWYoIWhhcyhpdCwgSElEREVOKSlkUChpdCwgSElEREVOLCBjcmVhdGVEZXNjKDEsIHt9KSk7XG4gICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZihoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKWl0W0hJRERFTl1ba2V5XSA9IGZhbHNlO1xuICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7XG4gICAgfSByZXR1cm4gc2V0U3ltYm9sRGVzYyhpdCwga2V5LCBEKTtcbiAgfSByZXR1cm4gZFAoaXQsIGtleSwgRCk7XG59O1xudmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhpdCwgUCl7XG4gIGFuT2JqZWN0KGl0KTtcbiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKVxuICAgICwgaSAgICA9IDBcbiAgICAsIGwgPSBrZXlzLmxlbmd0aFxuICAgICwga2V5O1xuICB3aGlsZShsID4gaSkkZGVmaW5lUHJvcGVydHkoaXQsIGtleSA9IGtleXNbaSsrXSwgUFtrZXldKTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciAkY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGl0LCBQKXtcbiAgcmV0dXJuIFAgPT09IHVuZGVmaW5lZCA/IF9jcmVhdGUoaXQpIDogJGRlZmluZVByb3BlcnRpZXMoX2NyZWF0ZShpdCksIFApO1xufTtcbnZhciAkcHJvcGVydHlJc0VudW1lcmFibGUgPSBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShrZXkpe1xuICB2YXIgRSA9IGlzRW51bS5jYWxsKHRoaXMsIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpO1xuICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7XG4gIHJldHVybiBFIHx8ICFoYXModGhpcywga2V5KSB8fCAhaGFzKEFsbFN5bWJvbHMsIGtleSkgfHwgaGFzKHRoaXMsIEhJRERFTikgJiYgdGhpc1tISURERU5dW2tleV0gPyBFIDogdHJ1ZTtcbn07XG52YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXtcbiAgaXQgID0gdG9JT2JqZWN0KGl0KTtcbiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTtcbiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjtcbiAgdmFyIEQgPSBnT1BEKGl0LCBrZXkpO1xuICBpZihEICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICEoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkpRC5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgcmV0dXJuIEQ7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eU5hbWVzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7XG4gIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpXG4gICAgLCByZXN1bHQgPSBbXVxuICAgICwgaSAgICAgID0gMFxuICAgICwga2V5O1xuICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKXtcbiAgICBpZighaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIGtleSAhPSBISURERU4gJiYga2V5ICE9IE1FVEEpcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KXtcbiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90b1xuICAgICwgbmFtZXMgID0gZ09QTihJU19PUCA/IE9QU3ltYm9scyA6IHRvSU9iamVjdChpdCkpXG4gICAgLCByZXN1bHQgPSBbXVxuICAgICwgaSAgICAgID0gMFxuICAgICwga2V5O1xuICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKXtcbiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pXG5pZighVVNFX05BVElWRSl7XG4gICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXtcbiAgICBpZih0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCl0aHJvdyBUeXBlRXJyb3IoJ1N5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciEnKTtcbiAgICB2YXIgdGFnID0gdWlkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTtcbiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgIGlmKHRoaXMgPT09IE9iamVjdFByb3RvKSRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTtcbiAgICAgIGlmKGhhcyh0aGlzLCBISURERU4pICYmIGhhcyh0aGlzW0hJRERFTl0sIHRhZykpdGhpc1tISURERU5dW3RhZ10gPSBmYWxzZTtcbiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7XG4gICAgfTtcbiAgICBpZihERVNDUklQVE9SUyAmJiBzZXR0ZXIpc2V0U3ltYm9sRGVzYyhPYmplY3RQcm90bywgdGFnLCB7Y29uZmlndXJhYmxlOiB0cnVlLCBzZXQ6ICRzZXR9KTtcbiAgICByZXR1cm4gd3JhcCh0YWcpO1xuICB9O1xuICByZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRV0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCl7XG4gICAgcmV0dXJuIHRoaXMuX2s7XG4gIH0pO1xuXG4gICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICAkRFAuZiAgID0gJGRlZmluZVByb3BlcnR5O1xuICByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmYgPSBnT1BORXh0LmYgPSAkZ2V0T3duUHJvcGVydHlOYW1lcztcbiAgcmVxdWlyZSgnLi9fb2JqZWN0LXBpZScpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlO1xuICByZXF1aXJlKCcuL19vYmplY3QtZ29wcycpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuXG4gIGlmKERFU0NSSVBUT1JTICYmICFyZXF1aXJlKCcuL19saWJyYXJ5Jykpe1xuICAgIHJlZGVmaW5lKE9iamVjdFByb3RvLCAncHJvcGVydHlJc0VudW1lcmFibGUnLCAkcHJvcGVydHlJc0VudW1lcmFibGUsIHRydWUpO1xuICB9XG5cbiAgd2tzRXh0LmYgPSBmdW5jdGlvbihuYW1lKXtcbiAgICByZXR1cm4gd3JhcCh3a3MobmFtZSkpO1xuICB9XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTtcblxuZm9yKHZhciBzeW1ib2xzID0gKFxuICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNFxuICAnaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMnXG4pLnNwbGl0KCcsJyksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3Moc3ltYm9sc1tpKytdKTtcblxuZm9yKHZhciBzeW1ib2xzID0gJGtleXMod2tzLnN0b3JlKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrc0RlZmluZShzeW1ib2xzW2krK10pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywge1xuICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSlcbiAgJ2Zvcic6IGZ1bmN0aW9uKGtleSl7XG4gICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKVxuICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldXG4gICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7XG4gIH0sXG4gIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKVxuICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihrZXkpe1xuICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpO1xuICAgIHRocm93IFR5cGVFcnJvcihrZXkgKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTtcbiAgfSxcbiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LFxuICB1c2VTaW1wbGU6IGZ1bmN0aW9uKCl7IHNldHRlciA9IGZhbHNlOyB9XG59KTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ09iamVjdCcsIHtcbiAgLy8gMTkuMS4yLjIgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKVxuICBjcmVhdGU6ICRjcmVhdGUsXG4gIC8vIDE5LjEuMi40IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKVxuICBkZWZpbmVQcm9wZXJ0eTogJGRlZmluZVByb3BlcnR5LFxuICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKVxuICBkZWZpbmVQcm9wZXJ0aWVzOiAkZGVmaW5lUHJvcGVydGllcyxcbiAgLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKVxuICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gIC8vIDE5LjEuMi43IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pXG4gIGdldE93blByb3BlcnR5TmFtZXM6ICRnZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pXG4gIGdldE93blByb3BlcnR5U3ltYm9sczogJGdldE93blByb3BlcnR5U3ltYm9sc1xufSk7XG5cbi8vIDI0LjMuMiBKU09OLnN0cmluZ2lmeSh2YWx1ZSBbLCByZXBsYWNlciBbLCBzcGFjZV1dKVxuJEpTT04gJiYgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgJGZhaWxzKGZ1bmN0aW9uKCl7XG4gIHZhciBTID0gJFN5bWJvbCgpO1xuICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fVxuICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGxcbiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHNcbiAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHthOiBTfSkgIT0gJ3t9JyB8fCBfc3RyaW5naWZ5KE9iamVjdChTKSkgIT0gJ3t9Jztcbn0pKSwgJ0pTT04nLCB7XG4gIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXtcbiAgICBpZihpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSlyZXR1cm47IC8vIElFOCByZXR1cm5zIHN0cmluZyBvbiB1bmRlZmluZWRcbiAgICB2YXIgYXJncyA9IFtpdF1cbiAgICAgICwgaSAgICA9IDFcbiAgICAgICwgcmVwbGFjZXIsICRyZXBsYWNlcjtcbiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pO1xuICAgIHJlcGxhY2VyID0gYXJnc1sxXTtcbiAgICBpZih0eXBlb2YgcmVwbGFjZXIgPT0gJ2Z1bmN0aW9uJykkcmVwbGFjZXIgPSByZXBsYWNlcjtcbiAgICBpZigkcmVwbGFjZXIgfHwgIWlzQXJyYXkocmVwbGFjZXIpKXJlcGxhY2VyID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSl7XG4gICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTtcbiAgICAgIGlmKCFpc1N5bWJvbCh2YWx1ZSkpcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgYXJnc1sxXSA9IHJlcGxhY2VyO1xuICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTtcbiAgfVxufSk7XG5cbi8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludClcbiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IHJlcXVpcmUoJy4vX2hpZGUnKSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpO1xuLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpO1xuLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTtcbi8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddXG5zZXRUb1N0cmluZ1RhZyhnbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zeW1ib2wuanNcbiAqKiBtb2R1bGUgaWQgPSAyOTFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 292 */
/***/ function(module, exports, __webpack_require__) {

	eval("var META     = __webpack_require__(237)('meta')\n  , isObject = __webpack_require__(246)\n  , has      = __webpack_require__(233)\n  , setDesc  = __webpack_require__(244).f\n  , id       = 0;\nvar isExtensible = Object.isExtensible || function(){\n  return true;\n};\nvar FREEZE = !__webpack_require__(249)(function(){\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function(it){\n  setDesc(it, META, {value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  }});\n};\nvar fastKey = function(it, create){\n  // return primitive with prefix\n  if(!isObject(it))return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return 'F';\n    // not necessary to add metadata\n    if(!create)return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function(it, create){\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return true;\n    // not necessary to add metadata\n    if(!create)return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function(it){\n  if(FREEZE && meta.NEED && isExtensible(it) && !has(it, META))setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY:      META,\n  NEED:     false,\n  fastKey:  fastKey,\n  getWeak:  getWeak,\n  onFreeze: onFreeze\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19tZXRhLmpzPzRmOGQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIE1FVEEgICAgID0gcmVxdWlyZSgnLi9fdWlkJykoJ21ldGEnKVxuICAsIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JylcbiAgLCBoYXMgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpXG4gICwgc2V0RGVzYyAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mXG4gICwgaWQgICAgICAgPSAwO1xudmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHRydWU7XG59O1xudmFyIEZSRUVaRSA9ICFyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7XG4gIHJldHVybiBpc0V4dGVuc2libGUoT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHt9KSk7XG59KTtcbnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpe1xuICBzZXREZXNjKGl0LCBNRVRBLCB7dmFsdWU6IHtcbiAgICBpOiAnTycgKyArK2lkLCAvLyBvYmplY3QgSURcbiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEc1xuICB9fSk7XG59O1xudmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXtcbiAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeFxuICBpZighaXNPYmplY3QoaXQpKXJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7XG4gIGlmKCFoYXMoaXQsIE1FVEEpKXtcbiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdFxuICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiAnRic7XG4gICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGFcbiAgICBpZighY3JlYXRlKXJldHVybiAnRSc7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIG9iamVjdCBJRFxuICB9IHJldHVybiBpdFtNRVRBXS5pO1xufTtcbnZhciBnZXRXZWFrID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7XG4gIGlmKCFoYXMoaXQsIE1FVEEpKXtcbiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdFxuICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiB0cnVlO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSByZXR1cm4gaXRbTUVUQV0udztcbn07XG4vLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmdcbnZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uKGl0KXtcbiAgaWYoRlJFRVpFICYmIG1ldGEuTkVFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFoYXMoaXQsIE1FVEEpKXNldE1ldGEoaXQpO1xuICByZXR1cm4gaXQ7XG59O1xudmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgS0VZOiAgICAgIE1FVEEsXG4gIE5FRUQ6ICAgICBmYWxzZSxcbiAgZmFzdEtleTogIGZhc3RLZXksXG4gIGdldFdlYWs6ICBnZXRXZWFrLFxuICBvbkZyZWV6ZTogb25GcmVlemVcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fbWV0YS5qc1xuICoqIG1vZHVsZSBpZCA9IDI5MlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 293 */
/***/ function(module, exports, __webpack_require__) {

	eval("var global         = __webpack_require__(236)\n  , core           = __webpack_require__(240)\n  , LIBRARY        = __webpack_require__(266)\n  , wksExt         = __webpack_require__(288)\n  , defineProperty = __webpack_require__(244).f;\nmodule.exports = function(name){\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if(name.charAt(0) != '_' && !(name in $Symbol))defineProperty($Symbol, name, {value: wksExt.f(name)});\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZGVmaW5lLmpzPzk0NTEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGdsb2JhbCAgICAgICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJylcbiAgLCBjb3JlICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2NvcmUnKVxuICAsIExJQlJBUlkgICAgICAgID0gcmVxdWlyZSgnLi9fbGlicmFyeScpXG4gICwgd2tzRXh0ICAgICAgICAgPSByZXF1aXJlKCcuL193a3MtZXh0JylcbiAgLCBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpe1xuICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pO1xuICBpZihuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKWRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHt2YWx1ZTogd2tzRXh0LmYobmFtZSl9KTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fd2tzLWRlZmluZS5qc1xuICoqIG1vZHVsZSBpZCA9IDI5M1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 294 */
/***/ function(module, exports, __webpack_require__) {

	eval("var getKeys   = __webpack_require__(272)\n  , toIObject = __webpack_require__(274);\nmodule.exports = function(object, el){\n  var O      = toIObject(object)\n    , keys   = getKeys(O)\n    , length = keys.length\n    , index  = 0\n    , key;\n  while(length > index)if(O[key = keys[index++]] === el)return key;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19rZXlvZi5qcz8wNjM3Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBnZXRLZXlzICAgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpXG4gICwgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIGVsKXtcbiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpXG4gICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pXG4gICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aFxuICAgICwgaW5kZXggID0gMFxuICAgICwga2V5O1xuICB3aGlsZShsZW5ndGggPiBpbmRleClpZihPW2tleSA9IGtleXNbaW5kZXgrK11dID09PSBlbClyZXR1cm4ga2V5O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19rZXlvZi5qc1xuICoqIG1vZHVsZSBpZCA9IDI5NFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 295 */
/***/ function(module, exports, __webpack_require__) {

	eval("// all enumerable object keys, includes symbols\nvar getKeys = __webpack_require__(272)\n  , gOPS    = __webpack_require__(296)\n  , pIE     = __webpack_require__(297);\nmodule.exports = function(it){\n  var result     = getKeys(it)\n    , getSymbols = gOPS.f;\n  if(getSymbols){\n    var symbols = getSymbols(it)\n      , isEnum  = pIE.f\n      , i       = 0\n      , key;\n    while(symbols.length > i)if(isEnum.call(it, key = symbols[i++]))result.push(key);\n  } return result;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19lbnVtLWtleXMuanM/NzNhNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9sc1xudmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpXG4gICwgZ09QUyAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJylcbiAgLCBwSUUgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LXBpZScpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdClcbiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmY7XG4gIGlmKGdldFN5bWJvbHMpe1xuICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdClcbiAgICAgICwgaXNFbnVtICA9IHBJRS5mXG4gICAgICAsIGkgICAgICAgPSAwXG4gICAgICAsIGtleTtcbiAgICB3aGlsZShzeW1ib2xzLmxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19lbnVtLWtleXMuanNcbiAqKiBtb2R1bGUgaWQgPSAyOTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 296 */
/***/ function(module, exports) {

	eval("exports.f = Object.getOwnPropertySymbols;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ29wcy5qcz9mYTM3Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcHMuanNcbiAqKiBtb2R1bGUgaWQgPSAyOTZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 297 */
/***/ function(module, exports) {

	eval("exports.f = {}.propertyIsEnumerable;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtcGllLmpzP2FlMzkiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LXBpZS5qc1xuICoqIG1vZHVsZSBpZCA9IDI5N1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 298 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 7.2.2 IsArray(argument)\nvar cof = __webpack_require__(276);\nmodule.exports = Array.isArray || function isArray(arg){\n  return cof(arg) == 'Array';\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS5qcz84MDQ0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDcuMi4yIElzQXJyYXkoYXJndW1lbnQpXG52YXIgY29mID0gcmVxdWlyZSgnLi9fY29mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpe1xuICByZXR1cm4gY29mKGFyZykgPT0gJ0FycmF5Jztcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXMtYXJyYXkuanNcbiAqKiBtb2R1bGUgaWQgPSAyOThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 299 */
/***/ function(module, exports, __webpack_require__) {

	eval("// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = __webpack_require__(274)\n  , gOPN      = __webpack_require__(300).f\n  , toString  = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function(it){\n  try {\n    return gOPN(it);\n  } catch(e){\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it){\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjk5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ29wbi1leHQuanM/YmFmMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpXG4gICwgZ09QTiAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mXG4gICwgdG9TdHJpbmcgID0ge30udG9TdHJpbmc7XG5cbnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzXG4gID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdO1xuXG52YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbihpdCl7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGdPUE4oaXQpO1xuICB9IGNhdGNoKGUpe1xuICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7XG4gIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZy5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4odG9JT2JqZWN0KGl0KSk7XG59O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcG4tZXh0LmpzXG4gKiogbW9kdWxlIGlkID0gMjk5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 300 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys      = __webpack_require__(273)\n  , hiddenKeys = __webpack_require__(280).concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O){\n  return $keys(O, hiddenKeys);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ29wbi5qcz84MWM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcbnZhciAka2V5cyAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwnKVxuICAsIGhpZGRlbktleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJykuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7XG5cbmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTyl7XG4gIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcG4uanNcbiAqKiBtb2R1bGUgaWQgPSAzMDBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 301 */
/***/ function(module, exports, __webpack_require__) {

	eval("var pIE            = __webpack_require__(297)\n  , createDesc     = __webpack_require__(252)\n  , toIObject      = __webpack_require__(274)\n  , toPrimitive    = __webpack_require__(251)\n  , has            = __webpack_require__(233)\n  , IE8_DOM_DEFINE = __webpack_require__(247)\n  , gOPD           = Object.getOwnPropertyDescriptor;\n\nexports.f = __webpack_require__(248) ? gOPD : function getOwnPropertyDescriptor(O, P){\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if(IE8_DOM_DEFINE)try {\n    return gOPD(O, P);\n  } catch(e){ /* empty */ }\n  if(has(O, P))return createDesc(!pIE.f.call(O, P), O[P]);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ29wZC5qcz8yZDhiIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBwSUUgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1waWUnKVxuICAsIGNyZWF0ZURlc2MgICAgID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpXG4gICwgdG9JT2JqZWN0ICAgICAgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JylcbiAgLCB0b1ByaW1pdGl2ZSAgICA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpXG4gICwgaGFzICAgICAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKVxuICAsIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi9faWU4LWRvbS1kZWZpbmUnKVxuICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcblxuZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IGdPUEQgOiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCl7XG4gIE8gPSB0b0lPYmplY3QoTyk7XG4gIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTtcbiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHtcbiAgICByZXR1cm4gZ09QRChPLCBQKTtcbiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfVxuICBpZihoYXMoTywgUCkpcmV0dXJuIGNyZWF0ZURlc2MoIXBJRS5mLmNhbGwoTywgUCksIE9bUF0pO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ29wZC5qc1xuICoqIG1vZHVsZSBpZCA9IDMwMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 302 */
/***/ function(module, exports) {

	eval("//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nLmpzP2ZhZTkiXSwic291cmNlc0NvbnRlbnQiOlsiXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZy5qc1xuICoqIG1vZHVsZSBpZCA9IDMwMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 303 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(293)('asyncIterator');//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5zeW1ib2wuYXN5bmMtaXRlcmF0b3IuanM/MzdmNSJdLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCcuL193a3MtZGVmaW5lJykoJ2FzeW5jSXRlcmF0b3InKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5zeW1ib2wuYXN5bmMtaXRlcmF0b3IuanNcbiAqKiBtb2R1bGUgaWQgPSAzMDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 304 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(293)('observable');//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5zeW1ib2wub2JzZXJ2YWJsZS5qcz8wODc2Il0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4vX3drcy1kZWZpbmUnKSgnb2JzZXJ2YWJsZScpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM3LnN5bWJvbC5vYnNlcnZhYmxlLmpzXG4gKiogbW9kdWxlIGlkID0gMzA0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 305 */
/***/ function(module, exports, __webpack_require__) {

	eval("\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = __webpack_require__(306);\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = __webpack_require__(310);\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = __webpack_require__(259);\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9oZWxwZXJzL2luaGVyaXRzLmpzP2VmZTIiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfc2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZlwiKTtcblxudmFyIF9zZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXRQcm90b3R5cGVPZik7XG5cbnZhciBfY3JlYXRlID0gcmVxdWlyZShcIi4uL2NvcmUtanMvb2JqZWN0L2NyZWF0ZVwiKTtcblxudmFyIF9jcmVhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlKTtcblxudmFyIF90eXBlb2YyID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvdHlwZW9mXCIpO1xuXG52YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArICh0eXBlb2Ygc3VwZXJDbGFzcyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTtcbiAgfVxuXG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9XG4gIH0pO1xuICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0ID8gKDAsIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cy5qc1xuICoqIG1vZHVsZSBpZCA9IDMwNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 306 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(307), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mLmpzPzllYmQiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9zZXQtcHJvdG90eXBlLW9mXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qc1xuICoqIG1vZHVsZSBpZCA9IDMwNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 307 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(308);\nmodule.exports = __webpack_require__(240).Object.setPrototypeOf;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qcz9jOTljIl0sInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L3NldC1wcm90b3R5cGUtb2YuanNcbiAqKiBtb2R1bGUgaWQgPSAzMDdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 308 */
/***/ function(module, exports, __webpack_require__) {

	eval("// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = __webpack_require__(239);\n$export($export.S, 'Object', {setPrototypeOf: __webpack_require__(309).set});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZi5qcz8wOGIyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIDE5LjEuMy4xOSBPYmplY3Quc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pXG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7c2V0UHJvdG90eXBlT2Y6IHJlcXVpcmUoJy4vX3NldC1wcm90bycpLnNldH0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mLmpzXG4gKiogbW9kdWxlIGlkID0gMzA4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 309 */
/***/ function(module, exports, __webpack_require__) {

	eval("// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = __webpack_require__(246)\n  , anObject = __webpack_require__(245);\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function(test, buggy, set){\n      try {\n        set = __webpack_require__(241)(Function.call, __webpack_require__(301).f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzA5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zZXQtcHJvdG8uanM/MDk4NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKVxuICAsIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgY2hlY2sgPSBmdW5jdGlvbihPLCBwcm90byl7XG4gIGFuT2JqZWN0KE8pO1xuICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArIFwiOiBjYW4ndCBzZXQgYXMgcHJvdG90eXBlIVwiKTtcbn07XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2V0OiBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgKCdfX3Byb3RvX18nIGluIHt9ID8gLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpe1xuICAgICAgdHJ5IHtcbiAgICAgICAgc2V0ID0gcmVxdWlyZSgnLi9fY3R4JykoRnVuY3Rpb24uY2FsbCwgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpO1xuICAgICAgICBzZXQodGVzdCwgW10pO1xuICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTtcbiAgICAgIH0gY2F0Y2goZSl7IGJ1Z2d5ID0gdHJ1ZTsgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKXtcbiAgICAgICAgY2hlY2soTywgcHJvdG8pO1xuICAgICAgICBpZihidWdneSlPLl9fcHJvdG9fXyA9IHByb3RvO1xuICAgICAgICBlbHNlIHNldChPLCBwcm90byk7XG4gICAgICAgIHJldHVybiBPO1xuICAgICAgfTtcbiAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLFxuICBjaGVjazogY2hlY2tcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2V0LXByb3RvLmpzXG4gKiogbW9kdWxlIGlkID0gMzA5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 310 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(311), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUuanM/ZmMyMSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZVwiKSwgX19lc01vZHVsZTogdHJ1ZSB9O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2NyZWF0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDMxMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 311 */
/***/ function(module, exports, __webpack_require__) {

	eval("__webpack_require__(312);\nvar $Object = __webpack_require__(240).Object;\nmodule.exports = function create(P, D){\n  return $Object.create(P, D);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzExLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlLmpzP2NiNjEiXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZScpO1xudmFyICRPYmplY3QgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7XG4gIHJldHVybiAkT2JqZWN0LmNyZWF0ZShQLCBEKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvfi9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDMxMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 312 */
/***/ function(module, exports, __webpack_require__) {

	eval("var $export = __webpack_require__(239)\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', {create: __webpack_require__(270)});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QuY3JlYXRlLmpzPzAxNTQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKVxuLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtjcmVhdGU6IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKX0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5jcmVhdGUuanNcbiAqKiBtb2R1bGUgaWQgPSAzMTJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 313 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class;\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _connectToStores = __webpack_require__(314);\n\nvar _connectToStores2 = _interopRequireDefault(_connectToStores);\n\nvar _game = __webpack_require__(316);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _widget = __webpack_require__(343);\n\nvar _widget2 = _interopRequireDefault(_widget);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(348);\n\nvar Planets = (0, _connectToStores2.default)(_class = function (_Component) {\n  (0, _inherits3.default)(Planets, _Component);\n\n  function Planets() {\n    var _Object$getPrototypeO;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, Planets);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_Object$getPrototypeO = (0, _getPrototypeOf2.default)(Planets)).call.apply(_Object$getPrototypeO, [this].concat(args))), _this), _this.state = {\n      expanded: []\n    }, _this._toggleExpanded = function (i) {\n      var expanded = _this.state.expanded;\n      if (expanded.indexOf(i) !== -1) {\n        expanded.splice(expanded.indexOf(i), 1);\n      } else {\n        expanded.push(i);\n      }\n\n      _this.setState({\n        expanded: expanded\n      });\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(Planets, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return _react2.default.createElement(\n        _widget2.default,\n        { name: 'planets' },\n        _react2.default.createElement(\n          'pre',\n          { className: 'planets' },\n          this.props.planets.map(function (planet, i) {\n            var moreData = void 0;\n            if (_this2.state.expanded.indexOf(i) !== -1) {\n              moreData = _react2.default.createElement(\n                'div',\n                { className: 'more-data' },\n                'Population: ',\n                planet.pop,\n                ' ',\n                _react2.default.createElement('br', null),\n                'Wealth: ',\n                planet.wealth\n              );\n            }\n\n            return _react2.default.createElement(\n              'div',\n              { className: 'planet', key: 'planet-' + i, onMouseEnter: function onMouseEnter() {\n                  return _this2._toggleExpanded(i);\n                }, onMouseLeave: function onMouseLeave() {\n                  return _this2._toggleExpanded(i);\n                } },\n              _react2.default.createElement('i', { className: 'fa fa-globe' }),\n              ' ',\n              _react2.default.createElement(\n                'strong',\n                null,\n                'Planet at ',\n                planet.x,\n                ', ',\n                planet.y\n              ),\n              ' ',\n              _react2.default.createElement('br', null),\n              moreData\n            );\n          })\n        )\n      );\n    }\n  }], [{\n    key: 'getStores',\n    value: function getStores(props) {\n      return [_game2.default];\n    }\n  }, {\n    key: 'getPropsFromStores',\n    value: function getPropsFromStores(props) {\n      var planets = [];\n\n      var systems = _game2.default.getObjectsByType(\"simulation.systems.system.SolarSystem\");\n\n      systems.map(function (system) {\n        planets = planets.concat(system.planets);\n      });\n\n      return {\n        planets: planets\n      };\n    }\n  }]);\n  return Planets;\n}(_react.Component)) || _class;\n\nexports.default = Planets;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL3dpZGdldHMvUGxhbmV0cy5qcz81YTNjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY29ubmVjdFRvU3RvcmVzIGZyb20gJ2FsdC11dGlscy9saWIvY29ubmVjdFRvU3RvcmVzJztcblxuaW1wb3J0IEdhbWVTdG9yZSBmcm9tICcuLi8uLi9zdG9yZXMvZ2FtZSc7XG5cbmltcG9ydCBXaWRnZXQgZnJvbSAnLi4vd2lkZ2V0JztcblxucmVxdWlyZSgnLi4vLi4vc3R5bGVzL3dpZGdldHMvcGxhbmV0cy5sZXNzJyk7XG5cbkBjb25uZWN0VG9TdG9yZXNcbmNsYXNzIFBsYW5ldHMgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgZ2V0U3RvcmVzKHByb3BzKSB7XG4gICAgcmV0dXJuIFtHYW1lU3RvcmVdO1xuICB9XG5cbiAgc3RhdGljIGdldFByb3BzRnJvbVN0b3Jlcyhwcm9wcykge1xuICAgIGxldCBwbGFuZXRzID0gW107XG5cbiAgICBjb25zdCBzeXN0ZW1zID0gR2FtZVN0b3JlLmdldE9iamVjdHNCeVR5cGUoXCJzaW11bGF0aW9uLnN5c3RlbXMuc3lzdGVtLlNvbGFyU3lzdGVtXCIpO1xuXG4gICAgc3lzdGVtcy5tYXAoKHN5c3RlbSkgPT4ge1xuICAgICAgcGxhbmV0cyA9IHBsYW5ldHMuY29uY2F0KHN5c3RlbS5wbGFuZXRzKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBwbGFuZXRzXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRlID0ge1xuICAgIGV4cGFuZGVkOiBbXVxuICB9O1xuXG4gIF90b2dnbGVFeHBhbmRlZCA9IChpKSA9PiB7XG4gICAgbGV0IGV4cGFuZGVkID0gdGhpcy5zdGF0ZS5leHBhbmRlZDtcbiAgICBpZiAoZXhwYW5kZWQuaW5kZXhPZihpKSAhPT0gLTEpIHtcbiAgICAgIGV4cGFuZGVkLnNwbGljZShleHBhbmRlZC5pbmRleE9mKGkpLCAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZXhwYW5kZWQucHVzaChpKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGV4cGFuZGVkXG4gICAgfSk7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8V2lkZ2V0IG5hbWU9XCJwbGFuZXRzXCI+XG4gICAgICAgIDxwcmUgY2xhc3NOYW1lPVwicGxhbmV0c1wiPlxuICAgICAgICAgIHt0aGlzLnByb3BzLnBsYW5ldHMubWFwKChwbGFuZXQsIGkpID0+IHtcbiAgICAgICAgICAgIGxldCBtb3JlRGF0YTtcbiAgICAgICAgICAgIGlmKHRoaXMuc3RhdGUuZXhwYW5kZWQuaW5kZXhPZihpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgbW9yZURhdGEgPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb3JlLWRhdGFcIj5cbiAgICAgICAgICAgICAgICAgIFBvcHVsYXRpb246IHtwbGFuZXQucG9wfSA8YnIvPlxuICAgICAgICAgICAgICAgICAgV2VhbHRoOiB7cGxhbmV0LndlYWx0aH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBsYW5ldFwiIGtleT17YHBsYW5ldC0ke2l9YH0gb25Nb3VzZUVudGVyPXsoKSA9PiB0aGlzLl90b2dnbGVFeHBhbmRlZChpKX0gb25Nb3VzZUxlYXZlPXsoKSA9PiB0aGlzLl90b2dnbGVFeHBhbmRlZChpKX0+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtZ2xvYmVcIj48L2k+IDxzdHJvbmc+UGxhbmV0IGF0IHtwbGFuZXQueH0sIHtwbGFuZXQueX08L3N0cm9uZz4gPGJyLz5cbiAgICAgICAgICAgICAgICB7bW9yZURhdGF9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pfVxuICAgICAgICA8L3ByZT5cbiAgICAgIDwvV2lkZ2V0PlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUGxhbmV0cztcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvY29tcG9uZW50cy93aWRnZXRzL1BsYW5ldHMuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFDQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7QUFtQkE7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7Ozs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBRUE7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQWxCQTtBQURBO0FBdUJBOzs7QUE1REE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7Ozs7QUErQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 314 */
/***/ function(module, exports, __webpack_require__) {

	eval("/**\n * 'Higher Order Component' that controls the props of a wrapped\n * component via stores.\n *\n * Expects the Component to have two static methods:\n *   - getStores(): Should return an array of stores.\n *   - getPropsFromStores(props): Should return the props from the stores.\n *\n * Example using old React.createClass() style:\n *\n *    const MyComponent = React.createClass({\n *      statics: {\n *        getStores(props) {\n *          return [myStore]\n *        },\n *        getPropsFromStores(props) {\n *          return myStore.getState()\n *        }\n *      },\n *      render() {\n *        // Use this.props like normal ...\n *      }\n *    })\n *    MyComponent = connectToStores(MyComponent)\n *\n *\n * Example using ES6 Class:\n *\n *    class MyComponent extends React.Component {\n *      static getStores(props) {\n *        return [myStore]\n *      }\n *      static getPropsFromStores(props) {\n *        return myStore.getState()\n *      }\n *      render() {\n *        // Use this.props like normal ...\n *      }\n *    }\n *    MyComponent = connectToStores(MyComponent)\n *\n * A great explanation of the merits of higher order components can be found at\n * http://bit.ly/1abPkrP\n */\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _functions = __webpack_require__(315);\n\nfunction connectToStores(Spec) {\n  var Component = arguments.length <= 1 || arguments[1] === undefined ? Spec : arguments[1];\n  return (function () {\n    // Check for required static methods.\n    if (!(0, _functions.isFunction)(Spec.getStores)) {\n      throw new Error('connectToStores() expects the wrapped component to have a static getStores() method');\n    }\n    if (!(0, _functions.isFunction)(Spec.getPropsFromStores)) {\n      throw new Error('connectToStores() expects the wrapped component to have a static getPropsFromStores() method');\n    }\n\n    var StoreConnection = _react2['default'].createClass({\n      displayName: 'Stateful' + (Component.displayName || Component.name || 'Container'),\n\n      getInitialState: function getInitialState() {\n        return Spec.getPropsFromStores(this.props, this.context);\n      },\n\n      componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n        this.setState(Spec.getPropsFromStores(nextProps, this.context));\n      },\n\n      componentDidMount: function componentDidMount() {\n        var _this = this;\n\n        var stores = Spec.getStores(this.props, this.context);\n        this.storeListeners = stores.map(function (store) {\n          return store.listen(_this.onChange);\n        });\n        if (Spec.componentDidConnect) {\n          Spec.componentDidConnect(this.props, this.context);\n        }\n      },\n\n      componentWillUnmount: function componentWillUnmount() {\n        this.storeListeners.forEach(function (unlisten) {\n          return unlisten();\n        });\n      },\n\n      onChange: function onChange() {\n        this.setState(Spec.getPropsFromStores(this.props, this.context));\n      },\n\n      render: function render() {\n        return _react2['default'].createElement(Component, (0, _functions.assign)({}, this.props, this.state));\n      }\n    });\n    if (Component.contextTypes) {\n      StoreConnection.contextTypes = Component.contextTypes;\n    }\n\n    return StoreConnection;\n  })();\n}\n\nexports['default'] = connectToStores;\nmodule.exports = exports['default'];//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYWx0LXV0aWxzL2xpYi9jb25uZWN0VG9TdG9yZXMuanM/NGRjZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICdIaWdoZXIgT3JkZXIgQ29tcG9uZW50JyB0aGF0IGNvbnRyb2xzIHRoZSBwcm9wcyBvZiBhIHdyYXBwZWRcbiAqIGNvbXBvbmVudCB2aWEgc3RvcmVzLlxuICpcbiAqIEV4cGVjdHMgdGhlIENvbXBvbmVudCB0byBoYXZlIHR3byBzdGF0aWMgbWV0aG9kczpcbiAqICAgLSBnZXRTdG9yZXMoKTogU2hvdWxkIHJldHVybiBhbiBhcnJheSBvZiBzdG9yZXMuXG4gKiAgIC0gZ2V0UHJvcHNGcm9tU3RvcmVzKHByb3BzKTogU2hvdWxkIHJldHVybiB0aGUgcHJvcHMgZnJvbSB0aGUgc3RvcmVzLlxuICpcbiAqIEV4YW1wbGUgdXNpbmcgb2xkIFJlYWN0LmNyZWF0ZUNsYXNzKCkgc3R5bGU6XG4gKlxuICogICAgY29uc3QgTXlDb21wb25lbnQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gKiAgICAgIHN0YXRpY3M6IHtcbiAqICAgICAgICBnZXRTdG9yZXMocHJvcHMpIHtcbiAqICAgICAgICAgIHJldHVybiBbbXlTdG9yZV1cbiAqICAgICAgICB9LFxuICogICAgICAgIGdldFByb3BzRnJvbVN0b3Jlcyhwcm9wcykge1xuICogICAgICAgICAgcmV0dXJuIG15U3RvcmUuZ2V0U3RhdGUoKVxuICogICAgICAgIH1cbiAqICAgICAgfSxcbiAqICAgICAgcmVuZGVyKCkge1xuICogICAgICAgIC8vIFVzZSB0aGlzLnByb3BzIGxpa2Ugbm9ybWFsIC4uLlxuICogICAgICB9XG4gKiAgICB9KVxuICogICAgTXlDb21wb25lbnQgPSBjb25uZWN0VG9TdG9yZXMoTXlDb21wb25lbnQpXG4gKlxuICpcbiAqIEV4YW1wbGUgdXNpbmcgRVM2IENsYXNzOlxuICpcbiAqICAgIGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAqICAgICAgc3RhdGljIGdldFN0b3Jlcyhwcm9wcykge1xuICogICAgICAgIHJldHVybiBbbXlTdG9yZV1cbiAqICAgICAgfVxuICogICAgICBzdGF0aWMgZ2V0UHJvcHNGcm9tU3RvcmVzKHByb3BzKSB7XG4gKiAgICAgICAgcmV0dXJuIG15U3RvcmUuZ2V0U3RhdGUoKVxuICogICAgICB9XG4gKiAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAvLyBVc2UgdGhpcy5wcm9wcyBsaWtlIG5vcm1hbCAuLi5cbiAqICAgICAgfVxuICogICAgfVxuICogICAgTXlDb21wb25lbnQgPSBjb25uZWN0VG9TdG9yZXMoTXlDb21wb25lbnQpXG4gKlxuICogQSBncmVhdCBleHBsYW5hdGlvbiBvZiB0aGUgbWVyaXRzIG9mIGhpZ2hlciBvcmRlciBjb21wb25lbnRzIGNhbiBiZSBmb3VuZCBhdFxuICogaHR0cDovL2JpdC5seS8xYWJQa3JQXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfZnVuY3Rpb25zID0gcmVxdWlyZSgnLi9mdW5jdGlvbnMnKTtcblxuZnVuY3Rpb24gY29ubmVjdFRvU3RvcmVzKFNwZWMpIHtcbiAgdmFyIENvbXBvbmVudCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IFNwZWMgOiBhcmd1bWVudHNbMV07XG4gIHJldHVybiAoZnVuY3Rpb24gKCkge1xuICAgIC8vIENoZWNrIGZvciByZXF1aXJlZCBzdGF0aWMgbWV0aG9kcy5cbiAgICBpZiAoISgwLCBfZnVuY3Rpb25zLmlzRnVuY3Rpb24pKFNwZWMuZ2V0U3RvcmVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25uZWN0VG9TdG9yZXMoKSBleHBlY3RzIHRoZSB3cmFwcGVkIGNvbXBvbmVudCB0byBoYXZlIGEgc3RhdGljIGdldFN0b3JlcygpIG1ldGhvZCcpO1xuICAgIH1cbiAgICBpZiAoISgwLCBfZnVuY3Rpb25zLmlzRnVuY3Rpb24pKFNwZWMuZ2V0UHJvcHNGcm9tU3RvcmVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb25uZWN0VG9TdG9yZXMoKSBleHBlY3RzIHRoZSB3cmFwcGVkIGNvbXBvbmVudCB0byBoYXZlIGEgc3RhdGljIGdldFByb3BzRnJvbVN0b3JlcygpIG1ldGhvZCcpO1xuICAgIH1cblxuICAgIHZhciBTdG9yZUNvbm5lY3Rpb24gPSBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlQ2xhc3Moe1xuICAgICAgZGlzcGxheU5hbWU6ICdTdGF0ZWZ1bCcgKyAoQ29tcG9uZW50LmRpc3BsYXlOYW1lIHx8IENvbXBvbmVudC5uYW1lIHx8ICdDb250YWluZXInKSxcblxuICAgICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgICAgIHJldHVybiBTcGVjLmdldFByb3BzRnJvbVN0b3Jlcyh0aGlzLnByb3BzLCB0aGlzLmNvbnRleHQpO1xuICAgICAgfSxcblxuICAgICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShTcGVjLmdldFByb3BzRnJvbVN0b3JlcyhuZXh0UHJvcHMsIHRoaXMuY29udGV4dCkpO1xuICAgICAgfSxcblxuICAgICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgIHZhciBzdG9yZXMgPSBTcGVjLmdldFN0b3Jlcyh0aGlzLnByb3BzLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICB0aGlzLnN0b3JlTGlzdGVuZXJzID0gc3RvcmVzLm1hcChmdW5jdGlvbiAoc3RvcmUpIHtcbiAgICAgICAgICByZXR1cm4gc3RvcmUubGlzdGVuKF90aGlzLm9uQ2hhbmdlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChTcGVjLmNvbXBvbmVudERpZENvbm5lY3QpIHtcbiAgICAgICAgICBTcGVjLmNvbXBvbmVudERpZENvbm5lY3QodGhpcy5wcm9wcywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB0aGlzLnN0b3JlTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKHVubGlzdGVuKSB7XG4gICAgICAgICAgcmV0dXJuIHVubGlzdGVuKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKFNwZWMuZ2V0UHJvcHNGcm9tU3RvcmVzKHRoaXMucHJvcHMsIHRoaXMuY29udGV4dCkpO1xuICAgICAgfSxcblxuICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChDb21wb25lbnQsICgwLCBfZnVuY3Rpb25zLmFzc2lnbikoe30sIHRoaXMucHJvcHMsIHRoaXMuc3RhdGUpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoQ29tcG9uZW50LmNvbnRleHRUeXBlcykge1xuICAgICAgU3RvcmVDb25uZWN0aW9uLmNvbnRleHRUeXBlcyA9IENvbXBvbmVudC5jb250ZXh0VHlwZXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIFN0b3JlQ29ubmVjdGlvbjtcbiAgfSkoKTtcbn1cblxuZXhwb3J0c1snZGVmYXVsdCddID0gY29ubmVjdFRvU3RvcmVzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2FsdC11dGlscy9saWIvY29ubmVjdFRvU3RvcmVzLmpzXG4gKiogbW9kdWxlIGlkID0gMzE0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 315 */
/***/ function(module, exports) {

	eval("'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.isPojo = isPojo;\nexports.isPromise = isPromise;\nexports.eachObject = eachObject;\nexports.assign = assign;\nvar isFunction = function isFunction(x) {\n  return typeof x === 'function';\n};\n\nexports.isFunction = isFunction;\n\nfunction isPojo(target) {\n  var Ctor = target.constructor;\n\n  return !!target && typeof target === 'object' && Object.prototype.toString.call(target) === '[object Object]' && isFunction(Ctor) && (Ctor instanceof Ctor || target.type === 'AltStore');\n}\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n\nfunction eachObject(f, o) {\n  o.forEach(function (from) {\n    Object.keys(Object(from)).forEach(function (key) {\n      f(key, from[key]);\n    });\n  });\n}\n\nfunction assign(target) {\n  for (var _len = arguments.length, source = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    source[_key - 1] = arguments[_key];\n  }\n\n  eachObject(function (key, value) {\n    return target[key] = value;\n  }, source);\n  return target;\n}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYWx0LXV0aWxzL2xpYi9mdW5jdGlvbnMuanM/YmY2NyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5pc1Bvam8gPSBpc1Bvam87XG5leHBvcnRzLmlzUHJvbWlzZSA9IGlzUHJvbWlzZTtcbmV4cG9ydHMuZWFjaE9iamVjdCA9IGVhY2hPYmplY3Q7XG5leHBvcnRzLmFzc2lnbiA9IGFzc2lnbjtcbnZhciBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gaXNGdW5jdGlvbih4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJztcbn07XG5cbmV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247XG5cbmZ1bmN0aW9uIGlzUG9qbyh0YXJnZXQpIHtcbiAgdmFyIEN0b3IgPSB0YXJnZXQuY29uc3RydWN0b3I7XG5cbiAgcmV0dXJuICEhdGFyZ2V0ICYmIHR5cGVvZiB0YXJnZXQgPT09ICdvYmplY3QnICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0YXJnZXQpID09PSAnW29iamVjdCBPYmplY3RdJyAmJiBpc0Z1bmN0aW9uKEN0b3IpICYmIChDdG9yIGluc3RhbmNlb2YgQ3RvciB8fCB0YXJnZXQudHlwZSA9PT0gJ0FsdFN0b3JlJyk7XG59XG5cbmZ1bmN0aW9uIGlzUHJvbWlzZShvYmopIHtcbiAgcmV0dXJuICEhb2JqICYmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyB8fCB0eXBlb2Ygb2JqID09PSAnZnVuY3Rpb24nKSAmJiB0eXBlb2Ygb2JqLnRoZW4gPT09ICdmdW5jdGlvbic7XG59XG5cbmZ1bmN0aW9uIGVhY2hPYmplY3QoZiwgbykge1xuICBvLmZvckVhY2goZnVuY3Rpb24gKGZyb20pIHtcbiAgICBPYmplY3Qua2V5cyhPYmplY3QoZnJvbSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgZihrZXksIGZyb21ba2V5XSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBzb3VyY2UgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgc291cmNlW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIGVhY2hPYmplY3QoZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICByZXR1cm4gdGFyZ2V0W2tleV0gPSB2YWx1ZTtcbiAgfSwgc291cmNlKTtcbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vYWx0LXV0aWxzL2xpYi9mdW5jdGlvbnMuanNcbiAqKiBtb2R1bGUgaWQgPSAzMTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 316 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _stringify = __webpack_require__(317);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _game = __webpack_require__(319);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _alt = __webpack_require__(320);\n\nvar _alt2 = _interopRequireDefault(_alt);\n\n__webpack_require__(334);\n\n__webpack_require__(335);\n\n__webpack_require__(336);\n\nvar _jsonpicklejs = __webpack_require__(337);\n\nvar _jsonpicklejs2 = _interopRequireDefault(_jsonpicklejs);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Load our simulation classes into the window\nvar GameStore = function () {\n  function GameStore() {\n    var _this = this;\n\n    (0, _classCallCheck3.default)(this, GameStore);\n\n    this._onOpen = function () {\n      _this.setState({\n        status: 'connected'\n      });\n    };\n\n    this._onClose = function () {\n      _this.setState({\n        status: 'disconnected'\n      });\n    };\n\n    this._onError = function () {\n      _this.setState({\n        status: 'error'\n      });\n    };\n\n    this._onMessage = function (raw_message) {\n      var game = _jsonpicklejs2.default.decode(raw_message.data);\n\n      _this.setState({\n        game: game\n      });\n    };\n\n    this.bindActions(_game2.default);\n\n    this.socket = null;\n    this.game = {};\n    this.status = 'disconnected';\n  }\n\n  (0, _createClass3.default)(GameStore, [{\n    key: 'onConnect',\n    value: function onConnect() {\n      var url = 'ws://localhost:8080/game';\n\n      this.setState({\n        status: 'connecting'\n      });\n\n      this.socket = new WebSocket(url);\n      this.socket.onopen = this._onOpen;\n      this.socket.onclose = this._onClose;\n      this.socket.onerror = this._onError;\n      this.socket.onmessage = this._onMessage;\n    }\n  }, {\n    key: 'onDisconnect',\n    value: function onDisconnect() {\n      this.socket.close();\n    }\n  }, {\n    key: 'onStart',\n    value: function onStart() {\n      this.socket.send((0, _stringify2.default)({\n        method: 'start'\n      }));\n    }\n  }, {\n    key: 'onStop',\n    value: function onStop() {\n      this.socket.send((0, _stringify2.default)({\n        method: 'stop'\n      }));\n    }\n  }, {\n    key: 'onRestart',\n    value: function onRestart() {\n      this.socket.send((0, _stringify2.default)({\n        method: 'restart'\n      }));\n    }\n  }, {\n    key: 'onGenerate',\n    value: function onGenerate() {\n      this.socket.send((0, _stringify2.default)({\n        method: 'generate'\n      }));\n    }\n\n    // Helper functions\n\n  }], [{\n    key: 'getObjectsByType',\n    value: function getObjectsByType(type) {\n      if (!this.getState().game.objects) {\n        return [];\n      }\n\n      var returned = [];\n\n      this.getState().game.objects.map(function (object) {\n        if (object[\"_py_class\"] == type) {\n          returned.push(object);\n        }\n      });\n\n      return returned;\n    }\n  }, {\n    key: 'getObjectById',\n    value: function getObjectById(id) {\n      if (!this.getState().game.objects) {\n        return [];\n      }\n\n      this.getState().game.objects.map(function (object) {\n        if (object.id == id) {\n          return object;\n        }\n      });\n    }\n  }]);\n  return GameStore;\n}();\n\nexports.default = _alt2.default.createStore(GameStore);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9zdG9yZXMvZ2FtZS5qcz84NGQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBHYW1lQWN0aW9ucyBmcm9tICcuLi9hY3Rpb25zL2dhbWUnO1xuaW1wb3J0IGFsdCBmcm9tICcuLi9hbHQnO1xuXG4vLyBMb2FkIG91ciBzaW11bGF0aW9uIGNsYXNzZXMgaW50byB0aGUgd2luZG93XG5pbXBvcnQgJy4uL3NpbXVsYXRpb24vZ2FtZSc7XG5pbXBvcnQgJy4uL3NpbXVsYXRpb24vc3lzdGVtJztcbmltcG9ydCAnLi4vc2ltdWxhdGlvbi9zaGlwJztcblxuaW1wb3J0IGpzb25waWNrbGUgZnJvbSAnanNvbnBpY2tsZWpzJztcblxuY2xhc3MgR2FtZVN0b3JlIHtcblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy5iaW5kQWN0aW9ucyhHYW1lQWN0aW9ucyk7XG5cbiAgICB0aGlzLnNvY2tldCA9IG51bGw7XG5cdFx0dGhpcy5nYW1lID0ge307XG5cdFx0dGhpcy5zdGF0dXMgPSAnZGlzY29ubmVjdGVkJztcblx0fVxuXG5cdHN0YXRpYyBnZXRPYmplY3RzQnlUeXBlKHR5cGUpIHtcbiAgICBpZighdGhpcy5nZXRTdGF0ZSgpLmdhbWUub2JqZWN0cykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuXHQgIGxldCByZXR1cm5lZCA9IFtdO1xuXG4gICAgdGhpcy5nZXRTdGF0ZSgpLmdhbWUub2JqZWN0cy5tYXAoKG9iamVjdCkgPT4ge1xuICAgICAgaWYob2JqZWN0W1wiX3B5X2NsYXNzXCJdID09IHR5cGUpIHtcbiAgICAgICAgcmV0dXJuZWQucHVzaChvYmplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJldHVybmVkO1xuICB9XG5cbiAgc3RhdGljIGdldE9iamVjdEJ5SWQoaWQpIHtcbiAgICBpZighdGhpcy5nZXRTdGF0ZSgpLmdhbWUub2JqZWN0cykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHRoaXMuZ2V0U3RhdGUoKS5nYW1lLm9iamVjdHMubWFwKChvYmplY3QpID0+IHtcbiAgICAgIGlmKG9iamVjdC5pZCA9PSBpZCkge1xuICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cblx0b25Db25uZWN0KCkge1xuICAgIGNvbnN0IHVybCA9ICd3czovL2xvY2FsaG9zdDo4MDgwL2dhbWUnO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzdGF0dXM6ICdjb25uZWN0aW5nJ1xuICAgIH0pO1xuXG4gICAgdGhpcy5zb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybCk7XG4gICAgdGhpcy5zb2NrZXQub25vcGVuID0gdGhpcy5fb25PcGVuO1xuICAgIHRoaXMuc29ja2V0Lm9uY2xvc2UgPSB0aGlzLl9vbkNsb3NlO1xuICAgIHRoaXMuc29ja2V0Lm9uZXJyb3IgPSB0aGlzLl9vbkVycm9yO1xuICAgIHRoaXMuc29ja2V0Lm9ubWVzc2FnZSA9IHRoaXMuX29uTWVzc2FnZTtcbiAgfVxuXG4gIG9uRGlzY29ubmVjdCgpIHtcbiAgICB0aGlzLnNvY2tldC5jbG9zZSgpO1xuICB9XG5cbiAgb25TdGFydCgpIHtcbiAgICB0aGlzLnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG1ldGhvZDogJ3N0YXJ0J1xuICAgIH0pKTtcbiAgfVxuXG4gIG9uU3RvcCgpIHtcbiAgICB0aGlzLnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG1ldGhvZDogJ3N0b3AnXG4gICAgfSkpO1xuICB9XG5cbiAgb25SZXN0YXJ0KCkge1xuICAgIHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbWV0aG9kOiAncmVzdGFydCdcbiAgICB9KSk7XG4gIH1cblxuICBvbkdlbmVyYXRlKCkge1xuICAgIHRoaXMuc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgbWV0aG9kOiAnZ2VuZXJhdGUnXG4gICAgfSkpO1xuICB9XG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uc1xuICBfb25PcGVuID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc3RhdHVzOiAnY29ubmVjdGVkJ1xuICAgIH0pO1xuICB9O1xuXG4gIF9vbkNsb3NlID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc3RhdHVzOiAnZGlzY29ubmVjdGVkJ1xuICAgIH0pO1xuICB9O1xuXG4gIF9vbkVycm9yID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc3RhdHVzOiAnZXJyb3InXG4gICAgfSk7XG4gIH07XG5cbiAgX29uTWVzc2FnZSA9IChyYXdfbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGdhbWUgPSBqc29ucGlja2xlLmRlY29kZShyYXdfbWVzc2FnZS5kYXRhKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgZ2FtZVxuICAgIH0pO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBhbHQuY3JlYXRlU3RvcmUoR2FtZVN0b3JlKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvc3RvcmVzL2dhbWUuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBTkE7QUFPQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQWdGQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBcEZBO0FBc0ZBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUExRkE7QUE0RkE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQWhHQTtBQWtHQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQXZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBNkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7OztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7OztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7OztBQUVBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7OztBQXZFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBd0VBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 317 */
/***/ function(module, exports, __webpack_require__) {

	eval("module.exports = { \"default\": __webpack_require__(318), __esModule: true };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5LmpzP2QyN2IiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5XCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeS5qc1xuICoqIG1vZHVsZSBpZCA9IDMxN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 318 */
/***/ function(module, exports, __webpack_require__) {

	eval("var core  = __webpack_require__(240)\n  , $JSON = core.JSON || (core.JSON = {stringify: JSON.stringify});\nmodule.exports = function stringify(it){ // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vYmFiZWwtcnVudGltZS9+L2NvcmUtanMvbGlicmFyeS9mbi9qc29uL3N0cmluZ2lmeS5qcz83YzMzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBjb3JlICA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKVxuICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gIHJldHVybiAkSlNPTi5zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3VtZW50cyk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9iYWJlbC1ydW50aW1lL34vY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5LmpzXG4gKiogbW9kdWxlIGlkID0gMzE4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 319 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _alt = __webpack_require__(320);\n\nvar _alt2 = _interopRequireDefault(_alt);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar GameActions = function GameActions() {\n  (0, _classCallCheck3.default)(this, GameActions);\n\n  this.generateActions('connect', 'disconnect', 'start', 'stop', 'restart', 'generate');\n};\n\nexports.default = _alt2.default.createActions(GameActions);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzE5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9hY3Rpb25zL2dhbWUuanM/ZDQ3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYWx0IGZyb20gJy4uL2FsdCc7XG5cbmNsYXNzIEdhbWVBY3Rpb25zIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5nZW5lcmF0ZUFjdGlvbnMoJ2Nvbm5lY3QnLCAnZGlzY29ubmVjdCcsICdzdGFydCcsICdzdG9wJywgJ3Jlc3RhcnQnLCAnZ2VuZXJhdGUnKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBhbHQuY3JlYXRlQWN0aW9ucyhHYW1lQWN0aW9ucyk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvYWN0aW9ucy9nYW1lLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 320 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar Alt = __webpack_require__(321);\nvar alt = new Alt();\n\nexports.default = alt;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9hbHQuanM/OGE3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBbHQgPSByZXF1aXJlKCdhbHQnKTtcbmNvbnN0IGFsdCA9IG5ldyBBbHQoKTtcblxuZXhwb3J0IGRlZmF1bHQgYWx0O1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHNyYy9hbHQuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 321 */,
/* 322 */,
/* 323 */,
/* 324 */,
/* 325 */,
/* 326 */,
/* 327 */,
/* 328 */,
/* 329 */,
/* 330 */,
/* 331 */,
/* 332 */,
/* 333 */,
/* 334 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Game = function () {\n  (0, _createClass3.default)(Game, null, [{\n    key: 'restore',\n    value: function restore(obj) {\n      var _obj$pyState = obj['py/state'];\n      var objects = _obj$pyState.objects;\n      var running = _obj$pyState.running;\n\n      return new Game(objects, running);\n    }\n  }]);\n\n  function Game(objects, running) {\n    (0, _classCallCheck3.default)(this, Game);\n\n    this.objects = objects;\n    this.running = running;\n  }\n\n  (0, _createClass3.default)(Game, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      var objects = this.objects;\n      var running = this.running;\n\n      return {\n        objects: objects,\n        running: running\n      };\n    }\n  }]);\n  return Game;\n}();\n\nwindow.game = { 'Game': Game };//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9zaW11bGF0aW9uL2dhbWUuanM/MDUwMCJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBHYW1lIHtcbiAgc3RhdGljIHJlc3RvcmUob2JqKSB7XG4gICAgY29uc3QgeyBvYmplY3RzLCBydW5uaW5nIH0gPSBvYmpbJ3B5L3N0YXRlJ107XG4gICAgcmV0dXJuIG5ldyBHYW1lKG9iamVjdHMsIHJ1bm5pbmcpO1xuICB9XG5cbiAgY29uc3RydWN0b3Iob2JqZWN0cywgcnVubmluZykge1xuICAgIHRoaXMub2JqZWN0cyA9IG9iamVjdHM7XG4gICAgdGhpcy5ydW5uaW5nID0gcnVubmluZztcbiAgfVxuXG4gIHRvSlNPTigpIHtcbiAgICBjb25zdCB7b2JqZWN0cywgcnVubmluZ30gPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICBvYmplY3RzLFxuICAgICAgcnVubmluZ1xuICAgIH1cbiAgfVxufVxuXG53aW5kb3cuZ2FtZSA9IHsgJ0dhbWUnOiBHYW1lIH07XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogc3JjL3NpbXVsYXRpb24vZ2FtZS5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7OztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBOzs7OztBQUdBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 335 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SolarSystem = function () {\n  (0, _createClass3.default)(SolarSystem, null, [{\n    key: 'restore',\n    value: function restore(_ref) {\n      var planets = _ref.planets;\n      var ships = _ref.ships;\n\n      return new SolarSystem(planets, ships);\n    }\n  }]);\n\n  function SolarSystem(planets, ships) {\n    (0, _classCallCheck3.default)(this, SolarSystem);\n\n    this.planets = planets;\n    this.ships = ships;\n  }\n\n  (0, _createClass3.default)(SolarSystem, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      var planets = this.planets;\n      var ships = this.ships;\n\n      return {\n        planets: planets,\n        ships: ships\n      };\n    }\n  }]);\n  return SolarSystem;\n}();\n\nvar Planet = function () {\n  (0, _createClass3.default)(Planet, null, [{\n    key: 'restore',\n    value: function restore(_ref2) {\n      var system = _ref2.system;\n      var pop = _ref2.pop;\n      var wealth = _ref2.wealth;\n      var x = _ref2.x;\n      var y = _ref2.y;\n\n      return new Planet(system, pop, wealth, x, y);\n    }\n  }]);\n\n  function Planet(system, pop, wealth, x, y) {\n    (0, _classCallCheck3.default)(this, Planet);\n\n    this.system = system;\n    this.pop = pop;\n    this.wealth = wealth;\n    this.x = x;\n    this.y = y;\n  }\n\n  (0, _createClass3.default)(Planet, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      var system = this.system;\n      var pop = this.pop;\n      var wealth = this.wealth;\n      var x = this.x;\n      var y = this.y;\n\n      return {\n        pop: pop,\n        wealth: wealth,\n        x: x,\n        y: y\n      };\n    }\n  }]);\n  return Planet;\n}();\n\nif (!window.simulation) {\n  window.simulation = {};\n}\n\nwindow.simulation.systems = {\n  system: {\n    'SolarSystem': SolarSystem\n  },\n  planet: {\n    'Planet': Planet\n  }\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9zaW11bGF0aW9uL3N5c3RlbS5qcz85NTQ4Il0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNvbGFyU3lzdGVtIHtcbiAgc3RhdGljIHJlc3RvcmUoeyBwbGFuZXRzLCBzaGlwcyB9KSB7XG4gICAgcmV0dXJuIG5ldyBTb2xhclN5c3RlbShwbGFuZXRzLCBzaGlwcyk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwbGFuZXRzLCBzaGlwcykge1xuICAgIHRoaXMucGxhbmV0cyA9IHBsYW5ldHM7XG4gICAgdGhpcy5zaGlwcyA9IHNoaXBzO1xuICB9XG5cbiAgdG9KU09OKCkge1xuICAgIGxldCB7IHBsYW5ldHMsIHNoaXBzIH0gPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICBwbGFuZXRzLFxuICAgICAgc2hpcHNcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgUGxhbmV0IHtcbiAgc3RhdGljIHJlc3RvcmUoeyBzeXN0ZW0sIHBvcCwgd2VhbHRoLCB4LCB5IH0pIHtcbiAgICByZXR1cm4gbmV3IFBsYW5ldChzeXN0ZW0sIHBvcCwgd2VhbHRoLCB4LCB5KTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHN5c3RlbSwgcG9wLCB3ZWFsdGgsIHgsIHkpIHtcbiAgICB0aGlzLnN5c3RlbSA9IHN5c3RlbTtcbiAgICB0aGlzLnBvcCA9IHBvcDtcbiAgICB0aGlzLndlYWx0aCA9IHdlYWx0aDtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gIH1cblxuICB0b0pTT04oKSB7XG4gICAgbGV0IHsgc3lzdGVtLCBwb3AsIHdlYWx0aCwgeCwgeSB9ID0gdGhpcztcbiAgICByZXR1cm4ge1xuICAgICAgcG9wLFxuICAgICAgd2VhbHRoLFxuICAgICAgeCxcbiAgICAgIHlcbiAgICB9XG4gIH1cbn1cblxuaWYoIXdpbmRvdy5zaW11bGF0aW9uKSB7XG4gIHdpbmRvdy5zaW11bGF0aW9uID0ge307XG59XG5cbndpbmRvdy5zaW11bGF0aW9uLnN5c3RlbXMgPSB7XG4gIHN5c3RlbToge1xuICAgICdTb2xhclN5c3RlbSc6IFNvbGFyU3lzdGVtXG4gIH0sXG4gIHBsYW5ldDoge1xuICAgICdQbGFuZXQnOiBQbGFuZXRcbiAgfVxufTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvc2ltdWxhdGlvbi9zeXN0ZW0uanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBOzs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7Ozs7O0FBR0E7OztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUpBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 336 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Ship = function () {\n  (0, _createClass3.default)(Ship, null, [{\n    key: 'restore',\n    value: function restore(_ref) {\n      var system = _ref.system;\n      var x = _ref.x;\n      var y = _ref.y;\n      var contains = _ref.contains;\n      var speed = _ref.speed;\n      var destination = _ref.destination;\n\n      return new Ship(system, x, y, contains, speed, destination);\n    }\n  }]);\n\n  function Ship(system, x, y, contains, speed, destination) {\n    (0, _classCallCheck3.default)(this, Ship);\n\n    this.system = system;\n    this.x = x;\n    this.y = y;\n    this.contains = contains;\n    this.speed = speed;\n    this.destination = destination;\n  }\n\n  (0, _createClass3.default)(Ship, [{\n    key: 'toJSON',\n    value: function toJSON() {\n      var system = this.system;\n      var x = this.x;\n      var y = this.y;\n      var contains = this.contains;\n      var speed = this.speed;\n      var destination = this.destination;\n\n      return {\n        x: x,\n        y: y,\n        contains: contains,\n        speed: speed,\n        destination: destination\n      };\n    }\n  }]);\n  return Ship;\n}();\n\nif (!window.simulation) {\n  window.simulation = {};\n}\n\nwindow.simulation.ship = {\n  'Ship': Ship\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9zaW11bGF0aW9uL3NoaXAuanM/NWNiZiJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBTaGlwIHtcbiAgc3RhdGljIHJlc3RvcmUoeyBzeXN0ZW0sIHgsIHksIGNvbnRhaW5zLCBzcGVlZCwgZGVzdGluYXRpb24gfSkge1xuICAgIHJldHVybiBuZXcgU2hpcChzeXN0ZW0sIHgsIHksIGNvbnRhaW5zLCBzcGVlZCwgZGVzdGluYXRpb24pO1xuICB9XG5cbiAgY29uc3RydWN0b3Ioc3lzdGVtLCB4LCB5LCBjb250YWlucywgc3BlZWQsIGRlc3RpbmF0aW9uKSB7XG4gICAgdGhpcy5zeXN0ZW0gPSBzeXN0ZW07XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMuY29udGFpbnMgPSBjb250YWlucztcbiAgICB0aGlzLnNwZWVkID0gc3BlZWQ7XG4gICAgdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uO1xuICB9XG5cbiAgdG9KU09OKCkge1xuICAgIGxldCB7IHN5c3RlbSwgeCwgeSwgY29udGFpbnMsIHNwZWVkLCBkZXN0aW5hdGlvbiB9ID0gdGhpcztcbiAgICByZXR1cm4ge1xuICAgICAgeCxcbiAgICAgIHksXG4gICAgICBjb250YWlucyxcbiAgICAgIHNwZWVkLFxuICAgICAgZGVzdGluYXRpb25cbiAgICB9XG4gIH1cbn1cblxuaWYgKCF3aW5kb3cuc2ltdWxhdGlvbikge1xuICB3aW5kb3cuc2ltdWxhdGlvbiA9IHt9O1xufVxuXG53aW5kb3cuc2ltdWxhdGlvbi5zaGlwID0ge1xuICAnU2hpcCc6IFNoaXBcbn07XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogc3JjL3NpbXVsYXRpb24vc2hpcC5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7OztBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 337 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _unpickler = __webpack_require__(338);\n\nvar _pickler = __webpack_require__(342);\n\nvar _util = __webpack_require__(339);\n\nvar _tags = __webpack_require__(340);\n\nvar _handlers = __webpack_require__(341);\n\nvar jsonpickle = {}; /**\n                      * jsonpickleJS -- interpretation of python jsonpickle in Javascript\n                      * main.js -- main loader -- this should be the only file that most users care about.\n                      *\n                      * Copyright (c) 2014-16 Michael Scott Cuthbert and cuthbertLab\n                      */\n\njsonpickle.pickler = _pickler.pickler;\njsonpickle.unpickler = _unpickler.unpickler;\njsonpickle.util = _util.util;\njsonpickle.tags = _tags.tags;\njsonpickle.handlers = _handlers.handlers;\n\njsonpickle.encode = function jsonpickle_encode(value, unpicklable, make_refs, keys, max_depth, backend) {\n    if (unpicklable === undefined) {\n        unpicklable = true;\n    }\n    if (make_refs === undefined) {\n        make_refs = true;\n    }\n    if (keys === undefined) {\n        keys = false;\n    }\n    var options = {\n        unpicklable: unpicklable,\n        make_refs: make_refs,\n        keys: keys,\n        max_depth: max_depth,\n        backend: backend\n    };\n    return _pickler.pickler.encode(value, options);\n};\n\njsonpickle.decode = function jsonpickle_decode(string, backend, keys) {\n    if (keys === undefined) {\n        keys = false;\n    }\n    return _unpickler.unpickler.decode(string, backend, keys);\n};\n\nwindow.jsonpickle = {}; // global for now.\nexports.default = jsonpickle;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvbWFpbi5qcz9lNjAzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICoganNvbnBpY2tsZUpTIC0tIGludGVycHJldGF0aW9uIG9mIHB5dGhvbiBqc29ucGlja2xlIGluIEphdmFzY3JpcHRcbiAqIG1haW4uanMgLS0gbWFpbiBsb2FkZXIgLS0gdGhpcyBzaG91bGQgYmUgdGhlIG9ubHkgZmlsZSB0aGF0IG1vc3QgdXNlcnMgY2FyZSBhYm91dC5cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtMTYgTWljaGFlbCBTY290dCBDdXRoYmVydCBhbmQgY3V0aGJlcnRMYWJcbiAqL1xuaW1wb3J0IHsgdW5waWNrbGVyIH0gZnJvbSAnLi91bnBpY2tsZXInO1xuaW1wb3J0IHsgcGlja2xlciB9IGZyb20gJy4vcGlja2xlcic7XG5pbXBvcnQgeyB1dGlsIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7IHRhZ3MgfSBmcm9tICcuL3RhZ3MnO1xuaW1wb3J0IHsgaGFuZGxlcnMgfSBmcm9tICcuL2hhbmRsZXJzJztcblxuY29uc3QganNvbnBpY2tsZSA9IHt9O1xuanNvbnBpY2tsZS5waWNrbGVyID0gcGlja2xlcjtcbmpzb25waWNrbGUudW5waWNrbGVyID0gdW5waWNrbGVyO1xuanNvbnBpY2tsZS51dGlsID0gdXRpbDtcbmpzb25waWNrbGUudGFncyA9IHRhZ3M7XG5qc29ucGlja2xlLmhhbmRsZXJzID0gaGFuZGxlcnM7XG5cbmpzb25waWNrbGUuZW5jb2RlID0gZnVuY3Rpb24ganNvbnBpY2tsZV9lbmNvZGUodmFsdWUsIHVucGlja2xhYmxlLCBtYWtlX3JlZnMsXG4gICAgICAgIGtleXMsIG1heF9kZXB0aCwgYmFja2VuZCkge1xuICAgIGlmICh1bnBpY2tsYWJsZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHVucGlja2xhYmxlID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKG1ha2VfcmVmcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG1ha2VfcmVmcyA9IHRydWU7XG4gICAgfVxuICAgIGlmIChrZXlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAga2V5cyA9IGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICB1bnBpY2tsYWJsZSxcbiAgICAgICAgbWFrZV9yZWZzLFxuICAgICAgICBrZXlzLFxuICAgICAgICBtYXhfZGVwdGgsXG4gICAgICAgIGJhY2tlbmQsXG4gICAgfTtcbiAgICByZXR1cm4gcGlja2xlci5lbmNvZGUodmFsdWUsIG9wdGlvbnMpO1xufTtcblxuXG5qc29ucGlja2xlLmRlY29kZSA9IGZ1bmN0aW9uIGpzb25waWNrbGVfZGVjb2RlKHN0cmluZywgYmFja2VuZCwga2V5cykge1xuICAgIGlmIChrZXlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAga2V5cyA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdW5waWNrbGVyLmRlY29kZShzdHJpbmcsIGJhY2tlbmQsIGtleXMpO1xufTtcblxud2luZG93Lmpzb25waWNrbGUgPSB7fTsgLy8gZ2xvYmFsIGZvciBub3cuXG5leHBvcnQgZGVmYXVsdCBqc29ucGlja2xlO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogbm9kZV9tb2R1bGVzL2pzb25waWNrbGVqcy9tYWluLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFNQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 338 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Unpickler = exports.unpickler = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * jsonPickle/javascript/unpickler -- Conversion from music21p jsonpickle streams\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (c) 2013-14, Michael Scott Cuthbert and cuthbertLab\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Based on music21 (=music21p), Copyright (c) 2006–14, Michael Scott Cuthbert and cuthbertLab\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * usage:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * js_obj = unpickler.decode(json_string);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _util = __webpack_require__(339);\n\nvar _handlers = __webpack_require__(341);\n\nvar _tags = __webpack_require__(340);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar unpickler = exports.unpickler = {};\n\nunpickler.decode = function decode(string, user_handlers, options) {\n    var params = {\n        keys: false,\n        safe: false,\n        reset: true,\n        backend: JSON\n    };\n\n    _util.util.merge(params, options);\n\n    var use_handlers = {};\n    _util.util.merge(use_handlers, _handlers.handlers); // don't screw up default handlers...\n    _util.util.merge(use_handlers, user_handlers);\n\n    var context = void 0;\n    // backend does not do anything -- it is there for\n    // compat with py-JSON-Pickle\n    if (params.context === undefined) {\n        var unpickler_options = {\n            keys: params.keys,\n            backend: params.backend,\n            safe: params.safe\n        };\n        context = new unpickler.Unpickler(unpickler_options, use_handlers);\n    } else {\n        context = params.context;\n    }\n    var jsonObj = params.backend.parse(string);\n    return context.restore(jsonObj, params.reset);\n};\n\nvar Unpickler = exports.Unpickler = function () {\n    function Unpickler(options, handlers) {\n        _classCallCheck(this, Unpickler);\n\n        var params = {\n            keys: false,\n            safe: false\n        };\n        _util.util.merge(params, options);\n        this.keys = params.keys;\n        this.safe = params.safe;\n\n        this.handlers = handlers;\n        // obsolete...\n        // this._namedict = {};\n\n        // The namestack grows whenever we recurse into a child object\n        this._namestack = [];\n\n        // Maps objects to their index in the _objs list\n        this._obj_to_idx = {};\n        this._objs = [];\n    }\n\n    _createClass(Unpickler, [{\n        key: 'reset',\n        value: function reset() {\n            // this._namedict = {};\n            this._namestack = [];\n            this._obj_to_idx = {};\n            this._objs = [];\n        }\n\n        /**\n         * Restores a flattened object to a JavaScript representation\n         * as close to the original python object as possible.\n         *\n         */\n\n    }, {\n        key: 'restore',\n        value: function restore(obj, reset) {\n            if (reset) {\n                this.reset();\n            }\n            return this._restore(obj);\n        }\n    }, {\n        key: '_restore',\n        value: function _restore(obj) {\n            var has_tag = unpickler.has_tag;\n            var restoreMeth = function restoreMeth(obj) {\n                return obj;\n            };\n\n            if (has_tag(obj, _tags.tags.ID)) {\n                restoreMeth = this._restore_id.bind(this);\n            } else if (has_tag(obj, _tags.tags.REF)) {\n                // backwards compat. not supported\n            } else if (has_tag(obj, _tags.tags.TYPE)) {\n                restoreMeth = this._restore_type.bind(this);\n            } else if (has_tag(obj, _tags.tags.REPR)) {\n                // backwards compat. not supported\n            } else if (has_tag(obj, _tags.tags.OBJECT)) {\n                restoreMeth = this._restore_object.bind(this);\n            } else if (has_tag(obj, _tags.tags.TUPLE)) {\n                restoreMeth = this._restore_tuple.bind(this);\n            } else if (has_tag(obj, _tags.tags.SET)) {\n                restoreMeth = this._restore_set.bind(this);\n            } else if (_util.util.is_list(obj)) {\n                restoreMeth = this._restore_list.bind(this);\n            } else if (_util.util.is_dictionary(obj)) {\n                restoreMeth = this._restore_dict.bind(this);\n            } else {\n                // map to self\n            }\n            return restoreMeth(obj);\n        }\n    }, {\n        key: '_restore_id',\n        value: function _restore_id(obj) {\n            return this._objs[obj[_tags.tags.ID]];\n        }\n    }, {\n        key: '_restore_type',\n        value: function _restore_type(obj) {\n            var typeref = unpickler.loadclass(obj[_tags.tags.TYPE]);\n            if (typeref === undefined) {\n                return obj;\n            } else {\n                return typeref;\n            }\n        }\n    }, {\n        key: '_restore_object',\n        value: function _restore_object(obj) {\n            var class_name = obj[_tags.tags.OBJECT];\n            var handler = this.handlers[class_name];\n            if (handler !== undefined && handler.restore !== undefined) {\n                var instance = handler.restore(obj);\n                instance[_tags.tags.PY_CLASS] = class_name;\n                return this._mkref(instance);\n            } else {\n                var cls = unpickler.loadclass(class_name);\n                if (cls === undefined) {\n                    obj[_tags.tags.PY_CLASS] = class_name;\n                    return this._mkref(obj);\n                }\n                var _instance = this._restore_object_instance(obj, cls);\n                _instance[_tags.tags.PY_CLASS] = class_name;\n                if (handler !== undefined && handler.post_restore !== undefined) {\n                    return handler.post_restore(_instance);\n                } else {\n                    return _instance;\n                }\n            }\n        }\n    }, {\n        key: '_loadfactory',\n        value: function _loadfactory(obj) {\n            var default_factory = obj.default_factory;\n            if (default_factory === undefined) {\n                return undefined;\n            } else {\n                obj.default_factory = undefined;\n                return this._restore(default_factory);\n            }\n        }\n    }, {\n        key: '_restore_object_instance',\n        value: function _restore_object_instance(obj, cls) {\n            // var factory = this._loadfactory(obj);\n            var args = unpickler.getargs(obj);\n            if (args.length > 0) {\n                args = this._restore(args);\n            }\n            // not using factory... does not seem to apply to JS\n            var instance = unpickler.construct(cls, args);\n            this._mkref(instance);\n            return this._restore_object_instance_variables(obj, instance);\n        }\n    }, {\n        key: '_restore_object_instance_variables',\n        value: function _restore_object_instance_variables(obj, instance) {\n            var has_tag = unpickler.has_tag;\n            var restore_key = this._restore_key_fn();\n            var keys = [];\n            for (var k in obj) {\n                if ({}.hasOwnProperty.call(obj, k)) {\n                    keys.push(k);\n                }\n            }\n            keys.sort();\n            for (var i = 0; i < keys.length; i++) {\n                var _k = keys[i];\n                if (_tags.tags.RESERVED.indexOf(_k) !== -1) {\n                    continue;\n                }\n                var v = obj[_k];\n                this._namestack.push(_k);\n                _k = restore_key(_k);\n                var value = void 0;\n                if (v !== undefined && v !== null) {\n                    value = this._restore(v);\n                }\n                // no setattr checks...\n                instance[_k] = value;\n                this._namestack.pop();\n            }\n            if (has_tag(obj, _tags.tags.SEQ)) {\n                if (instance.push !== undefined) {\n                    for (var _v in obj[_tags.tags.SEQ]) {\n                        if (!{}.hasOwnProperty.call(obj[_tags.tags.SEQ], _v)) {\n                            continue;\n                        }\n                        instance.push(this._restore(_v));\n                    }\n                } // no .add ...\n            }\n\n            if (has_tag(obj, _tags.tags.STATE)) {\n                instance = this._restore_state(obj, instance);\n            }\n            return instance;\n        }\n    }, {\n        key: '_restore_state',\n        value: function _restore_state(obj, instance) {\n            // only if the JS object implements __setstate__\n            if (instance.__setstate__ !== undefined) {\n                var state = this._restore(obj[_tags.tags.STATE]);\n                instance.__setstate__(state);\n            } else {\n                instance = this._restore_object_instance_variables(obj[_tags.tags.STATE], instance);\n            }\n            return instance;\n        }\n    }, {\n        key: '_restore_list',\n        value: function _restore_list(obj) {\n            var parent = [];\n            this._mkref(parent);\n            var children = [];\n            for (var i = 0; i < obj.length; i++) {\n                var v = obj[i];\n                var rest = this._restore(v);\n                children.push(rest);\n            }\n            parent.push.apply(parent, children);\n            return parent;\n        }\n    }, {\n        key: '_restore_tuple',\n        value: function _restore_tuple(obj) {\n            // JS having no difference between list, tuple, set -- returns Array\n            var children = [];\n            var tupleContents = obj[_tags.tags.TUPLE];\n            for (var i = 0; i < tupleContents.length; i++) {\n                children.push(this._restore(tupleContents[i]));\n            }\n            return children;\n        }\n    }, {\n        key: '_restore_set',\n        value: function _restore_set(obj) {\n            // JS having no difference between list, tuple, set -- returns Array\n            // TODO: ES5 Sets!\n            var children = [];\n            var setContents = obj[_tags.tags.SET];\n            for (var i = 0; i < setContents.length; i++) {\n                children.push(this._restore(setContents[i]));\n            }\n            return children;\n        }\n    }, {\n        key: '_restore_dict',\n        value: function _restore_dict(obj) {\n            var data = {};\n            // var restore_key = this._restore_key_fn();\n            var keys = [];\n            for (var k in obj) {\n                if ({}.hasOwnProperty.call(obj, k)) {\n                    keys.push(k);\n                }\n            }\n            keys.sort();\n            for (var i = 0; i < keys.length; i++) {\n                var _k2 = keys[i];\n                var v = obj[_k2];\n\n                this._namestack.push(_k2);\n                data[_k2] = this._restore(v);\n                // no setattr checks...\n                this._namestack.pop();\n            }\n            return data;\n        }\n    }, {\n        key: '_restore_key_fn',\n        value: function _restore_key_fn() {\n            var _this = this;\n\n            if (this.keys) {\n                return function (key) {\n                    if (key.indexOf(_tags.tags.JSON_KEY) === 0) {\n                        key = unpickler.decode(key.slice(_tags.tags.JSON_KEY.length), _this.handlers, { context: _this,\n                            keys: _this.keys,\n                            reset: false\n                        });\n                        return key;\n                    } else {\n                        return key;\n                    }\n                };\n            } else {\n                return function (key) {\n                    return key;\n                };\n            }\n        }\n\n        //  _refname not needed...\n\n    }, {\n        key: '_mkref',\n        value: function _mkref(obj) {\n            // does not use id(obj) in javascript\n            this._objs.push(obj);\n            return obj;\n        }\n    }]);\n\n    return Unpickler;\n}();\n\nunpickler.Unpickler = Unpickler;\n\nunpickler.getargs = function getargs(obj) {\n    var seq_list = obj[_tags.tags.SEQ];\n    var obj_dict = obj[_tags.tags.OBJECT];\n    if (seq_list === undefined || obj_dict === undefined) {\n        return [];\n    }\n    var typeref = unpickler.loadclass(obj_dict);\n    if (typeref === undefined) {\n        return [];\n    }\n    if (typeref._fields !== undefined) {\n        if (typeref._fields.length === seq_list.length) {\n            return seq_list;\n        }\n    }\n    return [];\n};\n\nunpickler.loadclass = function loadclass(module_and_name) {\n    var main_check = '__main__.';\n    if (module_and_name.indexOf(main_check) === 0) {\n        module_and_name = module_and_name.slice(main_check.length);\n    }\n    var parent = window;\n    var module_class_split = module_and_name.split('.');\n    for (var i = 0; i < module_class_split.length; i++) {\n        var this_module_or_class = module_class_split[i];\n        parent = parent[this_module_or_class];\n        if (parent === undefined) {\n            return parent;\n        }\n    }\n    return parent;\n};\n\nunpickler.has_tag = function has_tag(obj, tag) {\n    if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null && obj[tag] !== undefined) {\n        return true;\n    } else {\n        return false;\n    }\n};\n\n// http://stackoverflow.com/questions/1606797/use-of-apply-with-new-operator-is-this-possible\nunpickler.construct = function construct(constructor, args) {\n    function F() {\n        return constructor.apply(this, args);\n    }\n    F.prototype = constructor.prototype;\n    return new F();\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvdW5waWNrbGVyLmpzPzEyMjkiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBqc29uUGlja2xlL2phdmFzY3JpcHQvdW5waWNrbGVyIC0tIENvbnZlcnNpb24gZnJvbSBtdXNpYzIxcCBqc29ucGlja2xlIHN0cmVhbXNcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMtMTQsIE1pY2hhZWwgU2NvdHQgQ3V0aGJlcnQgYW5kIGN1dGhiZXJ0TGFiXG4gKiBCYXNlZCBvbiBtdXNpYzIxICg9bXVzaWMyMXApLCBDb3B5cmlnaHQgKGMpIDIwMDbigJMxNCwgTWljaGFlbCBTY290dCBDdXRoYmVydCBhbmQgY3V0aGJlcnRMYWJcbiAqXG4gKiB1c2FnZTpcbiAqXG4gKiBqc19vYmogPSB1bnBpY2tsZXIuZGVjb2RlKGpzb25fc3RyaW5nKTtcbiAqXG4gKi9cblxuaW1wb3J0IHsgdXRpbCB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgeyBoYW5kbGVycyB9IGZyb20gJy4vaGFuZGxlcnMnO1xuaW1wb3J0IHsgdGFncyB9IGZyb20gJy4vdGFncyc7XG5cbmV4cG9ydCBjb25zdCB1bnBpY2tsZXIgPSB7fTtcblxudW5waWNrbGVyLmRlY29kZSA9IGZ1bmN0aW9uIGRlY29kZShzdHJpbmcsIHVzZXJfaGFuZGxlcnMsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIGtleXM6IGZhbHNlLFxuICAgICAgICBzYWZlOiBmYWxzZSxcbiAgICAgICAgcmVzZXQ6IHRydWUsXG4gICAgICAgIGJhY2tlbmQ6IEpTT04sXG4gICAgfTtcblxuICAgIHV0aWwubWVyZ2UocGFyYW1zLCBvcHRpb25zKTtcblxuICAgIGNvbnN0IHVzZV9oYW5kbGVycyA9IHt9O1xuICAgIHV0aWwubWVyZ2UodXNlX2hhbmRsZXJzLCBoYW5kbGVycyk7IC8vIGRvbid0IHNjcmV3IHVwIGRlZmF1bHQgaGFuZGxlcnMuLi5cbiAgICB1dGlsLm1lcmdlKHVzZV9oYW5kbGVycywgdXNlcl9oYW5kbGVycyk7XG5cbiAgICBsZXQgY29udGV4dDtcbiAgICAvLyBiYWNrZW5kIGRvZXMgbm90IGRvIGFueXRoaW5nIC0tIGl0IGlzIHRoZXJlIGZvclxuICAgIC8vIGNvbXBhdCB3aXRoIHB5LUpTT04tUGlja2xlXG4gICAgaWYgKHBhcmFtcy5jb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgdW5waWNrbGVyX29wdGlvbnMgPSB7XG4gICAgICAgICAgICBrZXlzOiBwYXJhbXMua2V5cyxcbiAgICAgICAgICAgIGJhY2tlbmQ6IHBhcmFtcy5iYWNrZW5kLFxuICAgICAgICAgICAgc2FmZTogcGFyYW1zLnNhZmUsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnRleHQgPSBuZXcgdW5waWNrbGVyLlVucGlja2xlcih1bnBpY2tsZXJfb3B0aW9ucywgdXNlX2hhbmRsZXJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0ID0gcGFyYW1zLmNvbnRleHQ7XG4gICAgfVxuICAgIGNvbnN0IGpzb25PYmogPSBwYXJhbXMuYmFja2VuZC5wYXJzZShzdHJpbmcpO1xuICAgIHJldHVybiBjb250ZXh0LnJlc3RvcmUoanNvbk9iaiwgcGFyYW1zLnJlc2V0KTtcbn07XG5cbmV4cG9ydCBjbGFzcyBVbnBpY2tsZXIge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGhhbmRsZXJzKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgIGtleXM6IGZhbHNlLFxuICAgICAgICAgICAgc2FmZTogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICAgIHV0aWwubWVyZ2UocGFyYW1zLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5rZXlzID0gcGFyYW1zLmtleXM7XG4gICAgICAgIHRoaXMuc2FmZSA9IHBhcmFtcy5zYWZlO1xuXG4gICAgICAgIHRoaXMuaGFuZGxlcnMgPSBoYW5kbGVycztcbiAgICAgICAgLy8gb2Jzb2xldGUuLi5cbiAgICAgICAgLy8gdGhpcy5fbmFtZWRpY3QgPSB7fTtcblxuICAgICAgICAvLyBUaGUgbmFtZXN0YWNrIGdyb3dzIHdoZW5ldmVyIHdlIHJlY3Vyc2UgaW50byBhIGNoaWxkIG9iamVjdFxuICAgICAgICB0aGlzLl9uYW1lc3RhY2sgPSBbXTtcblxuICAgICAgICAvLyBNYXBzIG9iamVjdHMgdG8gdGhlaXIgaW5kZXggaW4gdGhlIF9vYmpzIGxpc3RcbiAgICAgICAgdGhpcy5fb2JqX3RvX2lkeCA9IHt9O1xuICAgICAgICB0aGlzLl9vYmpzID0gW107XG4gICAgfVxuXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIC8vIHRoaXMuX25hbWVkaWN0ID0ge307XG4gICAgICAgIHRoaXMuX25hbWVzdGFjayA9IFtdO1xuICAgICAgICB0aGlzLl9vYmpfdG9faWR4ID0ge307XG4gICAgICAgIHRoaXMuX29ianMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXN0b3JlcyBhIGZsYXR0ZW5lZCBvYmplY3QgdG8gYSBKYXZhU2NyaXB0IHJlcHJlc2VudGF0aW9uXG4gICAgICogYXMgY2xvc2UgdG8gdGhlIG9yaWdpbmFsIHB5dGhvbiBvYmplY3QgYXMgcG9zc2libGUuXG4gICAgICpcbiAgICAgKi9cbiAgICByZXN0b3JlKG9iaiwgcmVzZXQpIHtcbiAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3RvcmUob2JqKTtcbiAgICB9XG5cbiAgICBfcmVzdG9yZShvYmopIHtcbiAgICAgICAgY29uc3QgaGFzX3RhZyA9IHVucGlja2xlci5oYXNfdGFnO1xuICAgICAgICBsZXQgcmVzdG9yZU1ldGggPSAob2JqKSA9PiBvYmo7XG5cbiAgICAgICAgaWYgKGhhc190YWcob2JqLCB0YWdzLklEKSkge1xuICAgICAgICAgICAgcmVzdG9yZU1ldGggPSB0aGlzLl9yZXN0b3JlX2lkLmJpbmQodGhpcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFzX3RhZyhvYmosIHRhZ3MuUkVGKSkge1xuICAgICAgICAgICAgLy8gYmFja3dhcmRzIGNvbXBhdC4gbm90IHN1cHBvcnRlZFxuICAgICAgICB9IGVsc2UgaWYgKGhhc190YWcob2JqLCB0YWdzLlRZUEUpKSB7XG4gICAgICAgICAgICByZXN0b3JlTWV0aCA9IHRoaXMuX3Jlc3RvcmVfdHlwZS5iaW5kKHRoaXMpO1xuICAgICAgICB9IGVsc2UgaWYgKGhhc190YWcob2JqLCB0YWdzLlJFUFIpKSB7XG4gICAgICAgICAgICAvLyBiYWNrd2FyZHMgY29tcGF0LiBub3Qgc3VwcG9ydGVkXG4gICAgICAgIH0gZWxzZSBpZiAoaGFzX3RhZyhvYmosIHRhZ3MuT0JKRUNUKSkge1xuICAgICAgICAgICAgcmVzdG9yZU1ldGggPSB0aGlzLl9yZXN0b3JlX29iamVjdC5iaW5kKHRoaXMpO1xuICAgICAgICB9IGVsc2UgaWYgKGhhc190YWcob2JqLCB0YWdzLlRVUExFKSkge1xuICAgICAgICAgICAgcmVzdG9yZU1ldGggPSB0aGlzLl9yZXN0b3JlX3R1cGxlLmJpbmQodGhpcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFzX3RhZyhvYmosIHRhZ3MuU0VUKSkge1xuICAgICAgICAgICAgcmVzdG9yZU1ldGggPSB0aGlzLl9yZXN0b3JlX3NldC5iaW5kKHRoaXMpO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWwuaXNfbGlzdChvYmopKSB7XG4gICAgICAgICAgICByZXN0b3JlTWV0aCA9IHRoaXMuX3Jlc3RvcmVfbGlzdC5iaW5kKHRoaXMpO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWwuaXNfZGljdGlvbmFyeShvYmopKSB7XG4gICAgICAgICAgICByZXN0b3JlTWV0aCA9IHRoaXMuX3Jlc3RvcmVfZGljdC5iaW5kKHRoaXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gbWFwIHRvIHNlbGZcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdG9yZU1ldGgob2JqKTtcbiAgICB9XG5cbiAgICBfcmVzdG9yZV9pZChvYmopIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29ianNbb2JqW3RhZ3MuSURdXTtcbiAgICB9XG5cbiAgICBfcmVzdG9yZV90eXBlKG9iaikge1xuICAgICAgICBjb25zdCB0eXBlcmVmID0gdW5waWNrbGVyLmxvYWRjbGFzcyhvYmpbdGFncy5UWVBFXSk7XG4gICAgICAgIGlmICh0eXBlcmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZXJlZjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9yZXN0b3JlX29iamVjdChvYmopIHtcbiAgICAgICAgY29uc3QgY2xhc3NfbmFtZSA9IG9ialt0YWdzLk9CSkVDVF07XG4gICAgICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLmhhbmRsZXJzW2NsYXNzX25hbWVdO1xuICAgICAgICBpZiAoaGFuZGxlciAhPT0gdW5kZWZpbmVkICYmIGhhbmRsZXIucmVzdG9yZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGhhbmRsZXIucmVzdG9yZShvYmopO1xuICAgICAgICAgICAgaW5zdGFuY2VbdGFncy5QWV9DTEFTU10gPSBjbGFzc19uYW1lO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21rcmVmKGluc3RhbmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGNscyA9IHVucGlja2xlci5sb2FkY2xhc3MoY2xhc3NfbmFtZSk7XG4gICAgICAgICAgICBpZiAoY2xzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBvYmpbdGFncy5QWV9DTEFTU10gPSBjbGFzc19uYW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ta3JlZihvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLl9yZXN0b3JlX29iamVjdF9pbnN0YW5jZShvYmosIGNscyk7XG4gICAgICAgICAgICBpbnN0YW5jZVt0YWdzLlBZX0NMQVNTXSA9IGNsYXNzX25hbWU7XG4gICAgICAgICAgICBpZiAoaGFuZGxlciAhPT0gdW5kZWZpbmVkICYmIGhhbmRsZXIucG9zdF9yZXN0b3JlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlci5wb3N0X3Jlc3RvcmUoaW5zdGFuY2UpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2xvYWRmYWN0b3J5KG9iaikge1xuICAgICAgICBjb25zdCBkZWZhdWx0X2ZhY3RvcnkgPSBvYmouZGVmYXVsdF9mYWN0b3J5O1xuICAgICAgICBpZiAoZGVmYXVsdF9mYWN0b3J5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvYmouZGVmYXVsdF9mYWN0b3J5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3RvcmUoZGVmYXVsdF9mYWN0b3J5KTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgX3Jlc3RvcmVfb2JqZWN0X2luc3RhbmNlKG9iaiwgY2xzKSB7XG4gICAgICAgIC8vIHZhciBmYWN0b3J5ID0gdGhpcy5fbG9hZGZhY3Rvcnkob2JqKTtcbiAgICAgICAgbGV0IGFyZ3MgPSB1bnBpY2tsZXIuZ2V0YXJncyhvYmopO1xuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBhcmdzID0gdGhpcy5fcmVzdG9yZShhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBub3QgdXNpbmcgZmFjdG9yeS4uLiBkb2VzIG5vdCBzZWVtIHRvIGFwcGx5IHRvIEpTXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gdW5waWNrbGVyLmNvbnN0cnVjdChjbHMsIGFyZ3MpO1xuICAgICAgICB0aGlzLl9ta3JlZihpbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXN0b3JlX29iamVjdF9pbnN0YW5jZV92YXJpYWJsZXMob2JqLCBpbnN0YW5jZSk7XG4gICAgfVxuXG4gICAgX3Jlc3RvcmVfb2JqZWN0X2luc3RhbmNlX3ZhcmlhYmxlcyhvYmosIGluc3RhbmNlKSB7XG4gICAgICAgIGNvbnN0IGhhc190YWcgPSB1bnBpY2tsZXIuaGFzX3RhZztcbiAgICAgICAgY29uc3QgcmVzdG9yZV9rZXkgPSB0aGlzLl9yZXN0b3JlX2tleV9mbigpO1xuICAgICAgICBjb25zdCBrZXlzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgayBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgaykpIHtcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2goayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5zb3J0KCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGsgPSBrZXlzW2ldO1xuICAgICAgICAgICAgaWYgKHRhZ3MuUkVTRVJWRUQuaW5kZXhPZihrKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHYgPSBvYmpba107XG4gICAgICAgICAgICB0aGlzLl9uYW1lc3RhY2sucHVzaChrKTtcbiAgICAgICAgICAgIGsgPSByZXN0b3JlX2tleShrKTtcbiAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQgJiYgdiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5fcmVzdG9yZSh2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIG5vIHNldGF0dHIgY2hlY2tzLi4uXG4gICAgICAgICAgICBpbnN0YW5jZVtrXSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fbmFtZXN0YWNrLnBvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNfdGFnKG9iaiwgdGFncy5TRVEpKSB7XG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UucHVzaCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB2IGluIG9ialt0YWdzLlNFUV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoe30uaGFzT3duUHJvcGVydHkuY2FsbChvYmpbdGFncy5TRVFdLCB2KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnB1c2godGhpcy5fcmVzdG9yZSh2KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSAvLyBubyAuYWRkIC4uLlxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGhhc190YWcob2JqLCB0YWdzLlNUQVRFKSkge1xuICAgICAgICAgICAgaW5zdGFuY2UgPSB0aGlzLl9yZXN0b3JlX3N0YXRlKG9iaiwgaW5zdGFuY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG5cblxuICAgIF9yZXN0b3JlX3N0YXRlKG9iaiwgaW5zdGFuY2UpIHtcbiAgICAgICAgLy8gb25seSBpZiB0aGUgSlMgb2JqZWN0IGltcGxlbWVudHMgX19zZXRzdGF0ZV9fXG4gICAgICAgIGlmIChpbnN0YW5jZS5fX3NldHN0YXRlX18gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLl9yZXN0b3JlKG9ialt0YWdzLlNUQVRFXSk7XG4gICAgICAgICAgICBpbnN0YW5jZS5fX3NldHN0YXRlX18oc3RhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5zdGFuY2UgPSB0aGlzLl9yZXN0b3JlX29iamVjdF9pbnN0YW5jZV92YXJpYWJsZXMob2JqW3RhZ3MuU1RBVEVdLCBpbnN0YW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cblxuICAgIF9yZXN0b3JlX2xpc3Qob2JqKSB7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IFtdO1xuICAgICAgICB0aGlzLl9ta3JlZihwYXJlbnQpO1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgdiA9IG9ialtpXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3QgPSB0aGlzLl9yZXN0b3JlKHYpO1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChyZXN0KTtcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQucHVzaCguLi5jaGlsZHJlbik7XG4gICAgICAgIHJldHVybiBwYXJlbnQ7XG4gICAgfVxuICAgIF9yZXN0b3JlX3R1cGxlKG9iaikge1xuICAgICAgICAvLyBKUyBoYXZpbmcgbm8gZGlmZmVyZW5jZSBiZXR3ZWVuIGxpc3QsIHR1cGxlLCBzZXQgLS0gcmV0dXJucyBBcnJheVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IFtdO1xuICAgICAgICBjb25zdCB0dXBsZUNvbnRlbnRzID0gb2JqW3RhZ3MuVFVQTEVdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR1cGxlQ29udGVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNoaWxkcmVuLnB1c2godGhpcy5fcmVzdG9yZSh0dXBsZUNvbnRlbnRzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cblxuICAgIF9yZXN0b3JlX3NldChvYmopIHtcbiAgICAgICAgLy8gSlMgaGF2aW5nIG5vIGRpZmZlcmVuY2UgYmV0d2VlbiBsaXN0LCB0dXBsZSwgc2V0IC0tIHJldHVybnMgQXJyYXlcbiAgICAgICAgLy8gVE9ETzogRVM1IFNldHMhXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gW107XG4gICAgICAgIGNvbnN0IHNldENvbnRlbnRzID0gb2JqW3RhZ3MuU0VUXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXRDb250ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaCh0aGlzLl9yZXN0b3JlKHNldENvbnRlbnRzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cblxuICAgIF9yZXN0b3JlX2RpY3Qob2JqKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICAgICAgLy8gdmFyIHJlc3RvcmVfa2V5ID0gdGhpcy5fcmVzdG9yZV9rZXlfZm4oKTtcbiAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoe30uaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGspKSB7XG4gICAgICAgICAgICAgICAga2V5cy5wdXNoKGspO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGtleXMuc29ydCgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGsgPSBrZXlzW2ldO1xuICAgICAgICAgICAgY29uc3QgdiA9IG9ialtrXTtcblxuICAgICAgICAgICAgdGhpcy5fbmFtZXN0YWNrLnB1c2goayk7XG4gICAgICAgICAgICBkYXRhW2tdID0gdGhpcy5fcmVzdG9yZSh2KTtcbiAgICAgICAgICAgIC8vIG5vIHNldGF0dHIgY2hlY2tzLi4uXG4gICAgICAgICAgICB0aGlzLl9uYW1lc3RhY2sucG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4gICAgX3Jlc3RvcmVfa2V5X2ZuKCkge1xuICAgICAgICBpZiAodGhpcy5rZXlzKSB7XG4gICAgICAgICAgICByZXR1cm4gKGtleSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChrZXkuaW5kZXhPZih0YWdzLkpTT05fS0VZKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSB1bnBpY2tsZXIuZGVjb2RlKGtleS5zbGljZSh0YWdzLkpTT05fS0VZLmxlbmd0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVycyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNvbnRleHQ6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiB0aGlzLmtleXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNldDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAoa2V5KSA9PiBrZXk7XG4gICAgICAgIH1cbiAgICB9XG5cbi8vICBfcmVmbmFtZSBub3QgbmVlZGVkLi4uXG4gICAgX21rcmVmKG9iaikge1xuICAgICAgICAvLyBkb2VzIG5vdCB1c2UgaWQob2JqKSBpbiBqYXZhc2NyaXB0XG4gICAgICAgIHRoaXMuX29ianMucHVzaChvYmopO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cbn1cbnVucGlja2xlci5VbnBpY2tsZXIgPSBVbnBpY2tsZXI7XG5cblxudW5waWNrbGVyLmdldGFyZ3MgPSBmdW5jdGlvbiBnZXRhcmdzKG9iaikge1xuICAgIGNvbnN0IHNlcV9saXN0ID0gb2JqW3RhZ3MuU0VRXTtcbiAgICBjb25zdCBvYmpfZGljdCA9IG9ialt0YWdzLk9CSkVDVF07XG4gICAgaWYgKHNlcV9saXN0ID09PSB1bmRlZmluZWQgfHwgb2JqX2RpY3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGNvbnN0IHR5cGVyZWYgPSB1bnBpY2tsZXIubG9hZGNsYXNzKG9ial9kaWN0KTtcbiAgICBpZiAodHlwZXJlZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgaWYgKHR5cGVyZWYuX2ZpZWxkcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICh0eXBlcmVmLl9maWVsZHMubGVuZ3RoID09PSBzZXFfbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBzZXFfbGlzdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gW107XG59O1xuXG51bnBpY2tsZXIubG9hZGNsYXNzID0gZnVuY3Rpb24gbG9hZGNsYXNzKG1vZHVsZV9hbmRfbmFtZSkge1xuICAgIGNvbnN0IG1haW5fY2hlY2sgPSAnX19tYWluX18uJztcbiAgICBpZiAobW9kdWxlX2FuZF9uYW1lLmluZGV4T2YobWFpbl9jaGVjaykgPT09IDApIHtcbiAgICAgICAgbW9kdWxlX2FuZF9uYW1lID0gbW9kdWxlX2FuZF9uYW1lLnNsaWNlKG1haW5fY2hlY2subGVuZ3RoKTtcbiAgICB9XG4gICAgbGV0IHBhcmVudCA9IHdpbmRvdztcbiAgICBjb25zdCBtb2R1bGVfY2xhc3Nfc3BsaXQgPSBtb2R1bGVfYW5kX25hbWUuc3BsaXQoJy4nKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1vZHVsZV9jbGFzc19zcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB0aGlzX21vZHVsZV9vcl9jbGFzcyA9IG1vZHVsZV9jbGFzc19zcGxpdFtpXTtcbiAgICAgICAgcGFyZW50ID0gcGFyZW50W3RoaXNfbW9kdWxlX29yX2NsYXNzXTtcbiAgICAgICAgaWYgKHBhcmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYXJlbnQ7XG59O1xuXG51bnBpY2tsZXIuaGFzX3RhZyA9IGZ1bmN0aW9uIGhhc190YWcob2JqLCB0YWcpIHtcbiAgICBpZiAoKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSAmJiAob2JqICE9PSBudWxsKSAmJlxuICAgICAgICAgICAgKG9ialt0YWddICE9PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59O1xuXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE2MDY3OTcvdXNlLW9mLWFwcGx5LXdpdGgtbmV3LW9wZXJhdG9yLWlzLXRoaXMtcG9zc2libGVcbnVucGlja2xlci5jb25zdHJ1Y3QgPSBmdW5jdGlvbiBjb25zdHJ1Y3QoY29uc3RydWN0b3IsIGFyZ3MpIHtcbiAgICBmdW5jdGlvbiBGKCkge1xuICAgICAgICByZXR1cm4gY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICAgIEYucHJvdG90eXBlID0gY29uc3RydWN0b3IucHJvdG90eXBlO1xuICAgIHJldHVybiBuZXcgRigpO1xufTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIG5vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvdW5waWNrbGVyLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7O0FBWUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 339 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.util = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _tags = __webpack_require__(340);\n\nvar util = exports.util = {};\n\nutil.merge = function merge(destination, source) {\n    if (source === undefined) {\n        return destination;\n    }\n    for (var prop in source) {\n        if (!{}.hasOwnProperty.call(source, prop)) {\n            continue;\n        }\n        destination[prop] = source[prop];\n    }\n    return destination;\n};\n\nutil.PRIMITIVES = ['string', 'number', 'boolean'];\n\n/* from jsonpickle.util */\n// to_do...\nutil.is_type = function (obj) {\n    return false;\n};\n\n// same as dictionary in JS...\nutil.is_object = function (obj) {\n    return util.is_dictionary(obj);\n};\n\nutil.is_primitive = function (obj) {\n    if (obj === undefined || obj == null) {\n        return true;\n    }\n    if (util.PRIMITIVES.indexOf(typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== -1) {\n        return true;\n    }\n    return false;\n};\n\nutil.is_dictionary = function (obj) {\n    return (typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null;\n};\n\nutil.is_sequence = function (obj) {\n    return util.is_list(obj) || util.is_set(obj) || util.is_tuple(obj);\n};\n\nutil.is_list = function (obj) {\n    return obj instanceof Array;\n};\n\n// to_do...\nutil.is_set = function (obj) {\n    return false;\n};\nutil.is_tuple = function (obj) {\n    return false;\n};\nutil.is_dictionary_subclass = function (obj) {\n    return false;\n};\nutil.is_sequence_subclass = function (obj) {\n    return false;\n};\nutil.is_noncomplex = function (obj) {\n    return false;\n};\n\nutil.is_function = function (obj) {\n    return typeof obj === 'function';\n};\nutil.is_module = function (obj) {\n    return false;\n};\n\nutil.is_picklable = function (name, value) {\n    if (_tags.tags.RESERVED.indexOf(name) !== -1) {\n        return false;\n    }\n    if (util.is_function(value)) {\n        return false;\n    } else {\n        return true;\n    }\n};\nutil.is_installed = function (module) {\n    return true;\n}; // ???\n\nutil.is_list_like = function (obj) {\n    return util.is_list(obj);\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvdXRpbC5qcz84YzdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRhZ3MgfSBmcm9tICcuL3RhZ3MnO1xuXG5leHBvcnQgY29uc3QgdXRpbCA9IHt9O1xuXG51dGlsLm1lcmdlID0gZnVuY3Rpb24gbWVyZ2UoZGVzdGluYXRpb24sIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZGVzdGluYXRpb247XG4gICAgfVxuICAgIGZvciAoY29uc3QgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKCEoe30uaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIHByb3ApKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgZGVzdGluYXRpb25bcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgfVxuICAgIHJldHVybiBkZXN0aW5hdGlvbjtcbn07XG5cbnV0aWwuUFJJTUlUSVZFUyA9IFsnc3RyaW5nJywgJ251bWJlcicsICdib29sZWFuJ107XG5cbi8qIGZyb20ganNvbnBpY2tsZS51dGlsICovXG4vLyB0b19kby4uLlxudXRpbC5pc190eXBlID0gKG9iaikgPT4gZmFsc2U7XG5cbi8vIHNhbWUgYXMgZGljdGlvbmFyeSBpbiBKUy4uLlxudXRpbC5pc19vYmplY3QgPSAob2JqKSA9PiB1dGlsLmlzX2RpY3Rpb25hcnkob2JqKTtcblxudXRpbC5pc19wcmltaXRpdmUgPSAob2JqKSA9PiB7XG4gICAgaWYgKG9iaiA9PT0gdW5kZWZpbmVkIHx8IG9iaiA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAodXRpbC5QUklNSVRJVkVTLmluZGV4T2YodHlwZW9mIG9iaikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbnV0aWwuaXNfZGljdGlvbmFyeSA9IChvYmopID0+ICgodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpICYmIChvYmogIT09IG51bGwpKTtcblxudXRpbC5pc19zZXF1ZW5jZSA9IChvYmopID0+ICh1dGlsLmlzX2xpc3Qob2JqKSB8fCB1dGlsLmlzX3NldChvYmopIHx8IHV0aWwuaXNfdHVwbGUob2JqKSk7XG5cbnV0aWwuaXNfbGlzdCA9IChvYmopID0+IChvYmogaW5zdGFuY2VvZiBBcnJheSk7XG5cbi8vIHRvX2RvLi4uXG51dGlsLmlzX3NldCA9IChvYmopID0+IGZhbHNlO1xudXRpbC5pc190dXBsZSA9IChvYmopID0+IGZhbHNlO1xudXRpbC5pc19kaWN0aW9uYXJ5X3N1YmNsYXNzID0gKG9iaikgPT4gZmFsc2U7XG51dGlsLmlzX3NlcXVlbmNlX3N1YmNsYXNzID0gKG9iaikgPT4gZmFsc2U7XG51dGlsLmlzX25vbmNvbXBsZXggPSAob2JqKSA9PiBmYWxzZTtcblxudXRpbC5pc19mdW5jdGlvbiA9IChvYmopID0+ICh0eXBlb2Ygb2JqID09PSAnZnVuY3Rpb24nKTtcbnV0aWwuaXNfbW9kdWxlID0gKG9iaikgPT4gZmFsc2U7XG5cbnV0aWwuaXNfcGlja2xhYmxlID0gKG5hbWUsIHZhbHVlKSA9PiB7XG4gICAgaWYgKHRhZ3MuUkVTRVJWRUQuaW5kZXhPZihuYW1lKSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodXRpbC5pc19mdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn07XG51dGlsLmlzX2luc3RhbGxlZCA9IChtb2R1bGUpID0+IHRydWU7IC8vID8/P1xuXG51dGlsLmlzX2xpc3RfbGlrZSA9IChvYmopID0+IHV0aWwuaXNfbGlzdChvYmopO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogbm9kZV9tb2R1bGVzL2pzb25waWNrbGVqcy91dGlsLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 340 */
/***/ function(module, exports) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar tags = exports.tags = {\n    ID: 'py/id',\n    OBJECT: 'py/object',\n    TYPE: 'py/type',\n    REPR: 'py/repr',\n    REF: 'py/ref',\n    TUPLE: 'py/tuple',\n    SET: 'py/set',\n    SEQ: 'py/seq',\n    STATE: 'py/state',\n    JSON_KEY: 'json://'\n};\ntags.RESERVED = [tags.ID, tags.OBJECT, tags.TYPE, tags.REPR, tags.REF, tags.TUPLE, tags.SET, tags.SEQ, tags.STATE, tags.JSON_KEY];\ntags.PY_CLASS = '_py_class';//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvdGFncy5qcz9jZGZmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB0YWdzID0ge1xuICAgIElEOiAncHkvaWQnLFxuICAgIE9CSkVDVDogJ3B5L29iamVjdCcsXG4gICAgVFlQRTogJ3B5L3R5cGUnLFxuICAgIFJFUFI6ICdweS9yZXByJyxcbiAgICBSRUY6ICdweS9yZWYnLFxuICAgIFRVUExFOiAncHkvdHVwbGUnLFxuICAgIFNFVDogJ3B5L3NldCcsXG4gICAgU0VROiAncHkvc2VxJyxcbiAgICBTVEFURTogJ3B5L3N0YXRlJyxcbiAgICBKU09OX0tFWTogJ2pzb246Ly8nLFxufTtcbnRhZ3MuUkVTRVJWRUQgPSBbdGFncy5JRCwgdGFncy5PQkpFQ1QsXG4gICAgICAgICAgICAgICAgIHRhZ3MuVFlQRSwgdGFncy5SRVBSLFxuICAgICAgICAgICAgICAgICB0YWdzLlJFRiwgdGFncy5UVVBMRSxcbiAgICAgICAgICAgICAgICAgdGFncy5TRVQsIHRhZ3MuU0VRLFxuICAgICAgICAgICAgICAgICB0YWdzLlNUQVRFLCB0YWdzLkpTT05fS0VZXTtcbnRhZ3MuUFlfQ0xBU1MgPSAnX3B5X2NsYXNzJztcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIG5vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvdGFncy5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQTtBQUtBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 341 */
/***/ function(module, exports) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar handlers = exports.handlers = {\n    'fractions.Fraction': {\n        restore: function restore(obj) {\n            return obj._numerator / obj._denominator;\n        }\n    }\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvaGFuZGxlcnMuanM/NGJjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaGFuZGxlcnMgPSB7XG4gICAgJ2ZyYWN0aW9ucy5GcmFjdGlvbic6IHtcbiAgICAgICAgcmVzdG9yZTogKG9iaikgPT4gb2JqLl9udW1lcmF0b3IgLyBvYmouX2Rlbm9taW5hdG9yLFxuICAgIH0sXG59O1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogbm9kZV9tb2R1bGVzL2pzb25waWNrbGVqcy9oYW5kbGVycy5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBREE7QUFEQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 342 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Pickler = exports.pickler = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _util = __webpack_require__(339);\n\nvar _handlers = __webpack_require__(341);\n\nvar _tags = __webpack_require__(340);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar pickler = exports.pickler = {};\n\npickler.encode = function encode(value, options) {\n    var params = {\n        unpicklable: false,\n        make_refs: true,\n        keys: false,\n        max_depth: undefined,\n        reset: true,\n        backend: undefined, // does nothing; python compat\n        context: undefined\n    };\n\n    _util.util.merge(params, options);\n    if (params.context === undefined) {\n        var outparams = {\n            unpicklable: params.unpicklable,\n            make_refs: params.make_refs,\n            keys: params.keys,\n            backend: params.backend,\n            max_depth: params.max_depth\n        };\n        params.context = new pickler.Pickler(outparams);\n        var fixed_obj = params.context.flatten(value, params.reset);\n        return JSON.stringify(fixed_obj);\n    } else {\n        return undefined;\n    }\n};\n\nvar Pickler = exports.Pickler = function () {\n    function Pickler(options) {\n        _classCallCheck(this, Pickler);\n\n        var params = {\n            unpicklable: true,\n            make_refs: true,\n            max_depth: undefined,\n            backend: undefined,\n            keys: false\n        };\n        _util.util.merge(params, options);\n        this.unpicklable = params.unpicklable;\n        this.make_refs = params.make_refs;\n        this.backend = params.backend;\n        this.keys = params.keys;\n        this._depth = -1;\n        this._max_depth = params.max_depth;\n        this._objs = [];\n        this._seen = [];\n    }\n\n    _createClass(Pickler, [{\n        key: 'reset',\n        value: function reset() {\n            this._objs = [];\n            this._depth = -1;\n            this._seen = [];\n        }\n    }, {\n        key: '_push',\n        value: function _push() {\n            this._depth += 1;\n        }\n    }, {\n        key: '_pop',\n        value: function _pop(value) {\n            this._depth -= 1;\n            if (this._depth === -1) {\n                this.reset();\n            }\n            return value;\n        }\n    }, {\n        key: '_mkref',\n        value: function _mkref(obj) {\n            var found_id = this._get_id_in_objs(obj);\n            // console.log(found_id);\n            if (found_id !== -1) {\n                return false;\n                //          if (this.unpicklable == false || this.make_refs == false) {\n                //          return true;\n                //          } else {\n                //          return false;\n                //          }\n            }\n            this._objs.push(obj);\n            return true;\n        }\n    }, {\n        key: '_get_id_in_objs',\n        value: function _get_id_in_objs(obj) {\n            var objLength = this._objs.length;\n            //      console.log('sought obj', obj);\n            //      console.log('stored objs: ', this._objs);\n            for (var i = 0; i < objLength; i++) {\n                if (obj === this._objs[i]) {\n                    return i;\n                }\n            }\n            return -1;\n        }\n    }, {\n        key: '_getref',\n        value: function _getref(obj) {\n            var wrap_obj = {};\n            wrap_obj[_tags.tags.ID] = this._get_id_in_objs(obj);\n            return wrap_obj;\n        }\n    }, {\n        key: 'flatten',\n        value: function flatten(obj, reset) {\n            if (reset === undefined) {\n                reset = true;\n            }\n            if (reset) {\n                this.reset();\n            }\n            var flatOut = this._flatten(obj);\n            console.log(this._objs);\n            return flatOut;\n        }\n    }, {\n        key: '_flatten',\n        value: function _flatten(obj) {\n            this._push();\n            return this._pop(this._flatten_obj(obj));\n        }\n    }, {\n        key: '_flatten_obj',\n        value: function _flatten_obj(obj) {\n            this._seen.push(obj);\n            var max_reached = this._depth === this._max_depth;\n            if (max_reached || this.make_refs === false && this._get_id_in_objs(obj) !== -1) {\n                // no repr equivalent, use str;\n                return toString(obj);\n            } else {\n                var flattener = this._get_flattener(obj);\n                // console.log(flattener);\n                return flattener.call(this, obj);\n            }\n        }\n    }, {\n        key: '_list_recurse',\n        value: function _list_recurse(obj) {\n            var l = [];\n            for (var i = 0; i < obj.length; i++) {\n                l.push(this._flatten(obj[i]));\n            }\n            return l;\n        }\n    }, {\n        key: '_get_flattener',\n        value: function _get_flattener(obj) {\n            var _this = this;\n\n            if (_util.util.is_primitive(obj)) {\n                return function (obj) {\n                    return obj;\n                };\n            }\n            if (_util.util.is_list(obj)) {\n                if (this._mkref(obj)) {\n                    return this._list_recurse;\n                } else {\n                    this._push();\n                    return this._getref;\n                }\n            }\n            if (_util.util.is_tuple(obj)) {\n                if (!this.unpicklable) {\n                    return this._list_recurse;\n                } else {\n                    return function (obj) {\n                        var obj_wrap = {};\n                        obj_wrap[_tags.tags.TUPLE] = _this._list_recurse(obj);\n                    };\n                }\n            }\n            if (_util.util.is_set(obj)) {\n                if (!this.unpicklable) {\n                    return this._list_recurse;\n                } else {\n                    return function (obj) {\n                        var obj_wrap = {};\n                        obj_wrap[_tags.tags.SET] = _this._list_recurse(obj);\n                    };\n                }\n            }\n            // better -- translate as object...\n            // if (util.is_dictionary(obj)) {\n            //    return this._flatten_dict_obj;\n            // }\n            // if (util.is_type(obj)) {\n            //    return _mktyperef;\n            // }\n            if (_util.util.is_object(obj)) {\n                return this._ref_obj_instance;\n            }\n            console.log('no flattener for ', obj, ' of type ', typeof obj === 'undefined' ? 'undefined' : _typeof(obj));\n            return undefined;\n        }\n    }, {\n        key: '_ref_obj_instance',\n        value: function _ref_obj_instance(obj) {\n            if (this._mkref(obj)) {\n                return this._flatten_obj_instance(obj);\n            }\n            return this._getref(obj);\n        }\n    }, {\n        key: '_flatten_obj_instance',\n        value: function _flatten_obj_instance(obj) {\n            var data = {};\n            var has_class = obj[_tags.tags.PY_CLASS] !== undefined; // ? or ...\n            var has_dict = true;\n            // const has_slots = false;\n            var has_getstate = obj.__getstate__ !== undefined;\n\n            if (has_class && _util.util.is_module(obj) === false) {\n                var fullModuleName = pickler._getclassdetail(obj);\n                if (this.unpicklable) {\n                    data[_tags.tags.OBJECT] = fullModuleName;\n                    console.log(data);\n                }\n                var handler = _handlers.handlers[fullModuleName];\n                if (handler !== undefined) {\n                    handler.flatten(obj, data);\n                }\n            }\n\n            if (_util.util.is_module(obj)) {\n                // todo if possible to have this happen...\n            }\n\n            if (_util.util.is_dictionary_subclass(obj)) {\n                // todo if possible to have this happen...\n            }\n            if (has_dict) {\n                // where every object currently ends up\n                if (_util.util.is_sequence_subclass(obj)) {\n                    // todo if possible to be...\n                }\n                if (has_getstate) {\n                    return this._getstate(obj, data);\n                }\n                return this._flatten_dict_obj(obj, data);\n            }\n            return undefined;\n\n            // todo: is_sequence_subclass\n            // todo: is_noncomplex\n            // todo: has_slots...\n        }\n    }, {\n        key: '_flatten_dict_obj',\n        value: function _flatten_dict_obj(obj, data) {\n            if (data === undefined) {\n                data = new obj.prototype.constructor();\n            }\n            var key_index = [];\n            for (var key in obj) {\n                if ({}.hasOwnProperty.call(obj, key)) {\n                    key_index.push(key);\n                }\n            }\n            for (var i = 0; i < key_index.length; i++) {\n                var _key = key_index[i];\n                var value = obj[_key];\n                if (_key === _tags.tags.PY_CLASS) {\n                    continue;\n                }\n                this._flatten_key_value_pair(_key, value, data);\n            }\n            // default_factory...\n            return data;\n        }\n\n        //  _flatten_newstyle_with_slots\n\n    }, {\n        key: '_flatten_key_value_pair',\n        value: function _flatten_key_value_pair(k, v, data) {\n            if (_util.util.is_picklable(k, v) === false) {\n                return data;\n            }\n            // assume all keys are strings -- Javascript;\n            data[k] = this._flatten(v);\n            return data;\n        }\n\n        //  pickler.Pickler.prototype._flatten_sequence_obj = function () {};\n\n    }, {\n        key: '_getstate',\n        value: function _getstate(obj, data) {\n            var state = this._flatten_obj(obj.__getstate__());\n            if (this.unpicklable) {\n                data[_tags.tags.STATE] = state;\n            } else {\n                data = state;\n            }\n            return data;\n        }\n\n        //  pickler._mktyperef = function (obj) {};\n\n    }, {\n        key: '_getclassdetail',\n        value: function _getclassdetail(obj) {\n            // just returns the Python class name\n            return obj[_tags.tags.PY_CLASS];\n        }\n    }]);\n\n    return Pickler;\n}();\n\npickler.Pickler = Pickler;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL25vZGVfbW9kdWxlcy9qc29ucGlja2xlanMvcGlja2xlci5qcz9kOGI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV0aWwgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHsgaGFuZGxlcnMgfSBmcm9tICcuL2hhbmRsZXJzJztcbmltcG9ydCB7IHRhZ3MgfSBmcm9tICcuL3RhZ3MnO1xuXG5leHBvcnQgY29uc3QgcGlja2xlciA9IHt9O1xuXG5waWNrbGVyLmVuY29kZSA9IGZ1bmN0aW9uIGVuY29kZSh2YWx1ZSwgb3B0aW9ucykge1xuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgdW5waWNrbGFibGU6IGZhbHNlLFxuICAgICAgICBtYWtlX3JlZnM6IHRydWUsXG4gICAgICAgIGtleXM6IGZhbHNlLFxuICAgICAgICBtYXhfZGVwdGg6IHVuZGVmaW5lZCxcbiAgICAgICAgcmVzZXQ6IHRydWUsXG4gICAgICAgIGJhY2tlbmQ6IHVuZGVmaW5lZCwgLy8gZG9lcyBub3RoaW5nOyBweXRob24gY29tcGF0XG4gICAgICAgIGNvbnRleHQ6IHVuZGVmaW5lZCxcbiAgICB9O1xuXG4gICAgdXRpbC5tZXJnZShwYXJhbXMsIG9wdGlvbnMpO1xuICAgIGlmIChwYXJhbXMuY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IG91dHBhcmFtcyA9IHtcbiAgICAgICAgICAgIHVucGlja2xhYmxlOiBwYXJhbXMudW5waWNrbGFibGUsXG4gICAgICAgICAgICBtYWtlX3JlZnM6IHBhcmFtcy5tYWtlX3JlZnMsXG4gICAgICAgICAgICBrZXlzOiBwYXJhbXMua2V5cyxcbiAgICAgICAgICAgIGJhY2tlbmQ6IHBhcmFtcy5iYWNrZW5kLFxuICAgICAgICAgICAgbWF4X2RlcHRoOiBwYXJhbXMubWF4X2RlcHRoLFxuICAgICAgICB9O1xuICAgICAgICBwYXJhbXMuY29udGV4dCA9IG5ldyBwaWNrbGVyLlBpY2tsZXIob3V0cGFyYW1zKTtcbiAgICAgICAgY29uc3QgZml4ZWRfb2JqID0gcGFyYW1zLmNvbnRleHQuZmxhdHRlbih2YWx1ZSwgcGFyYW1zLnJlc2V0KTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGZpeGVkX29iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG59O1xuXG5leHBvcnQgY2xhc3MgUGlja2xlciB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICB1bnBpY2tsYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIG1ha2VfcmVmczogdHJ1ZSxcbiAgICAgICAgICAgIG1heF9kZXB0aDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgYmFja2VuZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAga2V5czogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICAgIHV0aWwubWVyZ2UocGFyYW1zLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy51bnBpY2tsYWJsZSA9IHBhcmFtcy51bnBpY2tsYWJsZTtcbiAgICAgICAgdGhpcy5tYWtlX3JlZnMgPSBwYXJhbXMubWFrZV9yZWZzO1xuICAgICAgICB0aGlzLmJhY2tlbmQgPSBwYXJhbXMuYmFja2VuZDtcbiAgICAgICAgdGhpcy5rZXlzID0gcGFyYW1zLmtleXM7XG4gICAgICAgIHRoaXMuX2RlcHRoID0gLTE7XG4gICAgICAgIHRoaXMuX21heF9kZXB0aCA9IHBhcmFtcy5tYXhfZGVwdGg7XG4gICAgICAgIHRoaXMuX29ianMgPSBbXTtcbiAgICAgICAgdGhpcy5fc2VlbiA9IFtdO1xuICAgIH1cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy5fb2JqcyA9IFtdO1xuICAgICAgICB0aGlzLl9kZXB0aCA9IC0xO1xuICAgICAgICB0aGlzLl9zZWVuID0gW107XG4gICAgfVxuXG4gICAgX3B1c2goKSB7XG4gICAgICAgIHRoaXMuX2RlcHRoICs9IDE7XG4gICAgfVxuICAgIF9wb3AodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZGVwdGggLT0gMTtcbiAgICAgICAgaWYgKHRoaXMuX2RlcHRoID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgX21rcmVmKG9iaikge1xuICAgICAgICBjb25zdCBmb3VuZF9pZCA9IHRoaXMuX2dldF9pZF9pbl9vYmpzKG9iaik7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGZvdW5kX2lkKTtcbiAgICAgICAgaWYgKGZvdW5kX2lkICE9PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuLy8gICAgICAgICAgaWYgKHRoaXMudW5waWNrbGFibGUgPT0gZmFsc2UgfHwgdGhpcy5tYWtlX3JlZnMgPT0gZmFsc2UpIHtcbi8vICAgICAgICAgIHJldHVybiB0cnVlO1xuLy8gICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vYmpzLnB1c2gob2JqKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIF9nZXRfaWRfaW5fb2JqcyhvYmopIHtcbiAgICAgICAgY29uc3Qgb2JqTGVuZ3RoID0gdGhpcy5fb2Jqcy5sZW5ndGg7XG4vLyAgICAgIGNvbnNvbGUubG9nKCdzb3VnaHQgb2JqJywgb2JqKTtcbi8vICAgICAgY29uc29sZS5sb2coJ3N0b3JlZCBvYmpzOiAnLCB0aGlzLl9vYmpzKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmpMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG9iaiA9PT0gdGhpcy5fb2Jqc1tpXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgX2dldHJlZihvYmopIHtcbiAgICAgICAgY29uc3Qgd3JhcF9vYmogPSAge307XG4gICAgICAgIHdyYXBfb2JqW3RhZ3MuSURdID0gdGhpcy5fZ2V0X2lkX2luX29ianMob2JqKTtcbiAgICAgICAgcmV0dXJuIHdyYXBfb2JqO1xuICAgIH1cbiAgICBmbGF0dGVuKG9iaiwgcmVzZXQpIHtcbiAgICAgICAgaWYgKHJlc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc2V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmbGF0T3V0ID0gdGhpcy5fZmxhdHRlbihvYmopO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9vYmpzKTtcbiAgICAgICAgcmV0dXJuIGZsYXRPdXQ7XG4gICAgfVxuICAgIF9mbGF0dGVuKG9iaikge1xuICAgICAgICB0aGlzLl9wdXNoKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3AodGhpcy5fZmxhdHRlbl9vYmoob2JqKSk7XG4gICAgfVxuICAgIF9mbGF0dGVuX29iaihvYmopIHtcbiAgICAgICAgdGhpcy5fc2Vlbi5wdXNoKG9iaik7XG4gICAgICAgIGNvbnN0IG1heF9yZWFjaGVkID0gKHRoaXMuX2RlcHRoID09PSB0aGlzLl9tYXhfZGVwdGgpO1xuICAgICAgICBpZiAobWF4X3JlYWNoZWQgfHwgKHRoaXMubWFrZV9yZWZzID09PSBmYWxzZSAmJiB0aGlzLl9nZXRfaWRfaW5fb2JqcyhvYmopICE9PSAtMSkpIHtcbiAgICAgICAgICAgIC8vIG5vIHJlcHIgZXF1aXZhbGVudCwgdXNlIHN0cjtcbiAgICAgICAgICAgIHJldHVybiB0b1N0cmluZyhvYmopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmxhdHRlbmVyID0gdGhpcy5fZ2V0X2ZsYXR0ZW5lcihvYmopO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZmxhdHRlbmVyKTtcbiAgICAgICAgICAgIHJldHVybiBmbGF0dGVuZXIuY2FsbCh0aGlzLCBvYmopO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9saXN0X3JlY3Vyc2Uob2JqKSB7XG4gICAgICAgIGNvbnN0IGwgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGwucHVzaCh0aGlzLl9mbGF0dGVuKG9ialtpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsO1xuICAgIH1cbiAgICBfZ2V0X2ZsYXR0ZW5lcihvYmopIHtcbiAgICAgICAgaWYgKHV0aWwuaXNfcHJpbWl0aXZlKG9iaikpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmogPT4gb2JqO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1dGlsLmlzX2xpc3Qob2JqKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21rcmVmKG9iaikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdF9yZWN1cnNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wdXNoKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldHJlZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodXRpbC5pc190dXBsZShvYmopKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudW5waWNrbGFibGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdF9yZWN1cnNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKG9iaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmpfd3JhcCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBvYmpfd3JhcFt0YWdzLlRVUExFXSA9IHRoaXMuX2xpc3RfcmVjdXJzZShvYmopO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHV0aWwuaXNfc2V0KG9iaikpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy51bnBpY2tsYWJsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0X3JlY3Vyc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAob2JqKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9ial93cmFwID0ge307XG4gICAgICAgICAgICAgICAgICAgIG9ial93cmFwW3RhZ3MuU0VUXSA9IHRoaXMuX2xpc3RfcmVjdXJzZShvYmopO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gYmV0dGVyIC0tIHRyYW5zbGF0ZSBhcyBvYmplY3QuLi5cbiAgICAgICAgLy8gaWYgKHV0aWwuaXNfZGljdGlvbmFyeShvYmopKSB7XG4gICAgICAgIC8vICAgIHJldHVybiB0aGlzLl9mbGF0dGVuX2RpY3Rfb2JqO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGlmICh1dGlsLmlzX3R5cGUob2JqKSkge1xuICAgICAgICAvLyAgICByZXR1cm4gX21rdHlwZXJlZjtcbiAgICAgICAgLy8gfVxuICAgICAgICBpZiAodXRpbC5pc19vYmplY3Qob2JqKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlZl9vYmpfaW5zdGFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ25vIGZsYXR0ZW5lciBmb3IgJywgb2JqLCAnIG9mIHR5cGUgJywgdHlwZW9mIG9iaik7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIF9yZWZfb2JqX2luc3RhbmNlKG9iaikge1xuICAgICAgICBpZiAodGhpcy5fbWtyZWYob2JqKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZsYXR0ZW5fb2JqX2luc3RhbmNlKG9iaik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldHJlZihvYmopO1xuICAgIH1cbiAgICBfZmxhdHRlbl9vYmpfaW5zdGFuY2Uob2JqKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICAgICAgY29uc3QgaGFzX2NsYXNzID0gKG9ialt0YWdzLlBZX0NMQVNTXSAhPT0gdW5kZWZpbmVkKTsgLy8gPyBvciAuLi5cbiAgICAgICAgY29uc3QgaGFzX2RpY3QgPSB0cnVlO1xuICAgICAgICAvLyBjb25zdCBoYXNfc2xvdHMgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgaGFzX2dldHN0YXRlID0gKG9iai5fX2dldHN0YXRlX18gIT09IHVuZGVmaW5lZCk7XG5cbiAgICAgICAgaWYgKGhhc19jbGFzcyAmJiB1dGlsLmlzX21vZHVsZShvYmopID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY29uc3QgZnVsbE1vZHVsZU5hbWUgPSBwaWNrbGVyLl9nZXRjbGFzc2RldGFpbChvYmopO1xuICAgICAgICAgICAgaWYgKHRoaXMudW5waWNrbGFibGUpIHtcbiAgICAgICAgICAgICAgICBkYXRhW3RhZ3MuT0JKRUNUXSA9IGZ1bGxNb2R1bGVOYW1lO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9IGhhbmRsZXJzW2Z1bGxNb2R1bGVOYW1lXTtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLmZsYXR0ZW4ob2JqLCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1dGlsLmlzX21vZHVsZShvYmopKSB7XG4gICAgICAgICAgICAvLyB0b2RvIGlmIHBvc3NpYmxlIHRvIGhhdmUgdGhpcyBoYXBwZW4uLi5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1dGlsLmlzX2RpY3Rpb25hcnlfc3ViY2xhc3Mob2JqKSkge1xuICAgICAgICAgICAgLy8gdG9kbyBpZiBwb3NzaWJsZSB0byBoYXZlIHRoaXMgaGFwcGVuLi4uXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc19kaWN0KSB7XG4gICAgICAgICAgICAvLyB3aGVyZSBldmVyeSBvYmplY3QgY3VycmVudGx5IGVuZHMgdXBcbiAgICAgICAgICAgIGlmICh1dGlsLmlzX3NlcXVlbmNlX3N1YmNsYXNzKG9iaikpIHtcbiAgICAgICAgICAgICAgICAvLyB0b2RvIGlmIHBvc3NpYmxlIHRvIGJlLi4uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzX2dldHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldHN0YXRlKG9iaiwgZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZmxhdHRlbl9kaWN0X29iaihvYmosIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICAgICAgLy8gdG9kbzogaXNfc2VxdWVuY2Vfc3ViY2xhc3NcbiAgICAgICAgLy8gdG9kbzogaXNfbm9uY29tcGxleFxuICAgICAgICAvLyB0b2RvOiBoYXNfc2xvdHMuLi5cbiAgICB9XG4gICAgX2ZsYXR0ZW5fZGljdF9vYmoob2JqLCBkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGEgPSBuZXcgb2JqLnByb3RvdHlwZS5jb25zdHJ1Y3RvcigpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleV9pbmRleCA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICAgICAgICAgIGtleV9pbmRleC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlfaW5kZXgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGtleV9pbmRleFtpXTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gb2JqW2tleV07XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB0YWdzLlBZX0NMQVNTKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9mbGF0dGVuX2tleV92YWx1ZV9wYWlyKGtleSwgdmFsdWUsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGRlZmF1bHRfZmFjdG9yeS4uLlxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cblxuLy8gIF9mbGF0dGVuX25ld3N0eWxlX3dpdGhfc2xvdHNcbiAgICBfZmxhdHRlbl9rZXlfdmFsdWVfcGFpcihrLCB2LCBkYXRhKSB7XG4gICAgICAgIGlmICh1dGlsLmlzX3BpY2tsYWJsZShrLCB2KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFzc3VtZSBhbGwga2V5cyBhcmUgc3RyaW5ncyAtLSBKYXZhc2NyaXB0O1xuICAgICAgICBkYXRhW2tdID0gdGhpcy5fZmxhdHRlbih2KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4vLyAgcGlja2xlci5QaWNrbGVyLnByb3RvdHlwZS5fZmxhdHRlbl9zZXF1ZW5jZV9vYmogPSBmdW5jdGlvbiAoKSB7fTtcbiAgICBfZ2V0c3RhdGUob2JqLCBkYXRhKSB7XG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5fZmxhdHRlbl9vYmoob2JqLl9fZ2V0c3RhdGVfXygpKTtcbiAgICAgICAgaWYgKHRoaXMudW5waWNrbGFibGUpIHtcbiAgICAgICAgICAgIGRhdGFbdGFncy5TVEFURV0gPSBzdGF0ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRhdGEgPSBzdGF0ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbi8vICBwaWNrbGVyLl9ta3R5cGVyZWYgPSBmdW5jdGlvbiAob2JqKSB7fTtcbiAgICBfZ2V0Y2xhc3NkZXRhaWwob2JqKSB7XG4gICAgICAgIC8vIGp1c3QgcmV0dXJucyB0aGUgUHl0aG9uIGNsYXNzIG5hbWVcbiAgICAgICAgcmV0dXJuIG9ialt0YWdzLlBZX0NMQVNTXTtcbiAgICB9XG59XG5waWNrbGVyLlBpY2tsZXIgPSBQaWNrbGVyO1xuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBub2RlX21vZHVsZXMvanNvbnBpY2tsZWpzL3BpY2tsZXIuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFFQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 343 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(344);\n\nvar Widget = function (_Component) {\n  (0, _inherits3.default)(Widget, _Component);\n\n  function Widget() {\n    (0, _classCallCheck3.default)(this, Widget);\n    return (0, _possibleConstructorReturn3.default)(this, (0, _getPrototypeOf2.default)(Widget).apply(this, arguments));\n  }\n\n  (0, _createClass3.default)(Widget, [{\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement(\n        'div',\n        { className: 'widget' },\n        _react2.default.createElement(\n          'h4',\n          null,\n          this.props.name\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'widget-body' },\n          this.props.children\n        )\n      );\n    }\n  }]);\n  return Widget;\n}(_react.Component);\n\nexports.default = Widget;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL3dpZGdldC5qcz8xMjM3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5cbnJlcXVpcmUoJy4uL3N0eWxlcy93aWRnZXQubGVzcycpO1xuXG5jbGFzcyBXaWRnZXQgZXh0ZW5kcyBDb21wb25lbnQge1xuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2lkZ2V0XCI+XG4gICAgICAgIDxoND57dGhpcy5wcm9wcy5uYW1lfTwvaDQ+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aWRnZXQtYm9keVwiPlxuICAgICAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdpZGdldDtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHNyYy9jb21wb25lbnRzL3dpZGdldC5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFGQTtBQU9BOzs7OztBQUdBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 344 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL3dpZGdldC5sZXNzPzM2MGMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3R5bGVzL3dpZGdldC5sZXNzXG4gKiogbW9kdWxlIGlkID0gMzQ0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 345 */,
/* 346 */,
/* 347 */,
/* 348 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL3dpZGdldHMvcGxhbmV0cy5sZXNzPzdhYzAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3R5bGVzL3dpZGdldHMvcGxhbmV0cy5sZXNzXG4gKiogbW9kdWxlIGlkID0gMzQ4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 349 */,
/* 350 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class;\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _connectToStores = __webpack_require__(314);\n\nvar _connectToStores2 = _interopRequireDefault(_connectToStores);\n\nvar _game = __webpack_require__(316);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _widget = __webpack_require__(343);\n\nvar _widget2 = _interopRequireDefault(_widget);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(351);\n\nvar Ships = (0, _connectToStores2.default)(_class = function (_Component) {\n  (0, _inherits3.default)(Ships, _Component);\n\n  function Ships() {\n    var _Object$getPrototypeO;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, Ships);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_Object$getPrototypeO = (0, _getPrototypeOf2.default)(Ships)).call.apply(_Object$getPrototypeO, [this].concat(args))), _this), _this.state = {\n      expanded: []\n    }, _this._toggleExpanded = function (i) {\n      var expanded = _this.state.expanded;\n      if (expanded.indexOf(i) !== -1) {\n        expanded.splice(expanded.indexOf(i), 1);\n      } else {\n        expanded.push(i);\n      }\n\n      _this.setState({\n        expanded: expanded\n      });\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(Ships, [{\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement(\n        _widget2.default,\n        { name: 'ships' },\n        _react2.default.createElement(\n          'pre',\n          { className: 'ships' },\n          this.props.ships.map(function (ship, i) {\n            var destination = 'None';\n            if (ship.destination) {\n              destination = ship.destination.x + ', ' + ship.destination.y;\n            }\n\n            return _react2.default.createElement(\n              'p',\n              { key: 'ship-' + i },\n              'Ship @ ',\n              ship.x.toFixed(0),\n              ' ',\n              ship.y.toFixed(0),\n              _react2.default.createElement('br', null),\n              'Destination: ',\n              destination\n            );\n          })\n        )\n      );\n    }\n  }], [{\n    key: 'getStores',\n    value: function getStores(props) {\n      return [_game2.default];\n    }\n  }, {\n    key: 'getPropsFromStores',\n    value: function getPropsFromStores(props) {\n      var ships = _game2.default.getObjectsByType(\"simulation.ship.Ship\");\n      return {\n        ships: ships\n      };\n    }\n  }]);\n  return Ships;\n}(_react.Component)) || _class;\n\nexports.default = Ships;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL3dpZGdldHMvU2hpcHMuanM/N2UwMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNvbm5lY3RUb1N0b3JlcyBmcm9tICdhbHQtdXRpbHMvbGliL2Nvbm5lY3RUb1N0b3Jlcyc7XG5cbmltcG9ydCBHYW1lU3RvcmUgZnJvbSAnLi4vLi4vc3RvcmVzL2dhbWUnO1xuXG5pbXBvcnQgV2lkZ2V0IGZyb20gJy4uL3dpZGdldCc7XG5cbnJlcXVpcmUoJy4uLy4uL3N0eWxlcy93aWRnZXRzL3NoaXBzLmxlc3MnKTtcblxuQGNvbm5lY3RUb1N0b3Jlc1xuY2xhc3MgU2hpcHMgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgZ2V0U3RvcmVzKHByb3BzKSB7XG4gICAgcmV0dXJuIFtHYW1lU3RvcmVdO1xuICB9XG5cbiAgc3RhdGljIGdldFByb3BzRnJvbVN0b3Jlcyhwcm9wcykge1xuICAgIGNvbnN0IHNoaXBzID0gR2FtZVN0b3JlLmdldE9iamVjdHNCeVR5cGUoXCJzaW11bGF0aW9uLnNoaXAuU2hpcFwiKTtcbiAgICByZXR1cm4ge1xuICAgICAgc2hpcHNcbiAgICB9O1xuICB9XG5cbiAgc3RhdGUgPSB7XG4gICAgZXhwYW5kZWQ6IFtdXG4gIH07XG5cbiAgX3RvZ2dsZUV4cGFuZGVkID0gKGkpID0+IHtcbiAgICBsZXQgZXhwYW5kZWQgPSB0aGlzLnN0YXRlLmV4cGFuZGVkO1xuICAgIGlmIChleHBhbmRlZC5pbmRleE9mKGkpICE9PSAtMSkge1xuICAgICAgZXhwYW5kZWQuc3BsaWNlKGV4cGFuZGVkLmluZGV4T2YoaSksIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHBhbmRlZC5wdXNoKGkpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgZXhwYW5kZWRcbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxXaWRnZXQgbmFtZT1cInNoaXBzXCI+XG4gICAgICAgIDxwcmUgY2xhc3NOYW1lPVwic2hpcHNcIj5cbiAgICAgICAgICB7dGhpcy5wcm9wcy5zaGlwcy5tYXAoKHNoaXAsIGkpID0+IHtcbiAgICAgICAgICAgIGxldCBkZXN0aW5hdGlvbiA9ICdOb25lJztcbiAgICAgICAgICAgIGlmKHNoaXAuZGVzdGluYXRpb24pIHtcbiAgICAgICAgICAgICAgZGVzdGluYXRpb24gPSBgJHtzaGlwLmRlc3RpbmF0aW9uLnh9LCAke3NoaXAuZGVzdGluYXRpb24ueX1gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gPHAga2V5PXtgc2hpcC0ke2l9YH0+U2hpcCBAIHtzaGlwLngudG9GaXhlZCgwKX0ge3NoaXAueS50b0ZpeGVkKDApfTxici8+RGVzdGluYXRpb246IHtkZXN0aW5hdGlvbn08L3A+XG4gICAgICAgICAgfSl9XG4gICAgICAgIDwvcHJlPlxuICAgICAgPC9XaWRnZXQ+XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTaGlwcztcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiBzcmMvY29tcG9uZW50cy93aWRnZXRzL1NoaXBzLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7Ozs7O0FBWUE7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7Ozs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVJBO0FBREE7QUFhQTs7O0FBM0NBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7OztBQXFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 351 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL3dpZGdldHMvc2hpcHMubGVzcz9jNmUyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3N0eWxlcy93aWRnZXRzL3NoaXBzLmxlc3NcbiAqKiBtb2R1bGUgaWQgPSAzNTFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 352 */,
/* 353 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _title = __webpack_require__(354);\n\nvar _title2 = _interopRequireDefault(_title);\n\nvar _alt = __webpack_require__(320);\n\nvar _alt2 = _interopRequireDefault(_alt);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar TitleStore = function () {\n  function TitleStore() {\n    (0, _classCallCheck3.default)(this, TitleStore);\n\n    this.bindActions(_title2.default);\n\n    this.title = '';\n  }\n\n  (0, _createClass3.default)(TitleStore, [{\n    key: 'onSetTitle',\n    value: function onSetTitle(title) {\n      return this.setState({\n        title: title\n      });\n    }\n  }]);\n  return TitleStore;\n}();\n\nexports.default = _alt2.default.createStore(TitleStore);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9zdG9yZXMvdGl0bGUuanM/YWRmMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGl0bGVBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvdGl0bGUnO1xuaW1wb3J0IGFsdCBmcm9tICcuLi9hbHQnO1xuXG5jbGFzcyBUaXRsZVN0b3JlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5iaW5kQWN0aW9ucyhUaXRsZUFjdGlvbnMpO1xuXG4gICAgdGhpcy50aXRsZSA9ICcnO1xuICB9XG5cbiAgb25TZXRUaXRsZSh0aXRsZSkge1xuICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHRpdGxlXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgYWx0LmNyZWF0ZVN0b3JlKFRpdGxlU3RvcmUpO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHNyYy9zdG9yZXMvdGl0bGUuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7Ozs7O0FBR0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 354 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _alt = __webpack_require__(320);\n\nvar _alt2 = _interopRequireDefault(_alt);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar TitleActions = function TitleActions() {\n  (0, _classCallCheck3.default)(this, TitleActions);\n\n  this.generateActions('setTitle');\n};\n\nexports.default = _alt2.default.createActions(TitleActions);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzU0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9hY3Rpb25zL3RpdGxlLmpzPzQ2MGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFsdCBmcm9tICcuLi9hbHQnO1xuXG5jbGFzcyBUaXRsZUFjdGlvbnMge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmdlbmVyYXRlQWN0aW9ucygnc2V0VGl0bGUnKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBhbHQuY3JlYXRlQWN0aW9ucyhUaXRsZUFjdGlvbnMpO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogc3JjL2FjdGlvbnMvdGl0bGUuanNcbiAqKi8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 355 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzU1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL2FwcC5sZXNzPzNkYWUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3R5bGVzL2FwcC5sZXNzXG4gKiogbW9kdWxlIGlkID0gMzU1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 356 */,
/* 357 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _stringify = __webpack_require__(317);\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class;\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _connectToStores = __webpack_require__(314);\n\nvar _connectToStores2 = _interopRequireDefault(_connectToStores);\n\nvar _game = __webpack_require__(316);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _title = __webpack_require__(354);\n\nvar _title2 = _interopRequireDefault(_title);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(358);\n\nvar RawOutput = (0, _connectToStores2.default)(_class = function (_Component) {\n  (0, _inherits3.default)(RawOutput, _Component);\n\n  function RawOutput() {\n    (0, _classCallCheck3.default)(this, RawOutput);\n    return (0, _possibleConstructorReturn3.default)(this, (0, _getPrototypeOf2.default)(RawOutput).apply(this, arguments));\n  }\n\n  (0, _createClass3.default)(RawOutput, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      _title2.default.setTitle('raw output');\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement(\n        'div',\n        { className: 'raw-output' },\n        _react2.default.createElement(\n          'pre',\n          null,\n          (0, _stringify2.default)(this.props.game, null, 2)\n        )\n      );\n    }\n  }], [{\n    key: 'getStores',\n    value: function getStores(props) {\n      return [_game2.default];\n    }\n  }, {\n    key: 'getPropsFromStores',\n    value: function getPropsFromStores(props) {\n      var _GameStore$getState = _game2.default.getState();\n\n      var game = _GameStore$getState.game;\n\n      return {\n        game: game\n      };\n    }\n  }]);\n  return RawOutput;\n}(_react.Component)) || _class;\n\nexports.default = RawOutput;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL1Jhd091dHB1dC5qcz83YjI5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY29ubmVjdFRvU3RvcmVzIGZyb20gJ2FsdC11dGlscy9saWIvY29ubmVjdFRvU3RvcmVzJztcblxuaW1wb3J0IEdhbWVTdG9yZSBmcm9tICcuLi9zdG9yZXMvZ2FtZSc7XG5pbXBvcnQgVGl0bGVBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvdGl0bGUnO1xuXG5yZXF1aXJlKCcuLi9zdHlsZXMvcmF3LW91dHB1dC5sZXNzJyk7XG5cbkBjb25uZWN0VG9TdG9yZXNcbmNsYXNzIFJhd091dHB1dCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBnZXRTdG9yZXMocHJvcHMpIHtcbiAgICByZXR1cm4gW0dhbWVTdG9yZV07XG4gIH1cblxuICBzdGF0aWMgZ2V0UHJvcHNGcm9tU3RvcmVzKHByb3BzKSB7XG4gICAgY29uc3Qge2dhbWV9ID0gR2FtZVN0b3JlLmdldFN0YXRlKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdhbWVcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIFRpdGxlQWN0aW9ucy5zZXRUaXRsZSgncmF3IG91dHB1dCcpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInJhdy1vdXRwdXRcIj5cbiAgICAgICAgPHByZT5cbiAgICAgICAgICB7SlNPTi5zdHJpbmdpZnkodGhpcy5wcm9wcy5nYW1lLCBudWxsLCAyKX1cbiAgICAgICAgPC9wcmU+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJhd091dHB1dDtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHNyYy9jb21wb25lbnRzL1Jhd091dHB1dC5qc1xuICoqLyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7OztBQVlBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBREE7QUFNQTs7O0FBdkJBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBOzs7OztBQWlCQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 358 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzU4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL3Jhdy1vdXRwdXQubGVzcz9mMDE2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3N0eWxlcy9yYXctb3V0cHV0Lmxlc3NcbiAqKiBtb2R1bGUgaWQgPSAzNThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 359 */,
/* 360 */
/***/ function(module, exports, __webpack_require__) {

	eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getPrototypeOf = __webpack_require__(227);\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = __webpack_require__(253);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(254);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = __webpack_require__(258);\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = __webpack_require__(305);\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class;\n\nvar _react = __webpack_require__(1);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _connectToStores = __webpack_require__(314);\n\nvar _connectToStores2 = _interopRequireDefault(_connectToStores);\n\nvar _reactKonva = __webpack_require__(361);\n\nvar _game = __webpack_require__(316);\n\nvar _game2 = _interopRequireDefault(_game);\n\nvar _title = __webpack_require__(354);\n\nvar _title2 = _interopRequireDefault(_title);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_require__(366);\n\nvar SystemMap = (0, _connectToStores2.default)(_class = function (_Component) {\n  (0, _inherits3.default)(SystemMap, _Component);\n\n  function SystemMap() {\n    var _Object$getPrototypeO;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, SystemMap);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_Object$getPrototypeO = (0, _getPrototypeOf2.default)(SystemMap)).call.apply(_Object$getPrototypeO, [this].concat(args))), _this), _this.state = {\n      system: 0\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(SystemMap, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      _title2.default.setTitle('system map');\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      if (!this.props.systems || !this.props.systems.length) {\n        return _react2.default.createElement(\n          'div',\n          { className: 'system-map' },\n          _react2.default.createElement(\n            'div',\n            { className: 'no-system' },\n            'No systems in game.'\n          )\n        );\n      }\n\n      var system = this.props.systems[this.state.system];\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'system-map' },\n        _react2.default.createElement(\n          _reactKonva.Stage,\n          { width: 884, height: 478 },\n          _react2.default.createElement(\n            _reactKonva.Layer,\n            null,\n            _react2.default.createElement(_reactKonva.Circle, { x: 442, y: 239, radius: 40, fill: '#00ffff', shadowBlur: 10 }),\n            system.planets.map(function (planet, i) {\n              return _react2.default.createElement(_reactKonva.Circle, { x: planet.x + 442, y: planet.y + 239, radius: 15, key: 'planet-' + i, fill: '#000000', shadowBlur: 5 });\n            }),\n            system.ships.map(function (ship, i) {\n              return _react2.default.createElement(_reactKonva.Star, { x: ship.x + 442, y: ship.y + 239, innerRadius: 5, outerRadius: 7, numPoints: 3, key: 'ship-' + i, fill: '#000000' });\n            })\n          )\n        )\n      );\n    }\n  }], [{\n    key: 'getStores',\n    value: function getStores(props) {\n      return [_game2.default];\n    }\n  }, {\n    key: 'getPropsFromStores',\n    value: function getPropsFromStores(props) {\n      var systems = _game2.default.getObjectsByType(\"simulation.systems.system.SolarSystem\");\n\n      return {\n        systems: systems\n      };\n    }\n  }]);\n  return SystemMap;\n}(_react.Component)) || _class;\n\nexports.default = SystemMap;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3NyYy9jb21wb25lbnRzL1N5c3RlbU1hcC5qcz81ZGE0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY29ubmVjdFRvU3RvcmVzIGZyb20gJ2FsdC11dGlscy9saWIvY29ubmVjdFRvU3RvcmVzJztcbmltcG9ydCB7TGF5ZXIsIENpcmNsZSwgU3RhZ2UsIFN0YXJ9IGZyb20gJ3JlYWN0LWtvbnZhJztcblxuaW1wb3J0IEdhbWVTdG9yZSBmcm9tICcuLi9zdG9yZXMvZ2FtZSc7XG5pbXBvcnQgVGl0bGVBY3Rpb25zIGZyb20gJy4uL2FjdGlvbnMvdGl0bGUnO1xuXG5yZXF1aXJlKCcuLi9zdHlsZXMvc3lzdGVtLW1hcC5sZXNzJyk7XG5cbkBjb25uZWN0VG9TdG9yZXNcbmNsYXNzIFN5c3RlbU1hcCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBnZXRTdG9yZXMocHJvcHMpIHtcbiAgICByZXR1cm4gW0dhbWVTdG9yZV07XG4gIH1cblxuICBzdGF0aWMgZ2V0UHJvcHNGcm9tU3RvcmVzKHByb3BzKSB7XG4gICAgY29uc3Qgc3lzdGVtcyA9IEdhbWVTdG9yZS5nZXRPYmplY3RzQnlUeXBlKFwic2ltdWxhdGlvbi5zeXN0ZW1zLnN5c3RlbS5Tb2xhclN5c3RlbVwiKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzeXN0ZW1zLFxuICAgIH07XG4gIH1cblxuICBzdGF0ZSA9IHtcbiAgICBzeXN0ZW06IDBcbiAgfTtcblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgVGl0bGVBY3Rpb25zLnNldFRpdGxlKCdzeXN0ZW0gbWFwJyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgaWYoIXRoaXMucHJvcHMuc3lzdGVtcyB8fCAhdGhpcy5wcm9wcy5zeXN0ZW1zLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzeXN0ZW0tbWFwXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJuby1zeXN0ZW1cIj5cbiAgICAgICAgICAgIE5vIHN5c3RlbXMgaW4gZ2FtZS5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3Qgc3lzdGVtID0gdGhpcy5wcm9wcy5zeXN0ZW1zW3RoaXMuc3RhdGUuc3lzdGVtXTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN5c3RlbS1tYXBcIj5cbiAgICAgICAgPFN0YWdlIHdpZHRoPXs4ODR9IGhlaWdodD17NDc4fT5cbiAgICAgICAgICA8TGF5ZXI+XG4gICAgICAgICAgICA8Q2lyY2xlIHg9ezQ0Mn0geT17MjM5fSByYWRpdXM9ezQwfSBmaWxsPVwiIzAwZmZmZlwiIHNoYWRvd0JsdXI9ezEwfSAvPlxuICAgICAgICAgICAge3N5c3RlbS5wbGFuZXRzLm1hcCgocGxhbmV0LCBpKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPENpcmNsZSB4PXtwbGFuZXQueCArIDQ0Mn0geT17cGxhbmV0LnkgKyAyMzl9IHJhZGl1cz17MTV9IGtleT17YHBsYW5ldC0ke2l9YH0gZmlsbD1cIiMwMDAwMDBcIiBzaGFkb3dCbHVyPXs1fSAvPlxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICB7c3lzdGVtLnNoaXBzLm1hcCgoc2hpcCwgaSkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxTdGFyIHg9e3NoaXAueCArIDQ0Mn0geT17c2hpcC55ICsgMjM5fSBpbm5lclJhZGl1cz17NX0gb3V0ZXJSYWRpdXM9ezd9IG51bVBvaW50cz17M30ga2V5PXtgc2hpcC0ke2l9YH0gZmlsbD1cIiMwMDAwMDBcIiAvPlxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSl9XG4gICAgICAgICAgPC9MYXllcj5cbiAgICAgICAgPC9TdGFnZT5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU3lzdGVtTWFwO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogc3JjL2NvbXBvbmVudHMvU3lzdGVtTWFwLmpzXG4gKiovIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUVBOzs7Ozs7Ozs7Ozs7OztBQWFBO0FBQ0E7QUFEQTs7Ozs7QUFJQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBWEE7QUFEQTtBQURBO0FBa0JBOzs7QUFwREE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTs7Ozs7QUE2Q0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 361 */
/***/ function(module, exports, __webpack_require__) {

	eval("// Adapted from ReactART:\n// https://github.com/reactjs/react-art\n\nvar Konva = __webpack_require__(362);\nvar React = __webpack_require__(2);\n\nvar ReactInstanceMap = __webpack_require__(109);\nvar ReactMultiChild = __webpack_require__(107);\nvar ReactUpdates = __webpack_require__(52);\n\nvar assign = __webpack_require__(3);\nvar emptyObject = __webpack_require__(365);\n\n\n// some patching to make Konva.Node looks like DOM nodes\nvar oldAdd = Konva.Container.prototype.add;\nKonva.Container.prototype.add = function(child) {\n  child.parentNode = this;\n  oldAdd.apply(this, arguments);\n}\n\nKonva.Container.prototype.replaceChild = function(newChild, oldChild) {\n  var index = oldChild.index;\n  var parent = oldChild.parent;\n  oldChild.destroy();\n  parent.add(newChild);\n  if (newChild.index !== index) {\n    newChild.setZIndex(index);\n  }\n  parent.getLayer().batchDraw();\n}\n\n\n\n\nfunction createComponent(name) {\n  var ReactKonvaComponent = function(element) {\n    this.node = null;\n    this.subscriptions = null;\n    this.listeners = null;\n    this._mountImage = null;\n    this._renderedChildren = null;\n    this._mostRecentlyPlacedChild = null;\n    this._initialProps = element.props;\n    this._currentElement = element;\n  };\n\n  ReactKonvaComponent.displayName = name;\n\n  for (var i = 1, l = arguments.length; i < l; i++) {\n    assign(ReactKonvaComponent.prototype, arguments[i]);\n  }\n\n  return ReactKonvaComponent;\n}\n\n\nvar ContainerMixin = assign({}, ReactMultiChild.Mixin, {\n\n  moveChild: function(prevChild, lastPlacedNode, nextIndex, lastIndex) {\n    var childNode = prevChild._mountImage.node;\n    if (childNode.index !== nextIndex) {\n      childNode.setZIndex(nextIndex);\n      var layer = childNode.getLayer();\n      layer && layer.batchDraw();\n    }\n  },\n\n  createChild: function(child, afterNode, mountImage) {\n    child._mountImage = mountImage;\n    var childNode = mountImage.node;\n    childNode.moveTo(this.node);\n    childNode.parentNode = this.node;\n    if (child._mountIndex !== childNode.index) {\n      childNode.setZIndex(child._mountIndex);\n    }\n    this._mostRecentlyPlacedChild = childNode;\n  \tvar layer = childNode.getLayer();\n  \tlayer && layer.batchDraw();\n  },\n\n  removeChild: function(child, node) {\n    var layer = child._mountImage.node.getLayer();\n    child._mountImage.node.destroy();\n\t  layer && layer.batchDraw();\n    child._mountImage = null;\n  },\n\n  updateChildrenAtRoot: function(nextChildren, transaction) {\n    this.updateChildren(nextChildren, transaction, emptyObject);\n  },\n\n  mountAndInjectChildrenAtRoot: function(children, transaction) {\n    this.mountAndInjectChildren(children, transaction, emptyObject);\n  },\n\n  updateChildren: function(nextChildren, transaction, context) {\n    this._mostRecentlyPlacedChild = null;\n    this._updateChildren(nextChildren, transaction, context);\n  },\n\n  mountAndInjectChildren: function(children, transaction, context) {\n    var mountedImages = this.mountChildren(\n      children,\n      transaction,\n      context\n    );\n    // Each mount image corresponds to one of the flattened children\n    var i = 0;\n    for (var key in this._renderedChildren) {\n      if (this._renderedChildren.hasOwnProperty(key)) {\n        var child = this._renderedChildren[key];\n        child._mountImage = mountedImages[i];\n        // runtime check for moveTo method\n        // it is possible that child component with be not Konva.Node instance\n        // for instance <noscript> for null element\n        var node = mountedImages[i].node;\n        if ((!node instanceof Konva.Node)) {\n          var message =\n            \"Looks like one of child element is not Konva.Node.\" +\n            \"react-konva do not support in for now.\"\n            \"if you have empty(null) child, replace it with <Group/>\"\n          console.error(message, this);\n          continue;\n        }\n        if (node.parent !== this.node) {\n          node.moveTo(this.node);\n        }\n        i++;\n      }\n    }\n  },\n  mountAndAddChildren: function() {\n    console.log('mountAndAddChildren')\n  }\n});\n\n\nvar propsToSkip = {\n  children: true,\n  ref: true,\n  key: true\n};\n\nvar NodeMixin = {\n\n  construct: function(element) {\n    this._currentElement = element;\n  },\n\n  receiveComponent: function(nextComponent, transaction, context) {\n    var props = nextComponent.props;\n    var oldProps = this._currentElement.props || this._initialProps;\n    this.applyNodeProps(oldProps, props);\n    this.updateChildren(props.children, transaction, context);\n    this._currentElement = nextComponent;\n  },\n\n  getPublicInstance: function() {\n    return this.node;\n  },\n\n  putEventListener: function(type, listener) {\n    // NOPE...\n  },\n\n  handleEvent: function(event) {\n    // NOPE...\n  },\n\n  getNativeNode: function() {\n    return this.node;\n  },\n\n  applyNodeProps: function(oldProps, props) {\n    var updatedProps = {};\n    var hasUpdates = false;\n    for (var key in oldProps) {\n      if (propsToSkip[key]) {\n        continue;\n      }\n      var isEvent = key.slice(0, 2) === 'on';\n      var propChanged = (oldProps[key] !== props[key]);\n      if (isEvent && propChanged) {\n        var eventName = key.substr(2).toLowerCase();\n        if (eventName.substr(0, 7) === \"content\") {\n          eventName = \"content\" + eventName.substr(7, 1).toUpperCase() + eventName.substr(8);\n        }\n        this.node.off(eventName, oldProps[key]);\n      }\n      var toRemove = !props.hasOwnProperty(key);\n      if (toRemove) {\n        this.node.setAttr(key, undefined);\n      }\n    }\n    for (var key in props) {\n      if (propsToSkip[key]) {\n        continue;\n      }\n      var isEvent = key.slice(0, 2) === 'on';\n      var toAdd = oldProps[key] !== props[key];\n      if (isEvent && toAdd) {\n        var eventName = key.substr(2).toLowerCase();\n        if (eventName.substr(0, 7) === \"content\") {\n          eventName = \"content\" + eventName.substr(7, 1).toUpperCase() + eventName.substr(8);\n        }\n        this.node.on(eventName, props[key]);\n      }\n      if (!isEvent && ((props[key] !== oldProps[key]) || (props[key] !==  this.node.getAttr(key)))) {\n        hasUpdates = true;\n        updatedProps[key] = props[key];\n      }\n    }\n\n     if (hasUpdates) {\n      this.node.setAttrs(updatedProps);\n      var layer = this.node.getLayer();\n      layer && layer.batchDraw();\n      var val, prop;\n      for(prop in updatedProps) {\n        val = updatedProps[prop];\n        if (val instanceof Image && !val.complete) {\n          var node = this.node;\n          val.addEventListener('load', function() {\n            var layer = node.getLayer();\n            layer && layer.batchDraw();\n          });\n        }\n      }\n    }\n  },\n\n  unmountComponent: function() {\n  },\n\n  mountComponentIntoNode: function(rootID, container) {\n    throw new Error(\n      'You cannot render an ART component standalone. ' +\n      'You need to wrap it in a Stage.'\n    );\n  }\n};\n\n\nvar Stage = React.createClass({\n  propTypes: {\n    width: React.PropTypes.oneOfType([\n      React.PropTypes.number,\n      React.PropTypes.string,\n    ]),\n    height: React.PropTypes.oneOfType([\n      React.PropTypes.number,\n      React.PropTypes.string,\n    ])\n  },\n  displayName: 'Stage',\n\n  mixins: [ContainerMixin],\n\n  componentDidMount: function() {\n    this.node = new Konva.Stage({\n      container: this.domNode,\n      width: this.props.width,\n      height: this.props.height\n    });\n    this.applyNodeProps(emptyObject, this.props);\n    this._debugID = this._reactInternalInstance._debugID;\n    var transaction = ReactUpdates.ReactReconcileTransaction.getPooled();\n\n    transaction.perform(\n      this.mountAndInjectChildren,\n      this,\n      this.props.children,\n      transaction,\n      ReactInstanceMap.get(this)._context\n    );\n    ReactUpdates.ReactReconcileTransaction.release(transaction);\n\n    this.node.draw();\n  },\n\n  getStage: function() {\n    return this.node;\n  },\n\n  componentDidUpdate: function(oldProps) {\n    var node = this.node;\n\n    this.applyNodeProps(oldProps, this.props);\n\n    var transaction = ReactUpdates.ReactReconcileTransaction.getPooled();\n    transaction.perform(\n      this.updateChildren,\n      this,\n      this.props.children,\n      transaction,\n      ReactInstanceMap.get(this)._context\n    );\n    ReactUpdates.ReactReconcileTransaction.release(transaction);\n  },\n\n  componentWillUnmount: function() {\n    this.unmountChildren();\n  },\n\n  applyNodeProps: NodeMixin.applyNodeProps,\n\n  render: function() {\n    var props = this.props;\n\n    return (\n      React.createElement('div', {\n        ref: function(c)  {return this.domNode = c;}.bind(this),\n        className: props.className,\n        role: props.role,\n        style: props.style,\n        tabIndex: props.tabIndex,\n        title: props.title}\n      )\n    );\n  }\n});\n\n\nvar GroupMixin = {\n  mountComponent: function(transaction, nativeParent, nativeContainerInfo, context) {\n    this.node = new Konva[this.constructor.displayName]();\n    nativeParent.node.add(this.node);\n    var props = this._initialProps;\n    this.applyNodeProps(emptyObject, props);\n    this.mountAndInjectChildren(props.children, transaction, context);\n    return {\n      children: [],\n      node: this.node,\n      html: null,\n      text: null\n    }\n  },\n\n  unmountComponent: function() {\n    this.unmountChildren();\n  }\n}\n\n\nvar ShapeMixin = {\n\n  construct: function(element) {\n    this._currentElement = element;\n    this._oldPath = null;\n  },\n\n  mountComponent: function(transaction, nativeParent, nativeContainerInfo, context) {\n    this.node = new Konva[this.constructor.displayName]();\n    if (nativeParent) {\n      nativeParent.node.add(this.node);\n    }\n    this.applyNodeProps(emptyObject, this._initialProps);\n    return {\n      children: [],\n      node: this.node,\n      html: null,\n      text: null\n    }\n  },\n\n  receiveComponent: function(nextComponent, transaction, context) {\n    var props = nextComponent.props;\n    var oldProps = this._currentElement.props || this._initialProps;\n    this.applyNodeProps(oldProps, props);\n    this._currentElement = nextComponent;\n  }\n};\n\n\nvar Group = createComponent('Group', NodeMixin, ContainerMixin, GroupMixin);\nvar Layer = createComponent('Layer', NodeMixin, ContainerMixin, GroupMixin);\nvar FastLayer = createComponent('FastLayer', NodeMixin, ContainerMixin, GroupMixin);\n\nvar Label = createComponent('Label', NodeMixin, ContainerMixin, GroupMixin);\n\nvar ReactKonva = {\n  Stage: Stage,\n  Group: Group,\n  Layer: Layer,\n  FastLayer: FastLayer,\n  Label: Label\n};\n\nvar shapes = [\n  'Rect', 'Circle', 'Ellipse', 'Wedge', 'Line', 'Sprite', 'Image', 'Text', 'TextPath',\n  'Star', 'Ring', 'Arc', 'Tag', 'Path', 'RegularPolygon',  'Arrow', 'Shape'\n];\n\nshapes.forEach(function(shapeName) {\n  ReactKonva[shapeName] = createComponent(shapeName, NodeMixin, ShapeMixin);\n});\n\n\nmodule.exports = ReactKonva;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vcmVhY3Qta29udmEvc3JjL3JlYWN0LWtvbnZhLmpzPzNmY2UiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQWRhcHRlZCBmcm9tIFJlYWN0QVJUOlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0anMvcmVhY3QtYXJ0XG5cbnZhciBLb252YSA9IHJlcXVpcmUoJ2tvbnZhJyk7XG52YXIgUmVhY3QgPSByZXF1aXJlKCdyZWFjdC9saWIvUmVhY3QnKTtcblxudmFyIFJlYWN0SW5zdGFuY2VNYXAgPSByZXF1aXJlKCdyZWFjdC9saWIvUmVhY3RJbnN0YW5jZU1hcCcpO1xudmFyIFJlYWN0TXVsdGlDaGlsZCA9IHJlcXVpcmUoJ3JlYWN0L2xpYi9SZWFjdE11bHRpQ2hpbGQnKTtcbnZhciBSZWFjdFVwZGF0ZXMgPSByZXF1aXJlKCdyZWFjdC9saWIvUmVhY3RVcGRhdGVzJyk7XG5cbnZhciBhc3NpZ24gPSByZXF1aXJlKCdvYmplY3QtYXNzaWduJyk7XG52YXIgZW1wdHlPYmplY3QgPSByZXF1aXJlKCdmYmpzL2xpYi9lbXB0eU9iamVjdCcpO1xuXG5cbi8vIHNvbWUgcGF0Y2hpbmcgdG8gbWFrZSBLb252YS5Ob2RlIGxvb2tzIGxpa2UgRE9NIG5vZGVzXG52YXIgb2xkQWRkID0gS29udmEuQ29udGFpbmVyLnByb3RvdHlwZS5hZGQ7XG5Lb252YS5Db250YWluZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGNoaWxkKSB7XG4gIGNoaWxkLnBhcmVudE5vZGUgPSB0aGlzO1xuICBvbGRBZGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuS29udmEuQ29udGFpbmVyLnByb3RvdHlwZS5yZXBsYWNlQ2hpbGQgPSBmdW5jdGlvbihuZXdDaGlsZCwgb2xkQ2hpbGQpIHtcbiAgdmFyIGluZGV4ID0gb2xkQ2hpbGQuaW5kZXg7XG4gIHZhciBwYXJlbnQgPSBvbGRDaGlsZC5wYXJlbnQ7XG4gIG9sZENoaWxkLmRlc3Ryb3koKTtcbiAgcGFyZW50LmFkZChuZXdDaGlsZCk7XG4gIGlmIChuZXdDaGlsZC5pbmRleCAhPT0gaW5kZXgpIHtcbiAgICBuZXdDaGlsZC5zZXRaSW5kZXgoaW5kZXgpO1xuICB9XG4gIHBhcmVudC5nZXRMYXllcigpLmJhdGNoRHJhdygpO1xufVxuXG5cblxuXG5mdW5jdGlvbiBjcmVhdGVDb21wb25lbnQobmFtZSkge1xuICB2YXIgUmVhY3RLb252YUNvbXBvbmVudCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICB0aGlzLm5vZGUgPSBudWxsO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IG51bGw7XG4gICAgdGhpcy5saXN0ZW5lcnMgPSBudWxsO1xuICAgIHRoaXMuX21vdW50SW1hZ2UgPSBudWxsO1xuICAgIHRoaXMuX3JlbmRlcmVkQ2hpbGRyZW4gPSBudWxsO1xuICAgIHRoaXMuX21vc3RSZWNlbnRseVBsYWNlZENoaWxkID0gbnVsbDtcbiAgICB0aGlzLl9pbml0aWFsUHJvcHMgPSBlbGVtZW50LnByb3BzO1xuICAgIHRoaXMuX2N1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgfTtcblxuICBSZWFjdEtvbnZhQ29tcG9uZW50LmRpc3BsYXlOYW1lID0gbmFtZTtcblxuICBmb3IgKHZhciBpID0gMSwgbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBhc3NpZ24oUmVhY3RLb252YUNvbXBvbmVudC5wcm90b3R5cGUsIGFyZ3VtZW50c1tpXSk7XG4gIH1cblxuICByZXR1cm4gUmVhY3RLb252YUNvbXBvbmVudDtcbn1cblxuXG52YXIgQ29udGFpbmVyTWl4aW4gPSBhc3NpZ24oe30sIFJlYWN0TXVsdGlDaGlsZC5NaXhpbiwge1xuXG4gIG1vdmVDaGlsZDogZnVuY3Rpb24ocHJldkNoaWxkLCBsYXN0UGxhY2VkTm9kZSwgbmV4dEluZGV4LCBsYXN0SW5kZXgpIHtcbiAgICB2YXIgY2hpbGROb2RlID0gcHJldkNoaWxkLl9tb3VudEltYWdlLm5vZGU7XG4gICAgaWYgKGNoaWxkTm9kZS5pbmRleCAhPT0gbmV4dEluZGV4KSB7XG4gICAgICBjaGlsZE5vZGUuc2V0WkluZGV4KG5leHRJbmRleCk7XG4gICAgICB2YXIgbGF5ZXIgPSBjaGlsZE5vZGUuZ2V0TGF5ZXIoKTtcbiAgICAgIGxheWVyICYmIGxheWVyLmJhdGNoRHJhdygpO1xuICAgIH1cbiAgfSxcblxuICBjcmVhdGVDaGlsZDogZnVuY3Rpb24oY2hpbGQsIGFmdGVyTm9kZSwgbW91bnRJbWFnZSkge1xuICAgIGNoaWxkLl9tb3VudEltYWdlID0gbW91bnRJbWFnZTtcbiAgICB2YXIgY2hpbGROb2RlID0gbW91bnRJbWFnZS5ub2RlO1xuICAgIGNoaWxkTm9kZS5tb3ZlVG8odGhpcy5ub2RlKTtcbiAgICBjaGlsZE5vZGUucGFyZW50Tm9kZSA9IHRoaXMubm9kZTtcbiAgICBpZiAoY2hpbGQuX21vdW50SW5kZXggIT09IGNoaWxkTm9kZS5pbmRleCkge1xuICAgICAgY2hpbGROb2RlLnNldFpJbmRleChjaGlsZC5fbW91bnRJbmRleCk7XG4gICAgfVxuICAgIHRoaXMuX21vc3RSZWNlbnRseVBsYWNlZENoaWxkID0gY2hpbGROb2RlO1xuICBcdHZhciBsYXllciA9IGNoaWxkTm9kZS5nZXRMYXllcigpO1xuICBcdGxheWVyICYmIGxheWVyLmJhdGNoRHJhdygpO1xuICB9LFxuXG4gIHJlbW92ZUNoaWxkOiBmdW5jdGlvbihjaGlsZCwgbm9kZSkge1xuICAgIHZhciBsYXllciA9IGNoaWxkLl9tb3VudEltYWdlLm5vZGUuZ2V0TGF5ZXIoKTtcbiAgICBjaGlsZC5fbW91bnRJbWFnZS5ub2RlLmRlc3Ryb3koKTtcblx0ICBsYXllciAmJiBsYXllci5iYXRjaERyYXcoKTtcbiAgICBjaGlsZC5fbW91bnRJbWFnZSA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlQ2hpbGRyZW5BdFJvb3Q6IGZ1bmN0aW9uKG5leHRDaGlsZHJlbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLnVwZGF0ZUNoaWxkcmVuKG5leHRDaGlsZHJlbiwgdHJhbnNhY3Rpb24sIGVtcHR5T2JqZWN0KTtcbiAgfSxcblxuICBtb3VudEFuZEluamVjdENoaWxkcmVuQXRSb290OiBmdW5jdGlvbihjaGlsZHJlbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLm1vdW50QW5kSW5qZWN0Q2hpbGRyZW4oY2hpbGRyZW4sIHRyYW5zYWN0aW9uLCBlbXB0eU9iamVjdCk7XG4gIH0sXG5cbiAgdXBkYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKG5leHRDaGlsZHJlbiwgdHJhbnNhY3Rpb24sIGNvbnRleHQpIHtcbiAgICB0aGlzLl9tb3N0UmVjZW50bHlQbGFjZWRDaGlsZCA9IG51bGw7XG4gICAgdGhpcy5fdXBkYXRlQ2hpbGRyZW4obmV4dENoaWxkcmVuLCB0cmFuc2FjdGlvbiwgY29udGV4dCk7XG4gIH0sXG5cbiAgbW91bnRBbmRJbmplY3RDaGlsZHJlbjogZnVuY3Rpb24oY2hpbGRyZW4sIHRyYW5zYWN0aW9uLCBjb250ZXh0KSB7XG4gICAgdmFyIG1vdW50ZWRJbWFnZXMgPSB0aGlzLm1vdW50Q2hpbGRyZW4oXG4gICAgICBjaGlsZHJlbixcbiAgICAgIHRyYW5zYWN0aW9uLFxuICAgICAgY29udGV4dFxuICAgICk7XG4gICAgLy8gRWFjaCBtb3VudCBpbWFnZSBjb3JyZXNwb25kcyB0byBvbmUgb2YgdGhlIGZsYXR0ZW5lZCBjaGlsZHJlblxuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5fcmVuZGVyZWRDaGlsZHJlbikge1xuICAgICAgaWYgKHRoaXMuX3JlbmRlcmVkQ2hpbGRyZW4uaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLl9yZW5kZXJlZENoaWxkcmVuW2tleV07XG4gICAgICAgIGNoaWxkLl9tb3VudEltYWdlID0gbW91bnRlZEltYWdlc1tpXTtcbiAgICAgICAgLy8gcnVudGltZSBjaGVjayBmb3IgbW92ZVRvIG1ldGhvZFxuICAgICAgICAvLyBpdCBpcyBwb3NzaWJsZSB0aGF0IGNoaWxkIGNvbXBvbmVudCB3aXRoIGJlIG5vdCBLb252YS5Ob2RlIGluc3RhbmNlXG4gICAgICAgIC8vIGZvciBpbnN0YW5jZSA8bm9zY3JpcHQ+IGZvciBudWxsIGVsZW1lbnRcbiAgICAgICAgdmFyIG5vZGUgPSBtb3VudGVkSW1hZ2VzW2ldLm5vZGU7XG4gICAgICAgIGlmICgoIW5vZGUgaW5zdGFuY2VvZiBLb252YS5Ob2RlKSkge1xuICAgICAgICAgIHZhciBtZXNzYWdlID1cbiAgICAgICAgICAgIFwiTG9va3MgbGlrZSBvbmUgb2YgY2hpbGQgZWxlbWVudCBpcyBub3QgS29udmEuTm9kZS5cIiArXG4gICAgICAgICAgICBcInJlYWN0LWtvbnZhIGRvIG5vdCBzdXBwb3J0IGluIGZvciBub3cuXCJcbiAgICAgICAgICAgIFwiaWYgeW91IGhhdmUgZW1wdHkobnVsbCkgY2hpbGQsIHJlcGxhY2UgaXQgd2l0aCA8R3JvdXAvPlwiXG4gICAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlLCB0aGlzKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5wYXJlbnQgIT09IHRoaXMubm9kZSkge1xuICAgICAgICAgIG5vZGUubW92ZVRvKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgaSsrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgbW91bnRBbmRBZGRDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG4gICAgY29uc29sZS5sb2coJ21vdW50QW5kQWRkQ2hpbGRyZW4nKVxuICB9XG59KTtcblxuXG52YXIgcHJvcHNUb1NraXAgPSB7XG4gIGNoaWxkcmVuOiB0cnVlLFxuICByZWY6IHRydWUsXG4gIGtleTogdHJ1ZVxufTtcblxudmFyIE5vZGVNaXhpbiA9IHtcblxuICBjb25zdHJ1Y3Q6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jdXJyZW50RWxlbWVudCA9IGVsZW1lbnQ7XG4gIH0sXG5cbiAgcmVjZWl2ZUNvbXBvbmVudDogZnVuY3Rpb24obmV4dENvbXBvbmVudCwgdHJhbnNhY3Rpb24sIGNvbnRleHQpIHtcbiAgICB2YXIgcHJvcHMgPSBuZXh0Q29tcG9uZW50LnByb3BzO1xuICAgIHZhciBvbGRQcm9wcyA9IHRoaXMuX2N1cnJlbnRFbGVtZW50LnByb3BzIHx8IHRoaXMuX2luaXRpYWxQcm9wcztcbiAgICB0aGlzLmFwcGx5Tm9kZVByb3BzKG9sZFByb3BzLCBwcm9wcyk7XG4gICAgdGhpcy51cGRhdGVDaGlsZHJlbihwcm9wcy5jaGlsZHJlbiwgdHJhbnNhY3Rpb24sIGNvbnRleHQpO1xuICAgIHRoaXMuX2N1cnJlbnRFbGVtZW50ID0gbmV4dENvbXBvbmVudDtcbiAgfSxcblxuICBnZXRQdWJsaWNJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMubm9kZTtcbiAgfSxcblxuICBwdXRFdmVudExpc3RlbmVyOiBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICAgIC8vIE5PUEUuLi5cbiAgfSxcblxuICBoYW5kbGVFdmVudDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAvLyBOT1BFLi4uXG4gIH0sXG5cbiAgZ2V0TmF0aXZlTm9kZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMubm9kZTtcbiAgfSxcblxuICBhcHBseU5vZGVQcm9wczogZnVuY3Rpb24ob2xkUHJvcHMsIHByb3BzKSB7XG4gICAgdmFyIHVwZGF0ZWRQcm9wcyA9IHt9O1xuICAgIHZhciBoYXNVcGRhdGVzID0gZmFsc2U7XG4gICAgZm9yICh2YXIga2V5IGluIG9sZFByb3BzKSB7XG4gICAgICBpZiAocHJvcHNUb1NraXBba2V5XSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZhciBpc0V2ZW50ID0ga2V5LnNsaWNlKDAsIDIpID09PSAnb24nO1xuICAgICAgdmFyIHByb3BDaGFuZ2VkID0gKG9sZFByb3BzW2tleV0gIT09IHByb3BzW2tleV0pO1xuICAgICAgaWYgKGlzRXZlbnQgJiYgcHJvcENoYW5nZWQpIHtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IGtleS5zdWJzdHIoMikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGV2ZW50TmFtZS5zdWJzdHIoMCwgNykgPT09IFwiY29udGVudFwiKSB7XG4gICAgICAgICAgZXZlbnROYW1lID0gXCJjb250ZW50XCIgKyBldmVudE5hbWUuc3Vic3RyKDcsIDEpLnRvVXBwZXJDYXNlKCkgKyBldmVudE5hbWUuc3Vic3RyKDgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm9kZS5vZmYoZXZlbnROYW1lLCBvbGRQcm9wc1trZXldKTtcbiAgICAgIH1cbiAgICAgIHZhciB0b1JlbW92ZSA9ICFwcm9wcy5oYXNPd25Qcm9wZXJ0eShrZXkpO1xuICAgICAgaWYgKHRvUmVtb3ZlKSB7XG4gICAgICAgIHRoaXMubm9kZS5zZXRBdHRyKGtleSwgdW5kZWZpbmVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7XG4gICAgICBpZiAocHJvcHNUb1NraXBba2V5XSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZhciBpc0V2ZW50ID0ga2V5LnNsaWNlKDAsIDIpID09PSAnb24nO1xuICAgICAgdmFyIHRvQWRkID0gb2xkUHJvcHNba2V5XSAhPT0gcHJvcHNba2V5XTtcbiAgICAgIGlmIChpc0V2ZW50ICYmIHRvQWRkKSB7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBrZXkuc3Vic3RyKDIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChldmVudE5hbWUuc3Vic3RyKDAsIDcpID09PSBcImNvbnRlbnRcIikge1xuICAgICAgICAgIGV2ZW50TmFtZSA9IFwiY29udGVudFwiICsgZXZlbnROYW1lLnN1YnN0cig3LCAxKS50b1VwcGVyQ2FzZSgpICsgZXZlbnROYW1lLnN1YnN0cig4KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vZGUub24oZXZlbnROYW1lLCBwcm9wc1trZXldKTtcbiAgICAgIH1cbiAgICAgIGlmICghaXNFdmVudCAmJiAoKHByb3BzW2tleV0gIT09IG9sZFByb3BzW2tleV0pIHx8IChwcm9wc1trZXldICE9PSAgdGhpcy5ub2RlLmdldEF0dHIoa2V5KSkpKSB7XG4gICAgICAgIGhhc1VwZGF0ZXMgPSB0cnVlO1xuICAgICAgICB1cGRhdGVkUHJvcHNba2V5XSA9IHByb3BzW2tleV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgIGlmIChoYXNVcGRhdGVzKSB7XG4gICAgICB0aGlzLm5vZGUuc2V0QXR0cnModXBkYXRlZFByb3BzKTtcbiAgICAgIHZhciBsYXllciA9IHRoaXMubm9kZS5nZXRMYXllcigpO1xuICAgICAgbGF5ZXIgJiYgbGF5ZXIuYmF0Y2hEcmF3KCk7XG4gICAgICB2YXIgdmFsLCBwcm9wO1xuICAgICAgZm9yKHByb3AgaW4gdXBkYXRlZFByb3BzKSB7XG4gICAgICAgIHZhbCA9IHVwZGF0ZWRQcm9wc1twcm9wXTtcbiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIEltYWdlICYmICF2YWwuY29tcGxldGUpIHtcbiAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMubm9kZTtcbiAgICAgICAgICB2YWwuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gbm9kZS5nZXRMYXllcigpO1xuICAgICAgICAgICAgbGF5ZXIgJiYgbGF5ZXIuYmF0Y2hEcmF3KCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgdW5tb3VudENvbXBvbmVudDogZnVuY3Rpb24oKSB7XG4gIH0sXG5cbiAgbW91bnRDb21wb25lbnRJbnRvTm9kZTogZnVuY3Rpb24ocm9vdElELCBjb250YWluZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnWW91IGNhbm5vdCByZW5kZXIgYW4gQVJUIGNvbXBvbmVudCBzdGFuZGFsb25lLiAnICtcbiAgICAgICdZb3UgbmVlZCB0byB3cmFwIGl0IGluIGEgU3RhZ2UuJ1xuICAgICk7XG4gIH1cbn07XG5cblxudmFyIFN0YWdlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBwcm9wVHlwZXM6IHtcbiAgICB3aWR0aDogUmVhY3QuUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgICAgUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBdKSxcbiAgICBoZWlnaHQ6IFJlYWN0LlByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgUmVhY3QuUHJvcFR5cGVzLm51bWJlcixcbiAgICAgIFJlYWN0LlByb3BUeXBlcy5zdHJpbmcsXG4gICAgXSlcbiAgfSxcbiAgZGlzcGxheU5hbWU6ICdTdGFnZScsXG5cbiAgbWl4aW5zOiBbQ29udGFpbmVyTWl4aW5dLFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm5vZGUgPSBuZXcgS29udmEuU3RhZ2Uoe1xuICAgICAgY29udGFpbmVyOiB0aGlzLmRvbU5vZGUsXG4gICAgICB3aWR0aDogdGhpcy5wcm9wcy53aWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHRcbiAgICB9KTtcbiAgICB0aGlzLmFwcGx5Tm9kZVByb3BzKGVtcHR5T2JqZWN0LCB0aGlzLnByb3BzKTtcbiAgICB0aGlzLl9kZWJ1Z0lEID0gdGhpcy5fcmVhY3RJbnRlcm5hbEluc3RhbmNlLl9kZWJ1Z0lEO1xuICAgIHZhciB0cmFuc2FjdGlvbiA9IFJlYWN0VXBkYXRlcy5SZWFjdFJlY29uY2lsZVRyYW5zYWN0aW9uLmdldFBvb2xlZCgpO1xuXG4gICAgdHJhbnNhY3Rpb24ucGVyZm9ybShcbiAgICAgIHRoaXMubW91bnRBbmRJbmplY3RDaGlsZHJlbixcbiAgICAgIHRoaXMsXG4gICAgICB0aGlzLnByb3BzLmNoaWxkcmVuLFxuICAgICAgdHJhbnNhY3Rpb24sXG4gICAgICBSZWFjdEluc3RhbmNlTWFwLmdldCh0aGlzKS5fY29udGV4dFxuICAgICk7XG4gICAgUmVhY3RVcGRhdGVzLlJlYWN0UmVjb25jaWxlVHJhbnNhY3Rpb24ucmVsZWFzZSh0cmFuc2FjdGlvbik7XG5cbiAgICB0aGlzLm5vZGUuZHJhdygpO1xuICB9LFxuXG4gIGdldFN0YWdlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ub2RlO1xuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24ob2xkUHJvcHMpIHtcbiAgICB2YXIgbm9kZSA9IHRoaXMubm9kZTtcblxuICAgIHRoaXMuYXBwbHlOb2RlUHJvcHMob2xkUHJvcHMsIHRoaXMucHJvcHMpO1xuXG4gICAgdmFyIHRyYW5zYWN0aW9uID0gUmVhY3RVcGRhdGVzLlJlYWN0UmVjb25jaWxlVHJhbnNhY3Rpb24uZ2V0UG9vbGVkKCk7XG4gICAgdHJhbnNhY3Rpb24ucGVyZm9ybShcbiAgICAgIHRoaXMudXBkYXRlQ2hpbGRyZW4sXG4gICAgICB0aGlzLFxuICAgICAgdGhpcy5wcm9wcy5jaGlsZHJlbixcbiAgICAgIHRyYW5zYWN0aW9uLFxuICAgICAgUmVhY3RJbnN0YW5jZU1hcC5nZXQodGhpcykuX2NvbnRleHRcbiAgICApO1xuICAgIFJlYWN0VXBkYXRlcy5SZWFjdFJlY29uY2lsZVRyYW5zYWN0aW9uLnJlbGVhc2UodHJhbnNhY3Rpb24pO1xuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnVubW91bnRDaGlsZHJlbigpO1xuICB9LFxuXG4gIGFwcGx5Tm9kZVByb3BzOiBOb2RlTWl4aW4uYXBwbHlOb2RlUHJvcHMsXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BzO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgcmVmOiBmdW5jdGlvbihjKSAge3JldHVybiB0aGlzLmRvbU5vZGUgPSBjO30uYmluZCh0aGlzKSxcbiAgICAgICAgY2xhc3NOYW1lOiBwcm9wcy5jbGFzc05hbWUsXG4gICAgICAgIHJvbGU6IHByb3BzLnJvbGUsXG4gICAgICAgIHN0eWxlOiBwcm9wcy5zdHlsZSxcbiAgICAgICAgdGFiSW5kZXg6IHByb3BzLnRhYkluZGV4LFxuICAgICAgICB0aXRsZTogcHJvcHMudGl0bGV9XG4gICAgICApXG4gICAgKTtcbiAgfVxufSk7XG5cblxudmFyIEdyb3VwTWl4aW4gPSB7XG4gIG1vdW50Q29tcG9uZW50OiBmdW5jdGlvbih0cmFuc2FjdGlvbiwgbmF0aXZlUGFyZW50LCBuYXRpdmVDb250YWluZXJJbmZvLCBjb250ZXh0KSB7XG4gICAgdGhpcy5ub2RlID0gbmV3IEtvbnZhW3RoaXMuY29uc3RydWN0b3IuZGlzcGxheU5hbWVdKCk7XG4gICAgbmF0aXZlUGFyZW50Lm5vZGUuYWRkKHRoaXMubm9kZSk7XG4gICAgdmFyIHByb3BzID0gdGhpcy5faW5pdGlhbFByb3BzO1xuICAgIHRoaXMuYXBwbHlOb2RlUHJvcHMoZW1wdHlPYmplY3QsIHByb3BzKTtcbiAgICB0aGlzLm1vdW50QW5kSW5qZWN0Q2hpbGRyZW4ocHJvcHMuY2hpbGRyZW4sIHRyYW5zYWN0aW9uLCBjb250ZXh0KTtcbiAgICByZXR1cm4ge1xuICAgICAgY2hpbGRyZW46IFtdLFxuICAgICAgbm9kZTogdGhpcy5ub2RlLFxuICAgICAgaHRtbDogbnVsbCxcbiAgICAgIHRleHQ6IG51bGxcbiAgICB9XG4gIH0sXG5cbiAgdW5tb3VudENvbXBvbmVudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy51bm1vdW50Q2hpbGRyZW4oKTtcbiAgfVxufVxuXG5cbnZhciBTaGFwZU1peGluID0ge1xuXG4gIGNvbnN0cnVjdDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHRoaXMuX2N1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLl9vbGRQYXRoID0gbnVsbDtcbiAgfSxcblxuICBtb3VudENvbXBvbmVudDogZnVuY3Rpb24odHJhbnNhY3Rpb24sIG5hdGl2ZVBhcmVudCwgbmF0aXZlQ29udGFpbmVySW5mbywgY29udGV4dCkge1xuICAgIHRoaXMubm9kZSA9IG5ldyBLb252YVt0aGlzLmNvbnN0cnVjdG9yLmRpc3BsYXlOYW1lXSgpO1xuICAgIGlmIChuYXRpdmVQYXJlbnQpIHtcbiAgICAgIG5hdGl2ZVBhcmVudC5ub2RlLmFkZCh0aGlzLm5vZGUpO1xuICAgIH1cbiAgICB0aGlzLmFwcGx5Tm9kZVByb3BzKGVtcHR5T2JqZWN0LCB0aGlzLl9pbml0aWFsUHJvcHMpO1xuICAgIHJldHVybiB7XG4gICAgICBjaGlsZHJlbjogW10sXG4gICAgICBub2RlOiB0aGlzLm5vZGUsXG4gICAgICBodG1sOiBudWxsLFxuICAgICAgdGV4dDogbnVsbFxuICAgIH1cbiAgfSxcblxuICByZWNlaXZlQ29tcG9uZW50OiBmdW5jdGlvbihuZXh0Q29tcG9uZW50LCB0cmFuc2FjdGlvbiwgY29udGV4dCkge1xuICAgIHZhciBwcm9wcyA9IG5leHRDb21wb25lbnQucHJvcHM7XG4gICAgdmFyIG9sZFByb3BzID0gdGhpcy5fY3VycmVudEVsZW1lbnQucHJvcHMgfHwgdGhpcy5faW5pdGlhbFByb3BzO1xuICAgIHRoaXMuYXBwbHlOb2RlUHJvcHMob2xkUHJvcHMsIHByb3BzKTtcbiAgICB0aGlzLl9jdXJyZW50RWxlbWVudCA9IG5leHRDb21wb25lbnQ7XG4gIH1cbn07XG5cblxudmFyIEdyb3VwID0gY3JlYXRlQ29tcG9uZW50KCdHcm91cCcsIE5vZGVNaXhpbiwgQ29udGFpbmVyTWl4aW4sIEdyb3VwTWl4aW4pO1xudmFyIExheWVyID0gY3JlYXRlQ29tcG9uZW50KCdMYXllcicsIE5vZGVNaXhpbiwgQ29udGFpbmVyTWl4aW4sIEdyb3VwTWl4aW4pO1xudmFyIEZhc3RMYXllciA9IGNyZWF0ZUNvbXBvbmVudCgnRmFzdExheWVyJywgTm9kZU1peGluLCBDb250YWluZXJNaXhpbiwgR3JvdXBNaXhpbik7XG5cbnZhciBMYWJlbCA9IGNyZWF0ZUNvbXBvbmVudCgnTGFiZWwnLCBOb2RlTWl4aW4sIENvbnRhaW5lck1peGluLCBHcm91cE1peGluKTtcblxudmFyIFJlYWN0S29udmEgPSB7XG4gIFN0YWdlOiBTdGFnZSxcbiAgR3JvdXA6IEdyb3VwLFxuICBMYXllcjogTGF5ZXIsXG4gIEZhc3RMYXllcjogRmFzdExheWVyLFxuICBMYWJlbDogTGFiZWxcbn07XG5cbnZhciBzaGFwZXMgPSBbXG4gICdSZWN0JywgJ0NpcmNsZScsICdFbGxpcHNlJywgJ1dlZGdlJywgJ0xpbmUnLCAnU3ByaXRlJywgJ0ltYWdlJywgJ1RleHQnLCAnVGV4dFBhdGgnLFxuICAnU3RhcicsICdSaW5nJywgJ0FyYycsICdUYWcnLCAnUGF0aCcsICdSZWd1bGFyUG9seWdvbicsICAnQXJyb3cnLCAnU2hhcGUnXG5dO1xuXG5zaGFwZXMuZm9yRWFjaChmdW5jdGlvbihzaGFwZU5hbWUpIHtcbiAgUmVhY3RLb252YVtzaGFwZU5hbWVdID0gY3JlYXRlQ29tcG9uZW50KHNoYXBlTmFtZSwgTm9kZU1peGluLCBTaGFwZU1peGluKTtcbn0pO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3RLb252YTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9yZWFjdC1rb252YS9zcmMvcmVhY3Qta29udmEuanNcbiAqKiBtb2R1bGUgaWQgPSAzNjFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 362 */
/***/ function(module, exports, __webpack_require__) {

	eval("/* WEBPACK VAR INJECTION */(function(global) {\n/*\n * Konva JavaScript Framework v1.1.4\n * http://konvajs.github.io/\n * Licensed under the MIT or GPL Version 2 licenses.\n * Date: Tue Sep 13 2016\n *\n * Original work Copyright (C) 2011 - 2013 by Eric Rowell (KineticJS)\n * Modified work Copyright (C) 2014 - 2015 by Anton Lavrenov (Konva)\n *\n * @license\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n// runtime check for already included Konva\n(function(global){\n    'use strict';\n    /**\n     * @namespace Konva\n     */\n\n    var PI_OVER_180 = Math.PI / 180;\n\n    var Konva = {\n        // public\n        version: '1.1.4',\n\n        // private\n        stages: [],\n        idCounter: 0,\n        ids: {},\n        names: {},\n        shapes: {},\n        listenClickTap: false,\n        inDblClickWindow: false,\n\n        // configurations\n        enableTrace: false,\n        traceArrMax: 100,\n        dblClickWindow: 400,\n        /**\n         * Global pixel ratio configuration. KonvaJS automatically detect pixel ratio of current device.\n         * But you may override such property, if you want to use your value.\n         * @property pixelRatio\n         * @default undefined\n         * @memberof Konva\n         * @example\n         * Konva.pixelRatio = 1;\n         */\n        pixelRatio: undefined,\n        /**\n         * Drag distance property. If you start to drag a node you may want to wait until pointer is moved to some distance from start point,\n         * only then start dragging.\n         * @property dragDistance\n         * @default 0\n         * @memberof Konva\n         * @example\n         * Konva.dragDistance = 10;\n         */\n        dragDistance: 0,\n        /**\n         * Use degree values for angle properties. You may set this property to false if you want to use radiant values.\n         * @property angleDeg\n         * @default true\n         * @memberof Konva\n         * @example\n         * node.rotation(45); // 45 degrees\n         * Konva.angleDeg = false;\n         * node.rotation(Math.PI / 2); // PI/2 radian\n         */\n        angleDeg: true,\n         /**\n         * Show different warnings about errors or wrong API usage\n         * @property showWarnings\n         * @default true\n         * @memberof Konva\n         * @example\n         * Konva.showWarnings = false;\n         */\n        showWarnings: true,\n\n\n\n        /**\n         * @namespace Filters\n         * @memberof Konva\n         */\n        Filters: {},\n\n        /**\n         * returns whether or not drag and drop is currently active\n         * @method\n         * @memberof Konva\n         */\n        isDragging: function() {\n            var dd = Konva.DD;\n\n            // if DD is not included with the build, then\n            // drag and drop is not even possible\n            if (dd) {\n                return dd.isDragging;\n            }\n            return false;\n        },\n        /**\n        * returns whether or not a drag and drop operation is ready, but may\n        *  not necessarily have started\n        * @method\n        * @memberof Konva\n        */\n        isDragReady: function() {\n            var dd = Konva.DD;\n\n            // if DD is not included with the build, then\n            // drag and drop is not even possible\n            if (dd) {\n                return !!dd.node;\n            }\n            return false;\n        },\n        _addId: function(node, id) {\n            if(id !== undefined) {\n                this.ids[id] = node;\n            }\n        },\n        _removeId: function(id) {\n            if(id !== undefined) {\n                delete this.ids[id];\n            }\n        },\n        _addName: function(node, name) {\n            if(name) {\n                if(!this.names[name]) {\n                    this.names[name] = [];\n                }\n                this.names[name].push(node);\n            }\n        },\n        _removeName: function(name, _id) {\n            if(!name) {\n                return;\n            }\n            var nodes = this.names[name];\n            if(!nodes) {\n                return;\n            }\n            for(var n = 0; n < nodes.length; n++) {\n                var no = nodes[n];\n                if(no._id === _id) {\n                    nodes.splice(n, 1);\n                }\n            }\n            if(nodes.length === 0) {\n                delete this.names[name];\n            }\n        },\n        getAngle: function(angle) {\n            return this.angleDeg ? angle * PI_OVER_180 : angle;\n        },\n        _detectIE: function(ua) {\n            var msie = ua.indexOf('msie ');\n            if (msie > 0) {\n                // IE 10 or older => return version number\n                return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n            }\n\n            var trident = ua.indexOf('trident/');\n            if (trident > 0) {\n                // IE 11 => return version number\n                var rv = ua.indexOf('rv:');\n                return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n            }\n\n            var edge = ua.indexOf('edge/');\n            if (edge > 0) {\n                // Edge (IE 12+) => return version number\n                return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n            }\n\n            // other browser\n            return false;\n        },\n        _parseUA: function(userAgent) {\n            var ua = userAgent.toLowerCase(),\n                // jQuery UA regex\n                match = /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\n                /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\n                /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\n                /(msie) ([\\w.]+)/.exec( ua ) ||\n                ua.indexOf('compatible') < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\n                [],\n\n                // adding mobile flag as well\n                mobile = !!(userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)),\n                ieMobile = !!(userAgent.match(/IEMobile/i));\n\n            return {\n                browser: match[ 1 ] || '',\n                version: match[ 2 ] || '0',\n                isIE: Konva._detectIE(ua),\n                // adding mobile flab\n                mobile: mobile,\n                ieMobile: ieMobile  // If this is true (i.e., WP8), then Konva touch events are executed instead of equivalent Konva mouse events\n            };\n        },\n        // user agent\n        UA: undefined\n    };\n\n    var glob =\n        typeof window !== 'undefined' ? window :\n        typeof global !== 'undefined' ? global :\n        typeof WorkerGlobalScope !== 'undefined' ? self : {};\n\n\n    Konva.UA = Konva._parseUA((glob.navigator && glob.navigator.userAgent) || '');\n\n\n    if (glob.Konva) {\n        console.error(\n            'Konva instance is already exist in current eviroment. ' +\n            'Please use only one instance.'\n        );\n    }\n    glob.Konva = Konva;\n    Konva.global = glob;\n\n\n    if( true) {\n        // runtime-check for browserify and nw.js (node-webkit)\n        if(glob.window && glob.window.document) {\n            Konva.document = glob.window.document;\n            Konva.window = glob.window;\n        } else {\n            // Node. Does not work with strict CommonJS, but\n            // only CommonJS-like enviroments that support module.exports,\n            // like Node.\n            var Canvas = __webpack_require__(363);\n            var jsdom = __webpack_require__(364).jsdom;\n\n            Konva.window = jsdom('<!DOCTYPE html><html><head></head><body></body></html>').defaultView;\n            Konva.document = Konva.window.document;\n            Konva.window.Image = Canvas.Image;\n            Konva._nodeCanvas = Canvas;\n        }\n        module.exports = Konva;\n        return;\n    }\n    else if( typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(function() {\n            return Konva;\n        });\n    }\n    Konva.document = document;\n    Konva.window = window;\n})(typeof window !== 'undefined' ? window : global);\n\n/*eslint-disable  eqeqeq, no-cond-assign, no-empty*/\n(function() {\n    'use strict';\n    /**\n     * Collection constructor.  Collection extends\n     *  Array.  This class is used in conjunction with {@link Konva.Container#get}\n     * @constructor\n     * @memberof Konva\n     */\n    Konva.Collection = function() {\n        var args = [].slice.call(arguments), length = args.length, i = 0;\n\n        this.length = length;\n        for(; i < length; i++) {\n            this[i] = args[i];\n        }\n        return this;\n    };\n    Konva.Collection.prototype = [];\n    /**\n     * iterate through node array and run a function for each node.\n     *  The node and index is passed into the function\n     * @method\n     * @memberof Konva.Collection.prototype\n     * @param {Function} func\n     * @example\n     * // get all nodes with name foo inside layer, and set x to 10 for each\n     * layer.get('.foo').each(function(shape, n) {\n     *   shape.setX(10);\n     * });\n     */\n    Konva.Collection.prototype.each = function(func) {\n        for(var n = 0; n < this.length; n++) {\n            func(this[n], n);\n        }\n    };\n    /**\n     * convert collection into an array\n     * @method\n     * @memberof Konva.Collection.prototype\n     */\n    Konva.Collection.prototype.toArray = function() {\n        var arr = [],\n            len = this.length,\n            n;\n\n        for(n = 0; n < len; n++) {\n            arr.push(this[n]);\n        }\n        return arr;\n    };\n    /**\n     * convert array into a collection\n     * @method\n     * @memberof Konva.Collection\n     * @param {Array} arr\n     */\n    Konva.Collection.toCollection = function(arr) {\n        var collection = new Konva.Collection(),\n            len = arr.length,\n            n;\n\n        for(n = 0; n < len; n++) {\n            collection.push(arr[n]);\n        }\n        return collection;\n    };\n\n    // map one method by it's name\n    Konva.Collection._mapMethod = function(methodName) {\n        Konva.Collection.prototype[methodName] = function() {\n            var len = this.length,\n                i;\n\n            var args = [].slice.call(arguments);\n            for(i = 0; i < len; i++) {\n                this[i][methodName].apply(this[i], args);\n            }\n\n            return this;\n        };\n    };\n\n    Konva.Collection.mapMethods = function(constructor) {\n        var prot = constructor.prototype;\n        for(var methodName in prot) {\n            Konva.Collection._mapMethod(methodName);\n        }\n    };\n\n    /*\n    * Last updated November 2011\n    * By Simon Sarris\n    * www.simonsarris.com\n    * sarris@acm.org\n    *\n    * Free to use and distribute at will\n    * So long as you are nice to people, etc\n    */\n\n    /*\n    * The usage of this class was inspired by some of the work done by a forked\n    * project, KineticJS-Ext by Wappworks, which is based on Simon's Transform\n    * class.  Modified by Eric Rowell\n    */\n\n    /**\n     * Transform constructor\n     * @constructor\n     * @param {Array} [m] Optional six-element matrix\n     * @memberof Konva\n     */\n    Konva.Transform = function(m) {\n        this.m = (m && m.slice()) || [1, 0, 0, 1, 0, 0];\n    };\n\n    Konva.Transform.prototype = {\n        /**\n         * Copy Konva.Transform object\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @returns {Konva.Transform}\n         */\n        copy: function() {\n            return new Konva.Transform(this.m);\n        },\n        /**\n         * Transform point\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Object} point 2D point(x, y)\n         * @returns {Object} 2D point(x, y)\n         */\n        point: function(point) {\n            var m = this.m;\n            return {\n                x: m[0] * point.x + m[2] * point.y + m[4],\n                y: m[1] * point.x + m[3] * point.y + m[5]\n            };\n        },\n        /**\n         * Apply translation\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Number} x\n         * @param {Number} y\n         * @returns {Konva.Transform}\n         */\n        translate: function(x, y) {\n            this.m[4] += this.m[0] * x + this.m[2] * y;\n            this.m[5] += this.m[1] * x + this.m[3] * y;\n            return this;\n        },\n        /**\n         * Apply scale\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Number} sx\n         * @param {Number} sy\n         * @returns {Konva.Transform}\n         */\n        scale: function(sx, sy) {\n            this.m[0] *= sx;\n            this.m[1] *= sx;\n            this.m[2] *= sy;\n            this.m[3] *= sy;\n            return this;\n        },\n        /**\n         * Apply rotation\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Number} rad  Angle in radians\n         * @returns {Konva.Transform}\n         */\n        rotate: function(rad) {\n            var c = Math.cos(rad);\n            var s = Math.sin(rad);\n            var m11 = this.m[0] * c + this.m[2] * s;\n            var m12 = this.m[1] * c + this.m[3] * s;\n            var m21 = this.m[0] * -s + this.m[2] * c;\n            var m22 = this.m[1] * -s + this.m[3] * c;\n            this.m[0] = m11;\n            this.m[1] = m12;\n            this.m[2] = m21;\n            this.m[3] = m22;\n            return this;\n        },\n        /**\n         * Returns the translation\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @returns {Object} 2D point(x, y)\n         */\n        getTranslation: function() {\n            return {\n                x: this.m[4],\n                y: this.m[5]\n            };\n        },\n        /**\n         * Apply skew\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Number} sx\n         * @param {Number} sy\n         * @returns {Konva.Transform}\n         */\n        skew: function(sx, sy) {\n            var m11 = this.m[0] + this.m[2] * sy;\n            var m12 = this.m[1] + this.m[3] * sy;\n            var m21 = this.m[2] + this.m[0] * sx;\n            var m22 = this.m[3] + this.m[1] * sx;\n            this.m[0] = m11;\n            this.m[1] = m12;\n            this.m[2] = m21;\n            this.m[3] = m22;\n            return this;\n         },\n        /**\n         * Transform multiplication\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @param {Konva.Transform} matrix\n         * @returns {Konva.Transform}\n         */\n        multiply: function(matrix) {\n            var m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n            var m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n\n            var m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n            var m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n\n            var dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n            var dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n\n            this.m[0] = m11;\n            this.m[1] = m12;\n            this.m[2] = m21;\n            this.m[3] = m22;\n            this.m[4] = dx;\n            this.m[5] = dy;\n            return this;\n        },\n        /**\n         * Invert the matrix\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @returns {Konva.Transform}\n         */\n        invert: function() {\n            var d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n            var m0 = this.m[3] * d;\n            var m1 = -this.m[1] * d;\n            var m2 = -this.m[2] * d;\n            var m3 = this.m[0] * d;\n            var m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n            var m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n            this.m[0] = m0;\n            this.m[1] = m1;\n            this.m[2] = m2;\n            this.m[3] = m3;\n            this.m[4] = m4;\n            this.m[5] = m5;\n            return this;\n        },\n        /**\n         * return matrix\n         * @method\n         * @memberof Konva.Transform.prototype\n         */\n        getMatrix: function() {\n            return this.m;\n        },\n        /**\n         * set to absolute position via translation\n         * @method\n         * @memberof Konva.Transform.prototype\n         * @returns {Konva.Transform}\n         * @author ericdrowell\n         */\n        setAbsolutePosition: function(x, y) {\n            var m0 = this.m[0],\n                m1 = this.m[1],\n                m2 = this.m[2],\n                m3 = this.m[3],\n                m4 = this.m[4],\n                m5 = this.m[5],\n                yt = ((m0 * (y - m5)) - (m1 * (x - m4))) / ((m0 * m3) - (m1 * m2)),\n                xt = (x - m4 - (m2 * yt)) / m0;\n\n            return this.translate(xt, yt);\n        }\n    };\n\n    // CONSTANTS\n    var CONTEXT_2D = '2d',\n        OBJECT_ARRAY = '[object Array]',\n        OBJECT_NUMBER = '[object Number]',\n        OBJECT_STRING = '[object String]',\n        PI_OVER_DEG180 = Math.PI / 180,\n        DEG180_OVER_PI = 180 / Math.PI,\n        HASH = '#',\n        EMPTY_STRING = '',\n        ZERO = '0',\n        KONVA_WARNING = 'Konva warning: ',\n        KONVA_ERROR = 'Konva error: ',\n        RGB_PAREN = 'rgb(',\n        COLORS = {\n            aliceblue: [240, 248, 255],\n            antiquewhite: [250, 235, 215],\n            aqua: [0, 255, 255],\n            aquamarine: [127, 255, 212],\n            azure: [240, 255, 255],\n            beige: [245, 245, 220],\n            bisque: [255, 228, 196],\n            black: [0, 0, 0],\n            blanchedalmond: [255, 235, 205],\n            blue: [0, 0, 255],\n            blueviolet: [138, 43, 226],\n            brown: [165, 42, 42],\n            burlywood: [222, 184, 135],\n            cadetblue: [95, 158, 160],\n            chartreuse: [127, 255, 0],\n            chocolate: [210, 105, 30],\n            coral: [255, 127, 80],\n            cornflowerblue: [100, 149, 237],\n            cornsilk: [255, 248, 220],\n            crimson: [220, 20, 60],\n            cyan: [0, 255, 255],\n            darkblue: [0, 0, 139],\n            darkcyan: [0, 139, 139],\n            darkgoldenrod: [184, 132, 11],\n            darkgray: [169, 169, 169],\n            darkgreen: [0, 100, 0],\n            darkgrey: [169, 169, 169],\n            darkkhaki: [189, 183, 107],\n            darkmagenta: [139, 0, 139],\n            darkolivegreen: [85, 107, 47],\n            darkorange: [255, 140, 0],\n            darkorchid: [153, 50, 204],\n            darkred: [139, 0, 0],\n            darksalmon: [233, 150, 122],\n            darkseagreen: [143, 188, 143],\n            darkslateblue: [72, 61, 139],\n            darkslategray: [47, 79, 79],\n            darkslategrey: [47, 79, 79],\n            darkturquoise: [0, 206, 209],\n            darkviolet: [148, 0, 211],\n            deeppink: [255, 20, 147],\n            deepskyblue: [0, 191, 255],\n            dimgray: [105, 105, 105],\n            dimgrey: [105, 105, 105],\n            dodgerblue: [30, 144, 255],\n            firebrick: [178, 34, 34],\n            floralwhite: [255, 255, 240],\n            forestgreen: [34, 139, 34],\n            fuchsia: [255, 0, 255],\n            gainsboro: [220, 220, 220],\n            ghostwhite: [248, 248, 255],\n            gold: [255, 215, 0],\n            goldenrod: [218, 165, 32],\n            gray: [128, 128, 128],\n            green: [0, 128, 0],\n            greenyellow: [173, 255, 47],\n            grey: [128, 128, 128],\n            honeydew: [240, 255, 240],\n            hotpink: [255, 105, 180],\n            indianred: [205, 92, 92],\n            indigo: [75, 0, 130],\n            ivory: [255, 255, 240],\n            khaki: [240, 230, 140],\n            lavender: [230, 230, 250],\n            lavenderblush: [255, 240, 245],\n            lawngreen: [124, 252, 0],\n            lemonchiffon: [255, 250, 205],\n            lightblue: [173, 216, 230],\n            lightcoral: [240, 128, 128],\n            lightcyan: [224, 255, 255],\n            lightgoldenrodyellow: [250, 250, 210],\n            lightgray: [211, 211, 211],\n            lightgreen: [144, 238, 144],\n            lightgrey: [211, 211, 211],\n            lightpink: [255, 182, 193],\n            lightsalmon: [255, 160, 122],\n            lightseagreen: [32, 178, 170],\n            lightskyblue: [135, 206, 250],\n            lightslategray: [119, 136, 153],\n            lightslategrey: [119, 136, 153],\n            lightsteelblue: [176, 196, 222],\n            lightyellow: [255, 255, 224],\n            lime: [0, 255, 0],\n            limegreen: [50, 205, 50],\n            linen: [250, 240, 230],\n            magenta: [255, 0, 255],\n            maroon: [128, 0, 0],\n            mediumaquamarine: [102, 205, 170],\n            mediumblue: [0, 0, 205],\n            mediumorchid: [186, 85, 211],\n            mediumpurple: [147, 112, 219],\n            mediumseagreen: [60, 179, 113],\n            mediumslateblue: [123, 104, 238],\n            mediumspringgreen: [0, 250, 154],\n            mediumturquoise: [72, 209, 204],\n            mediumvioletred: [199, 21, 133],\n            midnightblue: [25, 25, 112],\n            mintcream: [245, 255, 250],\n            mistyrose: [255, 228, 225],\n            moccasin: [255, 228, 181],\n            navajowhite: [255, 222, 173],\n            navy: [0, 0, 128],\n            oldlace: [253, 245, 230],\n            olive: [128, 128, 0],\n            olivedrab: [107, 142, 35],\n            orange: [255, 165, 0],\n            orangered: [255, 69, 0],\n            orchid: [218, 112, 214],\n            palegoldenrod: [238, 232, 170],\n            palegreen: [152, 251, 152],\n            paleturquoise: [175, 238, 238],\n            palevioletred: [219, 112, 147],\n            papayawhip: [255, 239, 213],\n            peachpuff: [255, 218, 185],\n            peru: [205, 133, 63],\n            pink: [255, 192, 203],\n            plum: [221, 160, 203],\n            powderblue: [176, 224, 230],\n            purple: [128, 0, 128],\n            rebeccapurple: [102, 51, 153],\n            red: [255, 0, 0],\n            rosybrown: [188, 143, 143],\n            royalblue: [65, 105, 225],\n            saddlebrown: [139, 69, 19],\n            salmon: [250, 128, 114],\n            sandybrown: [244, 164, 96],\n            seagreen: [46, 139, 87],\n            seashell: [255, 245, 238],\n            sienna: [160, 82, 45],\n            silver: [192, 192, 192],\n            skyblue: [135, 206, 235],\n            slateblue: [106, 90, 205],\n            slategray: [119, 128, 144],\n            slategrey: [119, 128, 144],\n            snow: [255, 255, 250],\n            springgreen: [0, 255, 127],\n            steelblue: [70, 130, 180],\n            tan: [210, 180, 140],\n            teal: [0, 128, 128],\n            thistle: [216, 191, 216],\n            transparent: [255, 255, 255, 0],\n            tomato: [255, 99, 71],\n            turquoise: [64, 224, 208],\n            violet: [238, 130, 238],\n            wheat: [245, 222, 179],\n            white: [255, 255, 255],\n            whitesmoke: [245, 245, 245],\n            yellow: [255, 255, 0],\n            yellowgreen: [154, 205, 5]\n        },\n\n        RGB_REGEX = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/;\n\n    /**\n     * @namespace Util\n     * @memberof Konva\n     */\n    Konva.Util = {\n        /*\n         * cherry-picked utilities from underscore.js\n         */\n        _isElement: function(obj) {\n            return !!(obj && obj.nodeType == 1);\n        },\n        _isFunction: function(obj) {\n            return !!(obj && obj.constructor && obj.call && obj.apply);\n        },\n        _isObject: function(obj) {\n            return (!!obj && obj.constructor === Object);\n        },\n        _isArray: function(obj) {\n            return Object.prototype.toString.call(obj) === OBJECT_ARRAY;\n        },\n        _isNumber: function(obj) {\n            return Object.prototype.toString.call(obj) === OBJECT_NUMBER;\n        },\n        _isString: function(obj) {\n            return Object.prototype.toString.call(obj) === OBJECT_STRING;\n        },\n        // Returns a function, that, when invoked, will only be triggered at most once\n        // during a given window of time. Normally, the throttled function will run\n        // as much as it can, without ever going more than once per `wait` duration;\n        // but if you'd like to disable the execution on the leading edge, pass\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\n        _throttle: function(func, wait, opts) {\n            var context, args, result;\n            var timeout = null;\n            var previous = 0;\n            var options = opts || {};\n            var later = function() {\n                previous = options.leading === false ? 0 : new Date().getTime();\n                timeout = null;\n                result = func.apply(context, args);\n                context = args = null;\n            };\n            return function() {\n                var now = new Date().getTime();\n                if (!previous && options.leading === false) {\n                    previous = now;\n                }\n                var remaining = wait - (now - previous);\n                context = this;\n                args = arguments;\n                if (remaining <= 0) {\n                  clearTimeout(timeout);\n                  timeout = null;\n                  previous = now;\n                  result = func.apply(context, args);\n                  context = args = null;\n                } else if (!timeout && options.trailing !== false) {\n                  timeout = setTimeout(later, remaining);\n                }\n                return result;\n            };\n        },\n        /*\n         * other utils\n         */\n        _hasMethods: function(obj) {\n            var names = [],\n                key;\n\n            for(key in obj) {\n                if (!obj.hasOwnProperty(key)) {\n                    continue;\n                }\n                if(this._isFunction(obj[key])) {\n                    names.push(key);\n                }\n            }\n            return names.length > 0;\n        },\n        isValidSelector: function(selector) {\n            if (typeof selector !== 'string') {\n                return false;\n            }\n            var firstChar = selector[0];\n            return firstChar === '#' || firstChar === '.' || firstChar === firstChar.toUpperCase();\n        },\n        createCanvasElement: function() {\n            var canvas = Konva.document.createElement('canvas');\n            // on some environments canvas.style is readonly\n            try {\n                canvas.style = canvas.style || {};\n            } catch (e) {\n            }\n            return canvas;\n        },\n        isBrowser: function() {\n            return (typeof exports !== 'object');\n        },\n        _isInDocument: function(el) {\n            while(el = el.parentNode) {\n                if(el == Konva.document) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        _simplifyArray: function(arr) {\n            var retArr = [],\n                len = arr.length,\n                util = Konva.Util,\n                n, val;\n\n            for (n = 0; n < len; n++) {\n                val = arr[n];\n                if (util._isNumber(val)) {\n                    val = Math.round(val * 1000) / 1000;\n                }\n                else if (!util._isString(val)) {\n                    val = val.toString();\n                }\n\n                retArr.push(val);\n            }\n\n            return retArr;\n        },\n        /*\n         * arg can be an image object or image data\n         */\n        _getImage: function(arg, callback) {\n            var imageObj, canvas;\n\n            // if arg is null or undefined\n            if(!arg) {\n                callback(null);\n            }\n\n            // if arg is already an image object\n            else if(this._isElement(arg)) {\n                callback(arg);\n            }\n\n            // if arg is a string, then it's a data url\n            else if(this._isString(arg)) {\n                imageObj = new Konva.window.Image();\n                imageObj.onload = function() {\n                    callback(imageObj);\n                };\n                imageObj.src = arg;\n            }\n\n            //if arg is an object that contains the data property, it's an image object\n            else if(arg.data) {\n                canvas = Konva.Util.createCanvasElement();\n                canvas.width = arg.width;\n                canvas.height = arg.height;\n                var _context = canvas.getContext(CONTEXT_2D);\n                _context.putImageData(arg, 0, 0);\n                this._getImage(canvas.toDataURL(), callback);\n            }\n            else {\n                callback(null);\n            }\n        },\n        _getRGBAString: function(obj) {\n            var red = obj.red || 0,\n                green = obj.green || 0,\n                blue = obj.blue || 0,\n                alpha = obj.alpha || 1;\n\n            return [\n                'rgba(',\n                red,\n                ',',\n                green,\n                ',',\n                blue,\n                ',',\n                alpha,\n                ')'\n            ].join(EMPTY_STRING);\n        },\n        _rgbToHex: function(r, g, b) {\n            return ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n        },\n        _hexToRgb: function(hex) {\n            hex = hex.replace(HASH, EMPTY_STRING);\n            var bigint = parseInt(hex, 16);\n            return {\n                r: (bigint >> 16) & 255,\n                g: (bigint >> 8) & 255,\n                b: bigint & 255\n            };\n        },\n        /**\n         * return random hex color\n         * @method\n         * @memberof Konva.Util.prototype\n         */\n        getRandomColor: function() {\n            var randColor = (Math.random() * 0xFFFFFF << 0).toString(16);\n            while (randColor.length < 6) {\n                randColor = ZERO + randColor;\n            }\n            return HASH + randColor;\n        },\n        /**\n         * return value with default fallback\n         * @method\n         * @memberof Konva.Util.prototype\n         */\n        get: function(val, def) {\n            if (val === undefined) {\n                return def;\n            }\n            else {\n                return val;\n            }\n        },\n        /**\n         * get RGB components of a color\n         * @method\n         * @memberof Konva.Util.prototype\n         * @param {String} color\n         * @example\n         * // each of the following examples return {r:0, g:0, b:255}\n         * var rgb = Konva.Util.getRGB('blue');\n         * var rgb = Konva.Util.getRGB('#0000ff');\n         * var rgb = Konva.Util.getRGB('rgb(0,0,255)');\n         */\n        getRGB: function(color) {\n            var rgb;\n            // color string\n            if (color in COLORS) {\n                rgb = COLORS[color];\n                return {\n                    r: rgb[0],\n                    g: rgb[1],\n                    b: rgb[2]\n                };\n            }\n            // hex\n            else if (color[0] === HASH) {\n                return this._hexToRgb(color.substring(1));\n            }\n            // rgb string\n            else if (color.substr(0, 4) === RGB_PAREN) {\n                rgb = RGB_REGEX.exec(color.replace(/ /g, ''));\n                return {\n                    r: parseInt(rgb[1], 10),\n                    g: parseInt(rgb[2], 10),\n                    b: parseInt(rgb[3], 10)\n                };\n            }\n            // default\n            else {\n                return {\n                    r: 0,\n                    g: 0,\n                    b: 0\n                };\n            }\n        },\n        // convert any color string to RGBA object\n        // from https://github.com/component/color-parser\n        colorToRGBA: function(str) {\n            str = str || 'black';\n            return Konva.Util._namedColorToRBA(str)\n                || Konva.Util._hex3ColorToRGBA(str)\n                || Konva.Util._hex6ColorToRGBA(str)\n                || Konva.Util._rgbColorToRGBA(str)\n                || Konva.Util._rgbaColorToRGBA(str);\n        },\n        // Parse named css color. Like \"green\"\n        _namedColorToRBA: function(str) {\n            var c = COLORS[str.toLowerCase()];\n            if (!c) {\n                return null;\n            }\n            return {\n                r: c[0],\n                g: c[1],\n                b: c[2],\n                a: 1\n            };\n        },\n        // Parse rgb(n, n, n)\n        _rgbColorToRGBA: function(str) {\n            if (str.indexOf('rgb(') === 0) {\n                str = str.match(/rgb\\(([^)]+)\\)/)[1];\n                var parts = str.split(/ *, */).map(Number);\n                return {\n                    r: parts[0],\n                    g: parts[1],\n                    b: parts[2],\n                    a: 1\n                };\n            }\n        },\n        // Parse rgba(n, n, n, n)\n        _rgbaColorToRGBA: function(str) {\n            if (str.indexOf('rgba(') === 0) {\n                str = str.match(/rgba\\(([^)]+)\\)/)[1];\n                var parts = str.split(/ *, */).map(Number);\n                return {\n                    r: parts[0],\n                    g: parts[1],\n                    b: parts[2],\n                    a: parts[3]\n                };\n            }\n\n        },\n        // Parse #nnnnnn\n        _hex6ColorToRGBA: function(str) {\n            if ((str[0] === '#') && (str.length === 7)) {\n                return {\n                    r: parseInt(str.slice(1, 3), 16),\n                    g: parseInt(str.slice(3, 5), 16),\n                    b: parseInt(str.slice(5, 7), 16),\n                    a: 1\n                };\n            }\n        },\n        // Parse #nnn\n        _hex3ColorToRGBA: function(str) {\n            if ((str[0] === '#') && (str.length === 4)) {\n                return {\n                    r: parseInt(str[1] + str[1], 16),\n                    g: parseInt(str[2] + str[2], 16),\n                    b: parseInt(str[3] + str[3], 16),\n                    a: 1\n                };\n            }\n        },\n        // o1 takes precedence over o2\n        _merge: function(o1, o2) {\n            var retObj = this._clone(o2);\n            for(var key in o1) {\n                if(this._isObject(o1[key])) {\n                    retObj[key] = this._merge(o1[key], retObj[key]);\n                }\n                else {\n                    retObj[key] = o1[key];\n                }\n            }\n            return retObj;\n        },\n        cloneObject: function(obj) {\n            var retObj = {};\n            for(var key in obj) {\n                if(this._isObject(obj[key])) {\n                    retObj[key] = this.cloneObject(obj[key]);\n                }\n                else if (this._isArray(obj[key])) {\n                    retObj[key] = this.cloneArray(obj[key]);\n                } else {\n                    retObj[key] = obj[key];\n                }\n            }\n            return retObj;\n        },\n        cloneArray: function(arr) {\n            return arr.slice(0);\n        },\n        _degToRad: function(deg) {\n            return deg * PI_OVER_DEG180;\n        },\n        _radToDeg: function(rad) {\n            return rad * DEG180_OVER_PI;\n        },\n        _capitalize: function(str) {\n            return str.charAt(0).toUpperCase() + str.slice(1);\n        },\n        throw: function(str) {\n            throw new Error(KONVA_ERROR + str);\n        },\n        error: function(str) {\n          console.error(KONVA_ERROR + str);\n        },\n        warn: function(str) {\n            /*\n             * IE9 on Windows7 64bit will throw a JS error\n             * if we don't use window.console in the conditional\n             */\n            if(Konva.global.console && console.warn && Konva.showWarnings) {\n                console.warn(KONVA_WARNING + str);\n            }\n        },\n        extend: function(child, parent) {\n            function Ctor() {\n                this.constructor = child;\n            }\n            Ctor.prototype = parent.prototype;\n            var oldProto = child.prototype;\n            child.prototype = new Ctor();\n            for (var key in oldProto) {\n                if (oldProto.hasOwnProperty(key)) {\n                    child.prototype[key] = oldProto[key];\n                }\n            }\n            child.__super__ = parent.prototype;\n            // create reference to parent\n            child.super = parent;\n        },\n        /**\n         * adds methods to a constructor prototype\n         * @method\n         * @memberof Konva.Util.prototype\n         * @param {Function} constructor\n         * @param {Object} methods\n         */\n        addMethods: function(constructor, methods) {\n            var key;\n\n            for (key in methods) {\n                constructor.prototype[key] = methods[key];\n            }\n        },\n        _getControlPoints: function(x0, y0, x1, y1, x2, y2, t) {\n            var d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2)),\n                d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)),\n                fa = t * d01 / (d01 + d12),\n                fb = t * d12 / (d01 + d12),\n                p1x = x1 - fa * (x2 - x0),\n                p1y = y1 - fa * (y2 - y0),\n                p2x = x1 + fb * (x2 - x0),\n                p2y = y1 + fb * (y2 - y0);\n\n            return [p1x, p1y, p2x, p2y];\n        },\n        _expandPoints: function(p, tension) {\n            var len = p.length,\n                allPoints = [],\n                n, cp;\n\n            for (n = 2; n < len - 2; n += 2) {\n                cp = Konva.Util._getControlPoints(p[n - 2], p[n - 1], p[n], p[n + 1], p[n + 2], p[n + 3], tension);\n                allPoints.push(cp[0]);\n                allPoints.push(cp[1]);\n                allPoints.push(p[n]);\n                allPoints.push(p[n + 1]);\n                allPoints.push(cp[2]);\n                allPoints.push(cp[3]);\n            }\n\n            return allPoints;\n        },\n        _removeLastLetter: function(str) {\n            return str.substring(0, str.length - 1);\n        },\n        each: function(obj, func) {\n            for (var key in obj) {\n                func(key, obj[key]);\n            }\n        },\n        _getProjectionToSegment: function(x1, y1, x2, y2, x3, y3) {\n            var x, y, dist;\n\n            var pd2 = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n            if(pd2 == 0) {\n                x = x1;\n                y = y1;\n                dist = (x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2);\n            } else {\n                var u = ((x3 - x1) * (x2 - x1) + (y3 - y1) * (y2 - y1)) / pd2;\n                if(u < 0) {\n                    x = x1;\n                    y = y1;\n                    dist = (x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3);\n                } else if (u > 1.0) {\n                    x = x2;\n                    y = y2;\n                    dist = (x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3);\n                } else {\n                    x = x1 + u * (x2 - x1);\n                    y = y1 + u * (y2 - y1);\n                    dist = (x - x3) * (x - x3) + (y - y3) * (y - y3);\n                }\n            }\n            return [x, y, dist];\n        },\n        // line as array of points.\n        // line might be closed\n        _getProjectionToLine: function(pt, line, isClosed) {\n            var pc = Konva.Util.cloneObject(pt);\n            var dist = Number.MAX_VALUE;\n            line.forEach(function(p1, i) {\n                if (!isClosed && i === line.length - 1) {\n                    return;\n                }\n                var p2 = line[(i + 1) % line.length];\n                var proj = Konva.Util._getProjectionToSegment(p1.x, p1.y, p2.x, p2.y, pt.x, pt.y);\n                var px = proj[0], py = proj[1], pdist = proj[2];\n                if (pdist < dist) {\n                    pc.x = px;\n                    pc.y = py;\n                    dist = pdist;\n                }\n            });\n            return pc;\n        },\n        _prepareArrayForTween: function(startArray, endArray, isClosed) {\n            var n, start = [], end = [];\n            if (startArray.length > endArray.length) {\n                var temp = endArray;\n                endArray = startArray;\n                startArray = temp;\n            }\n            for (n = 0; n < startArray.length; n += 2) {\n                start.push({\n                    x: startArray[n],\n                    y: startArray[n + 1]\n                });\n            }\n            for (n = 0; n < endArray.length; n += 2) {\n                end.push({\n                    x: endArray[n],\n                    y: endArray[n + 1]\n                });\n            }\n\n\n            var newStart = [];\n            end.forEach(function(point) {\n                var pr = Konva.Util._getProjectionToLine(point, start, isClosed);\n                newStart.push(pr.x);\n                newStart.push(pr.y);\n            });\n            return newStart;\n        },\n        _prepareToStringify: function(obj) {\n            var desc;\n\n            obj.visitedByCircularReferenceRemoval = true;\n\n            for(var key in obj) {\n                if (!(obj.hasOwnProperty(key) && obj[key] && typeof obj[key] == 'object')) {\n                    continue;\n                }\n                desc = Object.getOwnPropertyDescriptor(obj, key);\n                if (obj[key].visitedByCircularReferenceRemoval || Konva.Util._isElement(obj[key])) {\n                    if (desc.configurable) {\n                        delete obj[key];\n                    } else {\n                        return null;\n                    }\n                } else if (Konva.Util._prepareToStringify(obj[key]) === null) {\n                    if (desc.configurable) {\n                        delete obj[key];\n                    } else {\n                        return null;\n                    }\n                }\n            }\n\n            delete obj.visitedByCircularReferenceRemoval;\n\n            return obj;\n        }\n    };\n})();\n\n(function() {\n    'use strict';\n    // calculate pixel ratio\n    var canvas = Konva.Util.createCanvasElement(),\n        context = canvas.getContext('2d'),\n        _pixelRatio = (function(){\n            var devicePixelRatio = Konva.window.devicePixelRatio || 1,\n            backingStoreRatio = context.webkitBackingStorePixelRatio\n                || context.mozBackingStorePixelRatio\n                || context.msBackingStorePixelRatio\n                || context.oBackingStorePixelRatio\n                || context.backingStorePixelRatio\n                || 1;\n            return devicePixelRatio / backingStoreRatio;\n        })();\n\n    /**\n     * Canvas Renderer constructor\n     * @constructor\n     * @abstract\n     * @memberof Konva\n     * @param {Object} config\n     * @param {Number} config.width\n     * @param {Number} config.height\n     * @param {Number} config.pixelRatio KonvaJS automatically handles pixel ratio adjustments in order to render crisp drawings\n     *  on all devices. Most desktops, low end tablets, and low end phones, have device pixel ratios\n     *  of 1.  Some high end tablets and phones, like iPhones and iPads (not the mini) have a device pixel ratio\n     *  of 2.  Some Macbook Pros, and iMacs also have a device pixel ratio of 2.  Some high end Android devices have pixel\n     *  ratios of 2 or 3.  Some browsers like Firefox allow you to configure the pixel ratio of the viewport.  Unless otherwise\n     *  specified, the pixel ratio will be defaulted to the actual device pixel ratio.  You can override the device pixel\n     *  ratio for special situations, or, if you don't want the pixel ratio to be taken into account, you can set it to 1.\n     */\n    Konva.Canvas = function(config) {\n        this.init(config);\n    };\n\n    Konva.Canvas.prototype = {\n        init: function(config) {\n            var conf = config || {};\n\n            var pixelRatio = conf.pixelRatio || Konva.pixelRatio || _pixelRatio;\n\n            this.pixelRatio = pixelRatio;\n            this._canvas = Konva.Util.createCanvasElement();\n\n            // set inline styles\n            this._canvas.style.padding = 0;\n            this._canvas.style.margin = 0;\n            this._canvas.style.border = 0;\n            this._canvas.style.background = 'transparent';\n            this._canvas.style.position = 'absolute';\n            this._canvas.style.top = 0;\n            this._canvas.style.left = 0;\n        },\n        /**\n         * get canvas context\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @returns {CanvasContext} context\n         */\n        getContext: function() {\n            return this.context;\n        },\n        /**\n         * get pixel ratio\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @returns {Number} pixel ratio\n         */\n        getPixelRatio: function() {\n            return this.pixelRatio;\n        },\n        /**\n         * get pixel ratio\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @param {Number} pixelRatio KonvaJS automatically handles pixel ratio adustments in order to render crisp drawings\n         *  on all devices. Most desktops, low end tablets, and low end phones, have device pixel ratios\n         *  of 1.  Some high end tablets and phones, like iPhones and iPads have a device pixel ratio\n         *  of 2.  Some Macbook Pros, and iMacs also have a device pixel ratio of 2.  Some high end Android devices have pixel\n         *  ratios of 2 or 3.  Some browsers like Firefox allow you to configure the pixel ratio of the viewport.  Unless otherwise\n         *  specificed, the pixel ratio will be defaulted to the actual device pixel ratio.  You can override the device pixel\n         *  ratio for special situations, or, if you don't want the pixel ratio to be taken into account, you can set it to 1.\n         */\n        setPixelRatio: function(pixelRatio) {\n            var previousRatio = this.pixelRatio;\n            this.pixelRatio = pixelRatio;\n            this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n        },\n        /**\n         * set width\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @param {Number} width\n         */\n        setWidth: function(width) {\n            // take into account pixel ratio\n            this.width = this._canvas.width = width * this.pixelRatio;\n            this._canvas.style.width = width + 'px';\n\n            var pixelRatio = this.pixelRatio,\n                _context = this.getContext()._context;\n            _context.scale(pixelRatio, pixelRatio);\n        },\n        /**\n         * set height\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @param {Number} height\n         */\n        setHeight: function(height) {\n            // take into account pixel ratio\n            this.height = this._canvas.height = height * this.pixelRatio;\n            this._canvas.style.height = height + 'px';\n            var pixelRatio = this.pixelRatio,\n                _context = this.getContext()._context;\n            _context.scale(pixelRatio, pixelRatio);\n        },\n        /**\n         * get width\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @returns {Number} width\n         */\n        getWidth: function() {\n            return this.width;\n        },\n        /**\n         * get height\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @returns {Number} height\n         */\n        getHeight: function() {\n            return this.height;\n        },\n        /**\n         * set size\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @param {Number} width\n         * @param {Number} height\n         */\n        setSize: function(width, height) {\n            this.setWidth(width);\n            this.setHeight(height);\n        },\n        /**\n         * to data url\n         * @method\n         * @memberof Konva.Canvas.prototype\n         * @param {String} mimeType\n         * @param {Number} quality between 0 and 1 for jpg mime types\n         * @returns {String} data url string\n         */\n        toDataURL: function(mimeType, quality) {\n            try {\n                // If this call fails (due to browser bug, like in Firefox 3.6),\n                // then revert to previous no-parameter image/png behavior\n                return this._canvas.toDataURL(mimeType, quality);\n            }\n            catch(e) {\n                try {\n                    return this._canvas.toDataURL();\n                }\n                catch(err) {\n                    Konva.Util.warn('Unable to get data URL. ' + err.message);\n                    return '';\n                }\n            }\n        }\n    };\n\n    Konva.SceneCanvas = function(config) {\n        var conf = config || {};\n        var width = conf.width || 0,\n            height = conf.height || 0;\n\n        Konva.Canvas.call(this, conf);\n        this.context = new Konva.SceneContext(this);\n        this.setSize(width, height);\n    };\n\n    Konva.Util.extend(Konva.SceneCanvas, Konva.Canvas);\n\n    Konva.HitCanvas = function(config) {\n        var conf = config || {};\n        var width = conf.width || 0,\n            height = conf.height || 0;\n\n        Konva.Canvas.call(this, conf);\n        this.context = new Konva.HitContext(this);\n        this.setSize(width, height);\n        this.hitCanvas = true;\n    };\n    Konva.Util.extend(Konva.HitCanvas, Konva.Canvas);\n\n})();\n\n(function() {\n    'use strict';\n    var COMMA = ',',\n        OPEN_PAREN = '(',\n        CLOSE_PAREN = ')',\n        OPEN_PAREN_BRACKET = '([',\n        CLOSE_BRACKET_PAREN = '])',\n        SEMICOLON = ';',\n        DOUBLE_PAREN = '()',\n        // EMPTY_STRING = '',\n        EQUALS = '=',\n        // SET = 'set',\n        CONTEXT_METHODS = [\n            'arc',\n            'arcTo',\n            'beginPath',\n            'bezierCurveTo',\n            'clearRect',\n            'clip',\n            'closePath',\n            'createLinearGradient',\n            'createPattern',\n            'createRadialGradient',\n            'drawImage',\n            'fill',\n            'fillText',\n            'getImageData',\n            'createImageData',\n            'lineTo',\n            'moveTo',\n            'putImageData',\n            'quadraticCurveTo',\n            'rect',\n            'restore',\n            'rotate',\n            'save',\n            'scale',\n            'setLineDash',\n            'setTransform',\n            'stroke',\n            'strokeText',\n            'transform',\n            'translate'\n        ];\n\n    var CONTEXT_PROPERTIES = ['fillStyle', 'strokeStyle', 'shadowColor', 'shadowBlur', 'shadowOffsetX',\n        'shadowOffsetY', 'lineCap', 'lineJoin', 'lineWidth', 'miterLimit', 'font', 'textAlign', 'textBaseline',\n        'globalAlpha', 'globalCompositeOperation'];\n\n    /**\n     * Canvas Context constructor\n     * @constructor\n     * @abstract\n     * @memberof Konva\n     */\n    Konva.Context = function(canvas) {\n        this.init(canvas);\n    };\n\n    Konva.Context.prototype = {\n        init: function(canvas) {\n            this.canvas = canvas;\n            this._context = canvas._canvas.getContext('2d');\n\n            if (Konva.enableTrace) {\n                this.traceArr = [];\n                this._enableTrace();\n            }\n        },\n        /**\n         * fill shape\n         * @method\n         * @memberof Konva.Context.prototype\n         * @param {Konva.Shape} shape\n         */\n        fillShape: function(shape) {\n            if(shape.getFillEnabled()) {\n                this._fill(shape);\n            }\n        },\n        /**\n         * stroke shape\n         * @method\n         * @memberof Konva.Context.prototype\n         * @param {Konva.Shape} shape\n         */\n        strokeShape: function(shape) {\n            if(shape.getStrokeEnabled()) {\n                this._stroke(shape);\n            }\n        },\n        /**\n         * fill then stroke\n         * @method\n         * @memberof Konva.Context.prototype\n         * @param {Konva.Shape} shape\n         */\n        fillStrokeShape: function(shape) {\n            var fillEnabled = shape.getFillEnabled();\n            if(fillEnabled) {\n                this._fill(shape);\n            }\n            if(shape.getStrokeEnabled()) {\n                this._stroke(shape);\n            }\n        },\n        /**\n         * get context trace if trace is enabled\n         * @method\n         * @memberof Konva.Context.prototype\n         * @param {Boolean} relaxed if false, return strict context trace, which includes method names, method parameters\n         *  properties, and property values.  If true, return relaxed context trace, which only returns method names and\n         *  properites.\n         * @returns {String}\n         */\n        getTrace: function(relaxed) {\n            var traceArr = this.traceArr,\n                len = traceArr.length,\n                str = '',\n                n, trace, method, args;\n\n            for (n = 0; n < len; n++) {\n                trace = traceArr[n];\n                method = trace.method;\n\n                // methods\n                if (method) {\n                    args = trace.args;\n                    str += method;\n                    if (relaxed) {\n                        str += DOUBLE_PAREN;\n                    }\n                    else {\n                        if (Konva.Util._isArray(args[0])) {\n                            str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n                        }\n                        else {\n                            str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n                        }\n                    }\n                }\n                // properties\n                else {\n                    str += trace.property;\n                    if (!relaxed) {\n                        str += EQUALS + trace.val;\n                    }\n                }\n\n                str += SEMICOLON;\n            }\n\n            return str;\n        },\n        /**\n         * clear trace if trace is enabled\n         * @method\n         * @memberof Konva.Context.prototype\n         */\n        clearTrace: function() {\n            this.traceArr = [];\n        },\n        _trace: function(str) {\n            var traceArr = this.traceArr,\n                len;\n\n            traceArr.push(str);\n            len = traceArr.length;\n\n            if (len >= Konva.traceArrMax) {\n                traceArr.shift();\n            }\n        },\n        /**\n         * reset canvas context transform\n         * @method\n         * @memberof Konva.Context.prototype\n         */\n        reset: function() {\n            var pixelRatio = this.getCanvas().getPixelRatio();\n            this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n        },\n        /**\n         * get canvas\n         * @method\n         * @memberof Konva.Context.prototype\n         * @returns {Konva.Canvas}\n         */\n        getCanvas: function() {\n            return this.canvas;\n        },\n        /**\n         * clear canvas\n         * @method\n         * @memberof Konva.Context.prototype\n         * @param {Object} [bounds]\n         * @param {Number} [bounds.x]\n         * @param {Number} [bounds.y]\n         * @param {Number} [bounds.width]\n         * @param {Number} [bounds.height]\n         */\n        clear: function(bounds) {\n            var canvas = this.getCanvas();\n\n            if (bounds) {\n                this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n            }\n            else {\n                this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n            }\n        },\n        _applyLineCap: function(shape) {\n            var lineCap = shape.getLineCap();\n            if(lineCap) {\n                this.setAttr('lineCap', lineCap);\n            }\n        },\n        _applyOpacity: function(shape) {\n            var absOpacity = shape.getAbsoluteOpacity();\n            if(absOpacity !== 1) {\n                this.setAttr('globalAlpha', absOpacity);\n            }\n        },\n        _applyLineJoin: function(shape) {\n            var lineJoin = shape.getLineJoin();\n            if(lineJoin) {\n                this.setAttr('lineJoin', lineJoin);\n            }\n        },\n        setAttr: function(attr, val) {\n            this._context[attr] = val;\n        },\n\n        // context pass through methods\n        arc: function() {\n            var a = arguments;\n            this._context.arc(a[0], a[1], a[2], a[3], a[4], a[5]);\n        },\n        beginPath: function() {\n            this._context.beginPath();\n        },\n        bezierCurveTo: function() {\n            var a = arguments;\n            this._context.bezierCurveTo(a[0], a[1], a[2], a[3], a[4], a[5]);\n        },\n        clearRect: function() {\n            var a = arguments;\n            this._context.clearRect(a[0], a[1], a[2], a[3]);\n        },\n        clip: function() {\n            this._context.clip();\n        },\n        closePath: function() {\n            this._context.closePath();\n        },\n        createImageData: function() {\n            var a = arguments;\n            if(a.length === 2) {\n                return this._context.createImageData(a[0], a[1]);\n            }\n            else if(a.length === 1) {\n                return this._context.createImageData(a[0]);\n            }\n        },\n        createLinearGradient: function() {\n            var a = arguments;\n            return this._context.createLinearGradient(a[0], a[1], a[2], a[3]);\n        },\n        createPattern: function() {\n            var a = arguments;\n            return this._context.createPattern(a[0], a[1]);\n        },\n        createRadialGradient: function() {\n            var a = arguments;\n            return this._context.createRadialGradient(a[0], a[1], a[2], a[3], a[4], a[5]);\n        },\n        drawImage: function() {\n            var a = arguments,\n                _context = this._context;\n\n            if(a.length === 3) {\n                _context.drawImage(a[0], a[1], a[2]);\n            }\n            else if(a.length === 5) {\n                _context.drawImage(a[0], a[1], a[2], a[3], a[4]);\n            }\n            else if(a.length === 9) {\n                _context.drawImage(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n            }\n        },\n        isPointInPath: function(x, y) {\n            return this._context.isPointInPath(x, y);\n        },\n        fill: function() {\n            this._context.fill();\n        },\n        fillRect: function(x, y, width, height) {\n            this._context.fillRect(x, y, width, height);\n        },\n        strokeRect: function(x, y, width, height) {\n            this._context.strokeRect(x, y, width, height);\n        },\n        fillText: function() {\n            var a = arguments;\n            this._context.fillText(a[0], a[1], a[2]);\n        },\n        measureText: function(text) {\n            return this._context.measureText(text);\n        },\n        getImageData: function() {\n            var a = arguments;\n            return this._context.getImageData(a[0], a[1], a[2], a[3]);\n        },\n        lineTo: function() {\n            var a = arguments;\n            this._context.lineTo(a[0], a[1]);\n        },\n        moveTo: function() {\n            var a = arguments;\n            this._context.moveTo(a[0], a[1]);\n        },\n        rect: function() {\n            var a = arguments;\n            this._context.rect(a[0], a[1], a[2], a[3]);\n        },\n        putImageData: function() {\n            var a = arguments;\n            this._context.putImageData(a[0], a[1], a[2]);\n        },\n        quadraticCurveTo: function() {\n            var a = arguments;\n            this._context.quadraticCurveTo(a[0], a[1], a[2], a[3]);\n        },\n        restore: function() {\n            this._context.restore();\n        },\n        rotate: function() {\n            var a = arguments;\n            this._context.rotate(a[0]);\n        },\n        save: function() {\n            this._context.save();\n        },\n        scale: function() {\n            var a = arguments;\n            this._context.scale(a[0], a[1]);\n        },\n        setLineDash: function() {\n            var a = arguments,\n                _context = this._context;\n\n            // works for Chrome and IE11\n            if(this._context.setLineDash) {\n                _context.setLineDash(a[0]);\n            }\n            // verified that this works in firefox\n            else if('mozDash' in _context) {\n                _context.mozDash = a[0];\n            }\n            // does not currently work for Safari\n            else if('webkitLineDash' in _context) {\n                _context.webkitLineDash = a[0];\n            }\n\n            // no support for IE9 and IE10\n        },\n        getLineDash: function() {\n            return this._context.getLineDash();\n        },\n        setTransform: function() {\n            var a = arguments;\n            this._context.setTransform(a[0], a[1], a[2], a[3], a[4], a[5]);\n        },\n        stroke: function() {\n            this._context.stroke();\n        },\n        strokeText: function() {\n            var a = arguments;\n            this._context.strokeText(a[0], a[1], a[2]);\n        },\n        transform: function() {\n            var a = arguments;\n            this._context.transform(a[0], a[1], a[2], a[3], a[4], a[5]);\n        },\n        translate: function() {\n            var a = arguments;\n            this._context.translate(a[0], a[1]);\n        },\n        _enableTrace: function() {\n            var that = this,\n                len = CONTEXT_METHODS.length,\n                _simplifyArray = Konva.Util._simplifyArray,\n                origSetter = this.setAttr,\n                n, args;\n\n            // to prevent creating scope function at each loop\n            var func = function(methodName) {\n                    var origMethod = that[methodName],\n                        ret;\n\n                    that[methodName] = function() {\n                        args = _simplifyArray(Array.prototype.slice.call(arguments, 0));\n                        ret = origMethod.apply(that, arguments);\n\n                        that._trace({\n                            method: methodName,\n                            args: args\n                        });\n\n                        return ret;\n                    };\n            };\n            // methods\n            for (n = 0; n < len; n++) {\n                func(CONTEXT_METHODS[n]);\n            }\n\n            // attrs\n            that.setAttr = function() {\n                origSetter.apply(that, arguments);\n                that._trace({\n                    property: arguments[0],\n                    val: arguments[1]\n                });\n            };\n        }\n    };\n\n    CONTEXT_PROPERTIES.forEach(function(prop) {\n        Object.defineProperty(Konva.Context.prototype, prop, {\n            get: function () {\n                return this._context[prop];\n            },\n            set: function (val) {\n                this._context[prop] = val;\n            }\n        });\n    });\n\n    Konva.SceneContext = function(canvas) {\n        Konva.Context.call(this, canvas);\n    };\n\n    Konva.SceneContext.prototype = {\n        _fillColor: function(shape) {\n            var fill = shape.fill();\n\n            this.setAttr('fillStyle', fill);\n            shape._fillFunc(this);\n        },\n        _fillPattern: function(shape) {\n            var fillPatternX = shape.getFillPatternX(),\n                fillPatternY = shape.getFillPatternY(),\n                fillPatternScale = shape.getFillPatternScale(),\n                fillPatternRotation = Konva.getAngle(shape.getFillPatternRotation()),\n                fillPatternOffset = shape.getFillPatternOffset();\n\n            if(fillPatternX || fillPatternY) {\n                this.translate(fillPatternX || 0, fillPatternY || 0);\n            }\n            if(fillPatternRotation) {\n                this.rotate(fillPatternRotation);\n            }\n            if(fillPatternScale) {\n                this.scale(fillPatternScale.x, fillPatternScale.y);\n            }\n            if(fillPatternOffset) {\n                this.translate(-1 * fillPatternOffset.x, -1 * fillPatternOffset.y);\n            }\n\n            this.setAttr('fillStyle', this.createPattern(shape.getFillPatternImage(), shape.getFillPatternRepeat() || 'repeat'));\n            this.fill();\n        },\n        _fillLinearGradient: function(shape) {\n            var start = shape.getFillLinearGradientStartPoint(),\n                end = shape.getFillLinearGradientEndPoint(),\n                colorStops = shape.getFillLinearGradientColorStops(),\n                grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n\n            if (colorStops) {\n                // build color stops\n                for(var n = 0; n < colorStops.length; n += 2) {\n                    grd.addColorStop(colorStops[n], colorStops[n + 1]);\n                }\n                this.setAttr('fillStyle', grd);\n                shape._fillFunc(this);\n            }\n        },\n        _fillRadialGradient: function(shape) {\n            var start = shape.getFillRadialGradientStartPoint(),\n                end = shape.getFillRadialGradientEndPoint(),\n                startRadius = shape.getFillRadialGradientStartRadius(),\n                endRadius = shape.getFillRadialGradientEndRadius(),\n                colorStops = shape.getFillRadialGradientColorStops(),\n                grd = this.createRadialGradient(start.x, start.y, startRadius, end.x, end.y, endRadius);\n\n            // build color stops\n            for(var n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            this.setAttr('fillStyle', grd);\n            this.fill();\n        },\n        _fill: function(shape) {\n            var hasColor = shape.fill(),\n                hasPattern = shape.getFillPatternImage(),\n                hasLinearGradient = shape.getFillLinearGradientColorStops(),\n                hasRadialGradient = shape.getFillRadialGradientColorStops(),\n                fillPriority = shape.getFillPriority();\n\n            // priority fills\n            if(hasColor && fillPriority === 'color') {\n                this._fillColor(shape);\n            }\n            else if(hasPattern && fillPriority === 'pattern') {\n                this._fillPattern(shape);\n            }\n            else if(hasLinearGradient && fillPriority === 'linear-gradient') {\n                this._fillLinearGradient(shape);\n            }\n            else if(hasRadialGradient && fillPriority === 'radial-gradient') {\n                this._fillRadialGradient(shape);\n            }\n            // now just try and fill with whatever is available\n            else if(hasColor) {\n                this._fillColor(shape);\n            }\n            else if(hasPattern) {\n                this._fillPattern(shape);\n            }\n            else if(hasLinearGradient) {\n                this._fillLinearGradient(shape);\n            }\n            else if(hasRadialGradient) {\n                this._fillRadialGradient(shape);\n            }\n        },\n        _stroke: function(shape) {\n            var dash = shape.dash(),\n                // ignore strokeScaleEnabled for Text\n                strokeScaleEnabled = (shape.getStrokeScaleEnabled() || (shape instanceof Konva.Text));\n\n            if(shape.hasStroke()) {\n                if (!strokeScaleEnabled) {\n                    this.save();\n                    this.setTransform(1, 0, 0, 1, 0, 0);\n                }\n\n                this._applyLineCap(shape);\n                if(dash && shape.dashEnabled()) {\n                    this.setLineDash(dash);\n                }\n\n                this.setAttr('lineWidth', shape.strokeWidth());\n                this.setAttr('strokeStyle', shape.stroke());\n\n                if (!shape.getShadowForStrokeEnabled()) {\n                    this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n                }\n                shape._strokeFunc(this);\n\n                if (!strokeScaleEnabled) {\n                    this.restore();\n                }\n            }\n        },\n        _applyShadow: function(shape) {\n            var util = Konva.Util,\n                color = util.get(shape.getShadowRGBA(), 'black'),\n                blur = util.get(shape.getShadowBlur(), 5),\n                offset = util.get(shape.getShadowOffset(), {\n                    x: 0,\n                    y: 0\n                }),\n                // TODO: get this info from transform??\n                scale = shape.getAbsoluteScale(),\n                scaleX = scale.x,\n                scaleY = scale.y;\n\n            this.setAttr('shadowColor', color);\n            this.setAttr('shadowBlur', blur);\n            this.setAttr('shadowOffsetX', offset.x * scaleX);\n            this.setAttr('shadowOffsetY', offset.y * scaleY);\n        }\n    };\n    Konva.Util.extend(Konva.SceneContext, Konva.Context);\n\n    Konva.HitContext = function(canvas) {\n        Konva.Context.call(this, canvas);\n    };\n\n    Konva.HitContext.prototype = {\n        _fill: function(shape) {\n            this.save();\n            this.setAttr('fillStyle', shape.colorKey);\n            shape._fillFuncHit(this);\n            this.restore();\n        },\n        _stroke: function(shape) {\n            if(shape.hasStroke() && shape.strokeHitEnabled()) {\n                // ignore strokeScaleEnabled for Text\n                var strokeScaleEnabled = (shape.getStrokeScaleEnabled() || (shape instanceof Konva.Text));\n                if (!strokeScaleEnabled) {\n                    this.save();\n                    this.setTransform(1, 0, 0, 1, 0, 0);\n                }\n                this._applyLineCap(shape);\n                this.setAttr('lineWidth', shape.strokeWidth());\n                this.setAttr('strokeStyle', shape.colorKey);\n                shape._strokeFuncHit(this);\n                if (!strokeScaleEnabled) {\n                    this.restore();\n                }\n            }\n        }\n    };\n    Konva.Util.extend(Konva.HitContext, Konva.Context);\n})();\n\n(function() {\n    'use strict';\n    // CONSTANTS\n    var GET = 'get',\n        SET = 'set';\n\n    Konva.Factory = {\n        addGetterSetter: function(constructor, attr, def, validator, after) {\n            this.addGetter(constructor, attr, def);\n            this.addSetter(constructor, attr, validator, after);\n            this.addOverloadedGetterSetter(constructor, attr);\n        },\n        addGetter: function(constructor, attr, def) {\n            var method = GET + Konva.Util._capitalize(attr);\n\n            constructor.prototype[method] = function() {\n                var val = this.attrs[attr];\n                return val === undefined ? def : val;\n            };\n        },\n        addSetter: function(constructor, attr, validator, after) {\n            var method = SET + Konva.Util._capitalize(attr);\n\n            constructor.prototype[method] = function(val) {\n                if (validator) {\n                    val = validator.call(this, val);\n                }\n\n                this._setAttr(attr, val);\n\n                if (after) {\n                    after.call(this);\n                }\n\n                return this;\n            };\n        },\n        addComponentsGetterSetter: function(constructor, attr, components, validator, after) {\n            var len = components.length,\n                capitalize = Konva.Util._capitalize,\n                getter = GET + capitalize(attr),\n                setter = SET + capitalize(attr),\n                n, component;\n\n            // getter\n            constructor.prototype[getter] = function() {\n                var ret = {};\n\n                for (n = 0; n < len; n++) {\n                    component = components[n];\n                    ret[component] = this.getAttr(attr + capitalize(component));\n                }\n\n                return ret;\n            };\n\n            // setter\n            constructor.prototype[setter] = function(val) {\n                var oldVal = this.attrs[attr],\n                    key;\n\n                if (validator) {\n                    val = validator.call(this, val);\n                }\n\n                for (key in val) {\n                    if (!val.hasOwnProperty(key)) {\n                        continue;\n                    }\n                    this._setAttr(attr + capitalize(key), val[key]);\n                }\n\n                this._fireChangeEvent(attr, oldVal, val);\n\n                if (after) {\n                    after.call(this);\n                }\n\n                return this;\n            };\n\n            this.addOverloadedGetterSetter(constructor, attr);\n        },\n        addOverloadedGetterSetter: function(constructor, attr) {\n            var capitalizedAttr = Konva.Util._capitalize(attr),\n                setter = SET + capitalizedAttr,\n                getter = GET + capitalizedAttr;\n\n            constructor.prototype[attr] = function() {\n                // setting\n                if (arguments.length) {\n                    this[setter](arguments[0]);\n                    return this;\n                }\n                // getting\n                return this[getter]();\n            };\n        },\n        addDeprecatedGetterSetter: function(constructor, attr, def, validator) {\n            var method = GET + Konva.Util._capitalize(attr);\n            var message = attr + ' property is deprecated and will be removed soon. Look at Konva change log for more information.';\n            constructor.prototype[method] = function() {\n                Konva.Util.error(message);\n                var val = this.attrs[attr];\n                return val === undefined ? def : val;\n            };\n            this.addSetter(constructor, attr, validator, function() {\n              Konva.Util.error(message);\n            });\n            this.addOverloadedGetterSetter(constructor, attr);\n        },\n        backCompat: function(constructor, methods) {\n            Konva.Util.each(methods, function(oldMethodName, newMethodName) {\n                var method = constructor.prototype[newMethodName];\n                constructor.prototype[oldMethodName] = function(){\n                    method.apply(this, arguments);\n                    Konva.Util.error(oldMethodName + ' method is deprecated and will be removed soon. Use ' + newMethodName + ' instead');\n                };\n            });\n        },\n        afterSetFilter: function() {\n            this._filterUpToDate = false;\n        }\n    };\n\n    Konva.Validators = {\n        /**\n         * @return {number}\n         */\n        RGBComponent: function(val) {\n            if (val > 255) {\n                return 255;\n            } else if (val < 0) {\n                return 0;\n            }\n            return Math.round(val);\n        },\n        alphaComponent: function(val) {\n            if (val > 1) {\n                return 1;\n            }\n            // chrome does not honor alpha values of 0\n            else if (val < 0.0001) {\n                return 0.0001;\n            }\n\n            return val;\n        }\n    };\n})();\n\n(function(Konva) {\n    'use strict';\n    // CONSTANTS\n    var ABSOLUTE_OPACITY = 'absoluteOpacity',\n        ABSOLUTE_TRANSFORM = 'absoluteTransform',\n        ABSOLUTE_SCALE = 'absoluteScale',\n        CHANGE = 'Change',\n        CHILDREN = 'children',\n        DOT = '.',\n        EMPTY_STRING = '',\n        GET = 'get',\n        ID = 'id',\n        KONVA = 'konva',\n        LISTENING = 'listening',\n        MOUSEENTER = 'mouseenter',\n        MOUSELEAVE = 'mouseleave',\n        NAME = 'name',\n        SET = 'set',\n        SHAPE = 'Shape',\n        SPACE = ' ',\n        STAGE = 'stage',\n        TRANSFORM = 'transform',\n        UPPER_STAGE = 'Stage',\n        VISIBLE = 'visible',\n        CLONE_BLACK_LIST = ['id'],\n\n        TRANSFORM_CHANGE_STR = [\n            'xChange.konva',\n            'yChange.konva',\n            'scaleXChange.konva',\n            'scaleYChange.konva',\n            'skewXChange.konva',\n            'skewYChange.konva',\n            'rotationChange.konva',\n            'offsetXChange.konva',\n            'offsetYChange.konva',\n            'transformsEnabledChange.konva'\n        ].join(SPACE),\n\n        SCALE_CHANGE_STR = [\n            'scaleXChange.konva',\n            'scaleYChange.konva'\n        ].join(SPACE);\n\n    /**\n     * Node constructor. Nodes are entities that can be transformed, layered,\n     * and have bound events. The stage, layers, groups, and shapes all extend Node.\n     * @constructor\n     * @memberof Konva\n     * @abstract\n     * @param {Object} config\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     */\n    Konva.Node = function(config) {\n        this._init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Node, {\n        _init: function(config) {\n            var that = this;\n            this._id = Konva.idCounter++;\n            this.eventListeners = {};\n            this.attrs = {};\n            this._cache = {};\n            this._filterUpToDate = false;\n            this.setAttrs(config);\n\n            // event bindings for cache handling\n            this.on(TRANSFORM_CHANGE_STR, function() {\n                this._clearCache(TRANSFORM);\n                that._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n            });\n\n            this.on(SCALE_CHANGE_STR, function() {\n                that._clearSelfAndDescendantCache(ABSOLUTE_SCALE);\n            });\n\n            this.on('visibleChange.konva', function() {\n                that._clearSelfAndDescendantCache(VISIBLE);\n            });\n            this.on('listeningChange.konva', function() {\n                that._clearSelfAndDescendantCache(LISTENING);\n            });\n            this.on('opacityChange.konva', function() {\n                that._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n            });\n        },\n        _clearCache: function(attr){\n            if (attr) {\n                delete this._cache[attr];\n            }\n            else {\n                this._cache = {};\n            }\n        },\n        _getCache: function(attr, privateGetter){\n            var cache = this._cache[attr];\n\n            // if not cached, we need to set it using the private getter method.\n            if (cache === undefined) {\n                this._cache[attr] = privateGetter.call(this);\n            }\n\n            return this._cache[attr];\n        },\n        /*\n         * when the logic for a cached result depends on ancestor propagation, use this\n         * method to clear self and children cache\n         */\n        _clearSelfAndDescendantCache: function(attr) {\n            this._clearCache(attr);\n\n            if (this.children) {\n                this.getChildren().each(function(node) {\n                    node._clearSelfAndDescendantCache(attr);\n                });\n            }\n        },\n        /**\n        * clear cached canvas\n        * @method\n        * @memberof Konva.Node.prototype\n        * @returns {Konva.Node}\n        * @example\n        * node.clearCache();\n        */\n        clearCache: function() {\n            delete this._cache.canvas;\n            this._filterUpToDate = false;\n            return this;\n        },\n        /**\n        *  cache node to improve drawing performance, apply filters, or create more accurate\n        *  hit regions. For all basic shapes size of cache canvas will be automatically detected.\n        *  If you need to cache your custom `Konva.Shape` instance you have to pass shape's bounding box\n        *  properties. Look at [link to demo page](link to demo page) for more information.\n        * @method\n        * @memberof Konva.Node.prototype\n        * @param {Object} [config]\n        * @param {Number} [config.x]\n        * @param {Number} [config.y]\n        * @param {Number} [config.width]\n        * @param {Number} [config.height]\n        * @param {Number} [config.offset]  increase canvas size by `offset` pixel in all directions.\n        * @param {Boolean} [config.drawBorder] when set to true, a red border will be drawn around the cached\n        *  region for debugging purposes\n        * @returns {Konva.Node}\n        * @example\n        * // cache a shape with the x,y position of the bounding box at the center and\n        * // the width and height of the bounding box equal to the width and height of\n        * // the shape obtained from shape.width() and shape.height()\n        * image.cache();\n        *\n        * // cache a node and define the bounding box position and size\n        * node.cache({\n        *   x: -30,\n        *   y: -30,\n        *   width: 100,\n        *   height: 200\n        * });\n        *\n        * // cache a node and draw a red border around the bounding box\n        * // for debugging purposes\n        * node.cache({\n        *   x: -30,\n        *   y: -30,\n        *   width: 100,\n        *   height: 200,\n        *   offset : 10,\n        *   drawBorder: true\n        * });\n        */\n        cache: function(config) {\n            var conf = config || {},\n                rect = this.getClientRect(true),\n                width = conf.width || rect.width,\n                height = conf.height || rect.height,\n                x = conf.x || rect.x,\n                y = conf.y || rect.y,\n                offset = conf.offset || 0,\n                drawBorder = conf.drawBorder || false;\n\n            if (!width || !height) {\n                throw new Error('Width or height of caching configuration equals 0.');\n            }\n\n            width += offset * 2;\n            height += offset * 2;\n\n            x -= offset;\n            y -= offset;\n\n\n            var cachedSceneCanvas = new Konva.SceneCanvas({\n                width: width,\n                height: height\n            }),\n            cachedFilterCanvas = new Konva.SceneCanvas({\n                width: width,\n                height: height\n            }),\n            cachedHitCanvas = new Konva.HitCanvas({\n                pixelRatio: 1,\n                width: width,\n                height: height\n            }),\n            sceneContext = cachedSceneCanvas.getContext(),\n            hitContext = cachedHitCanvas.getContext();\n\n            cachedHitCanvas.isCache = true;\n\n            this.clearCache();\n\n            sceneContext.save();\n            hitContext.save();\n\n            sceneContext.translate(-x, -y);\n            hitContext.translate(-x, -y);\n\n            this.drawScene(cachedSceneCanvas, this, true);\n            this.drawHit(cachedHitCanvas, this, true);\n\n            sceneContext.restore();\n            hitContext.restore();\n\n            // this will draw a red border around the cached box for\n            // debugging purposes\n            if (drawBorder) {\n                sceneContext.save();\n                sceneContext.beginPath();\n                sceneContext.rect(0, 0, width, height);\n                sceneContext.closePath();\n                sceneContext.setAttr('strokeStyle', 'red');\n                sceneContext.setAttr('lineWidth', 5);\n                sceneContext.stroke();\n                sceneContext.restore();\n            }\n\n            this._cache.canvas = {\n                scene: cachedSceneCanvas,\n                filter: cachedFilterCanvas,\n                hit: cachedHitCanvas,\n                x: x,\n                y: y\n            };\n\n            return this;\n        },\n        /**\n         * Return client rectangle {x, y, width, height} of node. This rectangle also include all styling (strokes, shadows, etc).\n         * The rectangle position is relative to parent container.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Boolean} [skipTransform] flag should we skip transformation to rectangle\n         * @returns {Object} rect with {x, y, width, height} properties\n         * @example\n         * var rect = new Konva.Rect({\n         *      width : 100,\n         *      height : 100,\n         *      x : 50,\n         *      y : 50,\n         *      strokeWidth : 4,\n         *      stroke : 'black',\n         *      offsetX : 50,\n         *      scaleY : 2\n         * });\n         *\n         * // get client rect without think off transformations (position, rotation, scale, offset, etc)\n         * rect.getClientRect(true);\n         * // returns {\n         * //     x : -2,   // two pixels for stroke / 2\n         * //     y : -2,\n         * //     width : 104, // increased by 4 for stroke\n         * //     height : 104\n         * //}\n         *\n         * // get client rect with transformation applied\n         * rect.getClientRect();\n         * // returns Object {x: -2, y: 46, width: 104, height: 208}\n         */\n        getClientRect: function() {\n            // abstract method\n            // redefine in Container and Shape\n            throw new Error('abstract \"getClientRect\" method call');\n        },\n        _transformedRect: function(rect) {\n            var points = [\n                {x: rect.x, y: rect.y},\n                {x: rect.x + rect.width, y: rect.y},\n                {x: rect.x + rect.width, y: rect.y + rect.height},\n                {x: rect.x, y: rect.y + rect.height}\n            ];\n            var minX, minY, maxX, maxY;\n            var trans = this.getTransform();\n            points.forEach(function(point) {\n                var transformed = trans.point(point);\n                if (minX === undefined) {\n                    minX = maxX = transformed.x;\n                    minY = maxY = transformed.y;\n                }\n                minX = Math.min(minX, transformed.x);\n                minY = Math.min(minY, transformed.y);\n                maxX = Math.max(maxX, transformed.x);\n                maxY = Math.max(maxY, transformed.y);\n            });\n            return {\n                x: minX,\n                y: minY,\n                width: maxX - minX,\n                height: maxY - minY\n            };\n        },\n        _drawCachedSceneCanvas: function(context) {\n            context.save();\n            context._applyOpacity(this);\n            context.translate(\n                this._cache.canvas.x,\n                this._cache.canvas.y\n            );\n\n            var cacheCanvas = this._getCachedSceneCanvas();\n            var ratio = cacheCanvas.pixelRatio;\n\n            context.drawImage(cacheCanvas._canvas, 0, 0, cacheCanvas.width / ratio, cacheCanvas.height / ratio);\n            context.restore();\n        },\n        _drawCachedHitCanvas: function(context) {\n            var cachedCanvas = this._cache.canvas,\n                hitCanvas = cachedCanvas.hit;\n            context.save();\n            context.translate(\n                this._cache.canvas.x,\n                this._cache.canvas.y\n            );\n            context.drawImage(hitCanvas._canvas, 0, 0);\n            context.restore();\n        },\n        _getCachedSceneCanvas: function() {\n            var filters = this.filters(),\n                cachedCanvas = this._cache.canvas,\n                sceneCanvas = cachedCanvas.scene,\n                filterCanvas = cachedCanvas.filter,\n                filterContext = filterCanvas.getContext(),\n                len, imageData, n, filter;\n\n            if (filters) {\n                if (!this._filterUpToDate) {\n                    var ratio = sceneCanvas.pixelRatio;\n\n                    try {\n                        len = filters.length;\n                        filterContext.clear();\n\n                        // copy cached canvas onto filter context\n                        filterContext.drawImage(sceneCanvas._canvas, 0, 0, sceneCanvas.getWidth() / ratio, sceneCanvas.getHeight() / ratio);\n                        imageData = filterContext.getImageData(0, 0, filterCanvas.getWidth(), filterCanvas.getHeight());\n\n                        // apply filters to filter context\n                        for (n = 0; n < len; n++) {\n                            filter = filters[n];\n                            if (typeof filter !== 'function') {\n                                Konva.Util.error(\n                                  'Filter should be type of function, but got ' +\n                                  (typeof filter) + ' insted. Please check correct filters'\n                                );\n                                continue;\n                            }\n                            filter.call(this, imageData);\n                            filterContext.putImageData(imageData, 0, 0);\n                        }\n                    }\n                    catch(e) {\n                        Konva.Util.error('Unable to apply filter. ' + e.message);\n                    }\n\n                    this._filterUpToDate = true;\n                }\n\n                return filterCanvas;\n            }\n            return sceneCanvas;\n        },\n        /**\n         * bind events to the node. KonvaJS supports mouseover, mousemove,\n         *  mouseout, mouseenter, mouseleave, mousedown, mouseup, wheel, click, dblclick, touchstart, touchmove,\n         *  touchend, tap, dbltap, dragstart, dragmove, and dragend events. The Konva Stage supports\n         *  contentMouseover, contentMousemove, contentMouseout, contentMousedown, contentMouseup, contentWheel\n         *  contentClick, contentDblclick, contentTouchstart, contentTouchmove, contentTouchend, contentTap,\n         *  and contentDblTap.  Pass in a string of events delimmited by a space to bind multiple events at once\n         *  such as 'mousedown mouseup mousemove'. Include a namespace to bind an\n         *  event by name such as 'click.foobar'.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} evtStr e.g. 'click', 'mousedown touchstart', 'mousedown.foo touchstart.foo'\n         * @param {Function} handler The handler function is passed an event object\n         * @returns {Konva.Node}\n         * @example\n         * // add click listener\n         * node.on('click', function() {\n         *   console.log('you clicked me!');\n         * });\n         *\n         * // get the target node\n         * node.on('click', function(evt) {\n         *   console.log(evt.target);\n         * });\n         *\n         * // stop event propagation\n         * node.on('click', function(evt) {\n         *   evt.cancelBubble = true;\n         * });\n         *\n         * // bind multiple listeners\n         * node.on('click touchstart', function() {\n         *   console.log('you clicked/touched me!');\n         * });\n         *\n         * // namespace listener\n         * node.on('click.foo', function() {\n         *   console.log('you clicked/touched me!');\n         * });\n         *\n         * // get the event type\n         * node.on('click tap', function(evt) {\n         *   var eventType = evt.type;\n         * });\n         *\n         * // get native event object\n         * node.on('click tap', function(evt) {\n         *   var nativeEvent = evt.evt;\n         * });\n         *\n         * // for change events, get the old and new val\n         * node.on('xChange', function(evt) {\n         *   var oldVal = evt.oldVal;\n         *   var newVal = evt.newVal;\n         * });\n         *\n         * // get event targets\n         * // with event delegations\n         * layer.on('click', 'Group', function(evt) {\n         *   var shape = evt.target;\n         *   var group = evtn.currentTarger;\n         * });\n         */\n        on: function(evtStr, handler) {\n            if (arguments.length === 3) {\n                return this._delegate.apply(this, arguments);\n            }\n            var events = evtStr.split(SPACE),\n                len = events.length,\n                n, event, parts, baseEvent, name;\n\n             /*\n             * loop through types and attach event listeners to\n             * each one.  eg. 'click mouseover.namespace mouseout'\n             * will create three event bindings\n             */\n            for(n = 0; n < len; n++) {\n                event = events[n];\n                parts = event.split(DOT);\n                baseEvent = parts[0];\n                name = parts[1] || EMPTY_STRING;\n\n                // create events array if it doesn't exist\n                if(!this.eventListeners[baseEvent]) {\n                    this.eventListeners[baseEvent] = [];\n                }\n\n                this.eventListeners[baseEvent].push({\n                    name: name,\n                    handler: handler\n                });\n            }\n\n            return this;\n        },\n        /**\n         * remove event bindings from the node. Pass in a string of\n         *  event types delimmited by a space to remove multiple event\n         *  bindings at once such as 'mousedown mouseup mousemove'.\n         *  include a namespace to remove an event binding by name\n         *  such as 'click.foobar'. If you only give a name like '.foobar',\n         *  all events in that namespace will be removed.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} evtStr e.g. 'click', 'mousedown touchstart', '.foobar'\n         * @returns {Konva.Node}\n         * @example\n         * // remove listener\n         * node.off('click');\n         *\n         * // remove multiple listeners\n         * node.off('click touchstart');\n         *\n         * // remove listener by name\n         * node.off('click.foo');\n         */\n        off: function(evtStr) {\n            var events = (evtStr || '').split(SPACE),\n                len = events.length,\n                n, t, event, parts, baseEvent, name;\n\n            if (!evtStr) {\n                // remove all events\n                for(t in this.eventListeners) {\n                    this._off(t);\n                }\n            }\n            for(n = 0; n < len; n++) {\n                event = events[n];\n                parts = event.split(DOT);\n                baseEvent = parts[0];\n                name = parts[1];\n\n                if(baseEvent) {\n                    if(this.eventListeners[baseEvent]) {\n                        this._off(baseEvent, name);\n                    }\n                }\n                else {\n                    for(t in this.eventListeners) {\n                        this._off(t, name);\n                    }\n                }\n            }\n            return this;\n        },\n        // some event aliases for third party integration like HammerJS\n        dispatchEvent: function(evt) {\n            var e = {\n              target: this,\n              type: evt.type,\n              evt: evt\n            };\n            this.fire(evt.type, e);\n            return this;\n        },\n        addEventListener: function(type, handler) {\n            // we have to pass native event to handler\n            this.on(type, function(evt){\n                handler.call(this, evt.evt);\n            });\n            return this;\n        },\n        removeEventListener: function(type) {\n            this.off(type);\n            return this;\n        },\n        // like node.on\n        _delegate: function(event, selector, handler) {\n            var stopNode = this;\n            this.on(event, function(evt) {\n                var targets = evt.target.findAncestors(selector, true, stopNode);\n                for(var i = 0; i < targets.length; i++) {\n                    evt = Konva.Util.cloneObject(evt);\n                    evt.currentTarget = targets[i];\n                    handler.call(targets[i], evt);\n                }\n            });\n        },\n        /**\n         * remove self from parent, but don't destroy\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Node}\n         * @example\n         * node.remove();\n         */\n        remove: function() {\n            var parent = this.getParent();\n\n            if(parent && parent.children) {\n                parent.children.splice(this.index, 1);\n                parent._setChildrenIndices();\n                delete this.parent;\n            }\n\n            // every cached attr that is calculated via node tree\n            // traversal must be cleared when removing a node\n            this._clearSelfAndDescendantCache(STAGE);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n            this._clearSelfAndDescendantCache(VISIBLE);\n            this._clearSelfAndDescendantCache(LISTENING);\n            this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY);\n\n            return this;\n        },\n        /**\n         * remove and destroy self\n         * @method\n         * @memberof Konva.Node.prototype\n         * @example\n         * node.destroy();\n         */\n        destroy: function() {\n            // remove from ids and names hashes\n            Konva._removeId(this.getId());\n            Konva._removeName(this.getName(), this._id);\n\n            this.remove();\n            return this;\n        },\n        /**\n         * get attr\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} attr\n         * @returns {Integer|String|Object|Array}\n         * @example\n         * var x = node.getAttr('x');\n         */\n        getAttr: function(attr) {\n            var method = GET + Konva.Util._capitalize(attr);\n            if(Konva.Util._isFunction(this[method])) {\n                return this[method]();\n            }\n            // otherwise get directly\n            return this.attrs[attr];\n        },\n        /**\n        * get ancestors\n        * @method\n        * @memberof Konva.Node.prototype\n        * @returns {Konva.Collection}\n        * @example\n        * shape.getAncestors().each(function(node) {\n        *   console.log(node.getId());\n        * })\n        */\n        getAncestors: function() {\n            var parent = this.getParent(),\n                ancestors = new Konva.Collection();\n\n            while (parent) {\n                ancestors.push(parent);\n                parent = parent.getParent();\n            }\n\n            return ancestors;\n        },\n        /**\n         * get attrs object literal\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Object}\n         */\n        getAttrs: function() {\n            return this.attrs || {};\n        },\n        /**\n         * set multiple attrs at once using an object literal\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} config object containing key value pairs\n         * @returns {Konva.Node}\n         * @example\n         * node.setAttrs({\n         *   x: 5,\n         *   fill: 'red'\n         * });\n         */\n        setAttrs: function(config) {\n            var key, method;\n\n            if(!config) {\n                return this;\n            }\n            for(key in config) {\n                if (key === CHILDREN) {\n                    continue;\n                }\n                method = SET + Konva.Util._capitalize(key);\n                // use setter if available\n                if(Konva.Util._isFunction(this[method])) {\n                    this[method](config[key]);\n                }\n                // otherwise set directly\n                else {\n                    this._setAttr(key, config[key]);\n                }\n            }\n            return this;\n        },\n        /**\n         * determine if node is listening for events by taking into account ancestors.\n         *\n         * Parent    | Self      | isListening\n         * listening | listening |\n         * ----------+-----------+------------\n         * T         | T         | T\n         * T         | F         | F\n         * F         | T         | T\n         * F         | F         | F\n         * ----------+-----------+------------\n         * T         | I         | T\n         * F         | I         | F\n         * I         | I         | T\n         *\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        isListening: function() {\n            return this._getCache(LISTENING, this._isListening);\n        },\n        _isListening: function() {\n            var listening = this.getListening(),\n                parent = this.getParent();\n\n            // the following conditions are a simplification of the truth table above.\n            // please modify carefully\n            if (listening === 'inherit') {\n                if (parent) {\n                    return parent.isListening();\n                }\n                else {\n                    return true;\n                }\n            }\n            else {\n                return listening;\n            }\n        },\n        /**\n         * determine if node is visible by taking into account ancestors.\n         *\n         * Parent    | Self      | isVisible\n         * visible   | visible   |\n         * ----------+-----------+------------\n         * T         | T         | T\n         * T         | F         | F\n         * F         | T         | T\n         * F         | F         | F\n         * ----------+-----------+------------\n         * T         | I         | T\n         * F         | I         | F\n         * I         | I         | T\n\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        isVisible: function() {\n            return this._getCache(VISIBLE, this._isVisible);\n        },\n        _isVisible: function() {\n            var visible = this.getVisible(),\n                parent = this.getParent();\n\n            // the following conditions are a simplification of the truth table above.\n            // please modify carefully\n            if (visible === 'inherit') {\n                if (parent) {\n                    return parent.isVisible();\n                }\n                else {\n                    return true;\n                }\n            }\n            else {\n                return visible;\n            }\n        },\n        /**\n         * determine if listening is enabled by taking into account descendants.  If self or any children\n         * have _isListeningEnabled set to true, then self also has listening enabled.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        shouldDrawHit: function(canvas) {\n            var layer = this.getLayer();\n            return (canvas && canvas.isCache) || (layer && layer.hitGraphEnabled())\n                && this.isListening() && this.isVisible();\n        },\n        /**\n         * show node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Node}\n         */\n        show: function() {\n            this.setVisible(true);\n            return this;\n        },\n        /**\n         * hide node.  Hidden nodes are no longer detectable\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Node}\n         */\n        hide: function() {\n            this.setVisible(false);\n            return this;\n        },\n        /**\n         * get zIndex relative to the node's siblings who share the same parent\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Integer}\n         */\n        getZIndex: function() {\n            return this.index || 0;\n        },\n        /**\n         * get absolute z-index which takes into account sibling\n         *  and ancestor indices\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Integer}\n         */\n        getAbsoluteZIndex: function() {\n            var depth = this.getDepth(),\n                that = this,\n                index = 0,\n                nodes, len, n, child;\n\n            function addChildren(children) {\n                nodes = [];\n                len = children.length;\n                for(n = 0; n < len; n++) {\n                    child = children[n];\n                    index++;\n\n                    if(child.nodeType !== SHAPE) {\n                        nodes = nodes.concat(child.getChildren().toArray());\n                    }\n\n                    if(child._id === that._id) {\n                        n = len;\n                    }\n                }\n\n                if(nodes.length > 0 && nodes[0].getDepth() <= depth) {\n                    addChildren(nodes);\n                }\n            }\n            if(that.nodeType !== UPPER_STAGE) {\n                addChildren(that.getStage().getChildren());\n            }\n\n            return index;\n        },\n        /**\n         * get node depth in node tree.  Returns an integer.\n         *  e.g. Stage depth will always be 0.  Layers will always be 1.  Groups and Shapes will always\n         *  be >= 2\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Integer}\n         */\n        getDepth: function() {\n            var depth = 0,\n                parent = this.parent;\n\n            while(parent) {\n                depth++;\n                parent = parent.parent;\n            }\n            return depth;\n        },\n        setPosition: function(pos) {\n            this.setX(pos.x);\n            this.setY(pos.y);\n            return this;\n        },\n        getPosition: function() {\n            return {\n                x: this.getX(),\n                y: this.getY()\n            };\n        },\n        /**\n         * get absolute position relative to the top left corner of the stage container div\n         * or relative to passed node\n         * @method\n         * @param {Object} [top] optional parent node\n         * @memberof Konva.Node.prototype\n         * @returns {Object}\n         */\n        getAbsolutePosition: function(top) {\n            var absoluteMatrix = this.getAbsoluteTransform(top).getMatrix(),\n                absoluteTransform = new Konva.Transform(),\n                offset = this.offset();\n\n            // clone the matrix array\n            absoluteTransform.m = absoluteMatrix.slice();\n            absoluteTransform.translate(offset.x, offset.y);\n\n            return absoluteTransform.getTranslation();\n        },\n        /**\n         * set absolute position\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} pos\n         * @param {Number} pos.x\n         * @param {Number} pos.y\n         * @returns {Konva.Node}\n         */\n        setAbsolutePosition: function(pos) {\n            var origTrans = this._clearTransform(),\n                it;\n\n            // don't clear translation\n            this.attrs.x = origTrans.x;\n            this.attrs.y = origTrans.y;\n            delete origTrans.x;\n            delete origTrans.y;\n\n            // unravel transform\n            it = this.getAbsoluteTransform();\n\n            it.invert();\n            it.translate(pos.x, pos.y);\n            pos = {\n                x: this.attrs.x + it.getTranslation().x,\n                y: this.attrs.y + it.getTranslation().y\n            };\n\n            this.setPosition({x: pos.x, y: pos.y});\n            this._setTransform(origTrans);\n\n            return this;\n        },\n        _setTransform: function(trans) {\n            var key;\n\n            for(key in trans) {\n                this.attrs[key] = trans[key];\n            }\n\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n        },\n        _clearTransform: function() {\n            var trans = {\n                x: this.getX(),\n                y: this.getY(),\n                rotation: this.getRotation(),\n                scaleX: this.getScaleX(),\n                scaleY: this.getScaleY(),\n                offsetX: this.getOffsetX(),\n                offsetY: this.getOffsetY(),\n                skewX: this.getSkewX(),\n                skewY: this.getSkewY()\n            };\n\n            this.attrs.x = 0;\n            this.attrs.y = 0;\n            this.attrs.rotation = 0;\n            this.attrs.scaleX = 1;\n            this.attrs.scaleY = 1;\n            this.attrs.offsetX = 0;\n            this.attrs.offsetY = 0;\n            this.attrs.skewX = 0;\n            this.attrs.skewY = 0;\n\n            this._clearCache(TRANSFORM);\n            this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM);\n\n            // return original transform\n            return trans;\n        },\n        /**\n         * move node by an amount relative to its current position\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} change\n         * @param {Number} change.x\n         * @param {Number} change.y\n         * @returns {Konva.Node}\n         * @example\n         * // move node in x direction by 1px and y direction by 2px\n         * node.move({\n         *   x: 1,\n         *   y: 2)\n         * });\n         */\n        move: function(change) {\n            var changeX = change.x,\n                changeY = change.y,\n                x = this.getX(),\n                y = this.getY();\n\n            if(changeX !== undefined) {\n                x += changeX;\n            }\n\n            if(changeY !== undefined) {\n                y += changeY;\n            }\n\n            this.setPosition({x: x, y: y});\n            return this;\n        },\n        _eachAncestorReverse: function(func, top) {\n            var family = [],\n                parent = this.getParent(),\n                len, n;\n\n            // if top node is defined, and this node is top node,\n            // there's no need to build a family tree.  just execute\n            // func with this because it will be the only node\n            if (top && top._id === this._id) {\n                func(this);\n                return true;\n            }\n\n            family.unshift(this);\n\n            while(parent && (!top || parent._id !== top._id)) {\n                family.unshift(parent);\n                parent = parent.parent;\n            }\n\n            len = family.length;\n            for(n = 0; n < len; n++) {\n                func(family[n]);\n            }\n        },\n        /**\n         * rotate node by an amount in degrees relative to its current rotation\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Number} theta\n         * @returns {Konva.Node}\n         */\n        rotate: function(theta) {\n            this.setRotation(this.getRotation() + theta);\n            return this;\n        },\n        /**\n         * move node to the top of its siblings\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        moveToTop: function() {\n            if (!this.parent) {\n                Konva.Util.warn('Node has no parent. moveToTop function is ignored.');\n                return false;\n            }\n            var index = this.index;\n            this.parent.children.splice(index, 1);\n            this.parent.children.push(this);\n            this.parent._setChildrenIndices();\n            return true;\n        },\n        /**\n         * move node up\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean} flag is moved or not\n         */\n        moveUp: function() {\n            if (!this.parent) {\n                Konva.Util.warn('Node has no parent. moveUp function is ignored.');\n                return false;\n            }\n            var index = this.index,\n                len = this.parent.getChildren().length;\n            if(index < len - 1) {\n                this.parent.children.splice(index, 1);\n                this.parent.children.splice(index + 1, 0, this);\n                this.parent._setChildrenIndices();\n                return true;\n            }\n            return false;\n        },\n        /**\n         * move node down\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        moveDown: function() {\n            if (!this.parent) {\n                Konva.Util.warn('Node has no parent. moveDown function is ignored.');\n                return false;\n            }\n            var index = this.index;\n            if(index > 0) {\n                this.parent.children.splice(index, 1);\n                this.parent.children.splice(index - 1, 0, this);\n                this.parent._setChildrenIndices();\n                return true;\n            }\n            return false;\n        },\n        /**\n         * move node to the bottom of its siblings\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Boolean}\n         */\n        moveToBottom: function() {\n            if (!this.parent) {\n                Konva.Util.warn('Node has no parent. moveToBottom function is ignored.');\n                return false;\n            }\n            var index = this.index;\n            if(index > 0) {\n                this.parent.children.splice(index, 1);\n                this.parent.children.unshift(this);\n                this.parent._setChildrenIndices();\n                return true;\n            }\n            return false;\n        },\n        /**\n         * set zIndex relative to siblings\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Integer} zIndex\n         * @returns {Konva.Node}\n         */\n        setZIndex: function(zIndex) {\n            if (!this.parent) {\n                Konva.Util.warn('Node has no parent. zIndex parameter is ignored.');\n                return false;\n            }\n            var index = this.index;\n            this.parent.children.splice(index, 1);\n            this.parent.children.splice(zIndex, 0, this);\n            this.parent._setChildrenIndices();\n            return this;\n        },\n        /**\n         * get absolute opacity\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Number}\n         */\n        getAbsoluteOpacity: function() {\n            return this._getCache(ABSOLUTE_OPACITY, this._getAbsoluteOpacity);\n        },\n        _getAbsoluteOpacity: function() {\n            var absOpacity = this.getOpacity();\n            if(this.getParent()) {\n                absOpacity *= this.getParent().getAbsoluteOpacity();\n            }\n            return absOpacity;\n        },\n        /**\n         * move node to another container\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Container} newContainer\n         * @returns {Konva.Node}\n         * @example\n         * // move node from current layer into layer2\n         * node.moveTo(layer2);\n         */\n        moveTo: function(newContainer) {\n            // do nothing if new container is already parent\n            if (this.getParent() !== newContainer) {\n                this.remove();\n                newContainer.add(this);\n            }\n            return this;\n        },\n        /**\n         * convert Node into an object for serialization.  Returns an object.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Object}\n         */\n        toObject: function() {\n            var obj = {},\n                attrs = this.getAttrs(),\n                key, val, getter, defaultValue;\n\n            obj.attrs = {};\n\n            for(key in attrs) {\n                val = attrs[key];\n                getter = this[key];\n                // remove attr value so that we can extract the default value from the getter\n                delete attrs[key];\n                defaultValue = getter ? getter.call(this) : null;\n                // restore attr value\n                attrs[key] = val;\n                if (defaultValue !== val) {\n                    obj.attrs[key] = val;\n                }\n            }\n\n            obj.className = this.getClassName();\n            return Konva.Util._prepareToStringify(obj);\n        },\n        /**\n         * convert Node into a JSON string.  Returns a JSON string.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {String}}\n         */\n        toJSON: function() {\n            return JSON.stringify(this.toObject());\n        },\n        /**\n         * get parent container\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Node}\n         */\n        getParent: function() {\n            return this.parent;\n        },\n        /**\n         * get all ancestros (parent then parent of the parent, etc) of the node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} [selector] selector for search\n         * @param {Boolean} [includeSelf] show we think that node is ancestro itself?\n         * @param {Konva.Node} [stopNode] optional node where we need to stop searching (one of ancestors)\n         * @returns {Array} [ancestors]\n         * @example\n         * // get one of the parent group\n         * var parentGroups = node.findAncestors('Group');\n         */\n        findAncestors: function(selector, includeSelf, stopNode) {\n            var res = [];\n\n            if (includeSelf && this._isMatch(selector)) {\n                res.push(this);\n            }\n            var ancestor = this.parent;\n            while(ancestor) {\n                if (ancestor === stopNode) {\n                    return res;\n                }\n                if (ancestor._isMatch(selector)) {\n                    res.push(ancestor);\n                }\n                ancestor = ancestor.parent;\n            }\n            return res;\n        },\n        /**\n         * get ancestor (parent or parent of the parent, etc) of the node that match passed selector\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} [selector] selector for search\n         * @param {Boolean} [includeSelf] show we think that node is ancestro itself?\n         * @param {Konva.Node} [stopNode] optional node where we need to stop searching (one of ancestors)\n         * @returns {Konva.Node} ancestor\n         * @example\n         * // get one of the parent group\n         * var group = node.findAncestors('.mygroup');\n         */\n        findAncestor: function(selector, includeSelf, stopNode) {\n            return this.findAncestors(selector, includeSelf, stopNode)[0];\n        },\n        // is current node match passed selector?\n        _isMatch: function(selector) {\n            if (!selector) {\n                return false;\n            }\n            var selectorArr = selector.replace(/ /g, '').split(','),\n                len = selectorArr.length,\n                n, sel;\n\n            for (n = 0; n < len; n++) {\n                sel = selectorArr[n];\n                if (!Konva.Util.isValidSelector(sel)) {\n                    Konva.Util.warn('Selector \"' + sel + '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                    Konva.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                    Konva.Util.warn('Konva is awesome, right?');\n                }\n                // id selector\n                if(sel.charAt(0) === '#') {\n                    if (this.id() === sel.slice(1)) {\n                        return true;\n                    }\n                }\n                // name selector\n                else if(sel.charAt(0) === '.') {\n                    if (this.hasName(sel.slice(1))) {\n                        return true;\n                    }\n                } else if (this._get(sel).length !== 0) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        /**\n         * get layer ancestor\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Layer}\n         */\n        getLayer: function() {\n            var parent = this.getParent();\n            return parent ? parent.getLayer() : null;\n        },\n        /**\n         * get stage ancestor\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Stage}\n         */\n        getStage: function() {\n            return this._getCache(STAGE, this._getStage);\n        },\n        _getStage: function() {\n            var parent = this.getParent();\n            if(parent) {\n                return parent.getStage();\n            }\n            else {\n                return undefined;\n            }\n        },\n        /**\n         * fire event\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} eventType event type.  can be a regular event, like click, mouseover, or mouseout, or it can be a custom event, like myCustomEvent\n         * @param {Event} [evt] event object\n         * @param {Boolean} [bubble] setting the value to false, or leaving it undefined, will result in the event\n         *  not bubbling.  Setting the value to true will result in the event bubbling.\n         * @returns {Konva.Node}\n         * @example\n         * // manually fire click event\n         * node.fire('click');\n         *\n         * // fire custom event\n         * node.fire('foo');\n         *\n         * // fire custom event with custom event object\n         * node.fire('foo', {\n         *   bar: 10\n         * });\n         *\n         * // fire click event that bubbles\n         * node.fire('click', null, true);\n         */\n        fire: function(eventType, evt, bubble) {\n            evt = evt || {};\n            evt.target = evt.target || this;\n            // bubble\n            if (bubble) {\n                this._fireAndBubble(eventType, evt);\n            }\n            // no bubble\n            else {\n                this._fire(eventType, evt);\n            }\n            return this;\n        },\n        /**\n         * get absolute transform of the node which takes into\n         *  account its ancestor transforms\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Transform}\n         */\n        getAbsoluteTransform: function(top) {\n            // if using an argument, we can't cache the result.\n            if (top) {\n                return this._getAbsoluteTransform(top);\n            }\n            // if no argument, we can cache the result\n            else {\n                return this._getCache(ABSOLUTE_TRANSFORM, this._getAbsoluteTransform);\n            }\n        },\n        _getAbsoluteTransform: function(top) {\n            var at = new Konva.Transform(),\n                transformsEnabled, trans;\n\n            // start with stage and traverse downwards to self\n            this._eachAncestorReverse(function(node) {\n                transformsEnabled = node.transformsEnabled();\n                trans = node.getTransform();\n\n                if (transformsEnabled === 'all') {\n                    at.multiply(trans);\n                }\n                else if (transformsEnabled === 'position') {\n                    at.translate(node.x(), node.y());\n                }\n            }, top);\n            return at;\n        },\n        /**\n         * get absolute scale of the node which takes into\n         *  account its ancestor scales\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Transform}\n         */\n        getAbsoluteScale: function(top) {\n            // if using an argument, we can't cache the result.\n            if (top) {\n                return this._getAbsoluteTransform(top);\n            }\n            // if no argument, we can cache the result\n            else {\n                return this._getCache(ABSOLUTE_SCALE, this._getAbsoluteScale);\n            }\n        },\n        _getAbsoluteScale: function(top) {\n            var scaleX = 1, scaleY = 1;\n\n            // start with stage and traverse downwards to self\n            this._eachAncestorReverse(function(node) {\n                scaleX *= node.scaleX();\n                scaleY *= node.scaleY();\n            }, top);\n            return {\n                x: scaleX,\n                y: scaleY\n            };\n        },\n        /**\n         * get transform of the node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Transform}\n         */\n        getTransform: function() {\n            return this._getCache(TRANSFORM, this._getTransform);\n        },\n        _getTransform: function() {\n            var m = new Konva.Transform(),\n                x = this.getX(),\n                y = this.getY(),\n                rotation = Konva.getAngle(this.getRotation()),\n                scaleX = this.getScaleX(),\n                scaleY = this.getScaleY(),\n                skewX = this.getSkewX(),\n                skewY = this.getSkewY(),\n                offsetX = this.getOffsetX(),\n                offsetY = this.getOffsetY();\n\n            if(x !== 0 || y !== 0) {\n                m.translate(x, y);\n            }\n            if(rotation !== 0) {\n                m.rotate(rotation);\n            }\n            if(skewX !== 0 || skewY !== 0) {\n                m.skew(skewX, skewY);\n            }\n            if(scaleX !== 1 || scaleY !== 1) {\n                m.scale(scaleX, scaleY);\n            }\n            if(offsetX !== 0 || offsetY !== 0) {\n                m.translate(-1 * offsetX, -1 * offsetY);\n            }\n\n            return m;\n        },\n        /**\n         * clone node.  Returns a new Node instance with identical attributes.  You can also override\n         *  the node properties with an object literal, enabling you to use an existing node as a template\n         *  for another node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} obj override attrs\n         * @returns {Konva.Node}\n         * @example\n         * // simple clone\n         * var clone = node.clone();\n         *\n         * // clone a node and override the x position\n         * var clone = rect.clone({\n         *   x: 5\n         * });\n         */\n        clone: function(obj) {\n            // instantiate new node\n            var attrs = Konva.Util.cloneObject(this.attrs),\n                key, allListeners, len, n, listener;\n            // filter black attrs\n            for (var i in CLONE_BLACK_LIST) {\n                var blockAttr = CLONE_BLACK_LIST[i];\n                delete attrs[blockAttr];\n            }\n            // apply attr overrides\n            for (key in obj) {\n                attrs[key] = obj[key];\n            }\n\n            var node = new this.constructor(attrs);\n            // copy over listeners\n            for(key in this.eventListeners) {\n                allListeners = this.eventListeners[key];\n                len = allListeners.length;\n                for(n = 0; n < len; n++) {\n                    listener = allListeners[n];\n                    /*\n                     * don't include konva namespaced listeners because\n                     *  these are generated by the constructors\n                     */\n                    if(listener.name.indexOf(KONVA) < 0) {\n                        // if listeners array doesn't exist, then create it\n                        if(!node.eventListeners[key]) {\n                            node.eventListeners[key] = [];\n                        }\n                        node.eventListeners[key].push(listener);\n                    }\n                }\n            }\n            return node;\n        },\n        /**\n         * Creates a composite data URL. If MIME type is not\n         * specified, then \"image/png\" will result. For \"image/jpeg\", specify a quality\n         * level as quality (range 0.0 - 1.0)\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} config\n         * @param {String} [config.mimeType] can be \"image/png\" or \"image/jpeg\".\n         *  \"image/png\" is the default\n         * @param {Number} [config.x] x position of canvas section\n         * @param {Number} [config.y] y position of canvas section\n         * @param {Number} [config.width] width of canvas section\n         * @param {Number} [config.height] height of canvas section\n         * @param {Number} [config.quality] jpeg quality.  If using an \"image/jpeg\" mimeType,\n         *  you can specify the quality from 0 to 1, where 0 is very poor quality and 1\n         *  is very high quality\n         * @paremt {Number} [config.pixelRatio] pixelRatio of ouput image url. Default is 1\n         * @returns {String}\n         */\n        toDataURL: function(config) {\n            config = config || {};\n\n            var mimeType = config.mimeType || null,\n                quality = config.quality || null,\n                stage = this.getStage(),\n                x = config.x || 0,\n                y = config.y || 0,\n                pixelRatio = config.pixelRatio || 1,\n                canvas = new Konva.SceneCanvas({\n                    width: config.width || this.getWidth() || (stage ? stage.getWidth() : 0),\n                    height: config.height || this.getHeight() || (stage ? stage.getHeight() : 0),\n                    pixelRatio: pixelRatio\n                }),\n                context = canvas.getContext();\n\n            context.save();\n\n            if(x || y) {\n                context.translate(-1 * x, -1 * y);\n            }\n\n            this.drawScene(canvas);\n            context.restore();\n\n            return canvas.toDataURL(mimeType, quality);\n        },\n        /**\n         * converts node into an image.  Since the toImage\n         *  method is asynchronous, a callback is required.  toImage is most commonly used\n         *  to cache complex drawings as an image so that they don't have to constantly be redrawn\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {Object} config\n         * @param {Function} config.callback function executed when the composite has completed\n         * @param {String} [config.mimeType] can be \"image/png\" or \"image/jpeg\".\n         *  \"image/png\" is the default\n         * @param {Number} [config.x] x position of canvas section\n         * @param {Number} [config.y] y position of canvas section\n         * @param {Number} [config.width] width of canvas section\n         * @param {Number} [config.height] height of canvas section\n         * @param {Number} [config.quality] jpeg quality.  If using an \"image/jpeg\" mimeType,\n         *  you can specify the quality from 0 to 1, where 0 is very poor quality and 1\n         *  is very high quality\n         * @paremt {Number} [config.pixelRatio] pixelRatio of ouput image.  Default is 1.\n         * @example\n         * var image = node.toImage({\n         *   callback: function(img) {\n         *     // do stuff with img\n         *   }\n         * });\n         */\n        toImage: function(config) {\n            if (!config || !config.callback) {\n                throw 'callback required for toImage method config argument';\n            }\n            Konva.Util._getImage(this.toDataURL(config), function(img) {\n                config.callback(img);\n            });\n        },\n        setSize: function(size) {\n            this.setWidth(size.width);\n            this.setHeight(size.height);\n            return this;\n        },\n        getSize: function() {\n            return {\n                width: this.getWidth(),\n                height: this.getHeight()\n            };\n        },\n        getWidth: function() {\n            return this.attrs.width || 0;\n        },\n        getHeight: function() {\n            return this.attrs.height || 0;\n        },\n        /**\n         * get class name, which may return Stage, Layer, Group, or shape class names like Rect, Circle, Text, etc.\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {String}\n         */\n        getClassName: function() {\n            return this.className || this.nodeType;\n        },\n        /**\n         * get the node type, which may return Stage, Layer, Group, or Node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {String}\n         */\n        getType: function() {\n            return this.nodeType;\n        },\n        getDragDistance: function() {\n            // compare with undefined because we need to track 0 value\n            if (this.attrs.dragDistance !== undefined) {\n                return this.attrs.dragDistance;\n            } else if (this.parent) {\n                return this.parent.getDragDistance();\n            } else {\n                return Konva.dragDistance;\n            }\n        },\n        _get: function(selector) {\n            return this.className === selector || this.nodeType === selector ? [this] : [];\n        },\n        _off: function(type, name) {\n            var evtListeners = this.eventListeners[type],\n                i, evtName;\n\n            for(i = 0; i < evtListeners.length; i++) {\n                evtName = evtListeners[i].name;\n                // the following two conditions must be true in order to remove a handler:\n                // 1) the current event name cannot be konva unless the event name is konva\n                //    this enables developers to force remove a konva specific listener for whatever reason\n                // 2) an event name is not specified, or if one is specified, it matches the current event name\n                if((evtName !== 'konva' || name === 'konva') && (!name || evtName === name)) {\n                    evtListeners.splice(i, 1);\n                    if(evtListeners.length === 0) {\n                        delete this.eventListeners[type];\n                        break;\n                    }\n                    i--;\n                }\n            }\n        },\n        _fireChangeEvent: function(attr, oldVal, newVal) {\n            this._fire(attr + CHANGE, {\n                oldVal: oldVal,\n                newVal: newVal\n            });\n        },\n        setId: function(id) {\n            var oldId = this.getId();\n\n            Konva._removeId(oldId);\n            Konva._addId(this, id);\n            this._setAttr(ID, id);\n            return this;\n        },\n        setName: function(name) {\n            var oldNames = (this.getName() || '').split(/\\s/g);\n            var newNames = (name || '').split(/\\s/g);\n            var subname, i;\n            // remove all subnames\n            for(i = 0; i < oldNames.length; i++) {\n                subname = oldNames[i];\n                if ((newNames.indexOf(subname)) === -1 && subname) {\n                    Konva._removeName(subname, this._id);\n                }\n            }\n\n            // add new names\n            for(i = 0; i < newNames.length; i++) {\n                subname = newNames[i];\n                if ((oldNames.indexOf(subname) === -1) && subname) {\n                    Konva._addName(this, subname);\n                }\n            }\n\n            this._setAttr(NAME, name);\n            return this;\n        },\n        // naming methods\n        /**\n         * add name to node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} name\n         * @returns {Konva.Node}\n         * @example\n         * node.name('red');\n         * node.addName('selected');\n         * node.name(); // return 'red selected'\n         */\n        addName: function(name) {\n            if (!this.hasName(name)) {\n                var oldName = this.name();\n                var newName = oldName ? (oldName + ' ' + name) : name;\n                this.setName(newName);\n            }\n            return this;\n        },\n        /**\n         * check is node has name\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} name\n         * @returns {Boolean}\n         * @example\n         * node.name('red');\n         * node.hasName('red');   // return true\n         * node.hasName('selected'); // return false\n         */\n        hasName: function(name) {\n            var names = (this.name() || '').split(/\\s/g);\n            return names.indexOf(name) !== -1;\n        },\n        /**\n         * remove name from node\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} name\n         * @returns {Konva.Node}\n         * @example\n         * node.name('red selected');\n         * node.removeName('selected');\n         * node.hasName('selected'); // return false\n         * node.name(); // return 'red'\n         */\n        removeName: function(name) {\n            var names = (this.name() || '').split(/\\s/g);\n            var index = names.indexOf(name);\n            if (index !== -1) {\n                names.splice(index, 1);\n                this.setName(names.join(' '));\n            }\n            return this;\n        },\n        /**\n         * set attr\n         * @method\n         * @memberof Konva.Node.prototype\n         * @param {String} attr\n         * @param {*} val\n         * @returns {Konva.Node}\n         * @example\n         * node.setAttr('x', 5);\n         */\n        setAttr: function(attr, val) {\n            var method = SET + Konva.Util._capitalize(attr),\n                func = this[method];\n\n            if(Konva.Util._isFunction(func)) {\n                func.call(this, val);\n            }\n            // otherwise set directly\n            else {\n                this._setAttr(attr, val);\n            }\n            return this;\n        },\n        _setAttr: function(key, val) {\n            var oldVal;\n            oldVal = this.attrs[key];\n            if (oldVal === val) {\n                return;\n            }\n            if (val === undefined || val === null) {\n              delete this.attrs[key];\n            } else {\n              this.attrs[key] = val;\n            }\n            this._fireChangeEvent(key, oldVal, val);\n        },\n        _setComponentAttr: function(key, component, val) {\n            var oldVal;\n            if(val !== undefined) {\n                oldVal = this.attrs[key];\n\n                if (!oldVal) {\n                    // set value to default value using getAttr\n                    this.attrs[key] = this.getAttr(key);\n                }\n\n                this.attrs[key][component] = val;\n                this._fireChangeEvent(key, oldVal, val);\n            }\n        },\n        _fireAndBubble: function(eventType, evt, compareShape) {\n            var okayToRun = true;\n\n            if(evt && this.nodeType === SHAPE) {\n                evt.target = this;\n            }\n\n            if(eventType === MOUSEENTER && compareShape && (this._id === compareShape._id || (this.isAncestorOf && this.isAncestorOf(compareShape)))) {\n                okayToRun = false;\n            }\n            else if(eventType === MOUSELEAVE && compareShape && (this._id === compareShape._id || (this.isAncestorOf && this.isAncestorOf(compareShape)))) {\n                okayToRun = false;\n            }\n            if(okayToRun) {\n                this._fire(eventType, evt);\n\n                // simulate event bubbling\n                var stopBubble =\n                    (eventType === MOUSEENTER || eventType === MOUSELEAVE) &&\n                    ((compareShape && compareShape.isAncestorOf && compareShape.isAncestorOf(this) && !compareShape.isAncestorOf(this.parent)));\n                if((evt && !evt.cancelBubble || !evt) && this.parent && this.parent.isListening() && (!stopBubble)) {\n                    if (compareShape && compareShape.parent) {\n                        this._fireAndBubble.call(this.parent, eventType, evt, compareShape.parent);\n                    }\n                    else {\n                        this._fireAndBubble.call(this.parent, eventType, evt);\n                    }\n                }\n            }\n        },\n        _fire: function(eventType, evt) {\n            var events = this.eventListeners[eventType],\n                i;\n\n            evt = evt || {};\n            evt.currentTarget = this;\n            evt.type = eventType;\n\n            if (events) {\n                for(i = 0; i < events.length; i++) {\n                    events[i].handler.call(this, evt);\n                }\n            }\n        },\n        /**\n         * draw both scene and hit graphs.  If the node being drawn is the stage, all of the layers will be cleared and redrawn\n         * @method\n         * @memberof Konva.Node.prototype\n         * @returns {Konva.Node}\n         */\n        draw: function() {\n            this.drawScene();\n            this.drawHit();\n            return this;\n        }\n    });\n\n    /**\n     * create node with JSON string or an Object.  De-serializtion does not generate custom\n     *  shape drawing functions, images, or event handlers (this would make the\n     *  serialized object huge).  If your app uses custom shapes, images, and\n     *  event handlers (it probably does), then you need to select the appropriate\n     *  shapes after loading the stage and set these properties via on(), setDrawFunc(),\n     *  and setImage() methods\n     * @method\n     * @memberof Konva.Node\n     * @param {String|Object} json string or object\n     * @param {Element} [container] optional container dom element used only if you're\n     *  creating a stage node\n     */\n    Konva.Node.create = function(data, container) {\n        if (Konva.Util._isString(data)) {\n            data = JSON.parse(data);\n        }\n        return this._createNode(data, container);\n    };\n    Konva.Node._createNode = function(obj, container) {\n        var className = Konva.Node.prototype.getClassName.call(obj),\n            children = obj.children,\n            no, len, n;\n\n        // if container was passed in, add it to attrs\n        if(container) {\n            obj.attrs.container = container;\n        }\n\n        no = new Konva[className](obj.attrs);\n        if(children) {\n            len = children.length;\n            for(n = 0; n < len; n++) {\n                no.add(this._createNode(children[n]));\n            }\n        }\n\n        return no;\n    };\n\n\n    // =========================== add getters setters ===========================\n\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'position');\n    /**\n     * get/set node position relative to parent\n     * @name position\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Object} pos\n     * @param {Number} pos.x\n     * @param {Number} pos.y\n     * @returns {Object}\n     * @example\n     * // get position\n     * var position = node.position();\n     *\n     * // set position\n     * node.position({\n     *   x: 5\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'x', 0);\n\n    /**\n     * get/set x position\n     * @name x\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} x\n     * @returns {Object}\n     * @example\n     * // get x\n     * var x = node.x();\n     *\n     * // set x\n     * node.x(5);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'y', 0);\n\n    /**\n     * get/set y position\n     * @name y\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} y\n     * @returns {Integer}\n     * @example\n     * // get y\n     * var y = node.y();\n     *\n     * // set y\n     * node.y(5);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'opacity', 1);\n\n    /**\n     * get/set opacity.  Opacity values range from 0 to 1.\n     *  A node with an opacity of 0 is fully transparent, and a node\n     *  with an opacity of 1 is fully opaque\n     * @name opacity\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Object} opacity\n     * @returns {Number}\n     * @example\n     * // get opacity\n     * var opacity = node.opacity();\n     *\n     * // set opacity\n     * node.opacity(0.5);\n     */\n\n    Konva.Factory.addGetter(Konva.Node, 'name');\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'name');\n\n    /**\n     * get/set name\n     * @name name\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {String} name\n     * @returns {String}\n     * @example\n     * // get name\n     * var name = node.name();\n     *\n     * // set name\n     * node.name('foo');\n     *\n     * // also node may have multiple names (as css classes)\n     * node.name('foo bar');\n     */\n\n    Konva.Factory.addGetter(Konva.Node, 'id');\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'id');\n\n    /**\n     * get/set id. Id is global for whole page.\n     * @name id\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {String} id\n     * @returns {String}\n     * @example\n     * // get id\n     * var name = node.id();\n     *\n     * // set id\n     * node.id('foo');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'rotation', 0);\n\n    /**\n     * get/set rotation in degrees\n     * @name rotation\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} rotation\n     * @returns {Number}\n     * @example\n     * // get rotation in degrees\n     * var rotation = node.rotation();\n     *\n     * // set rotation in degrees\n     * node.rotation(45);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Node, 'scale', ['x', 'y']);\n\n    /**\n     * get/set scale\n     * @name scale\n     * @param {Object} scale\n     * @param {Number} scale.x\n     * @param {Number} scale.y\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Object}\n     * @example\n     * // get scale\n     * var scale = node.scale();\n     *\n     * // set scale\n     * shape.scale({\n     *   x: 2\n     *   y: 3\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'scaleX', 1);\n\n    /**\n     * get/set scale x\n     * @name scaleX\n     * @param {Number} x\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Number}\n     * @example\n     * // get scale x\n     * var scaleX = node.scaleX();\n     *\n     * // set scale x\n     * node.scaleX(2);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'scaleY', 1);\n\n    /**\n     * get/set scale y\n     * @name scaleY\n     * @param {Number} y\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Number}\n     * @example\n     * // get scale y\n     * var scaleY = node.scaleY();\n     *\n     * // set scale y\n     * node.scaleY(2);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Node, 'skew', ['x', 'y']);\n\n    /**\n     * get/set skew\n     * @name skew\n     * @param {Object} skew\n     * @param {Number} skew.x\n     * @param {Number} skew.y\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Object}\n     * @example\n     * // get skew\n     * var skew = node.skew();\n     *\n     * // set skew\n     * node.skew({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'skewX', 0);\n\n    /**\n     * get/set skew x\n     * @name skewX\n     * @param {Number} x\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Number}\n     * @example\n     * // get skew x\n     * var skewX = node.skewX();\n     *\n     * // set skew x\n     * node.skewX(3);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'skewY', 0);\n\n    /**\n     * get/set skew y\n     * @name skewY\n     * @param {Number} y\n     * @method\n     * @memberof Konva.Node.prototype\n     * @returns {Number}\n     * @example\n     * // get skew y\n     * var skewY = node.skewY();\n     *\n     * // set skew y\n     * node.skewY(3);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Node, 'offset', ['x', 'y']);\n\n    /**\n     * get/set offset.  Offsets the default position and rotation point\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Object} offset\n     * @param {Number} offset.x\n     * @param {Number} offset.y\n     * @returns {Object}\n     * @example\n     * // get offset\n     * var offset = node.offset();\n     *\n     * // set offset\n     * node.offset({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'offsetX', 0);\n\n    /**\n     * get/set offset x\n     * @name offsetX\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get offset x\n     * var offsetX = node.offsetX();\n     *\n     * // set offset x\n     * node.offsetX(3);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'offsetY', 0);\n\n    /**\n     * get/set offset y\n     * @name offsetY\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get offset y\n     * var offsetY = node.offsetY();\n     *\n     * // set offset y\n     * node.offsetY(3);\n     */\n\n    Konva.Factory.addSetter(Konva.Node, 'dragDistance');\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'dragDistance');\n\n    /**\n     * get/set drag distance\n     * @name dragDistance\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} distance\n     * @returns {Number}\n     * @example\n     * // get drag distance\n     * var dragDistance = node.dragDistance();\n     *\n     * // set distance\n     * // node starts dragging only if pointer moved more then 3 pixels\n     * node.dragDistance(3);\n     * // or set globally\n     * Konva.dragDistance = 3;\n     */\n\n\n    Konva.Factory.addSetter(Konva.Node, 'width', 0);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'width');\n    /**\n     * get/set width\n     * @name width\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} width\n     * @returns {Number}\n     * @example\n     * // get width\n     * var width = node.width();\n     *\n     * // set width\n     * node.width(100);\n     */\n\n    Konva.Factory.addSetter(Konva.Node, 'height', 0);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'height');\n    /**\n     * get/set height\n     * @name height\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Number} height\n     * @returns {Number}\n     * @example\n     * // get height\n     * var height = node.height();\n     *\n     * // set height\n     * node.height(100);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'listening', 'inherit');\n    /**\n     * get/set listenig attr.  If you need to determine if a node is listening or not\n     *   by taking into account its parents, use the isListening() method\n     * @name listening\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Boolean|String} listening Can be \"inherit\", true, or false.  The default is \"inherit\".\n     * @returns {Boolean|String}\n     * @example\n     * // get listening attr\n     * var listening = node.listening();\n     *\n     * // stop listening for events\n     * node.listening(false);\n     *\n     * // listen for events\n     * node.listening(true);\n     *\n     * // listen to events according to the parent\n     * node.listening('inherit');\n     */\n\n\n\n     /**\n      * get/set preventDefault\n      * By default all shapes will prevent default behaviour\n      * of a browser on a pointer move or tap.\n      * that will prevent native scrolling when you are trying to drag&drop a node\n      * but sometimes you may need to enable default actions\n      * in that case you can set the property to false\n      * @name preventDefault\n      * @method\n      * @memberof Konva.Node.prototype\n      * @param {Number} preventDefault\n      * @returns {Number}\n      * @example\n      * // get preventDefault\n      * var shouldPrevent = shape.preventDefault();\n      *\n      * // set preventDefault\n      * shape.preventDefault(false);\n      */\n\n     Konva.Factory.addGetterSetter(Konva.Node, 'preventDefault', true);\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'filters', undefined, function(val) {this._filterUpToDate = false; return val; });\n    /**\n     * get/set filters.  Filters are applied to cached canvases\n     * @name filters\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Array} filters array of filters\n     * @returns {Array}\n     * @example\n     * // get filters\n     * var filters = node.filters();\n     *\n     * // set a single filter\n     * node.cache();\n     * node.filters([Konva.Filters.Blur]);\n     *\n     * // set multiple filters\n     * node.cache();\n     * node.filters([\n     *   Konva.Filters.Blur,\n     *   Konva.Filters.Sepia,\n     *   Konva.Filters.Invert\n     * ]);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'visible', 'inherit');\n    /**\n     * get/set visible attr.  Can be \"inherit\", true, or false.  The default is \"inherit\".\n     *   If you need to determine if a node is visible or not\n     *   by taking into account its parents, use the isVisible() method\n     * @name visible\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Boolean|String} visible\n     * @returns {Boolean|String}\n     * @example\n     * // get visible attr\n     * var visible = node.visible();\n     *\n     * // make invisible\n     * node.visible(false);\n     *\n     * // make visible\n     * node.visible(true);\n     *\n     * // make visible according to the parent\n     * node.visible('inherit');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'transformsEnabled', 'all');\n\n    /**\n     * get/set transforms that are enabled.  Can be \"all\", \"none\", or \"position\".  The default\n     *  is \"all\"\n     * @name transformsEnabled\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {String} enabled\n     * @returns {String}\n     * @example\n     * // enable position transform only to improve draw performance\n     * node.transformsEnabled('position');\n     *\n     * // enable all transforms\n     * node.transformsEnabled('all');\n     */\n\n\n\n    /**\n     * get/set node size\n     * @name size\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Object} size\n     * @param {Number} size.width\n     * @param {Number} size.height\n     * @returns {Object}\n     * @example\n     * // get node size\n     * var size = node.size();\n     * var x = size.x;\n     * var y = size.y;\n     *\n     * // set size\n     * node.size({\n     *   width: 100,\n     *   height: 200\n     * });\n     */\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'size');\n\n    Konva.Factory.backCompat(Konva.Node, {\n        rotateDeg: 'rotate',\n        setRotationDeg: 'setRotation',\n        getRotationDeg: 'getRotation'\n    });\n\n    Konva.Collection.mapMethods(Konva.Node);\n})(Konva);\n\n(function() {\r\n    'use strict';\r\n    /**\r\n    * Grayscale Filter\r\n    * @function\r\n    * @memberof Konva.Filters\r\n    * @param {Object} imageData\r\n    * @example\r\n    * node.cache();\r\n    * node.filters([Konva.Filters.Grayscale]);\r\n    */\r\n    Konva.Filters.Grayscale = function(imageData) {\r\n        var data = imageData.data,\r\n            len = data.length,\r\n            i, brightness;\r\n\r\n        for(i = 0; i < len; i += 4) {\r\n            brightness = 0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2];\r\n            // red\r\n            data[i] = brightness;\r\n            // green\r\n            data[i + 1] = brightness;\r\n            // blue\r\n            data[i + 2] = brightness;\r\n        }\r\n    };\r\n})();\r\n\n(function() {\n    'use strict';\n    /**\n     * Brighten Filter.\n     * @function\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Brighten]);\n     * node.brightness(0.8);\n     */\n    Konva.Filters.Brighten = function(imageData) {\n        var brightness = this.brightness() * 255,\n            data = imageData.data,\n            len = data.length,\n            i;\n\n        for(i = 0; i < len; i += 4) {\n            // red\n            data[i] += brightness;\n            // green\n            data[i + 1] += brightness;\n            // blue\n            data[i + 2] += brightness;\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'brightness', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set filter brightness.  The brightness is a number between -1 and 1.&nbsp; Positive values\n    *  brighten the pixels and negative values darken them. Use with {@link Konva.Filters.Brighten} filter.\n    * @name brightness\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} brightness value between -1 and 1\n    * @returns {Number}\n    */\n\n})();\n\n(function() {\r\n    'use strict';\r\n    /**\r\n    * Invert Filter\r\n    * @function\r\n    * @memberof Konva.Filters\r\n    * @param {Object} imageData\r\n    * @example\r\n    * node.cache();\r\n    * node.filters([Konva.Filters.Invert]);\r\n    */\r\n    Konva.Filters.Invert = function(imageData) {\r\n        var data = imageData.data,\r\n            len = data.length,\r\n            i;\r\n\r\n        for(i = 0; i < len; i += 4) {\r\n            // red\r\n            data[i] = 255 - data[i];\r\n            // green\r\n            data[i + 1] = 255 - data[i + 1];\r\n            // blue\r\n            data[i + 2] = 255 - data[i + 2];\r\n        }\r\n    };\r\n})();\r\n\n/*\n the Gauss filter\n master repo: https://github.com/pavelpower/kineticjsGaussFilter\n*/\n(function() {\n    'use strict';\n    /*\n\n     StackBlur - a fast almost Gaussian Blur For Canvas\n\n     Version:   0.5\n     Author:    Mario Klingemann\n     Contact:   mario@quasimondo.com\n     Website:   http://www.quasimondo.com/StackBlurForCanvas\n     Twitter:   @quasimondo\n\n     In case you find this class useful - especially in commercial projects -\n     I am not totally unhappy for a small donation to my PayPal account\n     mario@quasimondo.de\n\n     Or support me on flattr:\n     https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\n     Copyright (c) 2010 Mario Klingemann\n\n     Permission is hereby granted, free of charge, to any person\n     obtaining a copy of this software and associated documentation\n     files (the \"Software\"), to deal in the Software without\n     restriction, including without limitation the rights to use,\n     copy, modify, merge, publish, distribute, sublicense, and/or sell\n     copies of the Software, and to permit persons to whom the\n     Software is furnished to do so, subject to the following\n     conditions:\n\n     The above copyright notice and this permission notice shall be\n     included in all copies or substantial portions of the Software.\n\n     THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n     EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n     OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n     NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n     HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n     WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n     FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n     OTHER DEALINGS IN THE SOFTWARE.\n     */\n\n    function BlurStack() {\n        this.r = 0;\n        this.g = 0;\n        this.b = 0;\n        this.a = 0;\n        this.next = null;\n    }\n\n    var mul_table = [\n        512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512,\n        454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512,\n        482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456,\n        437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512,\n        497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328,\n        320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456,\n        446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335,\n        329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512,\n        505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405,\n        399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328,\n        324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271,\n        268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456,\n        451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388,\n        385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335,\n        332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292,\n        289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259\n    ];\n\n    var shg_table = [\n        9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17,\n        17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19,\n        19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20,\n        20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,\n        21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,\n        21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22,\n        22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,\n        22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23,\n        23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n        23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n        23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n        23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n        24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n        24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n        24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n        24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24\n    ];\n\n    function filterGaussBlurRGBA( imageData, radius) {\n\n        var pixels = imageData.data,\n            width = imageData.width,\n            height = imageData.height;\n\n        var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum,\n            r_out_sum, g_out_sum, b_out_sum, a_out_sum,\n            r_in_sum, g_in_sum, b_in_sum, a_in_sum,\n            pr, pg, pb, pa, rbs;\n\n        var div = radius + radius + 1,\n            widthMinus1 = width - 1,\n            heightMinus1 = height - 1,\n            radiusPlus1 = radius + 1,\n            sumFactor = radiusPlus1 * ( radiusPlus1 + 1 ) / 2,\n            stackStart = new BlurStack(),\n            stackEnd = null,\n            stack = stackStart,\n            stackIn = null,\n            stackOut = null,\n            mul_sum = mul_table[radius],\n            shg_sum = shg_table[radius];\n\n        for ( i = 1; i < div; i++ ) {\n            stack = stack.next = new BlurStack();\n            if ( i === radiusPlus1 ){\n                stackEnd = stack;\n            }\n        }\n\n        stack.next = stackStart;\n\n        yw = yi = 0;\n\n        for ( y = 0; y < height; y++ )\n        {\n            r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;\n\n            r_out_sum = radiusPlus1 * ( pr = pixels[yi] );\n            g_out_sum = radiusPlus1 * ( pg = pixels[yi + 1] );\n            b_out_sum = radiusPlus1 * ( pb = pixels[yi + 2] );\n            a_out_sum = radiusPlus1 * ( pa = pixels[yi + 3] );\n\n            r_sum += sumFactor * pr;\n            g_sum += sumFactor * pg;\n            b_sum += sumFactor * pb;\n            a_sum += sumFactor * pa;\n\n            stack = stackStart;\n\n            for( i = 0; i < radiusPlus1; i++ )\n            {\n                stack.r = pr;\n                stack.g = pg;\n                stack.b = pb;\n                stack.a = pa;\n                stack = stack.next;\n            }\n\n            for( i = 1; i < radiusPlus1; i++ )\n            {\n                p = yi + (( widthMinus1 < i ? widthMinus1 : i ) << 2 );\n                r_sum += ( stack.r = ( pr = pixels[p])) * ( rbs = radiusPlus1 - i );\n                g_sum += ( stack.g = ( pg = pixels[p + 1])) * rbs;\n                b_sum += ( stack.b = ( pb = pixels[p + 2])) * rbs;\n                a_sum += ( stack.a = ( pa = pixels[p + 3])) * rbs;\n\n                r_in_sum += pr;\n                g_in_sum += pg;\n                b_in_sum += pb;\n                a_in_sum += pa;\n\n                stack = stack.next;\n            }\n\n\n            stackIn = stackStart;\n            stackOut = stackEnd;\n            for ( x = 0; x < width; x++ )\n            {\n                pixels[yi + 3] = pa = (a_sum * mul_sum) >> shg_sum;\n                if ( pa !== 0 )\n                {\n                    pa = 255 / pa;\n                    pixels[yi] = ((r_sum * mul_sum) >> shg_sum) * pa;\n                    pixels[yi + 1] = ((g_sum * mul_sum) >> shg_sum) * pa;\n                    pixels[yi + 2] = ((b_sum * mul_sum) >> shg_sum) * pa;\n                } else {\n                    pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n                }\n\n                r_sum -= r_out_sum;\n                g_sum -= g_out_sum;\n                b_sum -= b_out_sum;\n                a_sum -= a_out_sum;\n\n                r_out_sum -= stackIn.r;\n                g_out_sum -= stackIn.g;\n                b_out_sum -= stackIn.b;\n                a_out_sum -= stackIn.a;\n\n                p = (yw + ( ( p = x + radius + 1 ) < widthMinus1 ? p : widthMinus1 ) ) << 2;\n\n                r_in_sum += ( stackIn.r = pixels[p]);\n                g_in_sum += ( stackIn.g = pixels[p + 1]);\n                b_in_sum += ( stackIn.b = pixels[p + 2]);\n                a_in_sum += ( stackIn.a = pixels[p + 3]);\n\n                r_sum += r_in_sum;\n                g_sum += g_in_sum;\n                b_sum += b_in_sum;\n                a_sum += a_in_sum;\n\n                stackIn = stackIn.next;\n\n                r_out_sum += ( pr = stackOut.r );\n                g_out_sum += ( pg = stackOut.g );\n                b_out_sum += ( pb = stackOut.b );\n                a_out_sum += ( pa = stackOut.a );\n\n                r_in_sum -= pr;\n                g_in_sum -= pg;\n                b_in_sum -= pb;\n                a_in_sum -= pa;\n\n                stackOut = stackOut.next;\n\n                yi += 4;\n            }\n            yw += width;\n        }\n\n\n        for ( x = 0; x < width; x++ )\n        {\n            g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;\n\n            yi = x << 2;\n            r_out_sum = radiusPlus1 * ( pr = pixels[yi]);\n            g_out_sum = radiusPlus1 * ( pg = pixels[yi + 1]);\n            b_out_sum = radiusPlus1 * ( pb = pixels[yi + 2]);\n            a_out_sum = radiusPlus1 * ( pa = pixels[yi + 3]);\n\n            r_sum += sumFactor * pr;\n            g_sum += sumFactor * pg;\n            b_sum += sumFactor * pb;\n            a_sum += sumFactor * pa;\n\n            stack = stackStart;\n\n            for( i = 0; i < radiusPlus1; i++ )\n            {\n                stack.r = pr;\n                stack.g = pg;\n                stack.b = pb;\n                stack.a = pa;\n                stack = stack.next;\n            }\n\n            yp = width;\n\n            for( i = 1; i <= radius; i++ )\n            {\n                yi = ( yp + x ) << 2;\n\n                r_sum += ( stack.r = ( pr = pixels[yi])) * ( rbs = radiusPlus1 - i );\n                g_sum += ( stack.g = ( pg = pixels[yi + 1])) * rbs;\n                b_sum += ( stack.b = ( pb = pixels[yi + 2])) * rbs;\n                a_sum += ( stack.a = ( pa = pixels[yi + 3])) * rbs;\n\n                r_in_sum += pr;\n                g_in_sum += pg;\n                b_in_sum += pb;\n                a_in_sum += pa;\n\n                stack = stack.next;\n\n                if( i < heightMinus1 )\n                {\n                    yp += width;\n                }\n            }\n\n            yi = x;\n            stackIn = stackStart;\n            stackOut = stackEnd;\n            for ( y = 0; y < height; y++ )\n            {\n                p = yi << 2;\n                pixels[p + 3] = pa = (a_sum * mul_sum) >> shg_sum;\n                if ( pa > 0 )\n                {\n                    pa = 255 / pa;\n                    pixels[p] = ((r_sum * mul_sum) >> shg_sum ) * pa;\n                    pixels[p + 1] = ((g_sum * mul_sum) >> shg_sum ) * pa;\n                    pixels[p + 2] = ((b_sum * mul_sum) >> shg_sum ) * pa;\n                } else {\n                    pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;\n                }\n\n                r_sum -= r_out_sum;\n                g_sum -= g_out_sum;\n                b_sum -= b_out_sum;\n                a_sum -= a_out_sum;\n\n                r_out_sum -= stackIn.r;\n                g_out_sum -= stackIn.g;\n                b_out_sum -= stackIn.b;\n                a_out_sum -= stackIn.a;\n\n                p = ( x + (( ( p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1 ) * width )) << 2;\n\n                r_sum += ( r_in_sum += ( stackIn.r = pixels[p]));\n                g_sum += ( g_in_sum += ( stackIn.g = pixels[p + 1]));\n                b_sum += ( b_in_sum += ( stackIn.b = pixels[p + 2]));\n                a_sum += ( a_in_sum += ( stackIn.a = pixels[p + 3]));\n\n                stackIn = stackIn.next;\n\n                r_out_sum += ( pr = stackOut.r );\n                g_out_sum += ( pg = stackOut.g );\n                b_out_sum += ( pb = stackOut.b );\n                a_out_sum += ( pa = stackOut.a );\n\n                r_in_sum -= pr;\n                g_in_sum -= pg;\n                b_in_sum -= pb;\n                a_in_sum -= pa;\n\n                stackOut = stackOut.next;\n\n                yi += width;\n            }\n        }\n    }\n\n    /**\n     * Blur Filter\n     * @function\n     * @name Blur\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Blur]);\n     * node.blurRadius(10);\n     */\n    Konva.Filters.Blur = function Blur(imageData) {\n        var radius = Math.round(this.blurRadius());\n\n        if (radius > 0) {\n            filterGaussBlurRGBA(imageData, radius);\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'blurRadius', 0, null, Konva.Factory.afterSetFilter);\n\n    /**\n    * get/set blur radius. Use with {@link Konva.Filters.Blur} filter\n    * @name blurRadius\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} radius\n    * @returns {Integer}\n    */\n})();\n\n/*eslint-disable  max-depth */\n(function() {\n\t'use strict';\n\tfunction pixelAt(idata, x, y) {\n\t\tvar idx = (y * idata.width + x) * 4;\n\t\tvar d = [];\n\t\td.push(idata.data[idx++], idata.data[idx++], idata.data[idx++], idata.data[idx++]);\n\t\treturn d;\n\t}\n\n\tfunction rgbDistance(p1, p2) {\n\t\treturn Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2) + Math.pow(p1[2] - p2[2], 2));\n\t}\n\n\tfunction rgbMean(pTab) {\n\t\tvar m = [0, 0, 0];\n\n\t\tfor (var i = 0; i < pTab.length; i++) {\n\t\t\tm[0] += pTab[i][0];\n\t\t\tm[1] += pTab[i][1];\n\t\t\tm[2] += pTab[i][2];\n\t\t}\n\n\t\tm[0] /= pTab.length;\n\t\tm[1] /= pTab.length;\n\t\tm[2] /= pTab.length;\n\n\t\treturn m;\n\t}\n\n\tfunction backgroundMask(idata, threshold) {\n\t\tvar rgbv_no = pixelAt(idata, 0, 0);\n\t\tvar rgbv_ne = pixelAt(idata, idata.width - 1, 0);\n\t\tvar rgbv_so = pixelAt(idata, 0, idata.height - 1);\n\t\tvar rgbv_se = pixelAt(idata, idata.width - 1, idata.height - 1);\n\n\n\t\tvar thres = threshold || 10;\n\t\tif (rgbDistance(rgbv_no, rgbv_ne) < thres && rgbDistance(rgbv_ne, rgbv_se) < thres && rgbDistance(rgbv_se, rgbv_so) < thres && rgbDistance(rgbv_so, rgbv_no) < thres) {\n\n\t\t\t// Mean color\n\t\t\tvar mean = rgbMean([rgbv_ne, rgbv_no, rgbv_se, rgbv_so]);\n\n\t\t\t// Mask based on color distance\n\t\t\tvar mask = [];\n\t\t\tfor (var i = 0; i < idata.width * idata.height; i++) {\n\t\t\t\tvar d = rgbDistance(mean, [idata.data[i * 4], idata.data[i * 4 + 1], idata.data[i * 4 + 2]]);\n\t\t\t\tmask[i] = (d < thres) ? 0 : 255;\n\t\t\t}\n\n\t\t\treturn mask;\n\t\t}\n\t}\n\n\tfunction applyMask(idata, mask) {\n\t\tfor (var i = 0; i < idata.width * idata.height; i++) {\n\t\t\tidata.data[4 * i + 3] = mask[i];\n\t\t}\n\t}\n\n\tfunction erodeMask(mask, sw, sh) {\n\n\t\tvar weights = [1, 1, 1, 1, 0, 1, 1, 1, 1];\n\t\tvar side = Math.round(Math.sqrt(weights.length));\n\t\tvar halfSide = Math.floor(side / 2);\n\n\t\tvar maskResult = [];\n\t\tfor (var y = 0; y < sh; y++) {\n\t\t\tfor (var x = 0; x < sw; x++) {\n\n\t\t\t\tvar so = y * sw + x;\n\t\t\t\tvar a = 0;\n\t\t\t\tfor (var cy = 0; cy < side; cy++) {\n\t\t\t\t\tfor (var cx = 0; cx < side; cx++) {\n\t\t\t\t\t\tvar scy = y + cy - halfSide;\n\t\t\t\t\t\tvar scx = x + cx - halfSide;\n\n\t\t\t\t\t\tif (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n\n\t\t\t\t\t\t\tvar srcOff = scy * sw + scx;\n\t\t\t\t\t\t\tvar wt = weights[cy * side + cx];\n\n\t\t\t\t\t\t\ta += mask[srcOff] * wt;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmaskResult[so] = (a === 255 * 8) ? 255 : 0;\n\t\t\t}\n\t\t}\n\n\t\treturn maskResult;\n\t}\n\n\tfunction dilateMask(mask, sw, sh) {\n\n\t\tvar weights = [1, 1, 1, 1, 1, 1, 1, 1, 1];\n\t\tvar side = Math.round(Math.sqrt(weights.length));\n\t\tvar halfSide = Math.floor(side / 2);\n\n\t\tvar maskResult = [];\n\t\tfor (var y = 0; y < sh; y++) {\n\t\t\tfor (var x = 0; x < sw; x++) {\n\n\t\t\t\tvar so = y * sw + x;\n\t\t\t\tvar a = 0;\n\t\t\t\tfor (var cy = 0; cy < side; cy++) {\n\t\t\t\t\tfor (var cx = 0; cx < side; cx++) {\n\t\t\t\t\t\tvar scy = y + cy - halfSide;\n\t\t\t\t\t\tvar scx = x + cx - halfSide;\n\n\t\t\t\t\t\tif (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n\n\t\t\t\t\t\t\tvar srcOff = scy * sw + scx;\n\t\t\t\t\t\t\tvar wt = weights[cy * side + cx];\n\n\t\t\t\t\t\t\ta += mask[srcOff] * wt;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmaskResult[so] = (a >= 255 * 4) ? 255 : 0;\n\t\t\t}\n\t\t}\n\n\t\treturn maskResult;\n\t}\n\n\tfunction smoothEdgeMask(mask, sw, sh) {\n\n\t\tvar weights = [1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9];\n\t\tvar side = Math.round(Math.sqrt(weights.length));\n\t\tvar halfSide = Math.floor(side / 2);\n\n\t\tvar maskResult = [];\n\t\tfor (var y = 0; y < sh; y++) {\n\t\t\tfor (var x = 0; x < sw; x++) {\n\n\t\t\t\tvar so = y * sw + x;\n\t\t\t\tvar a = 0;\n\t\t\t\tfor (var cy = 0; cy < side; cy++) {\n\t\t\t\t\tfor (var cx = 0; cx < side; cx++) {\n\t\t\t\t\t\tvar scy = y + cy - halfSide;\n\t\t\t\t\t\tvar scx = x + cx - halfSide;\n\n\t\t\t\t\t\tif (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n\n\t\t\t\t\t\t\tvar srcOff = scy * sw + scx;\n\t\t\t\t\t\t\tvar wt = weights[cy * side + cx];\n\n\t\t\t\t\t\t\ta += mask[srcOff] * wt;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmaskResult[so] = a;\n\t\t\t}\n\t\t}\n\n\t\treturn maskResult;\n\t}\n\n\t/**\n\t * Mask Filter\n\t * @function\n\t * @name Mask\n\t * @memberof Konva.Filters\n\t * @param {Object} imageData\n\t * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Mask]);\n     * node.threshold(200);\n\t */\n\tKonva.Filters.Mask = function(imageData) {\n\t\t// Detect pixels close to the background color\n\t\tvar threshold = this.threshold(),\n        mask = backgroundMask(imageData, threshold);\n\t\tif (mask) {\n\t\t\t// Erode\n\t\t\tmask = erodeMask(mask, imageData.width, imageData.height);\n\n\t\t\t// Dilate\n\t\t\tmask = dilateMask(mask, imageData.width, imageData.height);\n\n\t\t\t// Gradient\n\t\t\tmask = smoothEdgeMask(mask, imageData.width, imageData.height);\n\n\t\t\t// Apply mask\n\t\t\tapplyMask(imageData, mask);\n\n\t\t\t// todo : Update hit region function according to mask\n\t\t}\n\n\t\treturn imageData;\n\t};\n\n\tKonva.Factory.addGetterSetter(Konva.Node, 'threshold', 0, null, Konva.Factory.afterSetFilter);\n})();\n\n(function () {\n    'use strict';\n    /**\n     * RGB Filter\n     * @function\n     * @name RGB\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @author ippo615\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.RGB]);\n     * node.blue(120);\n     * node.green(200);\n     */\n    Konva.Filters.RGB = function (imageData) {\n        var data = imageData.data,\n            nPixels = data.length,\n            red = this.red(),\n            green = this.green(),\n            blue = this.blue(),\n            i, brightness;\n\n        for (i = 0; i < nPixels; i += 4) {\n            brightness = (0.34 * data[i] + 0.5 * data[i + 1] + 0.16 * data[i + 2]) / 255;\n            data[i] = brightness * red; // r\n            data[i + 1] = brightness * green; // g\n            data[i + 2] = brightness * blue; // b\n            data[i + 3] = data[i + 3]; // alpha\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'red', 0, function(val) {\n        this._filterUpToDate = false;\n        if (val > 255) {\n            return 255;\n        }\n        else if (val < 0) {\n            return 0;\n        }\n        else {\n            return Math.round(val);\n        }\n    });\n    /**\n    * get/set filter red value. Use with {@link Konva.Filters.RGB} filter.\n    * @name red\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} red value between 0 and 255\n    * @returns {Integer}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'green', 0, function(val) {\n        this._filterUpToDate = false;\n        if (val > 255) {\n            return 255;\n        }\n        else if (val < 0) {\n            return 0;\n        }\n        else {\n            return Math.round(val);\n        }\n    });\n    /**\n    * get/set filter green value. Use with {@link Konva.Filters.RGB} filter.\n    * @name green\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} green value between 0 and 255\n    * @returns {Integer}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'blue', 0, Konva.Validators.RGBComponent, Konva.Factory.afterSetFilter);\n    /**\n    * get/set filter blue value. Use with {@link Konva.Filters.RGB} filter.\n    * @name blue\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} blue value between 0 and 255\n    * @returns {Integer}\n    */\n})();\n\n(function () {\n    'use strict';\n    /**\n     * RGBA Filter\n     * @function\n     * @name RGBA\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @author codefo\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.RGBA]);\n     * node.blue(120);\n     * node.green(200);\n     * node.alpha(0.3);\n     */\n    Konva.Filters.RGBA = function (imageData) {\n        var data = imageData.data,\n            nPixels = data.length,\n            red = this.red(),\n            green = this.green(),\n            blue = this.blue(),\n            alpha = this.alpha(),\n            i, ia;\n\n        for (i = 0; i < nPixels; i += 4) {\n            ia = 1 - alpha;\n\n            data[i] = red * alpha + data[i] * ia; // r\n            data[i + 1] = green * alpha + data[i + 1] * ia; // g\n            data[i + 2] = blue * alpha + data[i + 2] * ia; // b\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'red', 0, function(val) {\n        this._filterUpToDate = false;\n        if (val > 255) {\n            return 255;\n        }\n        else if (val < 0) {\n            return 0;\n        }\n        else {\n            return Math.round(val);\n        }\n    });\n    /**\n    * get/set filter red value. Use with {@link Konva.Filters.RGBA} filter.\n    * @name red\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} red value between 0 and 255\n    * @returns {Integer}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'green', 0, function(val) {\n        this._filterUpToDate = false;\n        if (val > 255) {\n            return 255;\n        }\n        else if (val < 0) {\n            return 0;\n        }\n        else {\n            return Math.round(val);\n        }\n    });\n    /**\n    * get/set filter green value. Use with {@link Konva.Filters.RGBA} filter.\n    * @name green\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} green value between 0 and 255\n    * @returns {Integer}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'blue', 0, Konva.Validators.RGBComponent, Konva.Factory.afterSetFilter);\n    /**\n    * get/set filter blue value. Use with {@link Konva.Filters.RGBA} filter.\n    * @name blue\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} blue value between 0 and 255\n    * @returns {Integer}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'alpha', 1, function(val) {\n        this._filterUpToDate = false;\n        if (val > 1) {\n            return 1;\n        }\n        else if (val < 0) {\n            return 0;\n        }\n        else {\n            return val;\n        }\n    });\n    /**\n     * get/set filter alpha value. Use with {@link Konva.Filters.RGBA} filter.\n     * @name alpha\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Float} alpha value between 0 and 1\n     * @returns {Float}\n     */\n})();\n\n(function () {\n    'use strict';\n    /**\n    * HSV Filter. Adjusts the hue, saturation and value\n    * @function\n    * @name HSV\n    * @memberof Konva.Filters\n    * @param {Object} imageData\n    * @author ippo615\n    * @example\n    * image.filters([Konva.Filters.HSV]);\n    * image.value(200);\n    */\n\n    Konva.Filters.HSV = function (imageData) {\n        var data = imageData.data,\n            nPixels = data.length,\n            v = Math.pow(2, this.value()),\n            s = Math.pow(2, this.saturation()),\n            h = Math.abs((this.hue()) + 360) % 360,\n            i;\n\n        // Basis for the technique used:\n        // http://beesbuzz.biz/code/hsv_color_transforms.php\n        // V is the value multiplier (1 for none, 2 for double, 0.5 for half)\n        // S is the saturation multiplier (1 for none, 2 for double, 0.5 for half)\n        // H is the hue shift in degrees (0 to 360)\n        // vsu = V*S*cos(H*PI/180);\n        // vsw = V*S*sin(H*PI/180);\n        //[ .299V+.701vsu+.168vsw    .587V-.587vsu+.330vsw    .114V-.114vsu-.497vsw ] [R]\n        //[ .299V-.299vsu-.328vsw    .587V+.413vsu+.035vsw    .114V-.114vsu+.292vsw ]*[G]\n        //[ .299V-.300vsu+1.25vsw    .587V-.588vsu-1.05vsw    .114V+.886vsu-.203vsw ] [B]\n\n        // Precompute the values in the matrix:\n        var vsu = v * s * Math.cos(h * Math.PI / 180),\n            vsw = v * s * Math.sin(h * Math.PI / 180);\n        // (result spot)(source spot)\n        var rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw,\n            rg = 0.587 * v - 0.587 * vsu + 0.330 * vsw,\n            rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;\n        var gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw,\n            gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw,\n            gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;\n        var br = 0.299 * v - 0.300 * vsu + 1.250 * vsw,\n            bg = 0.587 * v - 0.586 * vsu - 1.050 * vsw,\n            bb = 0.114 * v + 0.886 * vsu - 0.200 * vsw;\n\n        var r, g, b, a;\n\n        for (i = 0; i < nPixels; i += 4) {\n            r = data[i + 0];\n            g = data[i + 1];\n            b = data[i + 2];\n            a = data[i + 3];\n\n            data[i + 0] = rr * r + rg * g + rb * b;\n            data[i + 1] = gr * r + gg * g + gb * b;\n            data[i + 2] = br * r + bg * g + bb * b;\n            data[i + 3] = a; // alpha\n        }\n\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'hue', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsv hue in degrees. Use with {@link Konva.Filters.HSV} or {@link Konva.Filters.HSL} filter.\n    * @name hue\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} hue value between 0 and 359\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'saturation', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsv saturation. Use with {@link Konva.Filters.HSV} or {@link Konva.Filters.HSL} filter.\n    * @name saturation\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} saturation 0 is no change, -1.0 halves the saturation, 1.0 doubles, etc..\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'value', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsv value. Use with {@link Konva.Filters.HSV} filter.\n    * @name value\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} value 0 is no change, -1.0 halves the value, 1.0 doubles, etc..\n    * @returns {Number}\n    */\n\n})();\n\n(function () {\n    'use strict';\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'hue', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsv hue in degrees. Use with {@link Konva.Filters.HSV} or {@link Konva.Filters.HSL} filter.\n    * @name hue\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} hue value between 0 and 359\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'saturation', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsv saturation. Use with {@link Konva.Filters.HSV} or {@link Konva.Filters.HSL} filter.\n    * @name saturation\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} saturation 0 is no change, -1.0 halves the saturation, 1.0 doubles, etc..\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'luminance', 0, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set hsl luminance. Use with {@link Konva.Filters.HSL} filter.\n    * @name value\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} value 0 is no change, -1.0 halves the value, 1.0 doubles, etc..\n    * @returns {Number}\n    */\n\n    /**\n    * HSL Filter. Adjusts the hue, saturation and luminance (or lightness)\n    * @function\n    * @memberof Konva.Filters\n    * @param {Object} imageData\n    * @author ippo615\n    * @example\n    * image.filters([Konva.Filters.HSL]);\n    * image.luminance(200);\n    */\n\n    Konva.Filters.HSL = function (imageData) {\n        var data = imageData.data,\n            nPixels = data.length,\n            v = 1,\n            s = Math.pow(2, this.saturation()),\n            h = Math.abs((this.hue()) + 360) % 360,\n            l = this.luminance() * 127,\n            i;\n\n        // Basis for the technique used:\n        // http://beesbuzz.biz/code/hsv_color_transforms.php\n        // V is the value multiplier (1 for none, 2 for double, 0.5 for half)\n        // S is the saturation multiplier (1 for none, 2 for double, 0.5 for half)\n        // H is the hue shift in degrees (0 to 360)\n        // vsu = V*S*cos(H*PI/180);\n        // vsw = V*S*sin(H*PI/180);\n        //[ .299V+.701vsu+.168vsw    .587V-.587vsu+.330vsw    .114V-.114vsu-.497vsw ] [R]\n        //[ .299V-.299vsu-.328vsw    .587V+.413vsu+.035vsw    .114V-.114vsu+.292vsw ]*[G]\n        //[ .299V-.300vsu+1.25vsw    .587V-.588vsu-1.05vsw    .114V+.886vsu-.203vsw ] [B]\n\n        // Precompute the values in the matrix:\n        var vsu = v * s * Math.cos(h * Math.PI / 180),\n            vsw = v * s * Math.sin(h * Math.PI / 180);\n        // (result spot)(source spot)\n        var rr = 0.299 * v + 0.701 * vsu + 0.167 * vsw,\n            rg = 0.587 * v - 0.587 * vsu + 0.330 * vsw,\n            rb = 0.114 * v - 0.114 * vsu - 0.497 * vsw;\n        var gr = 0.299 * v - 0.299 * vsu - 0.328 * vsw,\n            gg = 0.587 * v + 0.413 * vsu + 0.035 * vsw,\n            gb = 0.114 * v - 0.114 * vsu + 0.293 * vsw;\n        var br = 0.299 * v - 0.300 * vsu + 1.250 * vsw,\n            bg = 0.587 * v - 0.586 * vsu - 1.050 * vsw,\n            bb = 0.114 * v + 0.886 * vsu - 0.200 * vsw;\n\n        var r, g, b, a;\n\n        for (i = 0; i < nPixels; i += 4) {\n            r = data[i + 0];\n            g = data[i + 1];\n            b = data[i + 2];\n            a = data[i + 3];\n\n            data[i + 0] = rr * r + rg * g + rb * b + l;\n            data[i + 1] = gr * r + gg * g + gb * b + l;\n            data[i + 2] = br * r + bg * g + bb * b + l;\n            data[i + 3] = a; // alpha\n        }\n    };\n})();\n\n(function () {\n    'use strict';\n    /**\n     * Emboss Filter.\n     * Pixastic Lib - Emboss filter - v0.1.0\n     * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/\n     * License: [http://www.pixastic.com/lib/license.txt]\n     * @function\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Emboss]);\n     * node.embossStrength(0.8);\n     * node.embossWhiteLevel(0.3);\n     * node.embossDirection('right');\n     * node.embossBlend(true);\n     */\n    Konva.Filters.Emboss = function (imageData) {\n\n        // pixastic strength is between 0 and 10.  I want it between 0 and 1\n        // pixastic greyLevel is between 0 and 255.  I want it between 0 and 1.  Also,\n        // a max value of greyLevel yields a white emboss, and the min value yields a black\n        // emboss.  Therefore, I changed greyLevel to whiteLevel\n        var strength = this.embossStrength() * 10,\n            greyLevel = this.embossWhiteLevel() * 255,\n            direction = this.embossDirection(),\n            blend = this.embossBlend(),\n            dirY = 0,\n            dirX = 0,\n            data = imageData.data,\n            w = imageData.width,\n            h = imageData.height,\n            w4 = w * 4,\n            y = h;\n\n        switch (direction) {\n            case 'top-left':\n                dirY = -1;\n                dirX = -1;\n                break;\n            case 'top':\n                dirY = -1;\n                dirX = 0;\n                break;\n            case 'top-right':\n                dirY = -1;\n                dirX = 1;\n                break;\n            case 'right':\n                dirY = 0;\n                dirX = 1;\n                break;\n            case 'bottom-right':\n                dirY = 1;\n                dirX = 1;\n                break;\n            case 'bottom':\n                dirY = 1;\n                dirX = 0;\n                break;\n            case 'bottom-left':\n                dirY = 1;\n                dirX = -1;\n                break;\n            case 'left':\n                dirY = 0;\n                dirX = -1;\n                break;\n            default:\n                Konva.Util.error('Unknwo emboss direction: ' + direction);\n        }\n\n        do {\n            var offsetY = (y - 1) * w4;\n\n            var otherY = dirY;\n            if (y + otherY < 1){\n                otherY = 0;\n            }\n            if (y + otherY > h) {\n                otherY = 0;\n            }\n\n            var offsetYOther = (y - 1 + otherY) * w * 4;\n\n            var x = w;\n            do {\n                var offset = offsetY + (x - 1) * 4;\n\n                var otherX = dirX;\n                if (x + otherX < 1){\n                    otherX = 0;\n                }\n                if (x + otherX > w) {\n                    otherX = 0;\n                }\n\n                var offsetOther = offsetYOther + (x - 1 + otherX) * 4;\n\n                var dR = data[offset] - data[offsetOther];\n                var dG = data[offset + 1] - data[offsetOther + 1];\n                var dB = data[offset + 2] - data[offsetOther + 2];\n\n                var dif = dR;\n                var absDif = dif > 0 ? dif : -dif;\n\n                var absG = dG > 0 ? dG : -dG;\n                var absB = dB > 0 ? dB : -dB;\n\n                if (absG > absDif) {\n                    dif = dG;\n                }\n                if (absB > absDif) {\n                    dif = dB;\n                }\n\n                dif *= strength;\n\n                if (blend) {\n                    var r = data[offset] + dif;\n                    var g = data[offset + 1] + dif;\n                    var b = data[offset + 2] + dif;\n\n                    data[offset] = (r > 255) ? 255 : (r < 0 ? 0 : r);\n                    data[offset + 1] = (g > 255) ? 255 : (g < 0 ? 0 : g);\n                    data[offset + 2] = (b > 255) ? 255 : (b < 0 ? 0 : b);\n                } else {\n                    var grey = greyLevel - dif;\n                    if (grey < 0) {\n                        grey = 0;\n                    } else if (grey > 255) {\n                        grey = 255;\n                    }\n\n                    data[offset] = data[offset + 1] = data[offset + 2] = grey;\n                }\n\n            } while (--x);\n        } while (--y);\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'embossStrength', 0.5, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set emboss strength. Use with {@link Konva.Filters.Emboss} filter.\n    * @name embossStrength\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} level between 0 and 1.  Default is 0.5\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'embossWhiteLevel', 0.5, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set emboss white level. Use with {@link Konva.Filters.Emboss} filter.\n    * @name embossWhiteLevel\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} embossWhiteLevel between 0 and 1.  Default is 0.5\n    * @returns {Number}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'embossDirection', 'top-left', null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set emboss direction. Use with {@link Konva.Filters.Emboss} filter.\n    * @name embossDirection\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {String} embossDirection can be top-left, top, top-right, right, bottom-right, bottom, bottom-left or left\n    *   The default is top-left\n    * @returns {String}\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'embossBlend', false, null, Konva.Factory.afterSetFilter);\n    /**\n    * get/set emboss blend. Use with {@link Konva.Filters.Emboss} filter.\n    * @name embossBlend\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Boolean} embossBlend\n    * @returns {Boolean}\n    */\n})();\n\n(function () {\n    'use strict';\n    function remap(fromValue, fromMin, fromMax, toMin, toMax) {\n        // Compute the range of the data\n        var fromRange = fromMax - fromMin,\n          toRange = toMax - toMin,\n          toValue;\n\n        // If either range is 0, then the value can only be mapped to 1 value\n        if (fromRange === 0) {\n            return toMin + toRange / 2;\n        }\n        if (toRange === 0) {\n            return toMin;\n        }\n\n        // (1) untranslate, (2) unscale, (3) rescale, (4) retranslate\n        toValue = (fromValue - fromMin) / fromRange;\n        toValue = (toRange * toValue) + toMin;\n\n        return toValue;\n    }\n\n\n    /**\n    * Enhance Filter. Adjusts the colors so that they span the widest\n    *  possible range (ie 0-255). Performs w*h pixel reads and w*h pixel\n    *  writes.\n    * @function\n    * @name Enhance\n    * @memberof Konva.Filters\n    * @param {Object} imageData\n    * @author ippo615\n    * @example\n    * node.cache();\n    * node.filters([Konva.Filters.Enhance]);\n    * node.enhance(0.4);\n    */\n    Konva.Filters.Enhance = function (imageData) {\n        var data = imageData.data,\n            nSubPixels = data.length,\n            rMin = data[0], rMax = rMin, r,\n            gMin = data[1], gMax = gMin, g,\n            bMin = data[2], bMax = bMin, b,\n            i;\n\n        // If we are not enhancing anything - don't do any computation\n        var enhanceAmount = this.enhance();\n        if( enhanceAmount === 0 ){ return; }\n\n        // 1st Pass - find the min and max for each channel:\n        for (i = 0; i < nSubPixels; i += 4) {\n            r = data[i + 0];\n            if (r < rMin) { rMin = r; }\n            else if (r > rMax) { rMax = r; }\n            g = data[i + 1];\n            if (g < gMin) { gMin = g; } else\n            if (g > gMax) { gMax = g; }\n            b = data[i + 2];\n            if (b < bMin) { bMin = b; } else\n            if (b > bMax) { bMax = b; }\n            //a = data[i + 3];\n            //if (a < aMin) { aMin = a; } else\n            //if (a > aMax) { aMax = a; }\n        }\n\n        // If there is only 1 level - don't remap\n        if( rMax === rMin ){ rMax = 255; rMin = 0; }\n        if( gMax === gMin ){ gMax = 255; gMin = 0; }\n        if( bMax === bMin ){ bMax = 255; bMin = 0; }\n\n        var rMid, rGoalMax, rGoalMin,\n            gMid, gGoalMax, gGoalMin,\n            bMid, bGoalMax, bGoalMin;\n\n        // If the enhancement is positive - stretch the histogram\n        if ( enhanceAmount > 0 ){\n            rGoalMax = rMax + enhanceAmount * (255 - rMax);\n            rGoalMin = rMin - enhanceAmount * (rMin - 0);\n            gGoalMax = gMax + enhanceAmount * (255 - gMax);\n            gGoalMin = gMin - enhanceAmount * (gMin - 0);\n            bGoalMax = bMax + enhanceAmount * (255 - bMax);\n            bGoalMin = bMin - enhanceAmount * (bMin - 0);\n        // If the enhancement is negative -   compress the histogram\n        } else {\n            rMid = (rMax + rMin) * 0.5;\n            rGoalMax = rMax + enhanceAmount * (rMax - rMid);\n            rGoalMin = rMin + enhanceAmount * (rMin - rMid);\n            gMid = (gMax + gMin) * 0.5;\n            gGoalMax = gMax + enhanceAmount * (gMax - gMid);\n            gGoalMin = gMin + enhanceAmount * (gMin - gMid);\n            bMid = (bMax + bMin) * 0.5;\n            bGoalMax = bMax + enhanceAmount * (bMax - bMid);\n            bGoalMin = bMin + enhanceAmount * (bMin - bMid);\n        }\n\n        // Pass 2 - remap everything, except the alpha\n        for (i = 0; i < nSubPixels; i += 4) {\n            data[i + 0] = remap(data[i + 0], rMin, rMax, rGoalMin, rGoalMax);\n            data[i + 1] = remap(data[i + 1], gMin, gMax, gGoalMin, gGoalMax);\n            data[i + 2] = remap(data[i + 2], bMin, bMax, bGoalMin, bGoalMax);\n            //data[i + 3] = remap(data[i + 3], aMin, aMax, aGoalMin, aGoalMax);\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'enhance', 0, null, Konva.Factory.afterSetFilter);\n\n    /**\n    * get/set enhance. Use with {@link Konva.Filters.Enhance} filter.\n    * @name enhance\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Float} amount\n    * @returns {Float}\n    */\n})();\n\n(function () {\n    'use strict';\n    /**\n     * Posterize Filter. Adjusts the channels so that there are no more\n     *  than n different values for that channel. This is also applied\n     *  to the alpha channel.\n     * @function\n     * @name Posterize\n     * @author ippo615\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Posterize]);\n     * node.levels(0.8); // between 0 and 1\n     */\n\n    Konva.Filters.Posterize = function (imageData) {\n        // level must be between 1 and 255\n        var levels = Math.round(this.levels() * 254) + 1,\n            data = imageData.data,\n            len = data.length,\n            scale = (255 / levels),\n            i;\n\n        for (i = 0; i < len; i += 1) {\n            data[i] = Math.floor(data[i] / scale) * scale;\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'levels', 0.5, null, Konva.Factory.afterSetFilter);\n\n    /**\n    * get/set levels.  Must be a number between 0 and 1.  Use with {@link Konva.Filters.Posterize} filter.\n    * @name levels\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Number} level between 0 and 1\n    * @returns {Number}\n    */\n})();\n\n(function () {\r\n    'use strict';\r\n\r\n    /**\r\n     * Noise Filter. Randomly adds or substracts to the color channels\r\n     * @function\r\n     * @name Noise\r\n     * @memberof Konva.Filters\r\n     * @param {Object} imageData\r\n     * @author ippo615\r\n     * @example\r\n     * node.cache();\r\n     * node.filters([Konva.Filters.Noise]);\r\n     * node.noise(0.8);\r\n     */\r\n    Konva.Filters.Noise = function (imageData) {\r\n        var amount = this.noise() * 255,\r\n            data = imageData.data,\r\n            nPixels = data.length,\r\n            half = amount / 2,\r\n            i;\r\n\r\n        for (i = 0; i < nPixels; i += 4) {\r\n            data[i + 0] += half - 2 * half * Math.random();\r\n            data[i + 1] += half - 2 * half * Math.random();\r\n            data[i + 2] += half - 2 * half * Math.random();\r\n        }\r\n    };\r\n\r\n    Konva.Factory.addGetterSetter(Konva.Node, 'noise', 0.2, null, Konva.Factory.afterSetFilter);\r\n\r\n    /**\r\n    * get/set noise amount.  Must be a value between 0 and 1. Use with {@link Konva.Filters.Noise} filter.\r\n    * @name noise\r\n    * @method\r\n    * @memberof Konva.Node.prototype\r\n    * @param {Number} noise\r\n    * @returns {Number}\r\n    */\r\n})();\r\n\n/*eslint-disable max-depth */\r\n(function () {\r\n    'use strict';\r\n    /**\r\n     * Pixelate Filter. Averages groups of pixels and redraws\r\n     *  them as larger pixels\r\n     * @function\r\n     * @name Pixelate\r\n     * @memberof Konva.Filters\r\n     * @param {Object} imageData\r\n     * @author ippo615\r\n     * @example\r\n     * node.cache();\r\n     * node.filters([Konva.Filters.Pixelate]);\r\n     * node.pixelSize(10);\r\n     */\r\n\r\n    Konva.Filters.Pixelate = function (imageData) {\r\n\r\n        var pixelSize = Math.ceil(this.pixelSize()),\r\n            width = imageData.width,\r\n            height = imageData.height,\r\n            x, y, i,\r\n            //pixelsPerBin = pixelSize * pixelSize,\r\n            red, green, blue, alpha,\r\n            nBinsX = Math.ceil(width / pixelSize),\r\n            nBinsY = Math.ceil(height / pixelSize),\r\n            xBinStart, xBinEnd, yBinStart, yBinEnd,\r\n            xBin, yBin, pixelsInBin;\r\n        imageData = imageData.data;\r\n\r\n        if (pixelSize <= 0) {\r\n            Konva.Util.error('pixelSize value can not be <= 0');\r\n            return;\r\n        }\r\n\r\n        for (xBin = 0; xBin < nBinsX; xBin += 1) {\r\n            for (yBin = 0; yBin < nBinsY; yBin += 1) {\r\n\r\n                // Initialize the color accumlators to 0\r\n                red = 0;\r\n                green = 0;\r\n                blue = 0;\r\n                alpha = 0;\r\n\r\n                // Determine which pixels are included in this bin\r\n                xBinStart = xBin * pixelSize;\r\n                xBinEnd = xBinStart + pixelSize;\r\n                yBinStart = yBin * pixelSize;\r\n                yBinEnd = yBinStart + pixelSize;\r\n\r\n                // Add all of the pixels to this bin!\r\n                pixelsInBin = 0;\r\n                for (x = xBinStart; x < xBinEnd; x += 1) {\r\n                    if( x >= width ){ continue; }\r\n                    for (y = yBinStart; y < yBinEnd; y += 1) {\r\n                        if( y >= height ){ continue; }\r\n                        i = (width * y + x) * 4;\r\n                        red += imageData[i + 0];\r\n                        green += imageData[i + 1];\r\n                        blue += imageData[i + 2];\r\n                        alpha += imageData[i + 3];\r\n                        pixelsInBin += 1;\r\n                    }\r\n                }\r\n\r\n                // Make sure the channels are between 0-255\r\n                red = red / pixelsInBin;\r\n                green = green / pixelsInBin;\r\n                blue = blue / pixelsInBin;\r\n\r\n                // Draw this bin\r\n                for (x = xBinStart; x < xBinEnd; x += 1) {\r\n                    if( x >= width ){ continue; }\r\n                    for (y = yBinStart; y < yBinEnd; y += 1) {\r\n                        if( y >= height ){ continue; }\r\n                        i = (width * y + x) * 4;\r\n                        imageData[i + 0] = red;\r\n                        imageData[i + 1] = green;\r\n                        imageData[i + 2] = blue;\r\n                        imageData[i + 3] = alpha;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    Konva.Factory.addGetterSetter(Konva.Node, 'pixelSize', 8, null, Konva.Factory.afterSetFilter);\r\n\r\n    /**\r\n    * get/set pixel size. Use with {@link Konva.Filters.Pixelate} filter.\r\n    * @name pixelSize\r\n    * @method\r\n    * @memberof Konva.Node.prototype\r\n    * @param {Integer} pixelSize\r\n    * @returns {Integer}\r\n    */\r\n})();\r\n\n(function () {\r\n    'use strict';\r\n    /**\r\n     * Threshold Filter. Pushes any value above the mid point to\r\n     *  the max and any value below the mid point to the min.\r\n     *  This affects the alpha channel.\r\n     * @function\r\n     * @name Threshold\r\n     * @memberof Konva.Filters\r\n     * @param {Object} imageData\r\n     * @author ippo615\r\n     * @example\r\n     * node.cache();\r\n     * node.filters([Konva.Filters.Threshold]);\r\n     * node.threshold(0.1);\r\n     */\r\n\r\n    Konva.Filters.Threshold = function (imageData) {\r\n        var level = this.threshold() * 255,\r\n            data = imageData.data,\r\n            len = data.length,\r\n            i;\r\n\r\n        for (i = 0; i < len; i += 1) {\r\n            data[i] = data[i] < level ? 0 : 255;\r\n        }\r\n    };\r\n\r\n    Konva.Factory.addGetterSetter(Konva.Node, 'threshold', 0.5, null, Konva.Factory.afterSetFilter);\r\n\r\n    /**\r\n    * get/set threshold.  Must be a value between 0 and 1. Use with {@link Konva.Filters.Threshold} or {@link Konva.Filters.Mask} filter.\r\n    * @name threshold\r\n    * @method\r\n    * @memberof Konva.Node.prototype\r\n    * @param {Number} threshold\r\n    * @returns {Number}\r\n    */\r\n})();\r\n\n(function() {\n    'use strict';\n    /**\n     * Sepia Filter\n     * Based on: Pixastic Lib - Sepia filter - v0.1.0\n     * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/\n     * @function\n     * @name Sepia\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @author Jacob Seidelin <jseidelin@nihilogic.dk>\n     * @license MPL v1.1 [http://www.pixastic.com/lib/license.txt]\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Sepia]);\n     */\n    Konva.Filters.Sepia = function (imageData) {\n        var data = imageData.data,\n            w = imageData.width,\n            y = imageData.height,\n            w4 = w * 4,\n            offsetY, x, offset, or, og, ob, r, g, b;\n\n        do {\n            offsetY = (y - 1) * w4;\n            x = w;\n            do {\n                offset = offsetY + (x - 1) * 4;\n\n                or = data[offset];\n                og = data[offset + 1];\n                ob = data[offset + 2];\n\n                r = or * 0.393 + og * 0.769 + ob * 0.189;\n                g = or * 0.349 + og * 0.686 + ob * 0.168;\n                b = or * 0.272 + og * 0.534 + ob * 0.131;\n\n                data[offset] = r > 255 ? 255 : r;\n                data[offset + 1] = g > 255 ? 255 : g;\n                data[offset + 2] = b > 255 ? 255 : b;\n                data[offset + 3] = data[offset + 3];\n            } while (--x);\n        } while (--y);\n    };\n})();\n\n(function () {\n    'use strict';\n    /**\n     * Solarize Filter\n     * Pixastic Lib - Solarize filter - v0.1.0\n     * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/\n     * License: [http://www.pixastic.com/lib/license.txt]\n     * @function\n     * @name Solarize\n     * @memberof Konva.Filters\n     * @param {Object} imageData\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Solarize]);\n     */\n    Konva.Filters.Solarize = function (imageData) {\n        var data = imageData.data,\n            w = imageData.width,\n            h = imageData.height,\n            w4 = w * 4,\n            y = h;\n\n        do {\n            var offsetY = (y - 1) * w4;\n            var x = w;\n            do {\n                var offset = offsetY + (x - 1) * 4;\n                var r = data[offset];\n                var g = data[offset + 1];\n                var b = data[offset + 2];\n\n                if (r > 127) {\n                    r = 255 - r;\n                }\n                if (g > 127) {\n                    g = 255 - g;\n                }\n                if (b > 127) {\n                    b = 255 - b;\n                }\n\n                data[offset] = r;\n                data[offset + 1] = g;\n                data[offset + 2] = b;\n            } while (--x);\n        } while (--y);\n    };\n})();\n\n\n\n(function () {\n    'use strict';\n\n  /*\n   * ToPolar Filter. Converts image data to polar coordinates. Performs\n   *  w*h*4 pixel reads and w*h pixel writes. The r axis is placed along\n   *  what would be the y axis and the theta axis along the x axis.\n   * @function\n   * @author ippo615\n   * @memberof Konva.Filters\n   * @param {ImageData} src, the source image data (what will be transformed)\n   * @param {ImageData} dst, the destination image data (where it will be saved)\n   * @param {Object} opt\n   * @param {Number} [opt.polarCenterX] horizontal location for the center of the circle,\n   *  default is in the middle\n   * @param {Number} [opt.polarCenterY] vertical location for the center of the circle,\n   *  default is in the middle\n   */\n\n    var ToPolar = function(src, dst, opt){\n\n        var srcPixels = src.data,\n            dstPixels = dst.data,\n            xSize = src.width,\n            ySize = src.height,\n            xMid = opt.polarCenterX || xSize / 2,\n            yMid = opt.polarCenterY || ySize / 2,\n            i, x, y, r = 0, g = 0, b = 0, a = 0;\n\n        // Find the largest radius\n        var rad, rMax = Math.sqrt( xMid * xMid + yMid * yMid );\n        x = xSize - xMid;\n        y = ySize - yMid;\n        rad = Math.sqrt( x * x + y * y );\n        rMax = (rad > rMax) ? rad : rMax;\n\n        // We'll be uisng y as the radius, and x as the angle (theta=t)\n        var rSize = ySize,\n            tSize = xSize,\n            radius, theta;\n\n        // We want to cover all angles (0-360) and we need to convert to\n        // radians (*PI/180)\n        var conversion = 360 / tSize * Math.PI / 180, sin, cos;\n\n        // var x1, x2, x1i, x2i, y1, y2, y1i, y2i, scale;\n\n        for( theta = 0; theta < tSize; theta += 1 ){\n            sin = Math.sin(theta * conversion);\n            cos = Math.cos(theta * conversion);\n            for( radius = 0; radius < rSize; radius += 1 ){\n                x = Math.floor(xMid + rMax * radius / rSize * cos);\n                y = Math.floor(yMid + rMax * radius / rSize * sin);\n                i = (y * xSize + x) * 4;\n                r = srcPixels[i + 0];\n                g = srcPixels[i + 1];\n                b = srcPixels[i + 2];\n                a = srcPixels[i + 3];\n\n                // Store it\n                //i = (theta * xSize  +  radius) * 4;\n                i = (theta + radius * xSize) * 4;\n                dstPixels[i + 0] = r;\n                dstPixels[i + 1] = g;\n                dstPixels[i + 2] = b;\n                dstPixels[i + 3] = a;\n\n            }\n        }\n    };\n\n    /*\n     * FromPolar Filter. Converts image data from polar coordinates back to rectangular.\n     *  Performs w*h*4 pixel reads and w*h pixel writes.\n     * @function\n     * @author ippo615\n     * @memberof Konva.Filters\n     * @param {ImageData} src, the source image data (what will be transformed)\n     * @param {ImageData} dst, the destination image data (where it will be saved)\n     * @param {Object} opt\n     * @param {Number} [opt.polarCenterX] horizontal location for the center of the circle,\n     *  default is in the middle\n     * @param {Number} [opt.polarCenterY] vertical location for the center of the circle,\n     *  default is in the middle\n     * @param {Number} [opt.polarRotation] amount to rotate the image counterclockwis,\n     *  0 is no rotation, 360 degrees is a full rotation\n     */\n\n    var FromPolar = function(src, dst, opt){\n\n        var srcPixels = src.data,\n            dstPixels = dst.data,\n            xSize = src.width,\n            ySize = src.height,\n            xMid = opt.polarCenterX || xSize / 2,\n            yMid = opt.polarCenterY || ySize / 2,\n            i, x, y, dx, dy, r = 0, g = 0, b = 0, a = 0;\n\n\n        // Find the largest radius\n        var rad, rMax = Math.sqrt( xMid * xMid + yMid * yMid );\n        x = xSize - xMid;\n        y = ySize - yMid;\n        rad = Math.sqrt( x * x + y * y );\n        rMax = (rad > rMax) ? rad : rMax;\n\n        // We'll be uisng x as the radius, and y as the angle (theta=t)\n        var rSize = ySize,\n        tSize = xSize,\n        radius, theta,\n        phaseShift = opt.polarRotation || 0;\n\n        // We need to convert to degrees and we need to make sure\n        // it's between (0-360)\n        // var conversion = tSize/360*180/Math.PI;\n        //var conversion = tSize/360*180/Math.PI;\n\n        var x1, y1;\n\n        for( x = 0; x < xSize; x += 1 ){\n            for( y = 0; y < ySize; y += 1 ){\n                dx = x - xMid;\n                dy = y - yMid;\n                radius = Math.sqrt(dx * dx + dy * dy) * rSize / rMax;\n                theta = (Math.atan2(dy, dx) * 180 / Math.PI + 360 + phaseShift) % 360;\n                theta = theta * tSize / 360;\n                x1 = Math.floor(theta);\n                y1 = Math.floor(radius);\n                i = (y1 * xSize + x1) * 4;\n                r = srcPixels[i + 0];\n                g = srcPixels[i + 1];\n                b = srcPixels[i + 2];\n                a = srcPixels[i + 3];\n\n                // Store it\n                i = (y * xSize + x) * 4;\n                dstPixels[i + 0] = r;\n                dstPixels[i + 1] = g;\n                dstPixels[i + 2] = b;\n                dstPixels[i + 3] = a;\n            }\n        }\n\n    };\n\n    //Konva.Filters.ToPolar = Konva.Util._FilterWrapDoubleBuffer(ToPolar);\n    //Konva.Filters.FromPolar = Konva.Util._FilterWrapDoubleBuffer(FromPolar);\n\n    // create a temporary canvas for working - shared between multiple calls\n    var tempCanvas = Konva.Util.createCanvasElement();\n\n    /*\n     * Kaleidoscope Filter.\n     * @function\n     * @name Kaleidoscope\n     * @author ippo615\n     * @memberof Konva.Filters\n     * @example\n     * node.cache();\n     * node.filters([Konva.Filters.Kaleidoscope]);\n     * node.kaleidoscopePower(3);\n     * node.kaleidoscopeAngle(45);\n     */\n    Konva.Filters.Kaleidoscope = function(imageData){\n        var xSize = imageData.width,\n            ySize = imageData.height;\n\n        var x, y, xoff, i, r, g, b, a, srcPos, dstPos;\n        var power = Math.round( this.kaleidoscopePower() );\n        var angle = Math.round( this.kaleidoscopeAngle() );\n        var offset = Math.floor(xSize * (angle % 360) / 360);\n\n        if( power < 1 ){return; }\n\n        // Work with our shared buffer canvas\n        tempCanvas.width = xSize;\n        tempCanvas.height = ySize;\n        var scratchData = tempCanvas.getContext('2d').getImageData(0, 0, xSize, ySize);\n\n        // Convert thhe original to polar coordinates\n        ToPolar( imageData, scratchData, {\n            polarCenterX: xSize / 2,\n            polarCenterY: ySize / 2\n        });\n\n        // Determine how big each section will be, if it's too small\n        // make it bigger\n        var minSectionSize = xSize / Math.pow(2, power);\n        while( minSectionSize <= 8){\n            minSectionSize = minSectionSize * 2;\n            power -= 1;\n        }\n        minSectionSize = Math.ceil(minSectionSize);\n        var sectionSize = minSectionSize;\n\n        // Copy the offset region to 0\n        // Depending on the size of filter and location of the offset we may need\n        // to copy the section backwards to prevent it from rewriting itself\n        var xStart = 0,\n          xEnd = sectionSize,\n          xDelta = 1;\n        if( offset + minSectionSize > xSize ){\n            xStart = sectionSize;\n            xEnd = 0;\n            xDelta = -1;\n        }\n        for( y = 0; y < ySize; y += 1 ){\n            for( x = xStart; x !== xEnd; x += xDelta ){\n                xoff = Math.round(x + offset) % xSize;\n                srcPos = (xSize * y + xoff) * 4;\n                r = scratchData.data[srcPos + 0];\n                g = scratchData.data[srcPos + 1];\n                b = scratchData.data[srcPos + 2];\n                a = scratchData.data[srcPos + 3];\n                dstPos = (xSize * y + x) * 4;\n                scratchData.data[dstPos + 0] = r;\n                scratchData.data[dstPos + 1] = g;\n                scratchData.data[dstPos + 2] = b;\n                scratchData.data[dstPos + 3] = a;\n            }\n        }\n\n        // Perform the actual effect\n        for( y = 0; y < ySize; y += 1 ){\n            sectionSize = Math.floor( minSectionSize );\n            for( i = 0; i < power; i += 1 ){\n                for( x = 0; x < sectionSize + 1; x += 1 ){\n                    srcPos = (xSize * y + x) * 4;\n                    r = scratchData.data[srcPos + 0];\n                    g = scratchData.data[srcPos + 1];\n                    b = scratchData.data[srcPos + 2];\n                    a = scratchData.data[srcPos + 3];\n                    dstPos = (xSize * y + sectionSize * 2 - x - 1) * 4;\n                    scratchData.data[dstPos + 0] = r;\n                    scratchData.data[dstPos + 1] = g;\n                    scratchData.data[dstPos + 2] = b;\n                    scratchData.data[dstPos + 3] = a;\n                }\n                sectionSize *= 2;\n            }\n        }\n\n        // Convert back from polar coordinates\n        FromPolar(scratchData, imageData, {polarRotation: 0});\n    };\n\n    /**\n    * get/set kaleidoscope power. Use with {@link Konva.Filters.Kaleidoscope} filter.\n    * @name kaleidoscopePower\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} power of kaleidoscope\n    * @returns {Integer}\n    */\n    Konva.Factory.addGetterSetter(Konva.Node, 'kaleidoscopePower', 2, null, Konva.Factory.afterSetFilter);\n\n    /**\n    * get/set kaleidoscope angle. Use with {@link Konva.Filters.Kaleidoscope} filter.\n    * @name kaleidoscopeAngle\n    * @method\n    * @memberof Konva.Node.prototype\n    * @param {Integer} degrees\n    * @returns {Integer}\n    */\n    Konva.Factory.addGetterSetter(Konva.Node, 'kaleidoscopeAngle', 0, null, Konva.Factory.afterSetFilter);\n\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Container constructor.&nbsp; Containers are used to contain nodes or other containers\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Node\n     * @abstract\n     * @param {Object} config\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * * @param {Object} [config.clip] set clip\n     * @param {Number} [config.clipX] set clip x\n     * @param {Number} [config.clipY] set clip y\n     * @param {Number} [config.clipWidth] set clip width\n     * @param {Number} [config.clipHeight] set clip height\n     * @param {Function} [config.clipFunc] set clip func\n\n     */\n    Konva.Container = function(config) {\n        this.__init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Container, {\n        __init: function(config) {\n            this.children = new Konva.Collection();\n            Konva.Node.call(this, config);\n        },\n        /**\n         * returns a {@link Konva.Collection} of direct descendant nodes\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {Function} [filterFunc] filter function\n         * @returns {Konva.Collection}\n         * @example\n         * // get all children\n         * var children = layer.getChildren();\n         *\n         * // get only circles\n         * var circles = layer.getChildren(function(node){\n         *    return node.getClassName() === 'Circle';\n         * });\n         */\n        getChildren: function(filterFunc) {\n            if (!filterFunc) {\n                return this.children;\n            }\n\n            var results = new Konva.Collection();\n            this.children.each(function(child){\n                if (filterFunc(child)) {\n                    results.push(child);\n                }\n            });\n            return results;\n        },\n        /**\n         * determine if node has children\n         * @method\n         * @memberof Konva.Container.prototype\n         * @returns {Boolean}\n         */\n        hasChildren: function() {\n            return this.getChildren().length > 0;\n        },\n        /**\n         * remove all children\n         * @method\n         * @memberof Konva.Container.prototype\n         */\n        removeChildren: function() {\n            var children = Konva.Collection.toCollection(this.children);\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                // reset parent to prevent many _setChildrenIndices calls\n                delete child.parent;\n                child.index = 0;\n                child.remove();\n            }\n            children = null;\n            this.children = new Konva.Collection();\n            return this;\n        },\n        /**\n         * destroy all children\n         * @method\n         * @memberof Konva.Container.prototype\n         */\n        destroyChildren: function() {\n           var children = Konva.Collection.toCollection(this.children);\n            var child;\n            for (var i = 0; i < children.length; i++) {\n                child = children[i];\n                // reset parent to prevent many _setChildrenIndices calls\n                delete child.parent;\n                child.index = 0;\n                child.destroy();\n            }\n            children = null;\n            this.children = new Konva.Collection();\n            return this;\n        },\n        /**\n         * Add node or nodes to container.\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {...Konva.Node} child\n         * @returns {Container}\n         * @example\n         * layer.add(shape1, shape2, shape3);\n         */\n        add: function(child) {\n            if (arguments.length > 1) {\n                for (var i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            if (child.getParent()) {\n                child.moveTo(this);\n                return this;\n            }\n            var children = this.children;\n            this._validateAdd(child);\n            child.index = children.length;\n            child.parent = this;\n            children.push(child);\n            this._fire('add', {\n                child: child\n            });\n\n            // if node under drag we need to update drag animation\n            if (Konva.DD && child.isDragging()) {\n                Konva.DD.anim.setLayers(child.getLayer());\n            }\n\n            // chainable\n            return this;\n        },\n        destroy: function() {\n            // destroy children\n            if (this.hasChildren()) {\n                this.destroyChildren();\n            }\n            // then destroy self\n            Konva.Node.prototype.destroy.call(this);\n            return this;\n        },\n        /**\n         * return a {@link Konva.Collection} of nodes that match the selector.  Use '#' for id selections\n         * and '.' for name selections.  You can also select by type or class name. Pass multiple selectors\n         * separated by a space.\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {String} selector\n         * @returns {Collection}\n         * @example\n         * // select node with id foo\n         * var node = stage.find('#foo');\n         *\n         * // select nodes with name bar inside layer\n         * var nodes = layer.find('.bar');\n         *\n         * // select all groups inside layer\n         * var nodes = layer.find('Group');\n         *\n         * // select all rectangles inside layer\n         * var nodes = layer.find('Rect');\n         *\n         * // select node with an id of foo or a name of bar inside layer\n         * var nodes = layer.find('#foo, .bar');\n         */\n        find: function(selector) {\n            var retArr = [],\n                selectorArr = selector.replace(/ /g, '').split(','),\n                len = selectorArr.length,\n                n, i, sel, arr, node, children, clen;\n\n            for (n = 0; n < len; n++) {\n                sel = selectorArr[n];\n                if (!Konva.Util.isValidSelector(sel)) {\n                    Konva.Util.warn('Selector \"' + sel + '\" is invalid. Allowed selectors examples are \"#foo\", \".bar\" or \"Group\".');\n                    Konva.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like \"Triangle\".');\n                    Konva.Util.warn('Konva is awesome, right?');\n                }\n                // id selector\n                if(sel.charAt(0) === '#') {\n                    node = this._getNodeById(sel.slice(1));\n                    if(node) {\n                        retArr.push(node);\n                    }\n                }\n                // name selector\n                else if(sel.charAt(0) === '.') {\n                    arr = this._getNodesByName(sel.slice(1));\n                    retArr = retArr.concat(arr);\n                }\n                // unrecognized selector, pass to children\n                else {\n                    children = this.getChildren();\n                    clen = children.length;\n                    for(i = 0; i < clen; i++) {\n                        retArr = retArr.concat(children[i]._get(sel));\n                    }\n                }\n            }\n\n            return Konva.Collection.toCollection(retArr);\n        },\n        /**\n         * return a first node from `find` method\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {String} selector\n         * @returns {Konva.Node}\n         * @example\n         * // select node with id foo\n         * var node = stage.findOne('#foo');\n         *\n         * // select node with name bar inside layer\n         * var nodes = layer.findOne('.bar');\n         */\n        findOne: function(selector) {\n            return this.find(selector)[0];\n        },\n        _getNodeById: function(key) {\n            var node = Konva.ids[key];\n\n            if(node !== undefined && this.isAncestorOf(node)) {\n                return node;\n            }\n            return null;\n        },\n        _getNodesByName: function(key) {\n            var arr = Konva.names[key] || [];\n            return this._getDescendants(arr);\n        },\n        _get: function(selector) {\n            var retArr = Konva.Node.prototype._get.call(this, selector);\n            var children = this.getChildren();\n            var len = children.length;\n            for(var n = 0; n < len; n++) {\n                retArr = retArr.concat(children[n]._get(selector));\n            }\n            return retArr;\n        },\n        // extenders\n        toObject: function() {\n            var obj = Konva.Node.prototype.toObject.call(this);\n\n            obj.children = [];\n\n            var children = this.getChildren();\n            var len = children.length;\n            for(var n = 0; n < len; n++) {\n                var child = children[n];\n                obj.children.push(child.toObject());\n            }\n\n            return obj;\n        },\n        _getDescendants: function(arr) {\n            var retArr = [];\n            var len = arr.length;\n            for(var n = 0; n < len; n++) {\n                var node = arr[n];\n                if(this.isAncestorOf(node)) {\n                    retArr.push(node);\n                }\n            }\n\n            return retArr;\n        },\n        /**\n         * determine if node is an ancestor\n         * of descendant\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {Konva.Node} node\n         */\n        isAncestorOf: function(node) {\n            var parent = node.getParent();\n            while(parent) {\n                if(parent._id === this._id) {\n                    return true;\n                }\n                parent = parent.getParent();\n            }\n\n            return false;\n        },\n        clone: function(obj) {\n            // call super method\n            var node = Konva.Node.prototype.clone.call(this, obj);\n\n            this.getChildren().each(function(no) {\n                node.add(no.clone());\n            });\n            return node;\n        },\n        /**\n         * get all shapes that intersect a point.  Note: because this method must clear a temporary\n         * canvas and redraw every shape inside the container, it should only be used for special sitations\n         * because it performs very poorly.  Please use the {@link Konva.Stage#getIntersection} method if at all possible\n         * because it performs much better\n         * @method\n         * @memberof Konva.Container.prototype\n         * @param {Object} pos\n         * @param {Number} pos.x\n         * @param {Number} pos.y\n         * @returns {Array} array of shapes\n         */\n        getAllIntersections: function(pos) {\n            var arr = [];\n\n            this.find('Shape').each(function(shape) {\n                if(shape.isVisible() && shape.intersects(pos)) {\n                    arr.push(shape);\n                }\n            });\n\n            return arr;\n        },\n        _setChildrenIndices: function() {\n            this.children.each(function(child, n) {\n                child.index = n;\n            });\n        },\n        drawScene: function(can, top, caching) {\n            var layer = this.getLayer(),\n                canvas = can || (layer && layer.getCanvas()),\n                context = canvas && canvas.getContext(),\n                cachedCanvas = this._cache.canvas,\n                cachedSceneCanvas = cachedCanvas && cachedCanvas.scene;\n\n            if (this.isVisible()) {\n                if (!caching && cachedSceneCanvas) {\n                    context.save();\n                    layer._applyTransform(this, context, top);\n                    this._drawCachedSceneCanvas(context);\n                    context.restore();\n                }\n                else {\n                    this._drawChildren(canvas, 'drawScene', top, false, caching);\n                }\n            }\n            return this;\n        },\n        drawHit: function(can, top, caching) {\n            var layer = this.getLayer(),\n                canvas = can || (layer && layer.hitCanvas),\n                context = canvas && canvas.getContext(),\n                cachedCanvas = this._cache.canvas,\n                cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n\n            if (this.shouldDrawHit(canvas)) {\n                if (layer) {\n                    layer.clearHitCache();\n                }\n                if (!caching && cachedHitCanvas) {\n                    context.save();\n                    layer._applyTransform(this, context, top);\n                    this._drawCachedHitCanvas(context);\n                    context.restore();\n                }\n                else {\n                    this._drawChildren(canvas, 'drawHit', top);\n                }\n            }\n            return this;\n        },\n        _drawChildren: function(canvas, drawMethod, top, caching, skipBuffer) {\n            var layer = this.getLayer(),\n                context = canvas && canvas.getContext(),\n                clipWidth = this.getClipWidth(),\n                clipHeight = this.getClipHeight(),\n                clipFunc = this.getClipFunc(),\n                hasClip = clipWidth && clipHeight || clipFunc,\n                clipX, clipY;\n\n            if (hasClip && layer) {\n                context.save();\n                layer._applyTransform(this, context);\n                context.beginPath();\n                if (clipFunc) {\n                  clipFunc.call(this, context, this);\n                } else {\n                  clipX = this.getClipX();\n                  clipY = this.getClipY();\n                  context.rect(clipX, clipY, clipWidth, clipHeight);\n                }\n                context.clip();\n                context.reset();\n            }\n\n            this.children.each(function(child) {\n                child[drawMethod](canvas, top, caching, skipBuffer);\n            });\n\n            if (hasClip) {\n                context.restore();\n            }\n        },\n        shouldDrawHit: function(canvas) {\n            var layer = this.getLayer();\n            var dd = Konva.DD;\n            var layerUnderDrag = dd && Konva.isDragging() && (Konva.DD.anim.getLayers().indexOf(layer) !== -1);\n            return (canvas && canvas.isCache) || (layer && layer.hitGraphEnabled())\n                && this.isVisible() && !layerUnderDrag;\n        },\n        getClientRect: function(skipTransform) {\n            var minX, minY, maxX, maxY;\n            var selfRect = {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0\n            };\n            this.children.each(function(child) {\n                var rect = child.getClientRect();\n\n                // skip invisible children (like empty groups)\n                // or don't skip... hmmm...\n                // if (rect.width === 0 && rect.height === 0) {\n                //     return;\n                // }\n\n                if (minX === undefined) { // initial value for first child\n                    minX = rect.x;\n                    minY = rect.y;\n                    maxX = rect.x + rect.width;\n                    maxY = rect.y + rect.height;\n                } else {\n                    minX = Math.min(minX, rect.x);\n                    minY = Math.min(minY, rect.y);\n                    maxX = Math.max(maxX, rect.x + rect.width);\n                    maxY = Math.max(maxY, rect.y + rect.height);\n                }\n\n            });\n\n            if (this.children.length !== 0) {\n                selfRect = {\n                    x: minX,\n                    y: minY,\n                    width: maxX - minX,\n                    height: maxY - minY\n                };\n            }\n\n            if (!skipTransform) {\n                return this._transformedRect(selfRect);\n            }\n            return selfRect;\n        }\n    });\n\n    Konva.Util.extend(Konva.Container, Konva.Node);\n    // deprecated methods\n    Konva.Container.prototype.get = Konva.Container.prototype.find;\n\n    // add getters setters\n    Konva.Factory.addComponentsGetterSetter(Konva.Container, 'clip', ['x', 'y', 'width', 'height']);\n    /**\n     * get/set clip\n     * @method\n     * @name clip\n     * @memberof Konva.Container.prototype\n     * @param {Object} clip\n     * @param {Number} clip.x\n     * @param {Number} clip.y\n     * @param {Number} clip.width\n     * @param {Number} clip.height\n     * @returns {Object}\n     * @example\n     * // get clip\n     * var clip = container.clip();\n     *\n     * // set clip\n     * container.setClip({\n     *   x: 20,\n     *   y: 20,\n     *   width: 20,\n     *   height: 20\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Container, 'clipX');\n    /**\n     * get/set clip x\n     * @name clipX\n     * @method\n     * @memberof Konva.Container.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get clip x\n     * var clipX = container.clipX();\n     *\n     * // set clip x\n     * container.clipX(10);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Container, 'clipY');\n    /**\n     * get/set clip y\n     * @name clipY\n     * @method\n     * @memberof Konva.Container.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get clip y\n     * var clipY = container.clipY();\n     *\n     * // set clip y\n     * container.clipY(10);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Container, 'clipWidth');\n    /**\n     * get/set clip width\n     * @name clipWidth\n     * @method\n     * @memberof Konva.Container.prototype\n     * @param {Number} width\n     * @returns {Number}\n     * @example\n     * // get clip width\n     * var clipWidth = container.clipWidth();\n     *\n     * // set clip width\n     * container.clipWidth(100);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Container, 'clipHeight');\n    /**\n     * get/set clip height\n     * @name clipHeight\n     * @method\n     * @memberof Konva.Container.prototype\n     * @param {Number} height\n     * @returns {Number}\n     * @example\n     * // get clip height\n     * var clipHeight = container.clipHeight();\n     *\n     * // set clip height\n     * container.clipHeight(100);\n     */\n\n     Konva.Factory.addGetterSetter(Konva.Container, 'clipFunc');\n     /**\n      * get/set clip function\n      * @name clipFunc\n      * @method\n      * @memberof Konva.Container.prototype\n      * @param {Function} function\n      * @returns {Function}\n      * @example\n      * // get clip function\n      * var clipFunction = container.clipFunc();\n      *\n      * // set clip height\n      * container.clipFunc(function(ctx) {\n      *   ctx.rect(0, 0, 100, 100);\n      * });\n      */\n\n    Konva.Collection.mapMethods(Konva.Container);\n})();\n\n(function(Konva) {\n    'use strict';\n    var HAS_SHADOW = 'hasShadow';\n    var SHADOW_RGBA = 'shadowRGBA';\n\n    function _fillFunc(context) {\n        context.fill();\n    }\n    function _strokeFunc(context) {\n        context.stroke();\n    }\n    function _fillFuncHit(context) {\n        context.fill();\n    }\n    function _strokeFuncHit(context) {\n        context.stroke();\n    }\n\n    function _clearHasShadowCache() {\n        this._clearCache(HAS_SHADOW);\n    }\n\n    function _clearGetShadowRGBACache() {\n        this._clearCache(SHADOW_RGBA);\n    }\n\n    /**\n     * Shape constructor.  Shapes are primitive objects such as rectangles,\n     *  circles, text, lines, etc.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Node\n     * @param {Object} config\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var customShape = new Konva.Shape({\n         *   x: 5,\n         *   y: 10,\n         *   fill: 'red',\n         *   // a Konva.Canvas renderer is passed into the drawFunc function\n         *   drawFunc: function(context) {\n         *     context.beginPath();\n         *     context.moveTo(200, 50);\n         *     context.lineTo(420, 80);\n         *     context.quadraticCurveTo(300, 100, 260, 170);\n         *     context.closePath();\n         *     context.fillStrokeShape(this);\n         *   }\n         *});\n     */\n    Konva.Shape = function(config) {\n        this.__init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Shape, {\n        __init: function(config) {\n            this.nodeType = 'Shape';\n            this._fillFunc = _fillFunc;\n            this._strokeFunc = _strokeFunc;\n            this._fillFuncHit = _fillFuncHit;\n            this._strokeFuncHit = _strokeFuncHit;\n\n            // set colorKey\n            var shapes = Konva.shapes;\n            var key;\n\n            while(true) {\n                key = Konva.Util.getRandomColor();\n                if(key && !( key in shapes)) {\n                    break;\n                }\n            }\n\n            this.colorKey = key;\n            shapes[key] = this;\n\n            // call super constructor\n            Konva.Node.call(this, config);\n\n            this.on('shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearHasShadowCache);\n\n            this.on('shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva', _clearGetShadowRGBACache);\n        },\n        hasChildren: function() {\n            return false;\n        },\n        getChildren: function() {\n            return [];\n        },\n        /**\n         * get canvas context tied to the layer\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Konva.Context}\n         */\n        getContext: function() {\n            return this.getLayer().getContext();\n        },\n        /**\n         * get canvas renderer tied to the layer.  Note that this returns a canvas renderer, not a canvas element\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Konva.Canvas}\n         */\n        getCanvas: function() {\n            return this.getLayer().getCanvas();\n        },\n        /**\n         * returns whether or not a shadow will be rendered\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Boolean}\n         */\n        hasShadow: function() {\n            return this._getCache(HAS_SHADOW, this._hasShadow);\n        },\n        _hasShadow: function() {\n            return this.getShadowEnabled() && (this.getShadowOpacity() !== 0 && !!(this.getShadowColor() || this.getShadowBlur() || this.getShadowOffsetX() || this.getShadowOffsetY()));\n        },\n        getShadowRGBA: function() {\n            return this._getCache(SHADOW_RGBA, this._getShadowRGBA);\n        },\n        _getShadowRGBA: function() {\n            if (this.hasShadow()) {\n                var rgba = Konva.Util.colorToRGBA(this.shadowColor());\n                return 'rgba(' + rgba.r + ',' + rgba.g + ',' + rgba.b + ',' + (rgba.a * (this.getShadowOpacity() || 1)) + ')';\n            }\n        },\n        /**\n         * returns whether or not the shape will be filled\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Boolean}\n         */\n        hasFill: function() {\n            return !!(this.getFill() || this.getFillPatternImage() || this.getFillLinearGradientColorStops() || this.getFillRadialGradientColorStops());\n        },\n        /**\n         * returns whether or not the shape will be stroked\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Boolean}\n         */\n        hasStroke: function() {\n            return !!(this.stroke());\n        },\n        /**\n         * determines if point is in the shape, regardless if other shapes are on top of it.  Note: because\n         *  this method clears a temporary canvas and then redraws the shape, it performs very poorly if executed many times\n         *  consecutively.  Please use the {@link Konva.Stage#getIntersection} method if at all possible\n         *  because it performs much better\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @param {Object} point\n         * @param {Number} point.x\n         * @param {Number} point.y\n         * @returns {Boolean}\n         */\n        intersects: function(point) {\n            var stage = this.getStage(),\n                bufferHitCanvas = stage.bufferHitCanvas,\n                p;\n\n            bufferHitCanvas.getContext().clear();\n            this.drawScene(bufferHitCanvas);\n            p = bufferHitCanvas.context.getImageData(Math.round(point.x), Math.round(point.y), 1, 1).data;\n            return p[3] > 0;\n        },\n        // extends Node.prototype.destroy\n        destroy: function() {\n            Konva.Node.prototype.destroy.call(this);\n            delete Konva.shapes[this.colorKey];\n            return this;\n        },\n        _useBufferCanvas: function(caching) {\n            return !caching && (this.perfectDrawEnabled() && (this.getAbsoluteOpacity() !== 1) && this.hasFill() && this.hasStroke() && this.getStage()) ||\n                   (this.perfectDrawEnabled() && this.hasShadow() && (this.getAbsoluteOpacity() !== 1) && this.hasFill() && this.hasStroke() && this.getStage());\n        },\n        /**\n         * return self rectangle (x, y, width, height) of shape.\n         * This method are not taken into account transformation and styles.\n         * @method\n         * @memberof Konva.Shape.prototype\n         * @returns {Object} rect with {x, y, width, height} properties\n         * @example\n         *\n         * rect.getSelfRect();  // return {x:0, y:0, width:rect.width(), height:rect.height()}\n         * circle.getSelfRect();  // return {x: - circle.width() / 2, y: - circle.height() / 2, width:circle.width(), height:circle.height()}\n         *\n         */\n        getSelfRect: function() {\n            var size = this.getSize();\n            return {\n                x: this._centroid ? Math.round(-size.width / 2) : 0,\n                y: this._centroid ? Math.round(-size.height / 2) : 0,\n                width: size.width,\n                height: size.height\n            };\n        },\n        getClientRect: function(skipTransform) {\n            var fillRect = this.getSelfRect();\n\n            var strokeWidth = (this.hasStroke() && this.strokeWidth()) || 0;\n            var fillAndStrokeWidth = fillRect.width + strokeWidth;\n            var fillAndStrokeHeight = fillRect.height + strokeWidth;\n\n            var shadowOffsetX = this.shadowOffsetX();\n            var shadowOffsetY = this.shadowOffsetY();\n\n            var preWidth = fillAndStrokeWidth + Math.abs(shadowOffsetX);\n            var preHeight = fillAndStrokeHeight + Math.abs(shadowOffsetY);\n\n            var blurRadius = (this.hasShadow() && this.shadowBlur() || 0);\n\n            var width = preWidth + blurRadius * 2;\n            var height = preHeight + blurRadius * 2;\n\n            // if stroke, for example = 3\n            // we need to set x to 1.5, but after Math.round it will be 2\n            // as we have additional offset we need to increase width and height by 1 pixel\n            var roundingOffset = 0;\n            if (Math.round(strokeWidth / 2) !== strokeWidth / 2) {\n                roundingOffset = 1;\n            }\n            var rect = {\n                width: width + roundingOffset,\n                height: height + roundingOffset,\n                x: -Math.round(strokeWidth / 2 + blurRadius) + Math.min(shadowOffsetX, 0) + fillRect.x,\n                y: -Math.round(strokeWidth / 2 + blurRadius) + Math.min(shadowOffsetY, 0) + fillRect.y\n            };\n            if (!skipTransform) {\n                return this._transformedRect(rect);\n            }\n            return rect;\n        },\n        drawScene: function(can, top, caching, skipBuffer) {\n            var layer = this.getLayer(),\n                canvas = can || layer.getCanvas(),\n                context = canvas.getContext(),\n                cachedCanvas = this._cache.canvas,\n                drawFunc = this.sceneFunc(),\n                hasShadow = this.hasShadow(),\n                hasStroke = this.hasStroke(),\n                stage, bufferCanvas, bufferContext;\n\n            if(!this.isVisible()) {\n                return this;\n            }\n            if (cachedCanvas) {\n                context.save();\n                layer._applyTransform(this, context, top);\n                this._drawCachedSceneCanvas(context);\n                context.restore();\n                return this;\n            }\n            if (!drawFunc) {\n                return this;\n            }\n            context.save();\n            // if buffer canvas is needed\n            if (this._useBufferCanvas(caching) && !skipBuffer) {\n                stage = this.getStage();\n                bufferCanvas = stage.bufferCanvas;\n                bufferContext = bufferCanvas.getContext();\n                bufferContext.clear();\n                bufferContext.save();\n                bufferContext._applyLineJoin(this);\n                // layer might be undefined if we are using cache before adding to layer\n                if (!caching) {\n                    if (layer) {\n                        layer._applyTransform(this, bufferContext, top);\n                    } else {\n                        var m = this.getAbsoluteTransform(top).getMatrix();\n                        context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n                    }\n                }\n\n                drawFunc.call(this, bufferContext);\n                bufferContext.restore();\n\n                var ratio = bufferCanvas.pixelRatio;\n                if (hasShadow && !canvas.hitCanvas) {\n                        context.save();\n                        context._applyShadow(this);\n                        context._applyOpacity(this);\n                        context.drawImage(bufferCanvas._canvas, 0, 0, bufferCanvas.width / ratio, bufferCanvas.height / ratio);\n                        context.restore();\n                } else {\n                    context._applyOpacity(this);\n                    context.drawImage(bufferCanvas._canvas, 0, 0, bufferCanvas.width / ratio, bufferCanvas.height / ratio);\n                }\n            }\n            // if buffer canvas is not needed\n            else {\n                context._applyLineJoin(this);\n                // layer might be undefined if we are using cache before adding to layer\n                if (!caching) {\n                    if (layer) {\n                        layer._applyTransform(this, context, top);\n                    } else {\n                        var o = this.getAbsoluteTransform(top).getMatrix();\n                        context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n                    }\n                }\n\n                if (hasShadow && hasStroke && !canvas.hitCanvas) {\n                    context.save();\n                    // apply shadow\n                    if (!caching) {\n                        context._applyOpacity(this);\n                    }\n                    context._applyShadow(this);\n                    drawFunc.call(this, context);\n                    context.restore();\n                    // if shape has stroke we need to redraw shape\n                    // otherwise we will see a shadow under stroke (and over fill)\n                    // but I think this is unexpected behavior\n                    if (this.hasFill() && this.getShadowForStrokeEnabled()) {\n                        drawFunc.call(this, context);\n                    }\n                } else if (hasShadow && !canvas.hitCanvas) {\n                    context.save();\n                    if (!caching) {\n                        context._applyOpacity(this);\n                    }\n                    context._applyShadow(this);\n                    drawFunc.call(this, context);\n                    context.restore();\n                } else {\n                    if (!caching) {\n                        context._applyOpacity(this);\n                    }\n                    drawFunc.call(this, context);\n                }\n            }\n            context.restore();\n            return this;\n        },\n        drawHit: function(can, top, caching) {\n            var layer = this.getLayer(),\n                canvas = can || layer.hitCanvas,\n                context = canvas.getContext(),\n                drawFunc = this.hitFunc() || this.sceneFunc(),\n                cachedCanvas = this._cache.canvas,\n                cachedHitCanvas = cachedCanvas && cachedCanvas.hit;\n\n            if(!this.shouldDrawHit(canvas)) {\n                return this;\n            }\n            if (layer) {\n                layer.clearHitCache();\n            }\n            if (cachedHitCanvas) {\n                context.save();\n                layer._applyTransform(this, context, top);\n                this._drawCachedHitCanvas(context);\n                context.restore();\n                return this;\n            }\n            if (!drawFunc) {\n                return this;\n            }\n            context.save();\n            context._applyLineJoin(this);\n            if (!caching) {\n                if (layer) {\n                    layer._applyTransform(this, context, top);\n                } else {\n                    var o = this.getAbsoluteTransform(top).getMatrix();\n                    context.transform(o[0], o[1], o[2], o[3], o[4], o[5]);\n                }\n            }\n            drawFunc.call(this, context);\n            context.restore();\n            return this;\n        },\n        /**\n        * draw hit graph using the cached scene canvas\n        * @method\n        * @memberof Konva.Shape.prototype\n        * @param {Integer} alphaThreshold alpha channel threshold that determines whether or not\n        *  a pixel should be drawn onto the hit graph.  Must be a value between 0 and 255.\n        *  The default is 0\n        * @returns {Konva.Shape}\n        * @example\n        * shape.cache();\n        * shape.drawHitFromCache();\n        */\n        drawHitFromCache: function(alphaThreshold) {\n            var threshold = alphaThreshold || 0,\n                cachedCanvas = this._cache.canvas,\n                sceneCanvas = this._getCachedSceneCanvas(),\n                hitCanvas = cachedCanvas.hit,\n                hitContext = hitCanvas.getContext(),\n                hitWidth = hitCanvas.getWidth(),\n                hitHeight = hitCanvas.getHeight(),\n                hitImageData, hitData, len, rgbColorKey, i, alpha;\n\n            hitContext.clear();\n            hitContext.drawImage(sceneCanvas._canvas, 0, 0, hitWidth, hitHeight);\n\n            try {\n                hitImageData = hitContext.getImageData(0, 0, hitWidth, hitHeight);\n                hitData = hitImageData.data;\n                len = hitData.length;\n                rgbColorKey = Konva.Util._hexToRgb(this.colorKey);\n\n                // replace non transparent pixels with color key\n                for(i = 0; i < len; i += 4) {\n                    alpha = hitData[i + 3];\n                    if (alpha > threshold) {\n                        hitData[i] = rgbColorKey.r;\n                        hitData[i + 1] = rgbColorKey.g;\n                        hitData[i + 2] = rgbColorKey.b;\n                        hitData[i + 3] = 255;\n                    }\n                    else {\n                        hitData[i + 3] = 0;\n                    }\n                }\n                hitContext.putImageData(hitImageData, 0, 0);\n            }\n            catch(e) {\n                Konva.Util.error('Unable to draw hit graph from cached scene canvas. ' + e.message);\n            }\n\n            return this;\n        }\n    });\n    Konva.Util.extend(Konva.Shape, Konva.Node);\n\n    // add getters and setters\n    Konva.Factory.addGetterSetter(Konva.Shape, 'stroke');\n\n    /**\n     * get/set stroke color\n     * @name stroke\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} color\n     * @returns {String}\n     * @example\n     * // get stroke color\n     * var stroke = shape.stroke();\n     *\n     * // set stroke color with color string\n     * shape.stroke('green');\n     *\n     * // set stroke color with hex\n     * shape.stroke('#00ff00');\n     *\n     * // set stroke color with rgb\n     * shape.stroke('rgb(0,255,0)');\n     *\n     * // set stroke color with rgba and make it 50% opaque\n     * shape.stroke('rgba(0,255,0,0.5');\n     */\n\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'strokeRed', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'strokeGreen', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'strokeBlue', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'strokeAlpha', 1, Konva.Validators.alphaComponent);\n\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'strokeWidth', 2);\n\n    /**\n     * get/set stroke width\n     * @name strokeWidth\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} strokeWidth\n     * @returns {Number}\n     * @example\n     * // get stroke width\n     * var strokeWidth = shape.strokeWidth();\n     *\n     * // set stroke width\n     * shape.strokeWidth();\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'strokeHitEnabled', true);\n\n    /**\n     * get/set strokeHitEnabled property. Useful for performance optimization.\n     * You may set `shape.strokeHitEnabled(false)`. In this case stroke will be no draw on hit canvas, so hit area\n     * of shape will be decreased (by lineWidth / 2). Remember that non closed line with `strokeHitEnabled = false`\n     * will be not drawn on hit canvas, that is mean line will no trigger pointer events (like mouseover)\n     * Default value is true\n     * @name strokeHitEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} strokeHitEnabled\n     * @returns {Boolean}\n     * @example\n     * // get strokeHitEnabled\n     * var strokeHitEnabled = shape.strokeHitEnabled();\n     *\n     * // set strokeHitEnabled\n     * shape.strokeHitEnabled();\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'perfectDrawEnabled', true);\n\n    /**\n     * get/set perfectDrawEnabled. If a shape has fill, stroke and opacity you may set `perfectDrawEnabled` to improve performance.\n     * See http://konvajs.github.io/docs/performance/Disable_Perfect_Draw.html for more information.\n     * Default value is true\n     * @name perfectDrawEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} perfectDrawEnabled\n     * @returns {Boolean}\n     * @example\n     * // get perfectDrawEnabled\n     * var perfectDrawEnabled = shape.perfectDrawEnabled();\n     *\n     * // set perfectDrawEnabled\n     * shape.perfectDrawEnabled();\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowForStrokeEnabled', true);\n\n    /**\n     * get/set shadowForStrokeEnabled. Useful for performance optimization.\n     * You may set `shape.shadowForStrokeEnabled(false)`. In this case stroke will be no draw shadow for stroke.\n     * Remember if you set `shadowForStrokeEnabled = false` for non closed line - that line with have no shadow!.\n     * Default value is true\n     * @name shadowForStrokeEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} shadowForStrokeEnabled\n     * @returns {Boolean}\n     * @example\n     * // get shadowForStrokeEnabled\n     * var shadowForStrokeEnabled = shape.shadowForStrokeEnabled();\n     *\n     * // set shadowForStrokeEnabled\n     * shape.shadowForStrokeEnabled();\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'lineJoin');\n\n    /**\n     * get/set line join.  Can be miter, round, or bevel.  The\n     *  default is miter\n     * @name lineJoin\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} lineJoin\n     * @returns {String}\n     * @example\n     * // get line join\n     * var lineJoin = shape.lineJoin();\n     *\n     * // set line join\n     * shape.lineJoin('round');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'lineCap');\n\n    /**\n     * get/set line cap.  Can be butt, round, or square\n     * @name lineCap\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} lineCap\n     * @returns {String}\n     * @example\n     * // get line cap\n     * var lineCap = shape.lineCap();\n     *\n     * // set line cap\n     * shape.lineCap('round');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'sceneFunc');\n\n    /**\n     * get/set scene draw function\n     * @name sceneFunc\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Function} drawFunc drawing function\n     * @returns {Function}\n     * @example\n     * // get scene draw function\n     * var sceneFunc = shape.sceneFunc();\n     *\n     * // set scene draw function\n     * shape.sceneFunc(function(context) {\n     *   context.beginPath();\n     *   context.rect(0, 0, this.width(), this.height());\n     *   context.closePath();\n     *   context.fillStrokeShape(this);\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'hitFunc');\n\n    /**\n     * get/set hit draw function\n     * @name hitFunc\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Function} drawFunc drawing function\n     * @returns {Function}\n     * @example\n     * // get hit draw function\n     * var hitFunc = shape.hitFunc();\n     *\n     * // set hit draw function\n     * shape.hitFunc(function(context) {\n     *   context.beginPath();\n     *   context.rect(0, 0, this.width(), this.height());\n     *   context.closePath();\n     *   context.fillStrokeShape(this);\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'dash');\n\n    /**\n     * get/set dash array for stroke.\n     * @name dash\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Array} dash\n     * @returns {Array}\n     * @example\n     *  // apply dashed stroke that is 10px long and 5 pixels apart\n     *  line.dash([10, 5]);\n     *  // apply dashed stroke that is made up of alternating dashed\n     *  // lines that are 10px long and 20px apart, and dots that have\n     *  // a radius of 5px and are 20px apart\n     *  line.dash([10, 20, 0.001, 20]);\n     */\n\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowColor');\n\n    /**\n     * get/set shadow color\n     * @name shadowColor\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} color\n     * @returns {String}\n     * @example\n     * // get shadow color\n     * var shadow = shape.shadowColor();\n     *\n     * // set shadow color with color string\n     * shape.shadowColor('green');\n     *\n     * // set shadow color with hex\n     * shape.shadowColor('#00ff00');\n     *\n     * // set shadow color with rgb\n     * shape.shadowColor('rgb(0,255,0)');\n     *\n     * // set shadow color with rgba and make it 50% opaque\n     * shape.shadowColor('rgba(0,255,0,0.5');\n     */\n\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'shadowRed', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'shadowGreen', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'shadowBlue', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'shadowAlpha', 1, Konva.Validators.alphaComponent);\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowBlur');\n\n    /**\n     * get/set shadow blur\n     * @name shadowBlur\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} blur\n     * @returns {Number}\n     * @example\n     * // get shadow blur\n     * var shadowBlur = shape.shadowBlur();\n     *\n     * // set shadow blur\n     * shape.shadowBlur(10);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowOpacity');\n\n    /**\n     * get/set shadow opacity.  must be a value between 0 and 1\n     * @name shadowOpacity\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} opacity\n     * @returns {Number}\n     * @example\n     * // get shadow opacity\n     * var shadowOpacity = shape.shadowOpacity();\n     *\n     * // set shadow opacity\n     * shape.shadowOpacity(0.5);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'shadowOffset', ['x', 'y']);\n\n    /**\n     * get/set shadow offset\n     * @name shadowOffset\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} offset\n     * @param {Number} offset.x\n     * @param {Number} offset.y\n     * @returns {Object}\n     * @example\n     * // get shadow offset\n     * var shadowOffset = shape.shadowOffset();\n     *\n     * // set shadow offset\n     * shape.shadowOffset({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowOffsetX', 0);\n\n     /**\n     * get/set shadow offset x\n     * @name shadowOffsetX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get shadow offset x\n     * var shadowOffsetX = shape.shadowOffsetX();\n     *\n     * // set shadow offset x\n     * shape.shadowOffsetX(5);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowOffsetY', 0);\n\n     /**\n     * get/set shadow offset y\n     * @name shadowOffsetY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get shadow offset y\n     * var shadowOffsetY = shape.shadowOffsetY();\n     *\n     * // set shadow offset y\n     * shape.shadowOffsetY(5);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternImage');\n\n    /**\n     * get/set fill pattern image\n     * @name fillPatternImage\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Image} image object\n     * @returns {Image}\n     * @example\n     * // get fill pattern image\n     * var fillPatternImage = shape.fillPatternImage();\n     *\n     * // set fill pattern image\n     * var imageObj = new Image();\n     * imageObj.onload = function() {\n     *   shape.fillPatternImage(imageObj);\n     * };\n     * imageObj.src = 'path/to/image/jpg';\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fill');\n\n    /**\n     * get/set fill color\n     * @name fill\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} color\n     * @returns {String}\n     * @example\n     * // get fill color\n     * var fill = shape.fill();\n     *\n     * // set fill color with color string\n     * shape.fill('green');\n     *\n     * // set fill color with hex\n     * shape.fill('#00ff00');\n     *\n     * // set fill color with rgb\n     * shape.fill('rgb(0,255,0)');\n     *\n     * // set fill color with rgba and make it 50% opaque\n     * shape.fill('rgba(0,255,0,0.5');\n     *\n     * // shape without fill\n     * shape.fill(null);\n     */\n\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'fillRed', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'fillGreen', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'fillBlue', 0, Konva.Validators.RGBComponent);\n    Konva.Factory.addDeprecatedGetterSetter(Konva.Shape, 'fillAlpha', 1, Konva.Validators.alphaComponent);\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternX', 0);\n\n    /**\n     * get/set fill pattern x\n     * @name fillPatternX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill pattern x\n     * var fillPatternX = shape.fillPatternX();\n     * // set fill pattern x\n     * shape.fillPatternX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternY', 0);\n\n    /**\n     * get/set fill pattern y\n     * @name fillPatternY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill pattern y\n     * var fillPatternY = shape.fillPatternY();\n     * // set fill pattern y\n     * shape.fillPatternY(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillLinearGradientColorStops');\n\n    /**\n     * get/set fill linear gradient color stops\n     * @name fillLinearGradientColorStops\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Array} colorStops\n     * @returns {Array} colorStops\n     * @example\n     * // get fill linear gradient color stops\n     * var colorStops = shape.fillLinearGradientColorStops();\n     *\n     * // create a linear gradient that starts with red, changes to blue\n     * // halfway through, and then changes to green\n     * shape.fillLinearGradientColorStops(0, 'red', 0.5, 'blue', 1, 'green');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientStartRadius', 0);\n\n    /**\n     * get/set fill radial gradient start radius\n     * @name fillRadialGradientStartRadius\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} radius\n     * @returns {Number}\n     * @example\n     * // get radial gradient start radius\n     * var startRadius = shape.fillRadialGradientStartRadius();\n     *\n     * // set radial gradient start radius\n     * shape.fillRadialGradientStartRadius(0);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientEndRadius', 0);\n\n    /**\n     * get/set fill radial gradient end radius\n     * @name fillRadialGradientEndRadius\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} radius\n     * @returns {Number}\n     * @example\n     * // get radial gradient end radius\n     * var endRadius = shape.fillRadialGradientEndRadius();\n     *\n     * // set radial gradient end radius\n     * shape.fillRadialGradientEndRadius(100);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientColorStops');\n\n    /**\n     * get/set fill radial gradient color stops\n     * @name fillRadialGradientColorStops\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} colorStops\n     * @returns {Array}\n     * @example\n     * // get fill radial gradient color stops\n     * var colorStops = shape.fillRadialGradientColorStops();\n     *\n     * // create a radial gradient that starts with red, changes to blue\n     * // halfway through, and then changes to green\n     * shape.fillRadialGradientColorStops(0, 'red', 0.5, 'blue', 1, 'green');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternRepeat', 'repeat');\n\n    /**\n     * get/set fill pattern repeat.  Can be 'repeat', 'repeat-x', 'repeat-y', or 'no-repeat'.  The default is 'repeat'\n     * @name fillPatternRepeat\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} repeat\n     * @returns {String}\n     * @example\n     * // get fill pattern repeat\n     * var repeat = shape.fillPatternRepeat();\n     *\n     * // repeat pattern in x direction only\n     * shape.fillPatternRepeat('repeat-x');\n     *\n     * // do not repeat the pattern\n     * shape.fillPatternRepeat('no repeat');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillEnabled', true);\n\n    /**\n     * get/set fill enabled flag\n     * @name fillEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get fill enabled flag\n     * var fillEnabled = shape.fillEnabled();\n     *\n     * // disable fill\n     * shape.fillEnabled(false);\n     *\n     * // enable fill\n     * shape.fillEnabled(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'strokeEnabled', true);\n\n    /**\n     * get/set stroke enabled flag\n     * @name strokeEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get stroke enabled flag\n     * var strokeEnabled = shape.strokeEnabled();\n     *\n     * // disable stroke\n     * shape.strokeEnabled(false);\n     *\n     * // enable stroke\n     * shape.strokeEnabled(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'shadowEnabled', true);\n\n    /**\n     * get/set shadow enabled flag\n     * @name shadowEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get shadow enabled flag\n     * var shadowEnabled = shape.shadowEnabled();\n     *\n     * // disable shadow\n     * shape.shadowEnabled(false);\n     *\n     * // enable shadow\n     * shape.shadowEnabled(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'dashEnabled', true);\n\n    /**\n     * get/set dash enabled flag\n     * @name dashEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get dash enabled flag\n     * var dashEnabled = shape.dashEnabled();\n     *\n     * // disable dash\n     * shape.dashEnabled(false);\n     *\n     * // enable dash\n     * shape.dashEnabled(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'strokeScaleEnabled', true);\n\n    /**\n     * get/set strokeScale enabled flag\n     * @name strokeScaleEnabled\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get stroke scale enabled flag\n     * var strokeScaleEnabled = shape.strokeScaleEnabled();\n     *\n     * // disable stroke scale\n     * shape.strokeScaleEnabled(false);\n     *\n     * // enable stroke scale\n     * shape.strokeScaleEnabled(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPriority', 'color');\n\n    /**\n     * get/set fill priority.  can be color, pattern, linear-gradient, or radial-gradient.  The default is color.\n     *   This is handy if you want to toggle between different fill types.\n     * @name fillPriority\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {String} priority\n     * @returns {String}\n     * @example\n     * // get fill priority\n     * var fillPriority = shape.fillPriority();\n     *\n     * // set fill priority\n     * shape.fillPriority('linear-gradient');\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillPatternOffset', ['x', 'y']);\n\n    /**\n     * get/set fill pattern offset\n     * @name fillPatternOffset\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} offset\n     * @param {Number} offset.x\n     * @param {Number} offset.y\n     * @returns {Object}\n     * @example\n     * // get fill pattern offset\n     * var patternOffset = shape.fillPatternOffset();\n     *\n     * // set fill pattern offset\n     * shape.fillPatternOffset({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternOffsetX', 0);\n    /**\n     * get/set fill pattern offset x\n     * @name fillPatternOffsetX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill pattern offset x\n     * var patternOffsetX = shape.fillPatternOffsetX();\n     *\n     * // set fill pattern offset x\n     * shape.fillPatternOffsetX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternOffsetY', 0);\n    /**\n     * get/set fill pattern offset y\n     * @name fillPatternOffsetY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill pattern offset y\n     * var patternOffsetY = shape.fillPatternOffsetY();\n     *\n     * // set fill pattern offset y\n     * shape.fillPatternOffsetY(10);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillPatternScale', ['x', 'y']);\n\n    /**\n     * get/set fill pattern scale\n     * @name fillPatternScale\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} scale\n     * @param {Number} scale.x\n     * @param {Number} scale.y\n     * @returns {Object}\n     * @example\n     * // get fill pattern scale\n     * var patternScale = shape.fillPatternScale();\n     *\n     * // set fill pattern scale\n     * shape.fillPatternScale({\n     *   x: 2\n     *   y: 2\n     * });\n     */\n\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternScaleX', 1);\n    /**\n     * get/set fill pattern scale x\n     * @name fillPatternScaleX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill pattern scale x\n     * var patternScaleX = shape.fillPatternScaleX();\n     *\n     * // set fill pattern scale x\n     * shape.fillPatternScaleX(2);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternScaleY', 1);\n    /**\n     * get/set fill pattern scale y\n     * @name fillPatternScaleY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill pattern scale y\n     * var patternScaleY = shape.fillPatternScaleY();\n     *\n     * // set fill pattern scale y\n     * shape.fillPatternScaleY(2);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillLinearGradientStartPoint', ['x', 'y']);\n\n    /**\n     * get/set fill linear gradient start point\n     * @name fillLinearGradientStartPoint\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} startPoint\n     * @param {Number} startPoint.x\n     * @param {Number} startPoint.y\n     * @returns {Object}\n     * @example\n     * // get fill linear gradient start point\n     * var startPoint = shape.fillLinearGradientStartPoint();\n     *\n     * // set fill linear gradient start point\n     * shape.fillLinearGradientStartPoint({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillLinearGradientStartPointX', 0);\n    /**\n     * get/set fill linear gradient start point x\n     * @name fillLinearGradientStartPointX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill linear gradient start point x\n     * var startPointX = shape.fillLinearGradientStartPointX();\n     *\n     * // set fill linear gradient start point x\n     * shape.fillLinearGradientStartPointX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillLinearGradientStartPointY', 0);\n    /**\n     * get/set fill linear gradient start point y\n     * @name fillLinearGradientStartPointY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill linear gradient start point y\n     * var startPointY = shape.fillLinearGradientStartPointY();\n     *\n     * // set fill linear gradient start point y\n     * shape.fillLinearGradientStartPointY(20);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillLinearGradientEndPoint', ['x', 'y']);\n\n    /**\n     * get/set fill linear gradient end point\n     * @name fillLinearGradientEndPoint\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} endPoint\n     * @param {Number} endPoint.x\n     * @param {Number} endPoint.y\n     * @returns {Object}\n     * @example\n     * // get fill linear gradient end point\n     * var endPoint = shape.fillLinearGradientEndPoint();\n     *\n     * // set fill linear gradient end point\n     * shape.fillLinearGradientEndPoint({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillLinearGradientEndPointX', 0);\n    /**\n     * get/set fill linear gradient end point x\n     * @name fillLinearGradientEndPointX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill linear gradient end point x\n     * var endPointX = shape.fillLinearGradientEndPointX();\n     *\n     * // set fill linear gradient end point x\n     * shape.fillLinearGradientEndPointX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillLinearGradientEndPointY', 0);\n    /**\n     * get/set fill linear gradient end point y\n     * @name fillLinearGradientEndPointY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill linear gradient end point y\n     * var endPointY = shape.fillLinearGradientEndPointY();\n     *\n     * // set fill linear gradient end point y\n     * shape.fillLinearGradientEndPointY(20);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillRadialGradientStartPoint', ['x', 'y']);\n\n    /**\n     * get/set fill radial gradient start point\n     * @name fillRadialGradientStartPoint\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} startPoint\n     * @param {Number} startPoint.x\n     * @param {Number} startPoint.y\n     * @returns {Object}\n     * @example\n     * // get fill radial gradient start point\n     * var startPoint = shape.fillRadialGradientStartPoint();\n     *\n     * // set fill radial gradient start point\n     * shape.fillRadialGradientStartPoint({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientStartPointX', 0);\n    /**\n     * get/set fill radial gradient start point x\n     * @name fillRadialGradientStartPointX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill radial gradient start point x\n     * var startPointX = shape.fillRadialGradientStartPointX();\n     *\n     * // set fill radial gradient start point x\n     * shape.fillRadialGradientStartPointX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientStartPointY', 0);\n    /**\n     * get/set fill radial gradient start point y\n     * @name fillRadialGradientStartPointY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill radial gradient start point y\n     * var startPointY = shape.fillRadialGradientStartPointY();\n     *\n     * // set fill radial gradient start point y\n     * shape.fillRadialGradientStartPointY(20);\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Shape, 'fillRadialGradientEndPoint', ['x', 'y']);\n\n    /**\n     * get/set fill radial gradient end point\n     * @name fillRadialGradientEndPoint\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Object} endPoint\n     * @param {Number} endPoint.x\n     * @param {Number} endPoint.y\n     * @returns {Object}\n     * @example\n     * // get fill radial gradient end point\n     * var endPoint = shape.fillRadialGradientEndPoint();\n     *\n     * // set fill radial gradient end point\n     * shape.fillRadialGradientEndPoint({\n     *   x: 20\n     *   y: 10\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientEndPointX', 0);\n    /**\n     * get/set fill radial gradient end point x\n     * @name fillRadialGradientEndPointX\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get fill radial gradient end point x\n     * var endPointX = shape.fillRadialGradientEndPointX();\n     *\n     * // set fill radial gradient end point x\n     * shape.fillRadialGradientEndPointX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillRadialGradientEndPointY', 0);\n    /**\n     * get/set fill radial gradient end point y\n     * @name fillRadialGradientEndPointY\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get fill radial gradient end point y\n     * var endPointY = shape.fillRadialGradientEndPointY();\n     *\n     * // set fill radial gradient end point y\n     * shape.fillRadialGradientEndPointY(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Shape, 'fillPatternRotation', 0);\n\n    /**\n     * get/set fill pattern rotation in degrees\n     * @name fillPatternRotation\n     * @method\n     * @memberof Konva.Shape.prototype\n     * @param {Number} rotation\n     * @returns {Konva.Shape}\n     * @example\n     * // get fill pattern rotation\n     * var patternRotation = shape.fillPatternRotation();\n     *\n     * // set fill pattern rotation\n     * shape.fillPatternRotation(20);\n     */\n\n\n    Konva.Factory.backCompat(Konva.Shape, {\n        dashArray: 'dash',\n        getDashArray: 'getDash',\n        setDashArray: 'getDash',\n\n        drawFunc: 'sceneFunc',\n        getDrawFunc: 'getSceneFunc',\n        setDrawFunc: 'setSceneFunc',\n\n        drawHitFunc: 'hitFunc',\n        getDrawHitFunc: 'getHitFunc',\n        setDrawHitFunc: 'setHitFunc'\n    });\n\n    Konva.Collection.mapMethods(Konva.Shape);\n})(Konva);\n\n(function() {\n    'use strict';\n    // CONSTANTS\n    var STAGE = 'Stage',\n        STRING = 'string',\n        PX = 'px',\n\n        MOUSEOUT = 'mouseout',\n        MOUSELEAVE = 'mouseleave',\n        MOUSEOVER = 'mouseover',\n        MOUSEENTER = 'mouseenter',\n        MOUSEMOVE = 'mousemove',\n        MOUSEDOWN = 'mousedown',\n        MOUSEUP = 'mouseup',\n        CLICK = 'click',\n        DBL_CLICK = 'dblclick',\n        TOUCHSTART = 'touchstart',\n        TOUCHEND = 'touchend',\n        TAP = 'tap',\n        DBL_TAP = 'dbltap',\n        TOUCHMOVE = 'touchmove',\n        DOMMOUSESCROLL = 'DOMMouseScroll',\n        MOUSEWHEEL = 'mousewheel',\n        WHEEL = 'wheel',\n\n        CONTENT_MOUSEOUT = 'contentMouseout',\n        CONTENT_MOUSEOVER = 'contentMouseover',\n        CONTENT_MOUSEMOVE = 'contentMousemove',\n        CONTENT_MOUSEDOWN = 'contentMousedown',\n        CONTENT_MOUSEUP = 'contentMouseup',\n        CONTENT_CLICK = 'contentClick',\n        CONTENT_DBL_CLICK = 'contentDblclick',\n        CONTENT_TOUCHSTART = 'contentTouchstart',\n        CONTENT_TOUCHEND = 'contentTouchend',\n        CONTENT_DBL_TAP = 'contentDbltap',\n        CONTENT_TAP = 'contentTap',\n        CONTENT_TOUCHMOVE = 'contentTouchmove',\n        CONTENT_WHEEL = 'contentWheel',\n\n        DIV = 'div',\n        RELATIVE = 'relative',\n        KONVA_CONTENT = 'konvajs-content',\n        SPACE = ' ',\n        UNDERSCORE = '_',\n        CONTAINER = 'container',\n        EMPTY_STRING = '',\n        EVENTS = [MOUSEDOWN, MOUSEMOVE, MOUSEUP, MOUSEOUT, TOUCHSTART, TOUCHMOVE, TOUCHEND, MOUSEOVER, DOMMOUSESCROLL, MOUSEWHEEL, WHEEL],\n\n        // cached variables\n        eventsLength = EVENTS.length;\n\n    function addEvent(ctx, eventName) {\n        ctx.content.addEventListener(eventName, function(evt) {\n            ctx[UNDERSCORE + eventName](evt);\n        }, false);\n    }\n\n    /**\n     * Stage constructor.  A stage is used to contain multiple layers\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Container\n     * @param {Object} config\n     * @param {String|Element} config.container Container selector or DOM element\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var stage = new Konva.Stage({\n         *   width: 500,\n         *   height: 800,\n         *   container: 'containerId' // or \"#containerId\" or \".containerClass\"\n         * });\n     */\n    Konva.Stage = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Stage, {\n        ___init: function(config) {\n            this.nodeType = STAGE;\n            // call super constructor\n            Konva.Container.call(this, config);\n            this._id = Konva.idCounter++;\n            this._buildDOM();\n            this._bindContentEvents();\n            this._enableNestedTransforms = false;\n            Konva.stages.push(this);\n        },\n        _validateAdd: function(child) {\n            if (child.getType() !== 'Layer') {\n                Konva.Util.throw('You may only add layers to the stage.');\n            }\n        },\n        /**\n         * set container dom element which contains the stage wrapper div element\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {DomElement} container can pass in a dom element or id string\n         */\n        setContainer: function (container) {\n            if (typeof container === STRING) {\n                if (container.charAt(0) === '.') {\n                    var className = container.slice(1);\n                    container = Konva.document.getElementsByClassName(className)[0];\n                } else {\n                    var id;\n                    if (container.charAt(0) !== '#') {\n                        id = container;\n                    } else {\n                        id = container.slice(1);\n                    }\n                    container = Konva.document.getElementById(id);\n                }\n                if (!container) {\n                    throw 'Can not find container in document with id ' + id;\n                }\n            }\n            this._setAttr(CONTAINER, container);\n            return this;\n        },\n        shouldDrawHit: function() {\n            return true;\n        },\n        draw: function() {\n            Konva.Node.prototype.draw.call(this);\n            return this;\n        },\n        /**\n         * draw layer scene graphs\n         * @name draw\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n\n        /**\n         * draw layer hit graphs\n         * @name drawHit\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n\n        /**\n         * set height\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {Number} height\n         */\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            this._resizeDOM();\n            return this;\n        },\n        /**\n         * set width\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {Number} width\n         */\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            this._resizeDOM();\n            return this;\n        },\n        /**\n         * clear all layers\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n        clear: function() {\n            var layers = this.children,\n                len = layers.length,\n                n;\n\n            for(n = 0; n < len; n++) {\n                layers[n].clear();\n            }\n            return this;\n        },\n        clone: function(obj) {\n            if (!obj) {\n                obj = {};\n            }\n            obj.container = Konva.document.createElement(DIV);\n            return Konva.Container.prototype.clone.call(this, obj);\n        },\n        /**\n         * destroy stage\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n        destroy: function() {\n            var content = this.content;\n            Konva.Container.prototype.destroy.call(this);\n\n            if(content && Konva.Util._isInDocument(content)) {\n                this.getContainer().removeChild(content);\n            }\n            var index = Konva.stages.indexOf(this);\n            if (index > -1) {\n                Konva.stages.splice(index, 1);\n            }\n            return this;\n        },\n        /**\n         * get pointer position which can be a touch position or mouse position\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @returns {Object}\n         */\n        getPointerPosition: function() {\n            return this.pointerPos;\n        },\n        getStage: function() {\n            return this;\n        },\n        /**\n         * get stage content div element which has the\n         *  the class name \"konvajs-content\"\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n        getContent: function() {\n            return this.content;\n        },\n        /**\n         * Creates a composite data URL\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {Object} config\n         * @param {Function} [config.callback] function executed when the composite has completed. Deprecated as method is sync now.\n         * @param {String} [config.mimeType] can be \"image/png\" or \"image/jpeg\".\n         *  \"image/png\" is the default\n         * @param {Number} [config.x] x position of canvas section\n         * @param {Number} [config.y] y position of canvas section\n         * @param {Number} [config.width] width of canvas section\n         * @param {Number} [config.height] height of canvas section\n         * @param {Number} [config.quality] jpeg quality.  If using an \"image/jpeg\" mimeType,\n         *  you can specify the quality from 0 to 1, where 0 is very poor quality and 1\n         *  is very high quality\n         */\n        toDataURL: function(config) {\n            config = config || {};\n\n            var mimeType = config.mimeType || null,\n                quality = config.quality || null,\n                x = config.x || 0,\n                y = config.y || 0,\n                canvas = new Konva.SceneCanvas({\n                    width: config.width || this.getWidth(),\n                    height: config.height || this.getHeight(),\n                    pixelRatio: config.pixelRatio\n                }),\n                _context = canvas.getContext()._context,\n                layers = this.children;\n\n            if(x || y) {\n                _context.translate(-1 * x, -1 * y);\n            }\n\n\n            layers.each(function(layer) {\n                var width = layer.getCanvas().getWidth();\n                var height = layer.getCanvas().getHeight();\n                var ratio = layer.getCanvas().getPixelRatio();\n                _context.drawImage(layer.getCanvas()._canvas, 0, 0, width / ratio, height / ratio);\n            });\n            var src = canvas.toDataURL(mimeType, quality);\n\n            if (config.callback) {\n                config.callback(src);\n            }\n\n            return src;\n        },\n        /**\n         * converts stage into an image.\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {Object} config\n         * @param {Function} config.callback function executed when the composite has completed\n         * @param {String} [config.mimeType] can be \"image/png\" or \"image/jpeg\".\n         *  \"image/png\" is the default\n         * @param {Number} [config.x] x position of canvas section\n         * @param {Number} [config.y] y position of canvas section\n         * @param {Number} [config.width] width of canvas section\n         * @param {Number} [config.height] height of canvas section\n         * @param {Number} [config.quality] jpeg quality.  If using an \"image/jpeg\" mimeType,\n         *  you can specify the quality from 0 to 1, where 0 is very poor quality and 1\n         *  is very high quality\n         */\n        toImage: function(config) {\n            var cb = config.callback;\n\n            config.callback = function(dataUrl) {\n                Konva.Util._getImage(dataUrl, function(img) {\n                    cb(img);\n                });\n            };\n            this.toDataURL(config);\n        },\n        /**\n         * get visible intersection shape. This is the preferred\n         *  method for determining if a point intersects a shape or not\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {Object} pos\n         * @param {Number} pos.x\n         * @param {Number} pos.y\n         * @param {String} [selector]\n         * @returns {Konva.Node}\n         * @example\n         * var shape = stage.getIntersection({x: 50, y: 50});\n         * // or if you interested in shape parent:\n         * var group = stage.getIntersection({x: 50, y: 50}, 'Group');\n         */\n        getIntersection: function(pos, selector) {\n            var layers = this.getChildren(),\n                len = layers.length,\n                end = len - 1,\n                n, shape;\n\n            for(n = end; n >= 0; n--) {\n                shape = layers[n].getIntersection(pos, selector);\n                if (shape) {\n                    return shape;\n                }\n            }\n\n            return null;\n        },\n        _resizeDOM: function() {\n            if(this.content) {\n                var width = this.getWidth(),\n                    height = this.getHeight(),\n                    layers = this.getChildren(),\n                    len = layers.length,\n                    n, layer;\n\n                // set content dimensions\n                this.content.style.width = width + PX;\n                this.content.style.height = height + PX;\n\n                this.bufferCanvas.setSize(width, height);\n                this.bufferHitCanvas.setSize(width, height);\n\n                // set layer dimensions\n                for(n = 0; n < len; n++) {\n                    layer = layers[n];\n                    layer.setSize(width, height);\n                    layer.draw();\n                }\n            }\n        },\n        /**\n         * add layer or layers to stage\n         * @method\n         * @memberof Konva.Stage.prototype\n         * @param {...Konva.Layer} layer\n         * @example\n         * stage.add(layer1, layer2, layer3);\n         */\n        add: function(layer) {\n            if (arguments.length > 1) {\n                for (var i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            Konva.Container.prototype.add.call(this, layer);\n            layer._setCanvasSize(this.width(), this.height());\n\n            // draw layer and append canvas to container\n            layer.draw();\n            this.content.appendChild(layer.canvas._canvas);\n\n            // chainable\n            return this;\n        },\n        getParent: function() {\n            return null;\n        },\n        getLayer: function() {\n            return null;\n        },\n        /**\n         * returns a {@link Konva.Collection} of layers\n         * @method\n         * @memberof Konva.Stage.prototype\n         */\n        getLayers: function() {\n            return this.getChildren();\n        },\n        _bindContentEvents: function() {\n            for (var n = 0; n < eventsLength; n++) {\n                addEvent(this, EVENTS[n]);\n            }\n        },\n        _mouseover: function(evt) {\n            if (!Konva.UA.mobile) {\n                this._setPointerPosition(evt);\n                this._fire(CONTENT_MOUSEOVER, {evt: evt});\n            }\n        },\n        _mouseout: function(evt) {\n            if (!Konva.UA.mobile) {\n                this._setPointerPosition(evt);\n                var targetShape = this.targetShape;\n\n                if(targetShape && !Konva.isDragging()) {\n                    targetShape._fireAndBubble(MOUSEOUT, {evt: evt});\n                    targetShape._fireAndBubble(MOUSELEAVE, {evt: evt});\n                    this.targetShape = null;\n                }\n                this.pointerPos = undefined;\n\n                this._fire(CONTENT_MOUSEOUT, {evt: evt});\n            }\n        },\n        _mousemove: function(evt) {\n            // workaround for mobile IE to force touch event when unhandled pointer event elevates into a mouse event\n            if (Konva.UA.ieMobile) {\n                return this._touchmove(evt);\n            }\n            // workaround fake mousemove event in chrome browser https://code.google.com/p/chromium/issues/detail?id=161464\n            if ((typeof evt.movementX !== 'undefined' || typeof evt.movementY !== 'undefined') && evt.movementY === 0 && evt.movementX === 0) {\n                return null;\n            }\n            if (Konva.UA.mobile) {\n                return null;\n            }\n            this._setPointerPosition(evt);\n            var shape;\n\n            if (!Konva.isDragging()) {\n                shape = this.getIntersection(this.getPointerPosition());\n                if(shape && shape.isListening()) {\n                    if(!Konva.isDragging() && (!this.targetShape || this.targetShape._id !== shape._id)) {\n                        if(this.targetShape) {\n                            this.targetShape._fireAndBubble(MOUSEOUT, {evt: evt}, shape);\n                            this.targetShape._fireAndBubble(MOUSELEAVE, {evt: evt}, shape);\n                        }\n                        shape._fireAndBubble(MOUSEOVER, {evt: evt}, this.targetShape);\n                        shape._fireAndBubble(MOUSEENTER, {evt: evt}, this.targetShape);\n                        this.targetShape = shape;\n                    }\n                    else {\n                        shape._fireAndBubble(MOUSEMOVE, {evt: evt});\n                    }\n                }\n                /*\n                 * if no shape was detected, clear target shape and try\n                 * to run mouseout from previous target shape\n                 */\n                else {\n                    if(this.targetShape && !Konva.isDragging()) {\n                        this.targetShape._fireAndBubble(MOUSEOUT, {evt: evt});\n                        this.targetShape._fireAndBubble(MOUSELEAVE, {evt: evt});\n                        this.targetShape = null;\n                    }\n\n                }\n\n                // content event\n                this._fire(CONTENT_MOUSEMOVE, {evt: evt});\n            }\n\n            // always call preventDefault for desktop events because some browsers\n            // try to drag and drop the canvas element\n            if (evt.preventDefault) {\n                evt.preventDefault();\n            }\n        },\n        _mousedown: function(evt) {\n            // workaround for mobile IE to force touch event when unhandled pointer event elevates into a mouse event\n            if (Konva.UA.ieMobile) {\n                return this._touchstart(evt);\n            }\n            if (!Konva.UA.mobile) {\n                this._setPointerPosition(evt);\n                var shape = this.getIntersection(this.getPointerPosition());\n\n                Konva.listenClickTap = true;\n\n                if (shape && shape.isListening()) {\n                    this.clickStartShape = shape;\n                    shape._fireAndBubble(MOUSEDOWN, {evt: evt});\n                }\n\n                // content event\n                this._fire(CONTENT_MOUSEDOWN, {evt: evt});\n            }\n\n            // always call preventDefault for desktop events because some browsers\n            // try to drag and drop the canvas element\n            if (evt.preventDefault) {\n                evt.preventDefault();\n            }\n        },\n        _mouseup: function(evt) {\n\n            // workaround for mobile IE to force touch event when unhandled pointer event elevates into a mouse event\n            if (Konva.UA.ieMobile) {\n                return this._touchend(evt);\n            }\n            if (!Konva.UA.mobile) {\n                this._setPointerPosition(evt);\n                var shape = this.getIntersection(this.getPointerPosition()),\n                    clickStartShape = this.clickStartShape,\n                    fireDblClick = false,\n                    dd = Konva.DD;\n\n                if(Konva.inDblClickWindow) {\n                    fireDblClick = true;\n                    Konva.inDblClickWindow = false;\n                }\n                // don't set inDblClickWindow after dragging\n                else if (!dd || !dd.justDragged) {\n                    Konva.inDblClickWindow = true;\n                } else if (dd) {\n                    dd.justDragged = false;\n                }\n\n                setTimeout(function() {\n                    Konva.inDblClickWindow = false;\n                }, Konva.dblClickWindow);\n\n                if (shape && shape.isListening()) {\n                    shape._fireAndBubble(MOUSEUP, {evt: evt});\n\n                    // detect if click or double click occurred\n                    if(Konva.listenClickTap && clickStartShape && clickStartShape._id === shape._id) {\n                        shape._fireAndBubble(CLICK, {evt: evt});\n\n                        if(fireDblClick) {\n                            shape._fireAndBubble(DBL_CLICK, {evt: evt});\n                        }\n                    }\n                }\n                // content events\n                this._fire(CONTENT_MOUSEUP, {evt: evt});\n                if (Konva.listenClickTap) {\n                    this._fire(CONTENT_CLICK, {evt: evt});\n                    if(fireDblClick) {\n                        this._fire(CONTENT_DBL_CLICK, {evt: evt});\n                    }\n                }\n\n                Konva.listenClickTap = false;\n            }\n\n            // always call preventDefault for desktop events because some browsers\n            // try to drag and drop the canvas element\n            if (evt.preventDefault) {\n                evt.preventDefault();\n            }\n        },\n        _touchstart: function(evt) {\n            this._setPointerPosition(evt);\n            var shape = this.getIntersection(this.getPointerPosition());\n\n            Konva.listenClickTap = true;\n\n            if (shape && shape.isListening()) {\n                this.tapStartShape = shape;\n                shape._fireAndBubble(TOUCHSTART, {evt: evt});\n\n                // only call preventDefault if the shape is listening for events\n                if (shape.isListening() && shape.preventDefault() && evt.preventDefault) {\n                    evt.preventDefault();\n                }\n            }\n            // content event\n            this._fire(CONTENT_TOUCHSTART, {evt: evt});\n        },\n        _touchend: function(evt) {\n            this._setPointerPosition(evt);\n            var shape = this.getIntersection(this.getPointerPosition()),\n                fireDblClick = false;\n\n            if(Konva.inDblClickWindow) {\n                fireDblClick = true;\n                Konva.inDblClickWindow = false;\n            }\n            else {\n                Konva.inDblClickWindow = true;\n            }\n\n            setTimeout(function() {\n                Konva.inDblClickWindow = false;\n            }, Konva.dblClickWindow);\n\n            if (shape && shape.isListening()) {\n                shape._fireAndBubble(TOUCHEND, {evt: evt});\n\n                // detect if tap or double tap occurred\n                if(Konva.listenClickTap && this.tapStartShape && shape._id === this.tapStartShape._id) {\n                    shape._fireAndBubble(TAP, {evt: evt});\n\n                    if(fireDblClick) {\n                        shape._fireAndBubble(DBL_TAP, {evt: evt});\n                    }\n                }\n                // only call preventDefault if the shape is listening for events\n                if (shape.isListening() && shape.preventDefault() && evt.preventDefault) {\n                    evt.preventDefault();\n                }\n            }\n            // content events\n            this._fire(CONTENT_TOUCHEND, {evt: evt});\n            if (Konva.listenClickTap) {\n                this._fire(CONTENT_TAP, {evt: evt});\n                if(fireDblClick) {\n                    this._fire(CONTENT_DBL_TAP, {evt: evt});\n                }\n            }\n\n            Konva.listenClickTap = false;\n        },\n        _touchmove: function(evt) {\n            this._setPointerPosition(evt);\n            var dd = Konva.DD,\n                shape;\n            if (!Konva.isDragging()) {\n                shape = this.getIntersection(this.getPointerPosition());\n                if (shape && shape.isListening()) {\n                    shape._fireAndBubble(TOUCHMOVE, {evt: evt});\n                    // only call preventDefault if the shape is listening for events\n                    if (shape.isListening() && shape.preventDefault() && evt.preventDefault) {\n                        evt.preventDefault();\n                    }\n                }\n                this._fire(CONTENT_TOUCHMOVE, {evt: evt});\n            }\n            if(dd) {\n                if (Konva.isDragging() && Konva.DD.node.preventDefault()) {\n                    evt.preventDefault();\n                }\n            }\n        },\n        _DOMMouseScroll: function(evt) {\n            this._mousewheel(evt);\n        },\n        _mousewheel: function(evt) {\n            this._setPointerPosition(evt);\n            var shape = this.getIntersection(this.getPointerPosition());\n\n            if (shape && shape.isListening()) {\n                shape._fireAndBubble(WHEEL, {evt: evt});\n            }\n            this._fire(CONTENT_WHEEL, {evt: evt});\n        },\n        _wheel: function(evt) {\n            this._mousewheel(evt);\n        },\n        _setPointerPosition: function(evt) {\n            var contentPosition = this._getContentPosition(),\n                x = null,\n                y = null;\n            evt = evt ? evt : window.event;\n\n            // touch events\n            if(evt.touches !== undefined) {\n                // currently, only handle one finger\n                if (evt.touches.length > 0) {\n\n                    var touch = evt.touches[0];\n                    // get the information for finger #1\n                    x = touch.clientX - contentPosition.left;\n                    y = touch.clientY - contentPosition.top;\n                }\n            }\n            // mouse events\n            else {\n                x = evt.clientX - contentPosition.left;\n                y = evt.clientY - contentPosition.top;\n            }\n            if (x !== null && y !== null) {\n                this.pointerPos = {\n                    x: x,\n                    y: y\n                };\n            }\n        },\n        _getContentPosition: function() {\n            var rect = this.content.getBoundingClientRect ? this.content.getBoundingClientRect() : { top: 0, left: 0 };\n            return {\n                top: rect.top,\n                left: rect.left\n            };\n        },\n        _buildDOM: function() {\n            var container = this.getContainer();\n            if (!container) {\n                if (Konva.Util.isBrowser()) {\n                    throw 'Stage has no container. A container is required.';\n                } else {\n                    // automatically create element for jsdom in nodejs env\n                    container = Konva.document.createElement(DIV);\n                }\n            }\n            // clear content inside container\n            container.innerHTML = EMPTY_STRING;\n\n            // content\n            this.content = Konva.document.createElement(DIV);\n            this.content.style.position = RELATIVE;\n            this.content.className = KONVA_CONTENT;\n            this.content.setAttribute('role', 'presentation');\n            container.appendChild(this.content);\n\n            // the buffer canvas pixel ratio must be 1 because it is used as an\n            // intermediate canvas before copying the result onto a scene canvas.\n            // not setting it to 1 will result in an over compensation\n            this.bufferCanvas = new Konva.SceneCanvas();\n            this.bufferHitCanvas = new Konva.HitCanvas({pixelRatio: 1});\n\n            this._resizeDOM();\n        },\n        _onContent: function(typesStr, handler) {\n            var types = typesStr.split(SPACE),\n                len = types.length,\n                n, baseEvent;\n\n            for(n = 0; n < len; n++) {\n                baseEvent = types[n];\n                this.content.addEventListener(baseEvent, handler, false);\n            }\n        },\n        // currently cache function is now working for stage, because stage has no its own canvas element\n        // TODO: may be it is better to cache all children layers?\n        cache: function() {\n            Konva.Util.warn('Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.');\n        },\n        clearCache: function() {\n        }\n    });\n    Konva.Util.extend(Konva.Stage, Konva.Container);\n\n    // add getters and setters\n    Konva.Factory.addGetter(Konva.Stage, 'container');\n    Konva.Factory.addOverloadedGetterSetter(Konva.Stage, 'container');\n\n    /**\n     * get container DOM element\n     * @name container\n     * @method\n     * @memberof Konva.Stage.prototype\n     * @returns {DomElement} container\n     * @example\n     * // get container\n     * var container = stage.container();\n     * // set container\n     * var container = document.createElement('div');\n     * body.appendChild(container);\n     * stage.container(container);\n     */\n\n})();\n\n(function() {\n    'use strict';\n    /**\n     * BaseLayer constructor.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Container\n     * @param {Object} config\n     * @param {Boolean} [config.clearBeforeDraw] set this property to false if you don't want\n     * to clear the canvas before each layer draw.  The default value is true.\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * * @param {Object} [config.clip] set clip\n     * @param {Number} [config.clipX] set clip x\n     * @param {Number} [config.clipY] set clip y\n     * @param {Number} [config.clipWidth] set clip width\n     * @param {Number} [config.clipHeight] set clip height\n     * @param {Function} [config.clipFunc] set clip func\n\n     * @example\n     * var layer = new Konva.Layer();\n     */\n    Konva.BaseLayer = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Util.addMethods(Konva.BaseLayer, {\n        ___init: function(config) {\n            this.nodeType = 'Layer';\n            Konva.Container.call(this, config);\n        },\n        createPNGStream: function() {\n            return this.canvas._canvas.createPNGStream();\n        },\n        /**\n         * get layer canvas\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         */\n        getCanvas: function() {\n            return this.canvas;\n        },\n        /**\n         * get layer hit canvas\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         */\n        getHitCanvas: function() {\n            return this.hitCanvas;\n        },\n        /**\n         * get layer canvas context\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         */\n        getContext: function() {\n            return this.getCanvas().getContext();\n        },\n        /**\n         * clear scene and hit canvas contexts tied to the layer\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         * @param {Object} [bounds]\n         * @param {Number} [bounds.x]\n         * @param {Number} [bounds.y]\n         * @param {Number} [bounds.width]\n         * @param {Number} [bounds.height]\n         * @example\n         * layer.clear();\n         * layer.clear({\n         *   x : 0,\n         *   y : 0,\n         *   width : 100,\n         *   height : 100\n         * });\n         */\n        clear: function(bounds) {\n            this.getContext().clear(bounds);\n            return this;\n        },\n        clearHitCache: function() {\n            this._hitImageData = undefined;\n        },\n        // extend Node.prototype.setZIndex\n        setZIndex: function(index) {\n            Konva.Node.prototype.setZIndex.call(this, index);\n            var stage = this.getStage();\n            if(stage) {\n                stage.content.removeChild(this.getCanvas()._canvas);\n\n                if(index < stage.getChildren().length - 1) {\n                    stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[index + 1].getCanvas()._canvas);\n                }\n                else {\n                    stage.content.appendChild(this.getCanvas()._canvas);\n                }\n            }\n            return this;\n        },\n        // extend Node.prototype.moveToTop\n        moveToTop: function() {\n            Konva.Node.prototype.moveToTop.call(this);\n            var stage = this.getStage();\n            if(stage) {\n                stage.content.removeChild(this.getCanvas()._canvas);\n                stage.content.appendChild(this.getCanvas()._canvas);\n            }\n            return this;\n        },\n        // extend Node.prototype.moveUp\n        moveUp: function() {\n            var moved = Konva.Node.prototype.moveUp.call(this);\n            if (!moved){\n                return this;\n            }\n            var stage = this.getStage();\n            if(!stage) {\n                return this;\n            }\n            stage.content.removeChild(this.getCanvas()._canvas);\n\n            if(this.index < stage.getChildren().length - 1) {\n                stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[this.index + 1].getCanvas()._canvas);\n            } else {\n                stage.content.appendChild(this.getCanvas()._canvas);\n            }\n            return this;\n        },\n        // extend Node.prototype.moveDown\n        moveDown: function() {\n            if(Konva.Node.prototype.moveDown.call(this)) {\n                var stage = this.getStage();\n                if(stage) {\n                    var children = stage.getChildren();\n                    stage.content.removeChild(this.getCanvas()._canvas);\n                    stage.content.insertBefore(this.getCanvas()._canvas, children[this.index + 1].getCanvas()._canvas);\n                }\n            }\n            return this;\n        },\n        // extend Node.prototype.moveToBottom\n        moveToBottom: function() {\n            if(Konva.Node.prototype.moveToBottom.call(this)) {\n                var stage = this.getStage();\n                if(stage) {\n                    var children = stage.getChildren();\n                    stage.content.removeChild(this.getCanvas()._canvas);\n                    stage.content.insertBefore(this.getCanvas()._canvas, children[1].getCanvas()._canvas);\n                }\n            }\n            return this;\n        },\n        getLayer: function() {\n            return this;\n        },\n        remove: function() {\n            var _canvas = this.getCanvas()._canvas;\n\n            Konva.Node.prototype.remove.call(this);\n\n            if(_canvas && _canvas.parentNode && Konva.Util._isInDocument(_canvas)) {\n                _canvas.parentNode.removeChild(_canvas);\n            }\n            return this;\n        },\n        getStage: function() {\n            return this.parent;\n        },\n        setSize: function(width, height) {\n            this.canvas.setSize(width, height);\n            return this;\n        },\n        /**\n         * get/set width of layer.getter return width of stage. setter doing nothing.\n         * if you want change width use `stage.width(value);`\n         * @name width\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         * @returns {Number}\n         * @example\n         * var width = layer.width();\n         */\n        getWidth: function() {\n            if (this.parent) {\n                return this.parent.getWidth();\n            }\n        },\n        setWidth: function() {\n            Konva.Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n        },\n        /**\n         * get/set height of layer.getter return height of stage. setter doing nothing.\n         * if you want change height use `stage.height(value);`\n         * @name height\n         * @method\n         * @memberof Konva.BaseLayer.prototype\n         * @returns {Number}\n         * @example\n         * var height = layer.height();\n         */\n        getHeight: function() {\n            if (this.parent) {\n                return this.parent.getHeight();\n            }\n        },\n        setHeight: function() {\n            Konva.Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n        },\n        // the apply transform method is handled by the Layer and FastLayer class\n        // because it is up to the layer to decide if an absolute or relative transform\n        // should be used\n        _applyTransform: function(shape, context, top) {\n            var m = shape.getAbsoluteTransform(top).getMatrix();\n            context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n    });\n    Konva.Util.extend(Konva.BaseLayer, Konva.Container);\n\n    // add getters and setters\n    Konva.Factory.addGetterSetter(Konva.BaseLayer, 'clearBeforeDraw', true);\n    /**\n     * get/set clearBeforeDraw flag which determines if the layer is cleared or not\n     *  before drawing\n     * @name clearBeforeDraw\n     * @method\n     * @memberof Konva.BaseLayer.prototype\n     * @param {Boolean} clearBeforeDraw\n     * @returns {Boolean}\n     * @example\n     * // get clearBeforeDraw flag\n     * var clearBeforeDraw = layer.clearBeforeDraw();\n     *\n     * // disable clear before draw\n     * layer.clearBeforeDraw(false);\n     *\n     * // enable clear before draw\n     * layer.clearBeforeDraw(true);\n     */\n\n    Konva.Collection.mapMethods(Konva.BaseLayer);\n})();\n\n(function() {\n    'use strict';\n    // constants\n    var HASH = '#',\n        BEFORE_DRAW = 'beforeDraw',\n        DRAW = 'draw',\n\n        /*\n         * 2 - 3 - 4\n         * |       |\n         * 1 - 0   5\n         *         |\n         * 8 - 7 - 6\n         */\n        INTERSECTION_OFFSETS = [\n            {x: 0, y: 0},  // 0\n            {x: -1, y: 0}, // 1\n            {x: -1, y: -1}, // 2\n            {x: 0, y: -1}, // 3\n            {x: 1, y: -1}, // 4\n            {x: 1, y: 0}, // 5\n            {x: 1, y: 1}, // 6\n            {x: 0, y: 1}, // 7\n            {x: -1, y: 1}  // 8\n        ],\n        INTERSECTION_OFFSETS_LEN = INTERSECTION_OFFSETS.length;\n\n    /**\n     * Layer constructor.  Layers are tied to their own canvas element and are used\n     * to contain groups or shapes.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.BaseLayer\n     * @param {Object} config\n     * @param {Boolean} [config.clearBeforeDraw] set this property to false if you don't want\n     * to clear the canvas before each layer draw.  The default value is true.\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * * @param {Object} [config.clip] set clip\n     * @param {Number} [config.clipX] set clip x\n     * @param {Number} [config.clipY] set clip y\n     * @param {Number} [config.clipWidth] set clip width\n     * @param {Number} [config.clipHeight] set clip height\n     * @param {Function} [config.clipFunc] set clip func\n\n     * @example\n     * var layer = new Konva.Layer();\n     */\n    Konva.Layer = function(config) {\n        this.____init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Layer, {\n        ____init: function(config) {\n            this.nodeType = 'Layer';\n            this.canvas = new Konva.SceneCanvas();\n            this.hitCanvas = new Konva.HitCanvas({\n                pixelRatio: 1\n            });\n            // call super constructor\n            Konva.BaseLayer.call(this, config);\n        },\n        _setCanvasSize: function(width, height) {\n            this.canvas.setSize(width, height);\n            this.hitCanvas.setSize(width, height);\n        },\n        _validateAdd: function(child) {\n            var type = child.getType();\n            if (type !== 'Group' && type !== 'Shape') {\n                Konva.Util.throw('You may only add groups and shapes to a layer.');\n            }\n        },\n        /**\n         * get visible intersection shape. This is the preferred\n         * method for determining if a point intersects a shape or not\n         * also you may pass optional selector parametr to return ancestor of intersected shape\n         * @method\n         * @memberof Konva.Layer.prototype\n         * @param {Object} pos\n         * @param {Number} pos.x\n         * @param {Number} pos.y\n         * @param {String} [selector]\n         * @returns {Konva.Node}\n         * @example\n         * var shape = layer.getIntersection({x: 50, y: 50});\n         * // or if you interested in shape parent:\n         * var group = layer.getIntersection({x: 50, y: 50}, 'Group');\n         */\n        getIntersection: function(pos, selector) {\n            var obj, i, intersectionOffset, shape;\n\n            if(!this.hitGraphEnabled() || !this.isVisible()) {\n                return null;\n            }\n            // in some cases antialiased area may be bigger than 1px\n            // it is possible if we will cache node, then scale it a lot\n            // TODO: check { 0; 0 } point before loop, and remove it from INTERSECTION_OFFSETS.\n            var spiralSearchDistance = 1;\n            var continueSearch = false;\n            while (true) {\n                for (i = 0; i < INTERSECTION_OFFSETS_LEN; i++) {\n                    intersectionOffset = INTERSECTION_OFFSETS[i];\n                    obj = this._getIntersection({\n                        x: pos.x + intersectionOffset.x * spiralSearchDistance,\n                        y: pos.y + intersectionOffset.y * spiralSearchDistance\n                    });\n                    shape = obj.shape;\n                    if (shape && selector) {\n                        return shape.findAncestor(selector, true);\n                    } else if (shape) {\n                        return shape;\n                    }\n                    // we should continue search if we found antialiased pixel\n                    // that means our node somewhere very close\n                    continueSearch = !!obj.antialiased;\n                    // stop search if found empty pixel\n                    if (!obj.antialiased) {\n                        break;\n                    }\n                }\n                // if no shape, and no antialiased pixel, we should end searching\n                if (continueSearch) {\n                    spiralSearchDistance += 1;\n                } else {\n                    return null;\n                }\n            }\n        },\n        _getImageData: function(x, y) {\n            var width = this.hitCanvas.width || 1,\n                height = this.hitCanvas.height || 1,\n                index = (Math.round(y) * width ) + Math.round(x);\n\n            if (!this._hitImageData) {\n                this._hitImageData = this.hitCanvas.context.getImageData(0, 0, width, height);\n            }\n\n            return [\n                this._hitImageData.data[4 * index + 0], // Red\n                this._hitImageData.data[4 * index + 1], // Green\n                this._hitImageData.data[4 * index + 2], // Blue\n                this._hitImageData.data[4 * index + 3] // Alpha\n            ];\n        },\n        _getIntersection: function(pos) {\n            var ratio = this.hitCanvas.pixelRatio;\n            var p = this.hitCanvas.context.getImageData(Math.round(pos.x * ratio), Math.round(pos.y * ratio), 1, 1).data,\n                p3 = p[3],\n                colorKey, shape;\n            // fully opaque pixel\n            if(p3 === 255) {\n                colorKey = Konva.Util._rgbToHex(p[0], p[1], p[2]);\n                shape = Konva.shapes[HASH + colorKey];\n                if (shape) {\n                    return {\n                        shape: shape\n                    };\n                }\n                return {\n                    antialiased: true\n                };\n            }\n            // antialiased pixel\n            else if(p3 > 0) {\n                return {\n                    antialiased: true\n                };\n            }\n            // empty pixel\n            return {};\n        },\n        drawScene: function(can, top) {\n            var layer = this.getLayer(),\n                canvas = can || (layer && layer.getCanvas());\n\n            this._fire(BEFORE_DRAW, {\n                node: this\n            });\n\n            if(this.getClearBeforeDraw()) {\n                canvas.getContext().clear();\n            }\n\n            Konva.Container.prototype.drawScene.call(this, canvas, top);\n\n            this._fire(DRAW, {\n                node: this\n            });\n\n            return this;\n        },\n        drawHit: function(can, top) {\n            var layer = this.getLayer(),\n                canvas = can || (layer && layer.hitCanvas);\n\n            if(layer && layer.getClearBeforeDraw()) {\n                layer.getHitCanvas().getContext().clear();\n            }\n\n            Konva.Container.prototype.drawHit.call(this, canvas, top);\n            this.imageData = null; // Clear imageData cache\n            return this;\n        },\n        clear: function(bounds) {\n            Konva.BaseLayer.prototype.clear.call(this, bounds);\n            this.getHitCanvas().getContext().clear(bounds);\n            this.imageData = null; // Clear getImageData cache\n            return this;\n        },\n        // extend Node.prototype.setVisible\n        setVisible: function(visible) {\n            Konva.Node.prototype.setVisible.call(this, visible);\n            if(visible) {\n                this.getCanvas()._canvas.style.display = 'block';\n                this.hitCanvas._canvas.style.display = 'block';\n            }\n            else {\n                this.getCanvas()._canvas.style.display = 'none';\n                this.hitCanvas._canvas.style.display = 'none';\n            }\n            return this;\n        },\n        /**\n         * enable hit graph\n         * @name enableHitGraph\n         * @method\n         * @memberof Konva.Layer.prototype\n         * @returns {Layer}\n         */\n        enableHitGraph: function() {\n            this.setHitGraphEnabled(true);\n            return this;\n        },\n        /**\n         * disable hit graph\n         * @name disableHitGraph\n         * @method\n         * @memberof Konva.Layer.prototype\n         * @returns {Layer}\n         */\n        disableHitGraph: function() {\n            this.setHitGraphEnabled(false);\n            return this;\n        },\n        setSize: function(width, height) {\n            Konva.BaseLayer.prototype.setSize.call(this, width, height);\n            this.hitCanvas.setSize(width, height);\n            return this;\n        }\n    });\n    Konva.Util.extend(Konva.Layer, Konva.BaseLayer);\n\n    Konva.Factory.addGetterSetter(Konva.Layer, 'hitGraphEnabled', true);\n    /**\n     * get/set hitGraphEnabled flag.  Disabling the hit graph will greatly increase\n     *  draw performance because the hit graph will not be redrawn each time the layer is\n     *  drawn.  This, however, also disables mouse/touch event detection\n     * @name hitGraphEnabled\n     * @method\n     * @memberof Konva.Layer.prototype\n     * @param {Boolean} enabled\n     * @returns {Boolean}\n     * @example\n     * // get hitGraphEnabled flag\n     * var hitGraphEnabled = layer.hitGraphEnabled();\n     *\n     * // disable hit graph\n     * layer.hitGraphEnabled(false);\n     *\n     * // enable hit graph\n     * layer.hitGraphEnabled(true);\n     */\n    Konva.Collection.mapMethods(Konva.Layer);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * FastLayer constructor. Layers are tied to their own canvas element and are used\n     * to contain shapes only.  If you don't need node nesting, mouse and touch interactions,\n     * or event pub/sub, you should use FastLayer instead of Layer to create your layers.\n     * It renders about 2x faster than normal layers.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.BaseLayer\n     * @param {Object} config\n     * @param {Boolean} [config.clearBeforeDraw] set this property to false if you don't want\n     * to clear the canvas before each layer draw.  The default value is true.\n     * @param {Boolean} [config.visible]\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * * @param {Object} [config.clip] set clip\n     * @param {Number} [config.clipX] set clip x\n     * @param {Number} [config.clipY] set clip y\n     * @param {Number} [config.clipWidth] set clip width\n     * @param {Number} [config.clipHeight] set clip height\n     * @param {Function} [config.clipFunc] set clip func\n\n     * @example\n     * var layer = new Konva.FastLayer();\n     */\n    Konva.FastLayer = function(config) {\n        this.____init(config);\n    };\n\n    Konva.Util.addMethods(Konva.FastLayer, {\n        ____init: function(config) {\n            this.nodeType = 'Layer';\n            this.canvas = new Konva.SceneCanvas();\n            // call super constructor\n            Konva.BaseLayer.call(this, config);\n        },\n        _validateAdd: function(child) {\n            var type = child.getType();\n            if (type !== 'Shape') {\n                Konva.Util.throw('You may only add shapes to a fast layer.');\n            }\n        },\n        _setCanvasSize: function(width, height) {\n            this.canvas.setSize(width, height);\n        },\n        hitGraphEnabled: function() {\n            return false;\n        },\n        getIntersection: function() {\n            return null;\n        },\n        drawScene: function(can) {\n            var layer = this.getLayer(),\n                canvas = can || (layer && layer.getCanvas());\n\n            if(this.getClearBeforeDraw()) {\n                canvas.getContext().clear();\n            }\n\n            Konva.Container.prototype.drawScene.call(this, canvas);\n\n            return this;\n        },\n        draw: function() {\n            this.drawScene();\n            return this;\n        },\n        // extend Node.prototype.setVisible\n        setVisible: function(visible) {\n            Konva.Node.prototype.setVisible.call(this, visible);\n            if(visible) {\n                this.getCanvas()._canvas.style.display = 'block';\n            }\n            else {\n                this.getCanvas()._canvas.style.display = 'none';\n            }\n            return this;\n        }\n    });\n    Konva.Util.extend(Konva.FastLayer, Konva.BaseLayer);\n\n    Konva.Collection.mapMethods(Konva.FastLayer);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Group constructor.  Groups are used to contain shapes or other groups.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Container\n     * @param {Object} config\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * * @param {Object} [config.clip] set clip\n     * @param {Number} [config.clipX] set clip x\n     * @param {Number} [config.clipY] set clip y\n     * @param {Number} [config.clipWidth] set clip width\n     * @param {Number} [config.clipHeight] set clip height\n     * @param {Function} [config.clipFunc] set clip func\n\n     * @example\n     * var group = new Konva.Group();\n     */\n    Konva.Group = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Util.addMethods(Konva.Group, {\n        ___init: function(config) {\n            this.nodeType = 'Group';\n            // call super constructor\n            Konva.Container.call(this, config);\n        },\n        _validateAdd: function(child) {\n            var type = child.getType();\n            if (type !== 'Group' && type !== 'Shape') {\n                Konva.Util.throw('You may only add groups and shapes to groups.');\n            }\n        }\n    });\n    Konva.Util.extend(Konva.Group, Konva.Container);\n\n    Konva.Collection.mapMethods(Konva.Group);\n})();\n\n(function(Konva) {\n    'use strict';\n\n    var now = (function() {\n        if (Konva.global.performance && Konva.global.performance.now) {\n            return function() {\n                return Konva.global.performance.now();\n            };\n        }\n\n        return function() {\n            return new Date().getTime();\n        };\n    })();\n\n    function FRAF(callback) {\n        setTimeout(callback, 1000 / 60);\n    }\n\n    var RAF = (function(){\n        return Konva.global.requestAnimationFrame\n            || Konva.global.webkitRequestAnimationFrame\n            || Konva.global.mozRequestAnimationFrame\n            || Konva.global.oRequestAnimationFrame\n            || Konva.global.msRequestAnimationFrame\n            || FRAF;\n    })();\n\n\n\n    function requestAnimFrame() {\n        return RAF.apply(Konva.global, arguments);\n    }\n\n    /**\n     * Animation constructor.  A stage is used to contain multiple layers and handle\n     * @constructor\n     * @memberof Konva\n     * @param {Function} func function executed on each animation frame.  The function is passed a frame object, which contains\n     *  timeDiff, lastTime, time, and frameRate properties.  The timeDiff property is the number of milliseconds that have passed\n     *  since the last animation frame.  The lastTime property is time in milliseconds that elapsed from the moment the animation started\n     *  to the last animation frame.  The time property is the time in milliseconds that ellapsed from the moment the animation started\n     *  to the current animation frame.  The frameRate property is the current frame rate in frames / second. Return false from function,\n     *  if you don't need to redraw layer/layers on some frames.\n     * @param {Konva.Layer|Array} [layers] layer(s) to be redrawn on each animation frame. Can be a layer, an array of layers, or null.\n     *  Not specifying a node will result in no redraw.\n     * @example\n     * // move a node to the right at 50 pixels / second\n     * var velocity = 50;\n     *\n     * var anim = new Konva.Animation(function(frame) {\n     *   var dist = velocity * (frame.timeDiff / 1000);\n     *   node.move(dist, 0);\n     * }, layer);\n     *\n     * anim.start();\n     */\n    Konva.Animation = function(func, layers) {\n        var Anim = Konva.Animation;\n        this.func = func;\n        this.setLayers(layers);\n        this.id = Anim.animIdCounter++;\n        this.frame = {\n            time: 0,\n            timeDiff: 0,\n            lastTime: now()\n        };\n    };\n    /*\n     * Animation methods\n     */\n    Konva.Animation.prototype = {\n        /**\n         * set layers to be redrawn on each animation frame\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @param {Konva.Layer|Array} [layers] layer(s) to be redrawn.&nbsp; Can be a layer, an array of layers, or null.  Not specifying a node will result in no redraw.\n         * @return {Konva.Animation} this\n         */\n        setLayers: function(layers) {\n            var lays = [];\n            // if passing in no layers\n            if (!layers) {\n                lays = [];\n            }\n            // if passing in an array of Layers\n            // NOTE: layers could be an array or Konva.Collection.  for simplicity, I'm just inspecting\n            // the length property to check for both cases\n            else if (layers.length > 0) {\n                lays = layers;\n            }\n            // if passing in a Layer\n            else {\n                lays = [layers];\n            }\n\n            this.layers = lays;\n            return this;\n        },\n        /**\n         * get layers\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @return {Array} Array of Konva.Layer\n         */\n        getLayers: function() {\n            return this.layers;\n        },\n        /**\n         * add layer.  Returns true if the layer was added, and false if it was not\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @param {Konva.Layer} layer to add\n         * @return {Bool} true if layer is added to animation, otherwise false\n         */\n        addLayer: function(layer) {\n            var layers = this.layers,\n                len = layers.length, n;\n\n            // don't add the layer if it already exists\n            for (n = 0; n < len; n++) {\n                if (layers[n]._id === layer._id){\n                    return false;\n                }\n            }\n\n            this.layers.push(layer);\n            return true;\n        },\n        /**\n         * determine if animation is running or not.  returns true or false\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @return {Bool} is animation running?\n         */\n        isRunning: function() {\n            var a = Konva.Animation,\n                animations = a.animations,\n                len = animations.length,\n                n;\n\n            for (n = 0; n < len; n++) {\n                if (animations[n].id === this.id) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        /**\n         * start animation\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @return {Konva.Animation} this\n         */\n        start: function() {\n            var Anim = Konva.Animation;\n            this.stop();\n            this.frame.timeDiff = 0;\n            this.frame.lastTime = now();\n            Anim._addAnimation(this);\n            return this;\n        },\n        /**\n         * stop animation\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @return {Konva.Animation} this\n         */\n        stop: function() {\n            Konva.Animation._removeAnimation(this);\n            return this;\n        },\n        _updateFrameObject: function(time) {\n            this.frame.timeDiff = time - this.frame.lastTime;\n            this.frame.lastTime = time;\n            this.frame.time += this.frame.timeDiff;\n            this.frame.frameRate = 1000 / this.frame.timeDiff;\n        }\n    };\n    Konva.Animation.animations = [];\n    Konva.Animation.animIdCounter = 0;\n    Konva.Animation.animRunning = false;\n\n    Konva.Animation._addAnimation = function(anim) {\n        this.animations.push(anim);\n        this._handleAnimation();\n    };\n    Konva.Animation._removeAnimation = function(anim) {\n        var id = anim.id,\n            animations = this.animations,\n            len = animations.length,\n            n;\n\n        for(n = 0; n < len; n++) {\n            if(animations[n].id === id) {\n                this.animations.splice(n, 1);\n                break;\n            }\n        }\n    };\n\n    Konva.Animation._runFrames = function() {\n        var layerHash = {},\n            animations = this.animations,\n            anim, layers, func, n, i, layersLen, layer, key, needRedraw;\n        /*\n         * loop through all animations and execute animation\n         *  function.  if the animation object has specified node,\n         *  we can add the node to the nodes hash to eliminate\n         *  drawing the same node multiple times.  The node property\n         *  can be the stage itself or a layer\n         */\n        /*\n         * WARNING: don't cache animations.length because it could change while\n         * the for loop is running, causing a JS error\n         */\n\n        for(n = 0; n < animations.length; n++) {\n            anim = animations[n];\n            layers = anim.layers;\n            func = anim.func;\n\n\n            anim._updateFrameObject(now());\n            layersLen = layers.length;\n\n            // if animation object has a function, execute it\n            if (func) {\n                // allow anim bypassing drawing\n                needRedraw = (func.call(anim, anim.frame) !== false);\n            } else {\n                needRedraw = true;\n            }\n            if (!needRedraw) {\n                continue;\n            }\n            for (i = 0; i < layersLen; i++) {\n                layer = layers[i];\n\n                if (layer._id !== undefined) {\n                    layerHash[layer._id] = layer;\n                }\n            }\n        }\n\n        for (key in layerHash) {\n            if (!layerHash.hasOwnProperty(key)) {\n                continue;\n            }\n            layerHash[key].draw();\n        }\n    };\n    Konva.Animation._animationLoop = function() {\n        var Anim = Konva.Animation;\n        if(Anim.animations.length) {\n            Anim._runFrames();\n            requestAnimFrame(Anim._animationLoop);\n        }\n        else {\n            Anim.animRunning = false;\n        }\n    };\n    Konva.Animation._handleAnimation = function() {\n        if(!this.animRunning) {\n            this.animRunning = true;\n            requestAnimFrame(this._animationLoop);\n        }\n    };\n\n    /**\n     * batch draw. this function will not do immediate draw\n     * but it will schedule drawing to next tick (requestAnimFrame)\n     * @method\n     * @return {Konva.Layer} this\n     * @memberof Konva.Base.prototype\n     */\n    Konva.BaseLayer.prototype.batchDraw = function() {\n        var that = this,\n            Anim = Konva.Animation;\n\n        if (!this.batchAnim) {\n            this.batchAnim = new Anim(function() {\n                // stop animation after first tick\n                that.batchAnim.stop();\n            }, this);\n        }\n\n        this.lastBatchDrawTime = now();\n\n        if (!this.batchAnim.isRunning()) {\n            this.batchAnim.start();\n        }\n        return this;\n    };\n\n    /**\n     * batch draw\n     * @method\n     * @return {Konva.Stage} this\n     * @memberof Konva.Stage.prototype\n     */\n    Konva.Stage.prototype.batchDraw = function() {\n        this.getChildren().each(function(layer) {\n            layer.batchDraw();\n        });\n        return this;\n    };\n})(Konva);\n\n(function() {\n    'use strict';\n    var blacklist = {\n        node: 1,\n        duration: 1,\n        easing: 1,\n        onFinish: 1,\n        yoyo: 1\n    },\n\n    PAUSED = 1,\n    PLAYING = 2,\n    REVERSING = 3,\n\n    idCounter = 0,\n    colorAttrs = ['fill', 'stroke', 'shadowColor'];\n\n    var Tween = function(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    };\n    /*\n     * Tween methods\n     */\n    Tween.prototype = {\n        fire: function(str) {\n            var handler = this[str];\n            if (handler) {\n                handler();\n            }\n        },\n        setTime: function(t) {\n            if(t > this.duration) {\n                if(this.yoyo) {\n                    this._time = this.duration;\n                    this.reverse();\n                }\n                else {\n                    this.finish();\n                }\n            }\n            else if(t < 0) {\n                if(this.yoyo) {\n                    this._time = 0;\n                    this.play();\n                }\n                else {\n                    this.reset();\n                }\n            }\n            else {\n                this._time = t;\n                this.update();\n            }\n        },\n        getTime: function() {\n            return this._time;\n        },\n        setPosition: function(p) {\n            this.prevPos = this._pos;\n            this.propFunc(p);\n            this._pos = p;\n        },\n        getPosition: function(t) {\n            if(t === undefined) {\n                t = this._time;\n            }\n            return this.func(t, this.begin, this._change, this.duration);\n        },\n        play: function() {\n            this.state = PLAYING;\n            this._startTime = this.getTimer() - this._time;\n            this.onEnterFrame();\n            this.fire('onPlay');\n        },\n        reverse: function() {\n            this.state = REVERSING;\n            this._time = this.duration - this._time;\n            this._startTime = this.getTimer() - this._time;\n            this.onEnterFrame();\n            this.fire('onReverse');\n        },\n        seek: function(t) {\n            this.pause();\n            this._time = t;\n            this.update();\n            this.fire('onSeek');\n        },\n        reset: function() {\n            this.pause();\n            this._time = 0;\n            this.update();\n            this.fire('onReset');\n        },\n        finish: function() {\n            this.pause();\n            this._time = this.duration;\n            this.update();\n            this.fire('onFinish');\n        },\n        update: function() {\n            this.setPosition(this.getPosition(this._time));\n        },\n        onEnterFrame: function() {\n            var t = this.getTimer() - this._startTime;\n            if(this.state === PLAYING) {\n                this.setTime(t);\n            }\n            else if (this.state === REVERSING) {\n                this.setTime(this.duration - t);\n            }\n        },\n        pause: function() {\n            this.state = PAUSED;\n            this.fire('onPause');\n        },\n        getTimer: function() {\n            return new Date().getTime();\n        }\n    };\n\n    /**\n     * Tween constructor.  Tweens enable you to animate a node between the current state and a new state.\n     *  You can play, pause, reverse, seek, reset, and finish tweens.  By default, tweens are animated using\n     *  a linear easing.  For more tweening options, check out {@link Konva.Easings}\n     * @constructor\n     * @memberof Konva\n     * @example\n     * // instantiate new tween which fully rotates a node in 1 second\n     * var tween = new Konva.Tween({\n     *   node: node,\n     *   rotationDeg: 360,\n     *   duration: 1,\n     *   easing: Konva.Easings.EaseInOut\n     * });\n     *\n     * // play tween\n     * tween.play();\n     *\n     * // pause tween\n     * tween.pause();\n     */\n    Konva.Tween = function(config) {\n        var that = this,\n            node = config.node,\n            nodeId = node._id,\n            duration,\n            easing = config.easing || Konva.Easings.Linear,\n            yoyo = !!config.yoyo,\n            key;\n\n        if (typeof config.duration === 'undefined') {\n            duration = 1;\n        } else if (config.duration === 0) {  // zero is bad value for duration\n            duration = 0.001;\n        } else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n\n        var layers = node.getLayer() || ((node instanceof Konva.Stage) ? node.getLayers() : null);\n        if (!layers) {\n            Konva.Util.error(\n                'Tween constructor have `node` that is not in a layer. Please add node into layer first.'\n            );\n        }\n        this.anim = new Konva.Animation(function() {\n            that.tween.onEnterFrame();\n        }, layers);\n\n        this.tween = new Tween(key, function(i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n\n        this._addListeners();\n\n        // init attrs map\n        if (!Konva.Tween.attrs[nodeId]) {\n            Konva.Tween.attrs[nodeId] = {};\n        }\n        if (!Konva.Tween.attrs[nodeId][this._id]) {\n            Konva.Tween.attrs[nodeId][this._id] = {};\n        }\n        // init tweens map\n        if (!Konva.Tween.tweens[nodeId]) {\n            Konva.Tween.tweens[nodeId] = {};\n        }\n\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n\n        this.reset();\n\n        // callbacks\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n    };\n\n    // start/diff object = attrs.nodeId.tweenId.attr\n    Konva.Tween.attrs = {};\n    // tweenId = tweens.nodeId.attr\n    Konva.Tween.tweens = {};\n\n    Konva.Tween.prototype = {\n        _addAttr: function(key, end) {\n            var node = this.node,\n                nodeId = node._id,\n                start, diff, tweenId, n, len, trueEnd, trueStart;\n\n            // remove conflict from tween map if it exists\n            tweenId = Konva.Tween.tweens[nodeId][key];\n\n            if (tweenId) {\n                delete Konva.Tween.attrs[nodeId][tweenId][key];\n            }\n\n            // add to tween map\n            start = node.getAttr(key);\n\n            if (Konva.Util._isArray(end)) {\n                diff = [];\n                len = Math.max(end.length, start.length);\n\n                if (key === 'points' && end.length !== start.length) {\n                    // before tweening points we need to make sure that start.length === end.length\n                    // Konva.Util._prepareArrayForTween thinking that end.length > start.length\n\n                    if (end.length > start.length) {\n                        // so in this case we will increase number of starting points\n                        trueStart = start;\n                        start = Konva.Util._prepareArrayForTween(start, end, node.closed());\n                    } else {\n                        // in this case we will increase number of eding points\n                        trueEnd = end;\n                        end = Konva.Util._prepareArrayForTween(end, start, node.closed());\n                    }\n                }\n\n                for (n = 0; n < len; n++) {\n                    diff.push((end[n]) - (start[n]));\n                }\n\n            } else if (colorAttrs.indexOf(key) !== -1) {\n                start = Konva.Util.colorToRGBA(start);\n                var endRGBA = Konva.Util.colorToRGBA(end);\n                diff = {\n                    r: endRGBA.r - start.r,\n                    g: endRGBA.g - start.g,\n                    b: endRGBA.b - start.b,\n                    a: endRGBA.a - start.a\n                };\n            } else {\n                diff = end - start;\n            }\n\n            Konva.Tween.attrs[nodeId][this._id][key] = {\n                start: start,\n                diff: diff,\n                end: end,\n                trueEnd: trueEnd,\n                trueStart: trueStart\n            };\n            Konva.Tween.tweens[nodeId][key] = this._id;\n        },\n        _tweenFunc: function(i) {\n            var node = this.node,\n                attrs = Konva.Tween.attrs[node._id][this._id],\n                key, attr, start, diff, newVal, n, len, end;\n\n            for (key in attrs) {\n                attr = attrs[key];\n                start = attr.start;\n                diff = attr.diff;\n                end = attr.end;\n\n                if (Konva.Util._isArray(start)) {\n                    newVal = [];\n                    len = Math.max(start.length, end.length);\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + (diff[n] * i));\n                    }\n                } else if (colorAttrs.indexOf(key) !== -1) {\n                    newVal = 'rgba(' +\n                            Math.round(start.r + diff.r * i) + ',' +\n                            Math.round(start.g + diff.g * i) + ',' +\n                            Math.round(start.b + diff.b * i) + ',' +\n                            (start.a + diff.a * i) + ')';\n                } else {\n                    newVal = start + (diff * i);\n                }\n\n                node.setAttr(key, newVal);\n            }\n        },\n        _addListeners: function() {\n            var that = this;\n\n            // start listeners\n            this.tween.onPlay = function() {\n                that.anim.start();\n            };\n            this.tween.onReverse = function() {\n                that.anim.start();\n            };\n\n            // stop listeners\n            this.tween.onPause = function() {\n                that.anim.stop();\n            };\n            this.tween.onFinish = function() {\n                var node = that.node;\n\n                // after tweening  points of line we need to set original end\n                var attrs = Konva.Tween.attrs[node._id][that._id];\n                if (attrs.points && attrs.points.trueEnd) {\n                    node.points(attrs.points.trueEnd);\n                }\n\n                if (that.onFinish) {\n                    that.onFinish.call(that);\n                }\n            };\n            this.tween.onReset = function() {\n                var node = that.node;\n                // after tweening  points of line we need to set original start\n                var attrs = Konva.Tween.attrs[node._id][that._id];\n                if (attrs.points && attrs.points.trueStart) {\n                    node.points(attrs.points.trueStart);\n                }\n\n                if (that.onReset) {\n                    that.onReset();\n                }\n            };\n        },\n        /**\n         * play\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @returns {Tween}\n         */\n        play: function() {\n            this.tween.play();\n            return this;\n        },\n        /**\n         * reverse\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @returns {Tween}\n         */\n        reverse: function() {\n            this.tween.reverse();\n            return this;\n        },\n        /**\n         * reset\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @returns {Tween}\n         */\n        reset: function() {\n            this.tween.reset();\n            return this;\n        },\n        /**\n         * seek\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @param {Integer} t time in seconds between 0 and the duration\n         * @returns {Tween}\n         */\n        seek: function(t) {\n            this.tween.seek(t * 1000);\n            return this;\n        },\n        /**\n         * pause\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @returns {Tween}\n         */\n        pause: function() {\n            this.tween.pause();\n            return this;\n        },\n        /**\n         * finish\n         * @method\n         * @memberof Konva.Tween.prototype\n         * @returns {Tween}\n         */\n        finish: function() {\n            this.tween.finish();\n            return this;\n        },\n        /**\n         * destroy\n         * @method\n         * @memberof Konva.Tween.prototype\n         */\n        destroy: function() {\n            var nodeId = this.node._id,\n                thisId = this._id,\n                attrs = Konva.Tween.tweens[nodeId],\n                key;\n\n            this.pause();\n\n            for (key in attrs) {\n                delete Konva.Tween.tweens[nodeId][key];\n            }\n\n            delete Konva.Tween.attrs[nodeId][thisId];\n        }\n    };\n\n    /**\n     * Tween node properties. Shorter usage of {@link Konva.Tween} object.\n     *\n     * @method Konva.Node#to\n     * @memberof Konva.Node\n     * @param {Object} [params] tween params\n     * @example\n     *\n     * circle.to({\n     *  x : 50,\n     *  duration : 0.5\n     * });\n     */\n    Konva.Node.prototype.to = function(params) {\n        var onFinish = params.onFinish;\n        params.node = this;\n        params.onFinish = function() {\n            this.destroy();\n            if (onFinish) {\n                onFinish();\n            }\n        };\n        var tween = new Konva.Tween(params);\n        tween.play();\n    };\n\n    /*\n    * These eases were ported from an Adobe Flash tweening library to JavaScript\n    * by Xaric\n    */\n\n    /**\n     * @namespace Easings\n     * @memberof Konva\n     */\n    Konva.Easings = {\n        /**\n        * back ease in\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BackEaseIn': function(t, b, c, d) {\n            var s = 1.70158;\n            return c * (t /= d) * t * ((s + 1) * t - s) + b;\n        },\n        /**\n        * back ease out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BackEaseOut': function(t, b, c, d) {\n            var s = 1.70158;\n            return c * (( t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n        },\n        /**\n        * back ease in out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BackEaseInOut': function(t, b, c, d) {\n            var s = 1.70158;\n            if((t /= d / 2) < 1) {\n                return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\n            }\n            return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\n        },\n        /**\n        * elastic ease in\n        * @function\n        * @memberof Konva.Easings\n        */\n        'ElasticEaseIn': function(t, b, c, d, a, p) {\n            // added s = 0\n            var s = 0;\n            if(t === 0) {\n                return b;\n            }\n            if((t /= d) === 1) {\n                return b + c;\n            }\n            if(!p) {\n                p = d * 0.3;\n            }\n            if(!a || a < Math.abs(c)) {\n                a = c;\n                s = p / 4;\n            }\n            else {\n                s = p / (2 * Math.PI) * Math.asin(c / a);\n            }\n            return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n        },\n        /**\n        * elastic ease out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'ElasticEaseOut': function(t, b, c, d, a, p) {\n            // added s = 0\n            var s = 0;\n            if(t === 0) {\n                return b;\n            }\n            if((t /= d) === 1) {\n                return b + c;\n            }\n            if(!p) {\n                p = d * 0.3;\n            }\n            if(!a || a < Math.abs(c)) {\n                a = c;\n                s = p / 4;\n            }\n            else {\n                s = p / (2 * Math.PI) * Math.asin(c / a);\n            }\n            return (a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b);\n        },\n        /**\n        * elastic ease in out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'ElasticEaseInOut': function(t, b, c, d, a, p) {\n            // added s = 0\n            var s = 0;\n            if(t === 0) {\n                return b;\n            }\n            if((t /= d / 2) === 2) {\n                return b + c;\n            }\n            if(!p) {\n                p = d * (0.3 * 1.5);\n            }\n            if(!a || a < Math.abs(c)) {\n                a = c;\n                s = p / 4;\n            }\n            else {\n                s = p / (2 * Math.PI) * Math.asin(c / a);\n            }\n            if(t < 1) {\n                return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n            }\n            return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;\n        },\n        /**\n        * bounce ease out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BounceEaseOut': function(t, b, c, d) {\n            if((t /= d) < (1 / 2.75)) {\n                return c * (7.5625 * t * t) + b;\n            }\n            else if(t < (2 / 2.75)) {\n                return c * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75) + b;\n            }\n            else if(t < (2.5 / 2.75)) {\n                return c * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375) + b;\n            }\n            else {\n                return c * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375) + b;\n            }\n        },\n        /**\n        * bounce ease in\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BounceEaseIn': function(t, b, c, d) {\n            return c - Konva.Easings.BounceEaseOut(d - t, 0, c, d) + b;\n        },\n        /**\n        * bounce ease in out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'BounceEaseInOut': function(t, b, c, d) {\n            if(t < d / 2) {\n                return Konva.Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n            }\n            else {\n                return Konva.Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n            }\n        },\n        /**\n        * ease in\n        * @function\n        * @memberof Konva.Easings\n        */\n        'EaseIn': function(t, b, c, d) {\n            return c * (t /= d) * t + b;\n        },\n        /**\n        * ease out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'EaseOut': function(t, b, c, d) {\n            return -c * (t /= d) * (t - 2) + b;\n        },\n        /**\n        * ease in out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'EaseInOut': function(t, b, c, d) {\n            if((t /= d / 2) < 1) {\n                return c / 2 * t * t + b;\n            }\n            return -c / 2 * ((--t) * (t - 2) - 1) + b;\n        },\n        /**\n        * strong ease in\n        * @function\n        * @memberof Konva.Easings\n        */\n        'StrongEaseIn': function(t, b, c, d) {\n            return c * (t /= d) * t * t * t * t + b;\n        },\n        /**\n        * strong ease out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'StrongEaseOut': function(t, b, c, d) {\n            return c * (( t = t / d - 1) * t * t * t * t + 1) + b;\n        },\n        /**\n        * strong ease in out\n        * @function\n        * @memberof Konva.Easings\n        */\n        'StrongEaseInOut': function(t, b, c, d) {\n            if((t /= d / 2) < 1) {\n                return c / 2 * t * t * t * t * t + b;\n            }\n            return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n        },\n        /**\n        * linear\n        * @function\n        * @memberof Konva.Easings\n        */\n        'Linear': function(t, b, c, d) {\n            return c * t / d + b;\n        }\n    };\n})();\n\n(function() {\n    'use strict';\n    Konva.DD = {\n        // properties\n        anim: new Konva.Animation(function() {\n            var b = this.dirty;\n            this.dirty = false;\n            return b;\n        }),\n        isDragging: false,\n        justDragged: false,\n        offset: {\n            x: 0,\n            y: 0\n        },\n        node: null,\n\n        // methods\n        _drag: function(evt) {\n            var dd = Konva.DD,\n                node = dd.node;\n\n            if(node) {\n               if(!dd.isDragging) {\n                    var pos = node.getStage().getPointerPosition();\n                    var dragDistance = node.dragDistance();\n                    var distance = Math.max(\n                        Math.abs(pos.x - dd.startPointerPos.x),\n                        Math.abs(pos.y - dd.startPointerPos.y)\n                    );\n                    if (distance < dragDistance) {\n                        return;\n                    }\n                }\n\n\n                node.getStage()._setPointerPosition(evt);\n                node._setDragPosition(evt);\n                if(!dd.isDragging) {\n                    dd.isDragging = true;\n                    node.fire('dragstart', {\n                        type: 'dragstart',\n                        target: node,\n                        evt: evt\n                    }, true);\n                }\n\n                // execute ondragmove if defined\n                node.fire('dragmove', {\n                    type: 'dragmove',\n                    target: node,\n                    evt: evt\n                }, true);\n            }\n        },\n        _endDragBefore: function(evt) {\n            var dd = Konva.DD,\n                node = dd.node,\n                layer;\n\n            if(node) {\n                layer = node.getLayer();\n                dd.anim.stop();\n\n                // only fire dragend event if the drag and drop\n                // operation actually started.\n                if(dd.isDragging) {\n                    dd.isDragging = false;\n                    dd.justDragged = true;\n                    Konva.listenClickTap = false;\n\n                    if (evt) {\n                        evt.dragEndNode = node;\n                    }\n                }\n\n                delete dd.node;\n\n                if (node.getLayer() || layer) {\n                  (layer || node).draw();\n                }\n\n            }\n        },\n        _endDragAfter: function(evt) {\n            evt = evt || {};\n            var dragEndNode = evt.dragEndNode;\n\n            if (evt && dragEndNode) {\n                dragEndNode.fire('dragend', {\n                    type: 'dragend',\n                    target: dragEndNode,\n                    evt: evt\n                }, true);\n            }\n        }\n    };\n\n    // Node extenders\n\n    /**\n     * initiate drag and drop\n     * @method\n     * @memberof Konva.Node.prototype\n     */\n    Konva.Node.prototype.startDrag = function() {\n        var dd = Konva.DD,\n            stage = this.getStage(),\n            layer = this.getLayer(),\n            pos = stage.getPointerPosition(),\n            ap = this.getAbsolutePosition();\n\n        if(pos) {\n            if (dd.node) {\n                dd.node.stopDrag();\n            }\n\n            dd.node = this;\n            dd.startPointerPos = pos;\n            dd.offset.x = pos.x - ap.x;\n            dd.offset.y = pos.y - ap.y;\n            dd.anim.setLayers(layer || this.getLayers());\n            dd.anim.start();\n\n            this._setDragPosition();\n        }\n    };\n\n    Konva.Node.prototype._setDragPosition = function(evt) {\n        var dd = Konva.DD,\n            pos = this.getStage().getPointerPosition(),\n            dbf = this.getDragBoundFunc();\n        if (!pos) {\n            return;\n        }\n        var newNodePos = {\n            x: pos.x - dd.offset.x,\n            y: pos.y - dd.offset.y\n        };\n\n        if(dbf !== undefined) {\n            newNodePos = dbf.call(this, newNodePos, evt);\n        }\n        this.setAbsolutePosition(newNodePos);\n\n        if (!this._lastPos || this._lastPos.x !== newNodePos.x ||\n            this._lastPos.y !== newNodePos.y) {\n            dd.anim.dirty = true;\n        }\n\n        this._lastPos = newNodePos;\n    };\n\n    /**\n     * stop drag and drop\n     * @method\n     * @memberof Konva.Node.prototype\n     */\n    Konva.Node.prototype.stopDrag = function() {\n        var dd = Konva.DD,\n            evt = {};\n        dd._endDragBefore(evt);\n        dd._endDragAfter(evt);\n    };\n\n    Konva.Node.prototype.setDraggable = function(draggable) {\n        this._setAttr('draggable', draggable);\n        this._dragChange();\n    };\n\n    var origDestroy = Konva.Node.prototype.destroy;\n\n    Konva.Node.prototype.destroy = function() {\n        var dd = Konva.DD;\n\n        // stop DD\n        if(dd.node && dd.node._id === this._id) {\n\n            this.stopDrag();\n        }\n\n        origDestroy.call(this);\n    };\n\n    /**\n     * determine if node is currently in drag and drop mode\n     * @method\n     * @memberof Konva.Node.prototype\n     */\n    Konva.Node.prototype.isDragging = function() {\n        var dd = Konva.DD;\n        return !!(dd.node && dd.node._id === this._id && dd.isDragging);\n    };\n\n    Konva.Node.prototype._listenDrag = function() {\n        var that = this;\n\n        this._dragCleanup();\n\n        if (this.getClassName() === 'Stage') {\n            this.on('contentMousedown.konva contentTouchstart.konva', function(evt) {\n                if(!Konva.DD.node) {\n                    that.startDrag(evt);\n                }\n            });\n        }\n        else {\n            this.on('mousedown.konva touchstart.konva', function(evt) {\n                // ignore right and middle buttons\n                if (evt.evt.button === 1 || evt.evt.button === 2) {\n                    return;\n                }\n                if(!Konva.DD.node) {\n                    that.startDrag(evt);\n                }\n            });\n        }\n\n        // listening is required for drag and drop\n        /*\n        this._listeningEnabled = true;\n        this._clearSelfAndAncestorCache('listeningEnabled');\n        */\n    };\n\n    Konva.Node.prototype._dragChange = function() {\n        if(this.attrs.draggable) {\n            this._listenDrag();\n        }\n        else {\n            // remove event listeners\n            this._dragCleanup();\n\n            /*\n             * force drag and drop to end\n             * if this node is currently in\n             * drag and drop mode\n             */\n            var stage = this.getStage();\n            var dd = Konva.DD;\n            if(stage && dd.node && dd.node._id === this._id) {\n                dd.node.stopDrag();\n            }\n        }\n    };\n\n    Konva.Node.prototype._dragCleanup = function() {\n        if (this.getClassName() === 'Stage') {\n            this.off('contentMousedown.konva');\n            this.off('contentTouchstart.konva');\n        } else {\n            this.off('mousedown.konva');\n            this.off('touchstart.konva');\n        }\n    };\n\n    Konva.Factory.addGetterSetter(Konva.Node, 'dragBoundFunc');\n\n    /**\n     * get/set drag bound function.  This is used to override the default\n     *  drag and drop position\n     * @name dragBoundFunc\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Function} dragBoundFunc\n     * @returns {Function}\n     * @example\n     * // get drag bound function\n     * var dragBoundFunc = node.dragBoundFunc();\n     *\n     * // create vertical drag and drop\n     * node.dragBoundFunc(function(pos){\n     *   return {\n     *     x: this.getAbsolutePosition().x,\n     *     y: pos.y\n     *   };\n     * });\n     */\n\n    Konva.Factory.addGetter(Konva.Node, 'draggable', false);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Node, 'draggable');\n\n     /**\n     * get/set draggable flag\n     * @name draggable\n     * @method\n     * @memberof Konva.Node.prototype\n     * @param {Boolean} draggable\n     * @returns {Boolean}\n     * @example\n     * // get draggable flag\n     * var draggable = node.draggable();\n     *\n     * // enable drag and drop\n     * node.draggable(true);\n     *\n     * // disable drag and drop\n     * node.draggable(false);\n     */\n\n    var html = Konva.document.documentElement;\n    html.addEventListener('mouseup', Konva.DD._endDragBefore, true);\n    html.addEventListener('touchend', Konva.DD._endDragBefore, true);\n\n    html.addEventListener('mousemove', Konva.DD._drag);\n    html.addEventListener('touchmove', Konva.DD._drag);\n\n    html.addEventListener('mouseup', Konva.DD._endDragAfter, false);\n    html.addEventListener('touchend', Konva.DD._endDragAfter, false);\n\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Rect constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} [config.cornerRadius]\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var rect = new Konva.Rect({\n     *   width: 100,\n     *   height: 50,\n     *   fill: 'red',\n     *   stroke: 'black',\n     *   strokeWidth: 5\n     * });\n     */\n    Konva.Rect = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Rect.prototype = {\n        ___init: function(config) {\n            Konva.Shape.call(this, config);\n            this.className = 'Rect';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var cornerRadius = this.getCornerRadius(),\n                width = this.getWidth(),\n                height = this.getHeight();\n\n            context.beginPath();\n\n            if(!cornerRadius) {\n                // simple rect - don't bother doing all that complicated maths stuff.\n                context.rect(0, 0, width, height);\n            } else {\n                // arcTo would be nicer, but browser support is patchy (Opera)\n                cornerRadius = Math.min(cornerRadius, width / 2, height / 2);\n                context.moveTo(cornerRadius, 0);\n                context.lineTo(width - cornerRadius, 0);\n                context.arc(width - cornerRadius, cornerRadius, cornerRadius, Math.PI * 3 / 2, 0, false);\n                context.lineTo(width, height - cornerRadius);\n                context.arc(width - cornerRadius, height - cornerRadius, cornerRadius, 0, Math.PI / 2, false);\n                context.lineTo(cornerRadius, height);\n                context.arc(cornerRadius, height - cornerRadius, cornerRadius, Math.PI / 2, Math.PI, false);\n                context.lineTo(0, cornerRadius);\n                context.arc(cornerRadius, cornerRadius, cornerRadius, Math.PI, Math.PI * 3 / 2, false);\n            }\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n    };\n\n    Konva.Util.extend(Konva.Rect, Konva.Shape);\n\n    Konva.Factory.addGetterSetter(Konva.Rect, 'cornerRadius', 0);\n    /**\n     * get/set corner radius\n     * @name cornerRadius\n     * @method\n     * @memberof Konva.Rect.prototype\n     * @param {Number} cornerRadius\n     * @returns {Number}\n     * @example\n     * // get corner radius\n     * var cornerRadius = rect.cornerRadius();\n     *\n     * // set corner radius\n     * rect.cornerRadius(10);\n     */\n\n    Konva.Collection.mapMethods(Konva.Rect);\n})();\n\n(function() {\n    'use strict';\n    // the 0.0001 offset fixes a bug in Chrome 27\n    var PIx2 = (Math.PI * 2) - 0.0001,\n        CIRCLE = 'Circle';\n\n    /**\n     * Circle constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} config.radius\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * // create circle\n     * var circle = new Konva.Circle({\n     *   radius: 40,\n     *   fill: 'red',\n     *   stroke: 'black'\n     *   strokeWidth: 5\n     * });\n     */\n    Konva.Circle = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Circle.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = CIRCLE;\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            context.beginPath();\n            context.arc(0, 0, this.getRadius(), 0, PIx2, false);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.radius() !== width / 2) {\n                this.setRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.radius() !== height / 2) {\n                this.setRadius(height / 2);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.Circle, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Circle, 'radius', 0);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Circle, 'radius');\n\n    /**\n     * get/set radius\n     * @name radius\n     * @method\n     * @memberof Konva.Circle.prototype\n     * @param {Number} radius\n     * @returns {Number}\n     * @example\n     * // get radius\n     * var radius = circle.radius();\n     *\n     * // set radius\n     * circle.radius(10);\n     */\n\n    Konva.Collection.mapMethods(Konva.Circle);\n})();\n\n(function() {\n    'use strict';\n    // the 0.0001 offset fixes a bug in Chrome 27\n    var PIx2 = (Math.PI * 2) - 0.0001,\n        ELLIPSE = 'Ellipse';\n\n    /**\n     * Ellipse constructor\n     * @constructor\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Object} config.radius defines x and y radius\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var ellipse = new Konva.Ellipse({\n     *   radius : {\n     *     x : 50,\n     *     y : 50\n     *   },\n     *   fill: 'red'\n     * });\n     */\n    Konva.Ellipse = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Ellipse.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = ELLIPSE;\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var rx = this.getRadiusX(),\n                ry = this.getRadiusY();\n\n            context.beginPath();\n            context.save();\n            if(rx !== ry) {\n                context.scale(1, ry / rx);\n            }\n            context.arc(0, 0, rx, 0, PIx2, false);\n            context.restore();\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getRadiusX() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getRadiusY() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            this.setRadius({\n                x: width / 2\n            });\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            this.setRadius({\n                y: height / 2\n            });\n        }\n    };\n    Konva.Util.extend(Konva.Ellipse, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addComponentsGetterSetter(Konva.Ellipse, 'radius', ['x', 'y']);\n\n    /**\n     * get/set radius\n     * @name radius\n     * @method\n     * @memberof Konva.Ellipse.prototype\n     * @param {Object} radius\n     * @param {Number} radius.x\n     * @param {Number} radius.y\n     * @returns {Object}\n     * @example\n     * // get radius\n     * var radius = ellipse.radius();\n     *\n     * // set radius\n     * ellipse.radius({\n     *   x: 200,\n     *   y: 100\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Ellipse, 'radiusX', 0);\n    /**\n     * get/set radius x\n     * @name radiusX\n     * @method\n     * @memberof Konva.Ellipse.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get radius x\n     * var radiusX = ellipse.radiusX();\n     *\n     * // set radius x\n     * ellipse.radiusX(200);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Ellipse, 'radiusY', 0);\n    /**\n     * get/set radius y\n     * @name radiusY\n     * @method\n     * @memberof Konva.Ellipse.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get radius y\n     * var radiusY = ellipse.radiusY();\n     *\n     * // set radius y\n     * ellipse.radiusY(200);\n     */\n\n    Konva.Collection.mapMethods(Konva.Ellipse);\n\n})();\n\n(function() {\n    'use strict';\n    // the 0.0001 offset fixes a bug in Chrome 27\n    var PIx2 = (Math.PI * 2) - 0.0001;\n    /**\n     * Ring constructor\n     * @constructor\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} config.innerRadius\n     * @param {Number} config.outerRadius\n     * @param {Boolean} [config.clockwise]\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var ring = new Konva.Ring({\n     *   innerRadius: 40,\n     *   outerRadius: 80,\n     *   fill: 'red',\n     *   stroke: 'black',\n     *   strokeWidth: 5\n     * });\n     */\n    Konva.Ring = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Ring.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Ring';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            context.beginPath();\n            context.arc(0, 0, this.getInnerRadius(), 0, PIx2, false);\n            context.moveTo(this.getOuterRadius(), 0);\n            context.arc(0, 0, this.getOuterRadius(), PIx2, 0, true);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.outerRadius() !== width / 2) {\n                this.setOuterRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.outerRadius() !== height / 2) {\n                this.setOuterRadius(height / 2);\n            }\n        },\n        setOuterRadius: function(val) {\n            this._setAttr('outerRadius', val);\n            this.setWidth(val * 2);\n            this.setHeight(val * 2);\n        }\n    };\n    Konva.Util.extend(Konva.Ring, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Ring, 'innerRadius', 0);\n\n    /**\n     * get/set innerRadius\n     * @name innerRadius\n     * @method\n     * @memberof Konva.Ring.prototype\n     * @param {Number} innerRadius\n     * @returns {Number}\n     * @example\n     * // get inner radius\n     * var innerRadius = ring.innerRadius();\n     *\n     * // set inner radius\n     * ring.innerRadius(20);\n     */\n    Konva.Factory.addGetter(Konva.Ring, 'outerRadius', 0);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Ring, 'outerRadius');\n\n    /**\n     * get/set outerRadius\n     * @name outerRadius\n     * @method\n     * @memberof Konva.Ring.prototype\n     * @param {Number} outerRadius\n     * @returns {Number}\n     * @example\n     * // get outer radius\n     * var outerRadius = ring.outerRadius();\n     *\n     * // set outer radius\n     * ring.outerRadius(20);\n     */\n\n    Konva.Collection.mapMethods(Konva.Ring);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Wedge constructor\n     * @constructor\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} config.angle in degrees\n     * @param {Number} config.radius\n     * @param {Boolean} [config.clockwise]\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * // draw a wedge that's pointing downwards\n     * var wedge = new Konva.Wedge({\n     *   radius: 40,\n     *   fill: 'red',\n     *   stroke: 'black'\n     *   strokeWidth: 5,\n     *   angleDeg: 60,\n     *   rotationDeg: -120\n     * });\n     */\n    Konva.Wedge = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Wedge.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Wedge';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            context.beginPath();\n            context.arc(0, 0, this.getRadius(), 0, Konva.getAngle(this.getAngle()), this.getClockwise());\n            context.lineTo(0, 0);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.radius() !== width / 2) {\n                this.setRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.radius() !== height / 2) {\n                this.setRadius(height / 2);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.Wedge, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Wedge, 'radius', 0);\n\n    /**\n     * get/set radius\n     * @name radius\n     * @method\n     * @memberof Konva.Wedge.prototype\n     * @param {Number} radius\n     * @returns {Number}\n     * @example\n     * // get radius\n     * var radius = wedge.radius();\n     *\n     * // set radius\n     * wedge.radius(10);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Wedge, 'angle', 0);\n\n    /**\n     * get/set angle in degrees\n     * @name angle\n     * @method\n     * @memberof Konva.Wedge.prototype\n     * @param {Number} angle\n     * @returns {Number}\n     * @example\n     * // get angle\n     * var angle = wedge.angle();\n     *\n     * // set angle\n     * wedge.angle(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Wedge, 'clockwise', false);\n\n    /**\n     * get/set clockwise flag\n     * @name clockwise\n     * @method\n     * @memberof Konva.Wedge.prototype\n     * @param {Number} clockwise\n     * @returns {Number}\n     * @example\n     * // get clockwise flag\n     * var clockwise = wedge.clockwise();\n     *\n     * // draw wedge counter-clockwise\n     * wedge.clockwise(false);\n     *\n     * // draw wedge clockwise\n     * wedge.clockwise(true);\n     */\n\n    Konva.Factory.backCompat(Konva.Wedge, {\n        angleDeg: 'angle',\n        getAngleDeg: 'getAngle',\n        setAngleDeg: 'setAngle'\n    });\n\n    Konva.Collection.mapMethods(Konva.Wedge);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Arc constructor\n     * @constructor\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} config.angle in degrees\n     * @param {Number} config.innerRadius\n     * @param {Number} config.outerRadius\n     * @param {Boolean} [config.clockwise]\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * // draw a Arc that's pointing downwards\n     * var arc = new Konva.Arc({\n     *   innerRadius: 40,\n     *   outerRadius: 80,\n     *   fill: 'red',\n     *   stroke: 'black'\n     *   strokeWidth: 5,\n     *   angle: 60,\n     *   rotationDeg: -120\n     * });\n     */\n    Konva.Arc = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Arc.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Arc';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var angle = Konva.getAngle(this.angle()),\n                clockwise = this.clockwise();\n\n            context.beginPath();\n            context.arc(0, 0, this.getOuterRadius(), 0, angle, clockwise);\n            context.arc(0, 0, this.getInnerRadius(), angle, 0, !clockwise);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.getOuterRadius() !== width / 2) {\n                this.setOuterRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.getOuterRadius() !== height / 2) {\n                this.setOuterRadius(height / 2);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.Arc, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Arc, 'innerRadius', 0);\n\n    /**\n     * get/set innerRadius\n     * @name innerRadius\n     * @method\n     * @memberof Konva.Arc.prototype\n     * @param {Number} innerRadius\n     * @returns {Number}\n     * @example\n     * // get inner radius\n     * var innerRadius = arc.innerRadius();\n     *\n     * // set inner radius\n     * arc.innerRadius(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arc, 'outerRadius', 0);\n\n    /**\n     * get/set outerRadius\n     * @name outerRadius\n     * @method\n     * @memberof Konva.Arc.prototype\n     * @param {Number} outerRadius\n     * @returns {Number}\n     * @example\n     * // get outer radius\n     * var outerRadius = arc.outerRadius();\n     *\n     * // set outer radius\n     * arc.outerRadius(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arc, 'angle', 0);\n\n    /**\n     * get/set angle in degrees\n     * @name angle\n     * @method\n     * @memberof Konva.Arc.prototype\n     * @param {Number} angle\n     * @returns {Number}\n     * @example\n     * // get angle\n     * var angle = arc.angle();\n     *\n     * // set angle\n     * arc.angle(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arc, 'clockwise', false);\n\n    /**\n     * get/set clockwise flag\n     * @name clockwise\n     * @method\n     * @memberof Konva.Arc.prototype\n     * @param {Boolean} clockwise\n     * @returns {Boolean}\n     * @example\n     * // get clockwise flag\n     * var clockwise = arc.clockwise();\n     *\n     * // draw arc counter-clockwise\n     * arc.clockwise(false);\n     *\n     * // draw arc clockwise\n     * arc.clockwise(true);\n     */\n\n    Konva.Collection.mapMethods(Konva.Arc);\n})();\n\n(function() {\n    'use strict';\n    // CONSTANTS\n    var IMAGE = 'Image';\n\n    /**\n     * Image constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Image} config.image\n     * @param {Object} [config.crop]\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var imageObj = new Image();\n     * imageObj.onload = function() {\n     *   var image = new Konva.Image({\n     *     x: 200,\n     *     y: 50,\n     *     image: imageObj,\n     *     width: 100,\n     *     height: 100\n     *   });\n     * };\n     * imageObj.src = '/path/to/image.jpg'\n     */\n    Konva.Image = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Image.prototype = {\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = IMAGE;\n            this.sceneFunc(this._sceneFunc);\n            this.hitFunc(this._hitFunc);\n        },\n        _useBufferCanvas: function() {\n            return (this.hasShadow() || this.getAbsoluteOpacity() !== 1) && this.hasStroke() && this.getStage();\n        },\n        _sceneFunc: function(context) {\n            var width = this.getWidth(),\n                height = this.getHeight(),\n                image = this.getImage(),\n                cropWidth, cropHeight, params;\n\n            if (image) {\n                cropWidth = this.getCropWidth();\n                cropHeight = this.getCropHeight();\n                if (cropWidth && cropHeight) {\n                    params = [image, this.getCropX(), this.getCropY(), cropWidth, cropHeight, 0, 0, width, height];\n                } else {\n                    params = [image, 0, 0, width, height];\n                }\n            }\n\n            if (this.hasFill() || this.hasStroke()) {\n                context.beginPath();\n                context.rect(0, 0, width, height);\n                context.closePath();\n                context.fillStrokeShape(this);\n            }\n\n            if (image) {\n                context.drawImage.apply(context, params);\n            }\n        },\n        _hitFunc: function(context) {\n            var width = this.getWidth(),\n                height = this.getHeight();\n\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        getWidth: function() {\n            var image = this.getImage();\n            return this.attrs.width || (image ? image.width : 0);\n        },\n        getHeight: function() {\n            var image = this.getImage();\n            return this.attrs.height || (image ? image.height : 0);\n        }\n    };\n    Konva.Util.extend(Konva.Image, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Image, 'image');\n\n    /**\n     * set image\n     * @name setImage\n     * @method\n     * @memberof Konva.Image.prototype\n     * @param {Image} image\n     */\n\n    /**\n     * get image\n     * @name getImage\n     * @method\n     * @memberof Konva.Image.prototype\n     * @returns {Image}\n     */\n\n    Konva.Factory.addComponentsGetterSetter(Konva.Image, 'crop', ['x', 'y', 'width', 'height']);\n    /**\n     * get/set crop\n     * @method\n     * @name crop\n     * @memberof Konva.Image.prototype\n     * @param {Object} crop\n     * @param {Number} crop.x\n     * @param {Number} crop.y\n     * @param {Number} crop.width\n     * @param {Number} crop.height\n     * @returns {Object}\n     * @example\n     * // get crop\n     * var crop = image.crop();\n     *\n     * // set crop\n     * image.crop({\n     *   x: 20,\n     *   y: 20,\n     *   width: 20,\n     *   height: 20\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Image, 'cropX', 0);\n    /**\n     * get/set crop x\n     * @method\n     * @name cropX\n     * @memberof Konva.Image.prototype\n     * @param {Number} x\n     * @returns {Number}\n     * @example\n     * // get crop x\n     * var cropX = image.cropX();\n     *\n     * // set crop x\n     * image.cropX(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Image, 'cropY', 0);\n    /**\n     * get/set crop y\n     * @name cropY\n     * @method\n     * @memberof Konva.Image.prototype\n     * @param {Number} y\n     * @returns {Number}\n     * @example\n     * // get crop y\n     * var cropY = image.cropY();\n     *\n     * // set crop y\n     * image.cropY(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Image, 'cropWidth', 0);\n    /**\n     * get/set crop width\n     * @name cropWidth\n     * @method\n     * @memberof Konva.Image.prototype\n     * @param {Number} width\n     * @returns {Number}\n     * @example\n     * // get crop width\n     * var cropWidth = image.cropWidth();\n     *\n     * // set crop width\n     * image.cropWidth(20);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Image, 'cropHeight', 0);\n    /**\n     * get/set crop height\n     * @name cropHeight\n     * @method\n     * @memberof Konva.Image.prototype\n     * @param {Number} height\n     * @returns {Number}\n     * @example\n     * // get crop height\n     * var cropHeight = image.cropHeight();\n     *\n     * // set crop height\n     * image.cropHeight(20);\n     */\n\n    Konva.Collection.mapMethods(Konva.Image);\n\n    /**\n     * load image from given url and create `Konva.Image` instance\n     * @method\n     * @memberof Konva.Image\n     * @param {String} url image source\n     * @param {Function} callback with Konva.Image instance as first argument\n     * @example\n     *  Konva.Image.fromURL(imageURL, function(image){\n     *    // image is Konva.Image instance\n     *    layer.add(image);\n     *    layer.draw();\n     *  });\n     */\n    Konva.Image.fromURL = function(url, callback) {\n        var img = new Image();\n        img.onload = function() {\n          var image = new Konva.Image({\n            image: img\n          });\n          callback(image);\n        };\n        img.src = url;\n    };\n})();\n\n/*eslint-disable max-depth */\n(function() {\n    'use strict';\n    // constants\n    var AUTO = 'auto',\n        //CANVAS = 'canvas',\n        CENTER = 'center',\n        CHANGE_KONVA = 'Change.konva',\n        CONTEXT_2D = '2d',\n        DASH = '-',\n        EMPTY_STRING = '',\n        LEFT = 'left',\n        TEXT = 'text',\n        TEXT_UPPER = 'Text',\n        MIDDLE = 'middle',\n        NORMAL = 'normal',\n        PX_SPACE = 'px ',\n        SPACE = ' ',\n        RIGHT = 'right',\n        WORD = 'word',\n        CHAR = 'char',\n        NONE = 'none',\n        ATTR_CHANGE_LIST = ['fontFamily', 'fontSize', 'fontStyle', 'fontVariant', 'padding', 'align', 'lineHeight', 'text', 'width', 'height', 'wrap'],\n\n        // cached variables\n        attrChangeListLen = ATTR_CHANGE_LIST.length,\n        dummyContext = Konva.Util.createCanvasElement().getContext(CONTEXT_2D);\n\n    /**\n     * Text constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {String} [config.fontFamily] default is Arial\n     * @param {Number} [config.fontSize] in pixels.  Default is 12\n     * @param {String} [config.fontStyle] can be normal, bold, or italic.  Default is normal\n     * @param {String} [config.fontVariant] can be normal or small-caps.  Default is normal\n     * @param {String} config.text\n     * @param {String} [config.align] can be left, center, or right\n     * @param {Number} [config.padding]\n     * @param {Number} [config.lineHeight] default is 1\n     * @param {String} [config.wrap] can be word, char, or none. Default is word\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var text = new Konva.Text({\n     *   x: 10,\n     *   y: 15,\n     *   text: 'Simple Text',\n     *   fontSize: 30,\n     *   fontFamily: 'Calibri',\n     *   fill: 'green'\n     * });\n     */\n    Konva.Text = function(config) {\n        this.___init(config);\n    };\n    function _fillFunc(context) {\n        context.fillText(this.partialText, 0, 0);\n    }\n    function _strokeFunc(context) {\n        context.strokeText(this.partialText, 0, 0);\n    }\n\n    Konva.Text.prototype = {\n        ___init: function(config) {\n            config = config || {};\n\n            // set default color to black\n            if (!config.fillLinearGradientColorStops && !config.fillRadialGradientColorStops) {\n                config.fill = config.fill || 'black';\n            }\n            //\n            // if (config.width === undefined) {\n            //     config.width = AUTO;\n            // }\n            // if (config.height === undefined) {\n            //     config.height = AUTO;\n            // }\n\n            // call super constructor\n            Konva.Shape.call(this, config);\n\n            this._fillFunc = _fillFunc;\n            this._strokeFunc = _strokeFunc;\n            this.className = TEXT_UPPER;\n\n            // update text data for certain attr changes\n            for(var n = 0; n < attrChangeListLen; n++) {\n                this.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, this._setTextData);\n            }\n\n            this._setTextData();\n            this.sceneFunc(this._sceneFunc);\n            this.hitFunc(this._hitFunc);\n        },\n        _sceneFunc: function(context) {\n            var p = this.getPadding(),\n                textHeight = this.getTextHeight(),\n                lineHeightPx = this.getLineHeight() * textHeight,\n                textArr = this.textArr,\n                textArrLen = textArr.length,\n                totalWidth = this.getWidth(),\n                n;\n\n            context.setAttr('font', this._getContextFont());\n\n            context.setAttr('textBaseline', MIDDLE);\n            context.setAttr('textAlign', LEFT);\n            context.save();\n            if (p) {\n                context.translate(p, 0);\n                context.translate(0, p + textHeight / 2);\n            } else {\n                context.translate(0, textHeight / 2);\n            }\n\n\n            // draw text lines\n            for(n = 0; n < textArrLen; n++) {\n                var obj = textArr[n],\n                    text = obj.text,\n                    width = obj.width;\n\n                // horizontal alignment\n                context.save();\n                if(this.getAlign() === RIGHT) {\n                    context.translate(totalWidth - width - p * 2, 0);\n                }\n                else if(this.getAlign() === CENTER) {\n                    context.translate((totalWidth - width - p * 2) / 2, 0);\n                }\n\n                this.partialText = text;\n\n                context.fillStrokeShape(this);\n                context.restore();\n                context.translate(0, lineHeightPx);\n            }\n            context.restore();\n        },\n        _hitFunc: function(context) {\n            var width = this.getWidth(),\n                height = this.getHeight();\n\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        setText: function(text) {\n            var str = Konva.Util._isString(text) ? text : (text || '').toString();\n            this._setAttr(TEXT, str);\n            return this;\n        },\n        /**\n         * get width of text area, which includes padding\n         * @method\n         * @memberof Konva.Text.prototype\n         * @returns {Number}\n         */\n        getWidth: function() {\n            var isAuto = (this.attrs.width === AUTO) || (this.attrs.width === undefined);\n            return isAuto ? this.getTextWidth() + this.getPadding() * 2 : this.attrs.width;\n        },\n        /**\n         * get the height of the text area, which takes into account multi-line text, line heights, and padding\n         * @method\n         * @memberof Konva.Text.prototype\n         * @returns {Number}\n         */\n        getHeight: function() {\n          var isAuto = (this.attrs.height === AUTO) || (this.attrs.height === undefined);\n          return isAuto ? (this.getTextHeight() * this.textArr.length * this.getLineHeight()) + this.getPadding() * 2 : this.attrs.height;\n        },\n        /**\n         * get text width\n         * @method\n         * @memberof Konva.Text.prototype\n         * @returns {Number}\n         */\n        getTextWidth: function() {\n            return this.textWidth;\n        },\n        /**\n         * get text height\n         * @method\n         * @memberof Konva.Text.prototype\n         * @returns {Number}\n         */\n        getTextHeight: function() {\n            return this.textHeight;\n        },\n        _getTextSize: function(text) {\n            var _context = dummyContext,\n                fontSize = this.getFontSize(),\n                metrics;\n\n            _context.save();\n            _context.font = this._getContextFont();\n\n            metrics = _context.measureText(text);\n            _context.restore();\n            return {\n                width: metrics.width,\n                height: parseInt(fontSize, 10)\n            };\n        },\n        _getContextFont: function() {\n            // IE don't want to work with usual font style\n            // bold was not working\n            // removing font variant will solve\n            // fix for: https://github.com/konvajs/konva/issues/94\n            if (Konva.UA.isIE) {\n                return this.getFontStyle() + SPACE + this.getFontSize() + PX_SPACE + this.getFontFamily();\n            }\n            return this.getFontStyle() + SPACE +\n                    this.getFontVariant() + SPACE +\n                    this.getFontSize() + PX_SPACE +\n                    this.getFontFamily();\n        },\n        _addTextLine: function (line, width) {\n            return this.textArr.push({text: line, width: width});\n        },\n        _getTextWidth: function (text) {\n            return dummyContext.measureText(text).width;\n        },\n        _setTextData: function () {\n            var lines = this.getText().split('\\n'),\n                fontSize = +this.getFontSize(),\n                textWidth = 0,\n                lineHeightPx = this.getLineHeight() * fontSize,\n                width = this.attrs.width,\n                height = this.attrs.height,\n                fixedWidth = width !== AUTO,\n                fixedHeight = height !== AUTO,\n                padding = this.getPadding(),\n                maxWidth = width - padding * 2,\n                maxHeightPx = height - padding * 2,\n                currentHeightPx = 0,\n                wrap = this.getWrap(),\n                shouldWrap = wrap !== NONE,\n                wrapAtWord = wrap !== CHAR && shouldWrap;\n\n            this.textArr = [];\n            dummyContext.save();\n            dummyContext.font = this._getContextFont();\n            for (var i = 0, max = lines.length; i < max; ++i) {\n                var line = lines[i],\n                    lineWidth = this._getTextWidth(line);\n                if (fixedWidth && lineWidth > maxWidth) {\n                    /*\n                     * if width is fixed and line does not fit entirely\n                     * break the line into multiple fitting lines\n                     */\n                    while (line.length > 0) {\n                        /*\n                         * use binary search to find the longest substring that\n                         * that would fit in the specified width\n                         */\n                        var low = 0, high = line.length,\n                            match = '', matchWidth = 0;\n                        while (low < high) {\n                            var mid = (low + high) >>> 1,\n                                substr = line.slice(0, mid + 1),\n                                substrWidth = this._getTextWidth(substr);\n                            if (substrWidth <= maxWidth) {\n                                low = mid + 1;\n                                match = substr;\n                                matchWidth = substrWidth;\n                            } else {\n                                high = mid;\n                            }\n                        }\n                        /*\n                         * 'low' is now the index of the substring end\n                         * 'match' is the substring\n                         * 'matchWidth' is the substring width in px\n                         */\n                        if (match) {\n                            // a fitting substring was found\n                            if (wrapAtWord) {\n                                // try to find a space or dash where wrapping could be done\n                                var wrapIndex = Math.max(match.lastIndexOf(SPACE),\n                                                          match.lastIndexOf(DASH)) + 1;\n                                if (wrapIndex > 0) {\n                                    // re-cut the substring found at the space/dash position\n                                    low = wrapIndex;\n                                    match = match.slice(0, low);\n                                    matchWidth = this._getTextWidth(match);\n                                }\n                            }\n                            this._addTextLine(match, matchWidth);\n                            textWidth = Math.max(textWidth, matchWidth);\n                            currentHeightPx += lineHeightPx;\n                            if (!shouldWrap ||\n                                (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx)) {\n                                /*\n                                 * stop wrapping if wrapping is disabled or if adding\n                                 * one more line would overflow the fixed height\n                                 */\n                                break;\n                            }\n                            line = line.slice(low);\n                            if (line.length > 0) {\n                                // Check if the remaining text would fit on one line\n                                lineWidth = this._getTextWidth(line);\n                                if (lineWidth <= maxWidth) {\n                                    // if it does, add the line and break out of the loop\n                                    this._addTextLine(line, lineWidth);\n                                    currentHeightPx += lineHeightPx;\n                                    textWidth = Math.max(textWidth, lineWidth);\n                                    break;\n                                }\n                            }\n                        } else {\n                            // not even one character could fit in the element, abort\n                            break;\n                        }\n                    }\n                } else {\n                    // element width is automatically adjusted to max line width\n                    this._addTextLine(line, lineWidth);\n                    currentHeightPx += lineHeightPx;\n                    textWidth = Math.max(textWidth, lineWidth);\n                }\n                // if element height is fixed, abort if adding one more line would overflow\n                if (fixedHeight && currentHeightPx + lineHeightPx > maxHeightPx) {\n                    break;\n                }\n            }\n            dummyContext.restore();\n            this.textHeight = fontSize;\n            this.textWidth = textWidth;\n        }\n    };\n    Konva.Util.extend(Konva.Text, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Text, 'fontFamily', 'Arial');\n\n    /**\n     * get/set font family\n     * @name fontFamily\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} fontFamily\n     * @returns {String}\n     * @example\n     * // get font family\n     * var fontFamily = text.fontFamily();\n     *\n     * // set font family\n     * text.fontFamily('Arial');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'fontSize', 12);\n\n    /**\n     * get/set font size in pixels\n     * @name fontSize\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {Number} fontSize\n     * @returns {Number}\n     * @example\n     * // get font size\n     * var fontSize = text.fontSize();\n     *\n     * // set font size to 22px\n     * text.fontSize(22);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'fontStyle', NORMAL);\n\n    /**\n     * set font style.  Can be 'normal', 'italic', or 'bold'.  'normal' is the default.\n     * @name fontStyle\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} fontStyle\n     * @returns {String}\n     * @example\n     * // get font style\n     * var fontStyle = text.fontStyle();\n     *\n     * // set font style\n     * text.fontStyle('bold');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'fontVariant', NORMAL);\n\n    /**\n     * set font variant.  Can be 'normal' or 'small-caps'.  'normal' is the default.\n     * @name fontVariant\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} fontVariant\n     * @returns {String}\n     * @example\n     * // get font variant\n     * var fontVariant = text.fontVariant();\n     *\n     * // set font variant\n     * text.fontVariant('small-caps');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'padding', 0);\n\n    /**\n     * set padding\n     * @name padding\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {Number} padding\n     * @returns {Number}\n     * @example\n     * // get padding\n     * var padding = text.padding();\n     *\n     * // set padding to 10 pixels\n     * text.padding(10);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'align', LEFT);\n\n    /**\n     * get/set horizontal align of text.  Can be 'left', 'center', or 'right'\n     * @name align\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} align\n     * @returns {String}\n     * @example\n     * // get text align\n     * var align = text.align();\n     *\n     * // center text\n     * text.align('center');\n     *\n     * // align text to right\n     * text.align('right');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'lineHeight', 1);\n\n    /**\n     * get/set line height.  The default is 1.\n     * @name lineHeight\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {Number} lineHeight\n     * @returns {Number}\n     * @example\n     * // get line height\n     * var lineHeight = text.lineHeight();\n     *\n     * // set the line height\n     * text.lineHeight(2);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Text, 'wrap', WORD);\n\n    /**\n     * get/set wrap.  Can be word, char, or none. Default is word.\n     * @name wrap\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} wrap\n     * @returns {String}\n     * @example\n     * // get wrap\n     * var wrap = text.wrap();\n     *\n     * // set wrap\n     * text.wrap('word');\n     */\n\n    Konva.Factory.addGetter(Konva.Text, 'text', EMPTY_STRING);\n    Konva.Factory.addOverloadedGetterSetter(Konva.Text, 'text');\n\n    /**\n     * get/set text\n     * @name getText\n     * @method\n     * @memberof Konva.Text.prototype\n     * @param {String} text\n     * @returns {String}\n     * @example\n     * // get text\n     * var text = text.text();\n     *\n     * // set text\n     * text.text('Hello world!');\n     */\n\n    Konva.Collection.mapMethods(Konva.Text);\n})();\n\n(function () {\n    'use strict';\n    /**\n     * Line constructor.&nbsp; Lines are defined by an array of points and\n     *  a tension\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Array} config.points\n     * @param {Number} [config.tension] Higher values will result in a more curvy line.  A value of 0 will result in no interpolation.\n     *   The default is 0\n     * @param {Boolean} [config.closed] defines whether or not the line shape is closed, creating a polygon or blob\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var line = new Konva.Line({\n     *   x: 100,\n     *   y: 50,\n     *   points: [73, 70, 340, 23, 450, 60, 500, 20],\n     *   stroke: 'red',\n     *   tension: 1\n     * });\n     */\n    Konva.Line = function (config) {\n        this.___init(config);\n    };\n\n    Konva.Line.prototype = {\n        ___init: function (config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Line';\n\n            this.on('pointsChange.konva tensionChange.konva closedChange.konva', function () {\n                this._clearCache('tensionPoints');\n            });\n\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function (context) {\n            var points = this.getPoints(),\n                length = points.length,\n                tension = this.getTension(),\n                closed = this.getClosed(),\n                tp, len, n;\n\n            if (!length) {\n                return;\n            }\n\n            context.beginPath();\n            context.moveTo(points[0], points[1]);\n\n            // tension\n            if (tension !== 0 && length > 4) {\n                tp = this.getTensionPoints();\n                len = tp.length;\n                n = closed ? 0 : 4;\n\n                if (!closed) {\n                    context.quadraticCurveTo(tp[0], tp[1], tp[2], tp[3]);\n                }\n\n                while (n < len - 2) {\n                    context.bezierCurveTo(tp[n++], tp[n++], tp[n++], tp[n++], tp[n++], tp[n++]);\n                }\n\n                if (!closed) {\n                    context.quadraticCurveTo(tp[len - 2], tp[len - 1], points[length - 2], points[length - 1]);\n                }\n            }\n            // no tension\n            else {\n                for (n = 2; n < length; n += 2) {\n                    context.lineTo(points[n], points[n + 1]);\n                }\n            }\n\n            // closed e.g. polygons and blobs\n            if (closed) {\n                context.closePath();\n                context.fillStrokeShape(this);\n            }\n            // open e.g. lines and splines\n            else {\n                context.strokeShape(this);\n            }\n        },\n        getTensionPoints: function () {\n            return this._getCache('tensionPoints', this._getTensionPoints);\n        },\n        _getTensionPoints: function () {\n            if (this.getClosed()) {\n                return this._getTensionPointsClosed();\n            } else {\n                return Konva.Util._expandPoints(this.getPoints(), this.getTension());\n            }\n        },\n        _getTensionPointsClosed: function () {\n            var p = this.getPoints(),\n                len = p.length,\n                tension = this.getTension(),\n                util = Konva.Util,\n                firstControlPoints = util._getControlPoints(\n                    p[len - 2],\n                    p[len - 1],\n                    p[0],\n                    p[1],\n                    p[2],\n                    p[3],\n                    tension\n                ),\n                lastControlPoints = util._getControlPoints(\n                    p[len - 4],\n                    p[len - 3],\n                    p[len - 2],\n                    p[len - 1],\n                    p[0],\n                    p[1],\n                    tension\n                ),\n                middle = Konva.Util._expandPoints(p, tension),\n                tp = [\n                    firstControlPoints[2],\n                    firstControlPoints[3]\n                ]\n                .concat(middle)\n                .concat([\n                    lastControlPoints[0],\n                    lastControlPoints[1],\n                    p[len - 2],\n                    p[len - 1],\n                    lastControlPoints[2],\n                    lastControlPoints[3],\n                    firstControlPoints[0],\n                    firstControlPoints[1],\n                    p[0],\n                    p[1]\n                ]);\n\n            return tp;\n        },\n        getWidth: function () {\n            return this.getSelfRect().width;\n        },\n        getHeight: function () {\n            return this.getSelfRect().height;\n        },\n        // overload size detection\n        getSelfRect: function () {\n            var points;\n            if (this.getTension() !== 0) {\n                points = this._getTensionPoints();\n            } else {\n                points = this.getPoints();\n            }\n            var minX = points[0];\n            var maxX = points[0];\n            var minY = points[1];\n            var maxY = points[1];\n            var x, y;\n            for (var i = 0; i < points.length / 2; i++) {\n                x = points[i * 2];\n                y = points[i * 2 + 1];\n                minX = Math.min(minX, x);\n                maxX = Math.max(maxX, x);\n                minY = Math.min(minY, y);\n                maxY = Math.max(maxY, y);\n            }\n            return {\n                x: Math.round(minX),\n                y: Math.round(minY),\n                width: Math.round(maxX - minX),\n                height: Math.round(maxY - minY)\n            };\n        }\n    };\n    Konva.Util.extend(Konva.Line, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Line, 'closed', false);\n\n    /**\n     * get/set closed flag.  The default is false\n     * @name closed\n     * @method\n     * @memberof Konva.Line.prototype\n     * @param {Boolean} closed\n     * @returns {Boolean}\n     * @example\n     * // get closed flag\n     * var closed = line.closed();\n     *\n     * // close the shape\n     * line.closed(true);\n     *\n     * // open the shape\n     * line.closed(false);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Line, 'tension', 0);\n\n    /**\n     * get/set tension\n     * @name tension\n     * @method\n     * @memberof Konva.Line.prototype\n     * @param {Number} Higher values will result in a more curvy line.  A value of 0 will result in no interpolation.\n     *   The default is 0\n     * @returns {Number}\n     * @example\n     * // get tension\n     * var tension = line.tension();\n     *\n     * // set tension\n     * line.tension(3);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Line, 'points', []);\n    /**\n     * get/set points array\n     * @name points\n     * @method\n     * @memberof Konva.Line.prototype\n     * @param {Array} points\n     * @returns {Array}\n     * @example\n     * // get points\n     * var points = line.points();\n     *\n     * // set points\n     * line.points([10, 20, 30, 40, 50, 60]);\n     *\n     * // push a new point\n     * line.points(line.points().concat([70, 80]));\n     */\n\n    Konva.Collection.mapMethods(Konva.Line);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Sprite constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {String} config.animation animation key\n     * @param {Object} config.animations animation map\n     * @param {Integer} [config.frameIndex] animation frame index\n     * @param {Image} config.image image object\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var imageObj = new Image();\n     * imageObj.onload = function() {\n     *   var sprite = new Konva.Sprite({\n     *     x: 200,\n     *     y: 100,\n     *     image: imageObj,\n     *     animation: 'standing',\n     *     animations: {\n     *       standing: [\n     *         // x, y, width, height (6 frames)\n     *         0, 0, 49, 109,\n     *         52, 0, 49, 109,\n     *         105, 0, 49, 109,\n     *         158, 0, 49, 109,\n     *         210, 0, 49, 109,\n     *         262, 0, 49, 109\n     *       ],\n     *       kicking: [\n     *         // x, y, width, height (6 frames)\n     *         0, 109, 45, 98,\n     *         45, 109, 45, 98,\n     *         95, 109, 63, 98,\n     *         156, 109, 70, 98,\n     *         229, 109, 60, 98,\n     *         287, 109, 41, 98\n     *       ]\n     *     },\n     *     frameRate: 7,\n     *     frameIndex: 0\n     *   });\n     * };\n     * imageObj.src = '/path/to/image.jpg'\n     */\n    Konva.Sprite = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Sprite.prototype = {\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Sprite';\n\n            this._updated = true;\n            var that = this;\n            this.anim = new Konva.Animation(function() {\n                // if we don't need to redraw layer we should return false\n                var updated = that._updated;\n                that._updated = false;\n                return updated;\n            });\n            this.on('animationChange.konva', function() {\n                // reset index when animation changes\n                this.frameIndex(0);\n            });\n            this.on('frameIndexChange.konva', function() {\n                this._updated = true;\n            });\n            // smooth change for frameRate\n            this.on('frameRateChange.konva', function() {\n                if (!this.anim.isRunning()) {\n                    return;\n                }\n                clearInterval(this.interval);\n                this._setInterval();\n            });\n\n            this.sceneFunc(this._sceneFunc);\n            this.hitFunc(this._hitFunc);\n        },\n        _sceneFunc: function(context) {\n            var anim = this.getAnimation(),\n                index = this.frameIndex(),\n                ix4 = index * 4,\n                set = this.getAnimations()[anim],\n                offsets = this.frameOffsets(),\n                x = set[ix4 + 0],\n                y = set[ix4 + 1],\n                width = set[ix4 + 2],\n                height = set[ix4 + 3],\n                image = this.getImage();\n\n            if (this.hasFill() || this.hasStroke()) {\n                context.beginPath();\n                context.rect(0, 0, width, height);\n                context.closePath();\n                context.fillStrokeShape(this);\n            }\n\n            if(image) {\n                if (offsets) {\n                    var offset = offsets[anim],\n                    ix2 = index * 2;\n                    context.drawImage(image, x, y, width, height, offset[ix2 + 0], offset[ix2 + 1], width, height);\n                } else {\n                    context.drawImage(image, x, y, width, height, 0, 0, width, height);\n                }\n            }\n        },\n        _hitFunc: function(context) {\n            var anim = this.getAnimation(),\n                index = this.frameIndex(),\n                ix4 = index * 4,\n                set = this.getAnimations()[anim],\n                offsets = this.frameOffsets(),\n                width = set[ix4 + 2],\n                height = set[ix4 + 3];\n\n            context.beginPath();\n            if (offsets) {\n                var offset = offsets[anim];\n                var ix2 = index * 2;\n                context.rect(offset[ix2 + 0], offset[ix2 + 1], width, height);\n            } else {\n                context.rect(0, 0, width, height);\n            }\n            context.closePath();\n            context.fillShape(this);\n        },\n        _useBufferCanvas: function() {\n            return (this.hasShadow() || this.getAbsoluteOpacity() !== 1) && this.hasStroke();\n        },\n        _setInterval: function() {\n            var that = this;\n            this.interval = setInterval(function() {\n                that._updateIndex();\n            }, 1000 / this.getFrameRate());\n        },\n        /**\n         * start sprite animation\n         * @method\n         * @memberof Konva.Sprite.prototype\n         */\n        start: function() {\n            var layer = this.getLayer();\n\n            /*\n             * animation object has no executable function because\n             *  the updates are done with a fixed FPS with the setInterval\n             *  below.  The anim object only needs the layer reference for\n             *  redraw\n             */\n            this.anim.setLayers(layer);\n            this._setInterval();\n            this.anim.start();\n        },\n        /**\n         * stop sprite animation\n         * @method\n         * @memberof Konva.Sprite.prototype\n         */\n        stop: function() {\n            this.anim.stop();\n            clearInterval(this.interval);\n        },\n        /**\n         * determine if animation of sprite is running or not.  returns true or false\n         * @method\n         * @memberof Konva.Animation.prototype\n         * @returns {Boolean}\n         */\n        isRunning: function() {\n            return this.anim.isRunning();\n        },\n        _updateIndex: function() {\n            var index = this.frameIndex(),\n                animation = this.getAnimation(),\n                animations = this.getAnimations(),\n                anim = animations[animation],\n                len = anim.length / 4;\n\n            if(index < len - 1) {\n                this.frameIndex(index + 1);\n            }\n            else {\n                this.frameIndex(0);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.Sprite, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'animation');\n\n    /**\n     * get/set animation key\n     * @name animation\n     * @method\n     * @memberof Konva.Sprite.prototype\n     * @param {String} anim animation key\n     * @returns {String}\n     * @example\n     * // get animation key\n     * var animation = sprite.animation();\n     *\n     * // set animation key\n     * sprite.animation('kicking');\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'animations');\n\n    /**\n     * get/set animations map\n     * @name animations\n     * @method\n     * @memberof Konva.Sprite.prototype\n     * @param {Object} animations\n     * @returns {Object}\n     * @example\n     * // get animations map\n     * var animations = sprite.animations();\n     *\n     * // set animations map\n     * sprite.animations({\n     *   standing: [\n     *     // x, y, width, height (6 frames)\n     *     0, 0, 49, 109,\n     *     52, 0, 49, 109,\n     *     105, 0, 49, 109,\n     *     158, 0, 49, 109,\n     *     210, 0, 49, 109,\n     *     262, 0, 49, 109\n     *   ],\n     *   kicking: [\n     *     // x, y, width, height (6 frames)\n     *     0, 109, 45, 98,\n     *     45, 109, 45, 98,\n     *     95, 109, 63, 98,\n     *     156, 109, 70, 98,\n     *     229, 109, 60, 98,\n     *     287, 109, 41, 98\n     *   ]\n     * });\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'frameOffsets');\n\n    /**\n    * get/set offsets map\n    * @name offsets\n    * @method\n    * @memberof Konva.Sprite.prototype\n    * @param {Object} offsets\n    * @returns {Object}\n    * @example\n    * // get offsets map\n    * var offsets = sprite.offsets();\n    *\n    * // set offsets map\n    * sprite.offsets({\n    *   standing: [\n    *     // x, y (6 frames)\n    *     0, 0,\n    *     0, 0,\n    *     5, 0,\n    *     0, 0,\n    *     0, 3,\n    *     2, 0\n    *   ],\n    *   kicking: [\n    *     // x, y (6 frames)\n    *     0, 5,\n    *     5, 0,\n    *     10, 0,\n    *     0, 0,\n    *     2, 1,\n    *     0, 0\n    *   ]\n    * });\n    */\n\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'image');\n\n    /**\n     * get/set image\n     * @name image\n     * @method\n     * @memberof Konva.Sprite.prototype\n     * @param {Image} image\n     * @returns {Image}\n     * @example\n     * // get image\n     * var image = sprite.image();\n     *\n     * // set image\n     * sprite.image(imageObj);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'frameIndex', 0);\n\n    /**\n     * set/set animation frame index\n     * @name frameIndex\n     * @method\n     * @memberof Konva.Sprite.prototype\n     * @param {Integer} frameIndex\n     * @returns {Integer}\n     * @example\n     * // get animation frame index\n     * var frameIndex = sprite.frameIndex();\n     *\n     * // set animation frame index\n     * sprite.frameIndex(3);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Sprite, 'frameRate', 17);\n\n    /**\n     * get/set frame rate in frames per second.  Increase this number to make the sprite\n     *  animation run faster, and decrease the number to make the sprite animation run slower\n     *  The default is 17 frames per second\n     * @name frameRate\n     * @method\n     * @memberof Konva.Sprite.prototype\n     * @param {Integer} frameRate\n     * @returns {Integer}\n     * @example\n     * // get frame rate\n     * var frameRate = sprite.frameRate();\n     *\n     * // set frame rate to 2 frames per second\n     * sprite.frameRate(2);\n     */\n\n    Konva.Factory.backCompat(Konva.Sprite, {\n        index: 'frameIndex',\n        getIndex: 'getFrameIndex',\n        setIndex: 'setFrameIndex'\n    });\n\n    Konva.Collection.mapMethods(Konva.Sprite);\n})();\n\n/*eslint-disable  no-shadow, max-len, max-depth */\n(function () {\n    'use strict';\n    /**\n     * Path constructor.\n     * @author Jason Follas\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {String} config.data SVG data string\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var path = new Konva.Path({\n     *   x: 240,\n     *   y: 40,\n     *   data: 'M12.582,9.551C3.251,16.237,0.921,29.021,7.08,38.564l-2.36,1.689l4.893,2.262l4.893,2.262l-0.568-5.36l-0.567-5.359l-2.365,1.694c-4.657-7.375-2.83-17.185,4.352-22.33c7.451-5.338,17.817-3.625,23.156,3.824c5.337,7.449,3.625,17.813-3.821,23.152l2.857,3.988c9.617-6.893,11.827-20.277,4.935-29.896C35.591,4.87,22.204,2.658,12.582,9.551z',\n     *   fill: 'green',\n     *   scale: 2\n     * });\n     */\n    Konva.Path = function (config) {\n        this.___init(config);\n    };\n\n    Konva.Path.prototype = {\n        ___init: function (config) {\n            this.dataArray = [];\n            var that = this;\n\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Path';\n\n            this.dataArray = Konva.Path.parsePathData(this.getData());\n            this.on('dataChange.konva', function () {\n                that.dataArray = Konva.Path.parsePathData(this.getData());\n            });\n\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var ca = this.dataArray;\n\n            // context position\n            context.beginPath();\n            for (var n = 0; n < ca.length; n++) {\n                var c = ca[n].command;\n                var p = ca[n].points;\n                switch (c) {\n                    case 'L':\n                        context.lineTo(p[0], p[1]);\n                        break;\n                    case 'M':\n                        context.moveTo(p[0], p[1]);\n                        break;\n                    case 'C':\n                        context.bezierCurveTo(p[0], p[1], p[2], p[3], p[4], p[5]);\n                        break;\n                    case 'Q':\n                        context.quadraticCurveTo(p[0], p[1], p[2], p[3]);\n                        break;\n                    case 'A':\n                        var cx = p[0], cy = p[1], rx = p[2], ry = p[3], theta = p[4], dTheta = p[5], psi = p[6], fs = p[7];\n\n                        var r = (rx > ry) ? rx : ry;\n                        var scaleX = (rx > ry) ? 1 : rx / ry;\n                        var scaleY = (rx > ry) ? ry / rx : 1;\n\n                        context.translate(cx, cy);\n                        context.rotate(psi);\n                        context.scale(scaleX, scaleY);\n                        context.arc(0, 0, r, theta, theta + dTheta, 1 - fs);\n                        context.scale(1 / scaleX, 1 / scaleY);\n                        context.rotate(-psi);\n                        context.translate(-cx, -cy);\n\n                        break;\n                    case 'z':\n                        context.closePath();\n                        break;\n                }\n            }\n\n            context.fillStrokeShape(this);\n        },\n        getSelfRect: function() {\n            var points = [];\n            this.dataArray.forEach(function(data) {\n                points = points.concat(data.points);\n            });\n            var minX = points[0];\n            var maxX = points[0];\n            var minY = points[1];\n            var maxY = points[1];\n            var x, y;\n            for (var i = 0; i < points.length / 2; i++) {\n                x = points[i * 2]; y = points[i * 2 + 1];\n                minX = Math.min(minX, x);\n                maxX = Math.max(maxX, x);\n                minY = Math.min(minY, y);\n                maxY = Math.max(maxY, y);\n            }\n            return {\n                x: Math.round(minX),\n                y: Math.round(minY),\n                width: Math.round(maxX - minX),\n                height: Math.round(maxY - minY)\n            };\n        }\n    };\n    Konva.Util.extend(Konva.Path, Konva.Shape);\n\n    Konva.Path.getLineLength = function(x1, y1, x2, y2) {\n        return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    };\n    Konva.Path.getPointOnLine = function(dist, P1x, P1y, P2x, P2y, fromX, fromY) {\n        if(fromX === undefined) {\n            fromX = P1x;\n        }\n        if(fromY === undefined) {\n            fromY = P1y;\n        }\n\n        var m = (P2y - P1y) / ((P2x - P1x) + 0.00000001);\n        var run = Math.sqrt(dist * dist / (1 + m * m));\n        if(P2x < P1x) {\n            run *= -1;\n        }\n        var rise = m * run;\n        var pt;\n\n        if (P2x === P1x) { // vertical line\n            pt = {\n                x: fromX,\n                y: fromY + rise\n            };\n        } else if((fromY - P1y) / ((fromX - P1x) + 0.00000001) === m) {\n            pt = {\n                x: fromX + run,\n                y: fromY + rise\n            };\n        }\n        else {\n            var ix, iy;\n\n            var len = this.getLineLength(P1x, P1y, P2x, P2y);\n            if(len < 0.00000001) {\n                return undefined;\n            }\n            var u = (((fromX - P1x) * (P2x - P1x)) + ((fromY - P1y) * (P2y - P1y)));\n            u = u / (len * len);\n            ix = P1x + u * (P2x - P1x);\n            iy = P1y + u * (P2y - P1y);\n\n            var pRise = this.getLineLength(fromX, fromY, ix, iy);\n            var pRun = Math.sqrt(dist * dist - pRise * pRise);\n            run = Math.sqrt(pRun * pRun / (1 + m * m));\n            if(P2x < P1x) {\n                run *= -1;\n            }\n            rise = m * run;\n            pt = {\n                x: ix + run,\n                y: iy + rise\n            };\n        }\n\n        return pt;\n    };\n\n    Konva.Path.getPointOnCubicBezier = function(pct, P1x, P1y, P2x, P2y, P3x, P3y, P4x, P4y) {\n        function CB1(t) {\n            return t * t * t;\n        }\n        function CB2(t) {\n            return 3 * t * t * (1 - t);\n        }\n        function CB3(t) {\n            return 3 * t * (1 - t) * (1 - t);\n        }\n        function CB4(t) {\n            return (1 - t) * (1 - t) * (1 - t);\n        }\n        var x = P4x * CB1(pct) + P3x * CB2(pct) + P2x * CB3(pct) + P1x * CB4(pct);\n        var y = P4y * CB1(pct) + P3y * CB2(pct) + P2y * CB3(pct) + P1y * CB4(pct);\n\n        return {\n            x: x,\n            y: y\n        };\n    };\n    Konva.Path.getPointOnQuadraticBezier = function(pct, P1x, P1y, P2x, P2y, P3x, P3y) {\n        function QB1(t) {\n            return t * t;\n        }\n        function QB2(t) {\n            return 2 * t * (1 - t);\n        }\n        function QB3(t) {\n            return (1 - t) * (1 - t);\n        }\n        var x = P3x * QB1(pct) + P2x * QB2(pct) + P1x * QB3(pct);\n        var y = P3y * QB1(pct) + P2y * QB2(pct) + P1y * QB3(pct);\n\n        return {\n            x: x,\n            y: y\n        };\n    };\n    Konva.Path.getPointOnEllipticalArc = function(cx, cy, rx, ry, theta, psi) {\n        var cosPsi = Math.cos(psi), sinPsi = Math.sin(psi);\n        var pt = {\n            x: rx * Math.cos(theta),\n            y: ry * Math.sin(theta)\n        };\n        return {\n            x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n            y: cy + (pt.x * sinPsi + pt.y * cosPsi)\n        };\n    };\n    /*\n     * get parsed data array from the data\n     *  string.  V, v, H, h, and l data are converted to\n     *  L data for the purpose of high performance Path\n     *  rendering\n     */\n    Konva.Path.parsePathData = function(data) {\n        // Path Data Segment must begin with a moveTo\n        //m (x y)+  Relative moveTo (subsequent points are treated as lineTo)\n        //M (x y)+  Absolute moveTo (subsequent points are treated as lineTo)\n        //l (x y)+  Relative lineTo\n        //L (x y)+  Absolute LineTo\n        //h (x)+    Relative horizontal lineTo\n        //H (x)+    Absolute horizontal lineTo\n        //v (y)+    Relative vertical lineTo\n        //V (y)+    Absolute vertical lineTo\n        //z (closepath)\n        //Z (closepath)\n        //c (x1 y1 x2 y2 x y)+ Relative Bezier curve\n        //C (x1 y1 x2 y2 x y)+ Absolute Bezier curve\n        //q (x1 y1 x y)+       Relative Quadratic Bezier\n        //Q (x1 y1 x y)+       Absolute Quadratic Bezier\n        //t (x y)+    Shorthand/Smooth Relative Quadratic Bezier\n        //T (x y)+    Shorthand/Smooth Absolute Quadratic Bezier\n        //s (x2 y2 x y)+       Shorthand/Smooth Relative Bezier curve\n        //S (x2 y2 x y)+       Shorthand/Smooth Absolute Bezier curve\n        //a (rx ry x-axis-rotation large-arc-flag sweep-flag x y)+     Relative Elliptical Arc\n        //A (rx ry x-axis-rotation large-arc-flag sweep-flag x y)+  Absolute Elliptical Arc\n\n        // return early if data is not defined\n        if(!data) {\n            return [];\n        }\n\n        // command string\n        var cs = data;\n\n        // command chars\n        var cc = ['m', 'M', 'l', 'L', 'v', 'V', 'h', 'H', 'z', 'Z', 'c', 'C', 'q', 'Q', 't', 'T', 's', 'S', 'a', 'A'];\n        // convert white spaces to commas\n        cs = cs.replace(new RegExp(' ', 'g'), ',');\n        // create pipes so that we can split the data\n        for(var n = 0; n < cc.length; n++) {\n            cs = cs.replace(new RegExp(cc[n], 'g'), '|' + cc[n]);\n        }\n        // create array\n        var arr = cs.split('|');\n        var ca = [];\n        // init context point\n        var cpx = 0;\n        var cpy = 0;\n        for( n = 1; n < arr.length; n++) {\n            var str = arr[n];\n            var c = str.charAt(0);\n            str = str.slice(1);\n            // remove ,- for consistency\n            str = str.replace(new RegExp(',-', 'g'), '-');\n            // add commas so that it's easy to split\n            str = str.replace(new RegExp('-', 'g'), ',-');\n            str = str.replace(new RegExp('e,-', 'g'), 'e-');\n            var p = str.split(',');\n            if(p.length > 0 && p[0] === '') {\n                p.shift();\n            }\n            // convert strings to floats\n            for(var i = 0; i < p.length; i++) {\n                p[i] = parseFloat(p[i]);\n            }\n            while(p.length > 0) {\n                if(isNaN(p[0])) {// case for a trailing comma before next command\n                    break;\n                }\n\n                var cmd = null;\n                var points = [];\n                var startX = cpx, startY = cpy;\n                // Move var from within the switch to up here (jshint)\n                var prevCmd, ctlPtx, ctlPty;     // Ss, Tt\n                var rx, ry, psi, fa, fs, x1, y1; // Aa\n\n\n                // convert l, H, h, V, and v to L\n                switch (c) {\n\n                    // Note: Keep the lineTo's above the moveTo's in this switch\n                    case 'l':\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'L':\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n\n                    // Note: lineTo handlers need to be above this point\n                    case 'm':\n                        var dx = p.shift();\n                        var dy = p.shift();\n                        cpx += dx;\n                        cpy += dy;\n                        cmd = 'M';\n                        // After closing the path move the current position\n                        // to the the first point of the path (if any).\n                        if(ca.length > 2 && ca[ca.length - 1].command === 'z'){\n                            for(var idx = ca.length - 2; idx >= 0; idx--){\n                                if(ca[idx].command === 'M'){\n                                    cpx = ca[idx].points[0] + dx;\n                                    cpy = ca[idx].points[1] + dy;\n                                    break;\n                                }\n                            }\n                        }\n                        points.push(cpx, cpy);\n                        c = 'l';\n                        // subsequent points are treated as relative lineTo\n                        break;\n                    case 'M':\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'M';\n                        points.push(cpx, cpy);\n                        c = 'L';\n                        // subsequent points are treated as absolute lineTo\n                        break;\n\n                    case 'h':\n                        cpx += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'H':\n                        cpx = p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'v':\n                        cpy += p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'V':\n                        cpy = p.shift();\n                        cmd = 'L';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'C':\n                        points.push(p.shift(), p.shift(), p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n                    case 'c':\n                        points.push(cpx + p.shift(), cpy + p.shift(), cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'S':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if(prevCmd.command === 'C') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[2]);\n                            ctlPty = cpy + (cpy - prevCmd.points[3]);\n                        }\n                        points.push(ctlPtx, ctlPty, p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 's':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if(prevCmd.command === 'C') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[2]);\n                            ctlPty = cpy + (cpy - prevCmd.points[3]);\n                        }\n                        points.push(ctlPtx, ctlPty, cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'C';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'Q':\n                        points.push(p.shift(), p.shift());\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        points.push(cpx, cpy);\n                        break;\n                    case 'q':\n                        points.push(cpx + p.shift(), cpy + p.shift());\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'Q';\n                        points.push(cpx, cpy);\n                        break;\n                    case 'T':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if(prevCmd.command === 'Q') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[0]);\n                            ctlPty = cpy + (cpy - prevCmd.points[1]);\n                        }\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'Q';\n                        points.push(ctlPtx, ctlPty, cpx, cpy);\n                        break;\n                    case 't':\n                        ctlPtx = cpx;\n                        ctlPty = cpy;\n                        prevCmd = ca[ca.length - 1];\n                        if(prevCmd.command === 'Q') {\n                            ctlPtx = cpx + (cpx - prevCmd.points[0]);\n                            ctlPty = cpy + (cpy - prevCmd.points[1]);\n                        }\n                        cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'Q';\n                        points.push(ctlPtx, ctlPty, cpx, cpy);\n                        break;\n                    case 'A':\n                        rx = p.shift();\n                        ry = p.shift();\n                        psi = p.shift();\n                        fa = p.shift();\n                        fs = p.shift();\n                        x1 = cpx;\n                        y1 = cpy;\n                        cpx = p.shift();\n                        cpy = p.shift();\n                        cmd = 'A';\n                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);\n                        break;\n                    case 'a':\n                        rx = p.shift();\n                        ry = p.shift();\n                        psi = p.shift();\n                        fa = p.shift();\n                        fs = p.shift();\n                        x1 = cpx;\n                        y1 = cpy; cpx += p.shift();\n                        cpy += p.shift();\n                        cmd = 'A';\n                        points = this.convertEndpointToCenterParameterization(x1, y1, cpx, cpy, fa, fs, rx, ry, psi);\n                        break;\n                }\n\n                ca.push({\n                    command: cmd || c,\n                    points: points,\n                    start: {\n                        x: startX,\n                        y: startY\n                    },\n                    pathLength: this.calcLength(startX, startY, cmd || c, points)\n                });\n            }\n\n            if(c === 'z' || c === 'Z') {\n                ca.push({\n                    command: 'z',\n                    points: [],\n                    start: undefined,\n                    pathLength: 0\n                });\n            }\n        }\n\n        return ca;\n    };\n    Konva.Path.calcLength = function(x, y, cmd, points) {\n        var len, p1, p2, t;\n        var path = Konva.Path;\n\n        switch (cmd) {\n            case 'L':\n                return path.getLineLength(x, y, points[0], points[1]);\n            case 'C':\n                // Approximates by breaking curve into 100 line segments\n                len = 0.0;\n                p1 = path.getPointOnCubicBezier(0, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n                for( t = 0.01; t <= 1; t += 0.01) {\n                    p2 = path.getPointOnCubicBezier(t, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n                    len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                    p1 = p2;\n                }\n                return len;\n            case 'Q':\n                // Approximates by breaking curve into 100 line segments\n                len = 0.0;\n                p1 = path.getPointOnQuadraticBezier(0, x, y, points[0], points[1], points[2], points[3]);\n                for( t = 0.01; t <= 1; t += 0.01) {\n                    p2 = path.getPointOnQuadraticBezier(t, x, y, points[0], points[1], points[2], points[3]);\n                    len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                    p1 = p2;\n                }\n                return len;\n            case 'A':\n                // Approximates by breaking curve into line segments\n                len = 0.0;\n                var start = points[4];\n                // 4 = theta\n                var dTheta = points[5];\n                // 5 = dTheta\n                var end = points[4] + dTheta;\n                var inc = Math.PI / 180.0;\n                // 1 degree resolution\n                if(Math.abs(start - end) < inc) {\n                    inc = Math.abs(start - end);\n                }\n                // Note: for purpose of calculating arc length, not going to worry about rotating X-axis by angle psi\n                p1 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);\n                if(dTheta < 0) {// clockwise\n                    for( t = start - inc; t > end; t -= inc) {\n                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                        p1 = p2;\n                    }\n                }\n                else {// counter-clockwise\n                    for( t = start + inc; t < end; t += inc) {\n                        p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n                        len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n                        p1 = p2;\n                    }\n                }\n                p2 = path.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);\n                len += path.getLineLength(p1.x, p1.y, p2.x, p2.y);\n\n                return len;\n        }\n\n        return 0;\n    };\n    Konva.Path.convertEndpointToCenterParameterization = function(x1, y1, x2, y2, fa, fs, rx, ry, psiDeg) {\n        // Derived from: http://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n        var psi = psiDeg * (Math.PI / 180.0);\n        var xp = Math.cos(psi) * (x1 - x2) / 2.0 + Math.sin(psi) * (y1 - y2) / 2.0;\n        var yp = -1 * Math.sin(psi) * (x1 - x2) / 2.0 + Math.cos(psi) * (y1 - y2) / 2.0;\n\n        var lambda = (xp * xp) / (rx * rx) + (yp * yp) / (ry * ry);\n\n        if(lambda > 1) {\n            rx *= Math.sqrt(lambda);\n            ry *= Math.sqrt(lambda);\n        }\n\n        var f = Math.sqrt((((rx * rx) * (ry * ry)) - ((rx * rx) * (yp * yp)) - ((ry * ry) * (xp * xp))) / ((rx * rx) * (yp * yp) + (ry * ry) * (xp * xp)));\n\n        if(fa === fs) {\n            f *= -1;\n        }\n        if(isNaN(f)) {\n            f = 0;\n        }\n\n        var cxp = f * rx * yp / ry;\n        var cyp = f * -ry * xp / rx;\n\n        var cx = (x1 + x2) / 2.0 + Math.cos(psi) * cxp - Math.sin(psi) * cyp;\n        var cy = (y1 + y2) / 2.0 + Math.sin(psi) * cxp + Math.cos(psi) * cyp;\n\n        var vMag = function(v) {\n            return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n        };\n        var vRatio = function(u, v) {\n            return (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v));\n        };\n        var vAngle = function(u, v) {\n            return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));\n        };\n        var theta = vAngle([1, 0], [(xp - cxp) / rx, (yp - cyp) / ry]);\n        var u = [(xp - cxp) / rx, (yp - cyp) / ry];\n        var v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];\n        var dTheta = vAngle(u, v);\n\n        if(vRatio(u, v) <= -1) {\n            dTheta = Math.PI;\n        }\n        if(vRatio(u, v) >= 1) {\n            dTheta = 0;\n        }\n        if(fs === 0 && dTheta > 0) {\n            dTheta = dTheta - 2 * Math.PI;\n        }\n        if(fs === 1 && dTheta < 0) {\n            dTheta = dTheta + 2 * Math.PI;\n        }\n        return [cx, cy, rx, ry, theta, dTheta, psi, fs];\n    };\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Path, 'data');\n\n    /**\n     * set SVG path data string.  This method\n     *  also automatically parses the data string\n     *  into a data array.  Currently supported SVG data:\n     *  M, m, L, l, H, h, V, v, Q, q, T, t, C, c, S, s, A, a, Z, z\n     * @name setData\n     * @method\n     * @memberof Konva.Path.prototype\n     * @param {String} SVG path command string\n     */\n\n    /**\n     * get SVG path data string\n     * @name getData\n     * @method\n     * @memberof Konva.Path.prototype\n     */\n\n    Konva.Collection.mapMethods(Konva.Path);\n})();\n\n(function() {\n    'use strict';\n    var EMPTY_STRING = '',\n        //CALIBRI = 'Calibri',\n        NORMAL = 'normal';\n\n    /**\n     * Path constructor.\n     * @author Jason Follas\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {String} [config.fontFamily] default is Calibri\n     * @param {Number} [config.fontSize] default is 12\n     * @param {String} [config.fontStyle] can be normal, bold, or italic.  Default is normal\n     * @param {String} [config.fontVariant] can be normal or small-caps.  Default is normal\n     * @param {String} config.text\n     * @param {String} config.data SVG data string\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var textpath = new Konva.TextPath({\n     *   x: 100,\n     *   y: 50,\n     *   fill: '#333',\n     *   fontSize: '24',\n     *   fontFamily: 'Arial',\n     *   text: 'All the world\\'s a stage, and all the men and women merely players.',\n     *   data: 'M10,10 C0,0 10,150 100,100 S300,150 400,50'\n     * });\n     */\n    Konva.TextPath = function(config) {\n        this.___init(config);\n    };\n\n    function _fillFunc(context) {\n        context.fillText(this.partialText, 0, 0);\n    }\n    function _strokeFunc(context) {\n        context.strokeText(this.partialText, 0, 0);\n    }\n\n    Konva.TextPath.prototype = {\n        ___init: function(config) {\n            var that = this;\n            this.dummyCanvas = Konva.Util.createCanvasElement();\n            this.dataArray = [];\n\n            // call super constructor\n            Konva.Shape.call(this, config);\n\n            // overrides\n            // TODO: shouldn't this be on the prototype?\n            this._fillFunc = _fillFunc;\n            this._strokeFunc = _strokeFunc;\n            this._fillFuncHit = _fillFunc;\n            this._strokeFuncHit = _strokeFunc;\n\n            this.className = 'TextPath';\n\n            this.dataArray = Konva.Path.parsePathData(this.attrs.data);\n            this.on('dataChange.konva', function() {\n                that.dataArray = Konva.Path.parsePathData(this.attrs.data);\n                that._setTextData();\n            });\n\n            // update text data for certain attr changes\n            this.on('textChange.konva textStroke.konva textStrokeWidth.konva', that._setTextData);\n            that._setTextData();\n            this.sceneFunc(this._sceneFunc);\n            this.hitFunc(this._hitFunc);\n        },\n        _sceneFunc: function(context) {\n            context.setAttr('font', this._getContextFont());\n            context.setAttr('textBaseline', 'middle');\n            context.setAttr('textAlign', 'left');\n            context.save();\n\n            var glyphInfo = this.glyphInfo;\n            for(var i = 0; i < glyphInfo.length; i++) {\n                context.save();\n\n                var p0 = glyphInfo[i].p0;\n\n                context.translate(p0.x, p0.y);\n                context.rotate(glyphInfo[i].rotation);\n                this.partialText = glyphInfo[i].text;\n\n                context.fillStrokeShape(this);\n                context.restore();\n\n                //// To assist with debugging visually, uncomment following\n                // context.beginPath();\n                // if (i % 2)\n                // context.strokeStyle = 'cyan';\n                // else\n                // context.strokeStyle = 'green';\n                // var p1 = glyphInfo[i].p1;\n                // context.moveTo(p0.x, p0.y);\n                // context.lineTo(p1.x, p1.y);\n                // context.stroke();\n            }\n            context.restore();\n        },\n        _hitFunc: function(context) {\n          context.beginPath();\n\n          var glyphInfo = this.glyphInfo;\n          if (glyphInfo.length >= 1) {\n            var p0 = glyphInfo[0].p0;\n            context.moveTo(p0.x, p0.y);\n          }\n          for(var i = 0; i < glyphInfo.length; i++) {\n              var p1 = glyphInfo[i].p1;\n              context.lineTo(p1.x, p1.y);\n          }\n          context.setAttr('lineWidth', this.getFontSize());\n          context.setAttr('strokeStyle', this.colorKey);\n          context.stroke();\n        },\n        /**\n         * get text width in pixels\n         * @method\n         * @memberof Konva.TextPath.prototype\n         */\n        getTextWidth: function() {\n            return this.textWidth;\n        },\n        /**\n         * get text height in pixels\n         * @method\n         * @memberof Konva.TextPath.prototype\n         */\n        getTextHeight: function() {\n            return this.textHeight;\n        },\n        /**\n         * set text\n         * @method\n         * @memberof Konva.TextPath.prototype\n         * @param {String} text\n         */\n        setText: function(text) {\n            Konva.Text.prototype.setText.call(this, text);\n        },\n        _getTextSize: function(text) {\n            var dummyCanvas = this.dummyCanvas;\n            var _context = dummyCanvas.getContext('2d');\n\n            _context.save();\n\n            _context.font = this._getContextFont();\n            var metrics = _context.measureText(text);\n\n            _context.restore();\n\n            return {\n                width: metrics.width,\n                height: parseInt(this.attrs.fontSize, 10)\n            };\n        },\n        _setTextData: function() {\n\n            var that = this;\n            var size = this._getTextSize(this.attrs.text);\n            this.textWidth = size.width;\n            this.textHeight = size.height;\n\n            this.glyphInfo = [];\n\n            var charArr = this.getText().split('');\n\n            var p0, p1, pathCmd;\n\n            var pIndex = -1;\n            var currentT = 0;\n\n            var getNextPathSegment = function() {\n                currentT = 0;\n                var pathData = that.dataArray;\n\n                for(var j = pIndex + 1; j < pathData.length; j++) {\n                    if(pathData[j].pathLength > 0) {\n                        pIndex = j;\n\n                        return pathData[j];\n                    }\n                    else if(pathData[j].command === 'M') {\n                        p0 = {\n                            x: pathData[j].points[0],\n                            y: pathData[j].points[1]\n                        };\n                    }\n                }\n\n                return {};\n            };\n            var findSegmentToFitCharacter = function(c) {\n\n                var glyphWidth = that._getTextSize(c).width;\n\n                var currLen = 0;\n                var attempts = 0;\n\n                p1 = undefined;\n                while(Math.abs(glyphWidth - currLen) / glyphWidth > 0.01 && attempts < 25) {\n                    attempts++;\n                    var cumulativePathLength = currLen;\n                    while(pathCmd === undefined) {\n                        pathCmd = getNextPathSegment();\n\n                        if(pathCmd && cumulativePathLength + pathCmd.pathLength < glyphWidth) {\n                            cumulativePathLength += pathCmd.pathLength;\n                            pathCmd = undefined;\n                        }\n                    }\n\n                    if(pathCmd === {} || p0 === undefined) {\n                        return undefined;\n                    }\n\n                    var needNewSegment = false;\n\n                    switch (pathCmd.command) {\n                        case 'L':\n                            if(Konva.Path.getLineLength(p0.x, p0.y, pathCmd.points[0], pathCmd.points[1]) > glyphWidth) {\n                                p1 = Konva.Path.getPointOnLine(glyphWidth, p0.x, p0.y, pathCmd.points[0], pathCmd.points[1], p0.x, p0.y);\n                            }\n                            else {\n                                pathCmd = undefined;\n                            }\n                            break;\n                        case 'A':\n\n                            var start = pathCmd.points[4];\n                            // 4 = theta\n                            var dTheta = pathCmd.points[5];\n                            // 5 = dTheta\n                            var end = pathCmd.points[4] + dTheta;\n\n                            if(currentT === 0){\n                                currentT = start + 0.00000001;\n                            }\n                            // Just in case start is 0\n                            else if(glyphWidth > currLen) {\n                                currentT += (Math.PI / 180.0) * dTheta / Math.abs(dTheta);\n                            }\n                            else {\n                                currentT -= Math.PI / 360.0 * dTheta / Math.abs(dTheta);\n                            }\n\n                            // Credit for bug fix: @therth https://github.com/ericdrowell/KonvaJS/issues/249\n                            // Old code failed to render text along arc of this path: \"M 50 50 a 150 50 0 0 1 250 50 l 50 0\"\n                            if(dTheta < 0 && currentT < end || dTheta >= 0 && currentT > end) {\n                                currentT = end;\n                                needNewSegment = true;\n                            }\n                            p1 = Konva.Path.getPointOnEllipticalArc(pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3], currentT, pathCmd.points[6]);\n                            break;\n                        case 'C':\n                            if(currentT === 0) {\n                                if(glyphWidth > pathCmd.pathLength) {\n                                    currentT = 0.00000001;\n                                }\n                                else {\n                                    currentT = glyphWidth / pathCmd.pathLength;\n                                }\n                            }\n                            else if(glyphWidth > currLen) {\n                                currentT += (glyphWidth - currLen) / pathCmd.pathLength;\n                            }\n                            else {\n                                currentT -= (currLen - glyphWidth) / pathCmd.pathLength;\n                            }\n\n                            if(currentT > 1.0) {\n                                currentT = 1.0;\n                                needNewSegment = true;\n                            }\n                            p1 = Konva.Path.getPointOnCubicBezier(currentT, pathCmd.start.x, pathCmd.start.y, pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3], pathCmd.points[4], pathCmd.points[5]);\n                            break;\n                        case 'Q':\n                            if(currentT === 0) {\n                                currentT = glyphWidth / pathCmd.pathLength;\n                            }\n                            else if(glyphWidth > currLen) {\n                                currentT += (glyphWidth - currLen) / pathCmd.pathLength;\n                            }\n                            else {\n                                currentT -= (currLen - glyphWidth) / pathCmd.pathLength;\n                            }\n\n                            if(currentT > 1.0) {\n                                currentT = 1.0;\n                                needNewSegment = true;\n                            }\n                            p1 = Konva.Path.getPointOnQuadraticBezier(currentT, pathCmd.start.x, pathCmd.start.y, pathCmd.points[0], pathCmd.points[1], pathCmd.points[2], pathCmd.points[3]);\n                            break;\n\n                    }\n\n                    if(p1 !== undefined) {\n                        currLen = Konva.Path.getLineLength(p0.x, p0.y, p1.x, p1.y);\n                    }\n\n                    if(needNewSegment) {\n                        needNewSegment = false;\n                        pathCmd = undefined;\n                    }\n                }\n            };\n            for(var i = 0; i < charArr.length; i++) {\n\n                // Find p1 such that line segment between p0 and p1 is approx. width of glyph\n                findSegmentToFitCharacter(charArr[i]);\n\n                if(p0 === undefined || p1 === undefined) {\n                    break;\n                }\n\n                var width = Konva.Path.getLineLength(p0.x, p0.y, p1.x, p1.y);\n\n                // Note: Since glyphs are rendered one at a time, any kerning pair data built into the font will not be used.\n                // Can foresee having a rough pair table built in that the developer can override as needed.\n\n                var kern = 0;\n                // placeholder for future implementation\n\n                var midpoint = Konva.Path.getPointOnLine(kern + width / 2.0, p0.x, p0.y, p1.x, p1.y);\n\n                var rotation = Math.atan2((p1.y - p0.y), (p1.x - p0.x));\n                this.glyphInfo.push({\n                    transposeX: midpoint.x,\n                    transposeY: midpoint.y,\n                    text: charArr[i],\n                    rotation: rotation,\n                    p0: p0,\n                    p1: p1\n                });\n                p0 = p1;\n            }\n        },\n        getSelfRect: function() {\n            var points = [];\n            var fontSize = this.fontSize();\n\n            this.glyphInfo.forEach(function(info) {\n                points.push(info.p0.x);\n                points.push(info.p0.y);\n                points.push(info.p1.x);\n                points.push(info.p1.y);\n            });\n            var minX = points[0];\n            var maxX = points[0];\n            var minY = points[0];\n            var maxY = points[0];\n            var x, y;\n            for (var i = 0; i < points.length / 2; i++) {\n                x = points[i * 2]; y = points[i * 2 + 1];\n                minX = Math.min(minX, x);\n                maxX = Math.max(maxX, x);\n                minY = Math.min(minY, y);\n                maxY = Math.max(maxY, y);\n            }\n            return {\n                x: Math.round(minX) - fontSize,\n                y: Math.round(minY) - fontSize,\n                width: Math.round(maxX - minX) + fontSize * 2,\n                height: Math.round(maxY - minY) + fontSize * 2\n            };\n        }\n    };\n\n    // map TextPath methods to Text\n    Konva.TextPath.prototype._getContextFont = Konva.Text.prototype._getContextFont;\n\n    Konva.Util.extend(Konva.TextPath, Konva.Shape);\n\n    // add setters and getters\n    Konva.Factory.addGetterSetter(Konva.TextPath, 'fontFamily', 'Arial');\n\n    /**\n     * set font family\n     * @name setFontFamily\n     * @method\n     * @memberof Konva.TextPath.prototype\n     * @param {String} fontFamily\n     */\n\n     /**\n     * get font family\n     * @name getFontFamily\n     * @method\n     * @memberof Konva.TextPath.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.TextPath, 'fontSize', 12);\n\n    /**\n     * set font size\n     * @name setFontSize\n     * @method\n     * @memberof Konva.TextPath.prototype\n     * @param {int} fontSize\n     */\n\n     /**\n     * get font size\n     * @name getFontSize\n     * @method\n     * @memberof Konva.TextPath.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.TextPath, 'fontStyle', NORMAL);\n\n    /**\n     * set font style.  Can be 'normal', 'italic', or 'bold'.  'normal' is the default.\n     * @name setFontStyle\n     * @method\n     * @memberof Konva.TextPath.prototype\n     * @param {String} fontStyle\n     */\n\n     /**\n     * get font style\n     * @name getFontStyle\n     * @method\n     * @memberof Konva.TextPath.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.TextPath, 'fontVariant', NORMAL);\n\n    /**\n     * set font variant.  Can be 'normal' or 'small-caps'.  'normal' is the default.\n     * @name setFontVariant\n     * @method\n     * @memberof Konva.TextPath.prototype\n     * @param {String} fontVariant\n     */\n\n    /**\n     * @get font variant\n     * @name getFontVariant\n     * @method\n     * @memberof Konva.TextPath.prototype\n     */\n\n    Konva.Factory.addGetter(Konva.TextPath, 'text', EMPTY_STRING);\n\n    /**\n     * get text\n     * @name getText\n     * @method\n     * @memberof Konva.TextPath.prototype\n     */\n\n    Konva.Collection.mapMethods(Konva.TextPath);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * RegularPolygon constructor.&nbsp; Examples include triangles, squares, pentagons, hexagons, etc.\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Number} config.sides\n     * @param {Number} config.radius\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var hexagon = new Konva.RegularPolygon({\n     *   x: 100,\n     *   y: 200,\n     *   sides: 6,\n     *   radius: 70,\n     *   fill: 'red',\n     *   stroke: 'black',\n     *   strokeWidth: 4\n     * });\n     */\n    Konva.RegularPolygon = function(config) {\n        this.___init(config);\n    };\n\n    Konva.RegularPolygon.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'RegularPolygon';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var sides = this.attrs.sides,\n                radius = this.attrs.radius,\n                n, x, y;\n\n            context.beginPath();\n            context.moveTo(0, 0 - radius);\n\n            for(n = 1; n < sides; n++) {\n                x = radius * Math.sin(n * 2 * Math.PI / sides);\n                y = -1 * radius * Math.cos(n * 2 * Math.PI / sides);\n                context.lineTo(x, y);\n            }\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        getWidth: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.radius() !== width / 2) {\n                this.setRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.radius() !== height / 2) {\n                this.setRadius(height / 2);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.RegularPolygon, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.RegularPolygon, 'radius', 0);\n\n    /**\n     * set radius\n     * @name setRadius\n     * @method\n     * @memberof Konva.RegularPolygon.prototype\n     * @param {Number} radius\n     */\n\n     /**\n     * get radius\n     * @name getRadius\n     * @method\n     * @memberof Konva.RegularPolygon.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.RegularPolygon, 'sides', 0);\n\n    /**\n     * set number of sides\n     * @name setSides\n     * @method\n     * @memberof Konva.RegularPolygon.prototype\n     * @param {int} sides\n     */\n\n    /**\n     * get number of sides\n     * @name getSides\n     * @method\n     * @memberof Konva.RegularPolygon.prototype\n     */\n\n    Konva.Collection.mapMethods(Konva.RegularPolygon);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Star constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Integer} config.numPoints\n     * @param {Number} config.innerRadius\n     * @param {Number} config.outerRadius\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var star = new Konva.Star({\n     *   x: 100,\n     *   y: 200,\n     *   numPoints: 5,\n     *   innerRadius: 70,\n     *   outerRadius: 70,\n     *   fill: 'red',\n     *   stroke: 'black',\n     *   strokeWidth: 4\n     * });\n     */\n    Konva.Star = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Star.prototype = {\n        _centroid: true,\n        ___init: function(config) {\n            // call super constructor\n            Konva.Shape.call(this, config);\n            this.className = 'Star';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var innerRadius = this.innerRadius(),\n                outerRadius = this.outerRadius(),\n                numPoints = this.numPoints();\n\n            context.beginPath();\n            context.moveTo(0, 0 - outerRadius);\n\n            for(var n = 1; n < numPoints * 2; n++) {\n                var radius = n % 2 === 0 ? outerRadius : innerRadius;\n                var x = radius * Math.sin(n * Math.PI / numPoints);\n                var y = -1 * radius * Math.cos(n * Math.PI / numPoints);\n                context.lineTo(x, y);\n            }\n            context.closePath();\n\n            context.fillStrokeShape(this);\n        },\n        // implements Shape.prototype.getWidth()\n        getWidth: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.getHeight()\n        getHeight: function() {\n            return this.getOuterRadius() * 2;\n        },\n        // implements Shape.prototype.setWidth()\n        setWidth: function(width) {\n            Konva.Node.prototype.setWidth.call(this, width);\n            if (this.outerRadius() !== width / 2) {\n                this.setOuterRadius(width / 2);\n            }\n        },\n        // implements Shape.prototype.setHeight()\n        setHeight: function(height) {\n            Konva.Node.prototype.setHeight.call(this, height);\n            if (this.outerRadius() !== height / 2) {\n                this.setOuterRadius(height / 2);\n            }\n        }\n    };\n    Konva.Util.extend(Konva.Star, Konva.Shape);\n\n    // add getters setters\n    Konva.Factory.addGetterSetter(Konva.Star, 'numPoints', 5);\n\n    /**\n     * set number of points\n     * @name setNumPoints\n     * @method\n     * @memberof Konva.Star.prototype\n     * @param {Integer} points\n     */\n\n     /**\n     * get number of points\n     * @name getNumPoints\n     * @method\n     * @memberof Konva.Star.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Star, 'innerRadius', 0);\n\n    /**\n     * set inner radius\n     * @name setInnerRadius\n     * @method\n     * @memberof Konva.Star.prototype\n     * @param {Number} radius\n     */\n\n     /**\n     * get inner radius\n     * @name getInnerRadius\n     * @method\n     * @memberof Konva.Star.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Star, 'outerRadius', 0);\n\n    /**\n     * set outer radius\n     * @name setOuterRadius\n     * @method\n     * @memberof Konva.Star.prototype\n     * @param {Number} radius\n     */\n\n     /**\n     * get outer radius\n     * @name getOuterRadius\n     * @method\n     * @memberof Konva.Star.prototype\n     */\n\n    Konva.Collection.mapMethods(Konva.Star);\n})();\n\n(function() {\n    'use strict';\n    // constants\n    var ATTR_CHANGE_LIST = ['fontFamily', 'fontSize', 'fontStyle', 'padding', 'lineHeight', 'text'],\n        CHANGE_KONVA = 'Change.konva',\n        NONE = 'none',\n        UP = 'up',\n        RIGHT = 'right',\n        DOWN = 'down',\n        LEFT = 'left',\n        LABEL = 'Label',\n\n     // cached variables\n     attrChangeListLen = ATTR_CHANGE_LIST.length;\n\n    /**\n     * Label constructor.&nbsp; Labels are groups that contain a Text and Tag shape\n     * @constructor\n     * @memberof Konva\n     * @param {Object} config\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * // create label\n     * var label = new Konva.Label({\n     *   x: 100,\n     *   y: 100,\n     *   draggable: true\n     * });\n     *\n     * // add a tag to the label\n     * label.add(new Konva.Tag({\n     *   fill: '#bbb',\n     *   stroke: '#333',\n     *   shadowColor: 'black',\n     *   shadowBlur: 10,\n     *   shadowOffset: [10, 10],\n     *   shadowOpacity: 0.2,\n     *   lineJoin: 'round',\n     *   pointerDirection: 'up',\n     *   pointerWidth: 20,\n     *   pointerHeight: 20,\n     *   cornerRadius: 5\n     * }));\n     *\n     * // add text to the label\n     * label.add(new Konva.Text({\n     *   text: 'Hello World!',\n     *   fontSize: 50,\n     *   lineHeight: 1.2,\n     *   padding: 10,\n     *   fill: 'green'\n     *  }));\n     */\n    Konva.Label = function(config) {\n        this.____init(config);\n    };\n\n    Konva.Label.prototype = {\n        ____init: function(config) {\n            var that = this;\n\n            Konva.Group.call(this, config);\n            this.className = LABEL;\n\n            this.on('add.konva', function(evt) {\n                that._addListeners(evt.child);\n                that._sync();\n            });\n        },\n        /**\n         * get Text shape for the label.  You need to access the Text shape in order to update\n         * the text properties\n         * @name getText\n         * @method\n         * @memberof Konva.Label.prototype\n         */\n        getText: function() {\n            return this.find('Text')[0];\n        },\n        /**\n         * get Tag shape for the label.  You need to access the Tag shape in order to update\n         * the pointer properties and the corner radius\n         * @name getTag\n         * @method\n         * @memberof Konva.Label.prototype\n         */\n        getTag: function() {\n            return this.find('Tag')[0];\n        },\n        _addListeners: function(text) {\n            var that = this,\n                n;\n            var func = function(){\n                    that._sync();\n                };\n\n            // update text data for certain attr changes\n            for(n = 0; n < attrChangeListLen; n++) {\n                text.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, func);\n            }\n        },\n        getWidth: function() {\n            return this.getText().getWidth();\n        },\n        getHeight: function() {\n            return this.getText().getHeight();\n        },\n        _sync: function() {\n            var text = this.getText(),\n                tag = this.getTag(),\n                width, height, pointerDirection, pointerWidth, x, y, pointerHeight;\n\n            if (text && tag) {\n                width = text.getWidth();\n                height = text.getHeight();\n                pointerDirection = tag.getPointerDirection();\n                pointerWidth = tag.getPointerWidth();\n                pointerHeight = tag.getPointerHeight();\n                x = 0;\n                y = 0;\n\n                switch(pointerDirection) {\n                    case UP:\n                        x = width / 2;\n                        y = -1 * pointerHeight;\n                        break;\n                    case RIGHT:\n                        x = width + pointerWidth;\n                        y = height / 2;\n                        break;\n                    case DOWN:\n                        x = width / 2;\n                        y = height + pointerHeight;\n                        break;\n                    case LEFT:\n                        x = -1 * pointerWidth;\n                        y = height / 2;\n                        break;\n                }\n\n                tag.setAttrs({\n                    x: -1 * x,\n                    y: -1 * y,\n                    width: width,\n                    height: height\n                });\n\n                text.setAttrs({\n                    x: -1 * x,\n                    y: -1 * y\n                });\n            }\n        }\n    };\n\n    Konva.Util.extend(Konva.Label, Konva.Group);\n\n    Konva.Collection.mapMethods(Konva.Label);\n\n    /**\n     * Tag constructor.&nbsp; A Tag can be configured\n     *  to have a pointer element that points up, right, down, or left\n     * @constructor\n     * @memberof Konva\n     * @param {Object} config\n     * @param {String} [config.pointerDirection] can be up, right, down, left, or none; the default\n     *  is none.  When a pointer is present, the positioning of the label is relative to the tip of the pointer.\n     * @param {Number} [config.pointerWidth]\n     * @param {Number} [config.pointerHeight]\n     * @param {Number} [config.cornerRadius]\n     */\n    Konva.Tag = function(config) {\n        this.___init(config);\n    };\n\n    Konva.Tag.prototype = {\n        ___init: function(config) {\n            Konva.Shape.call(this, config);\n            this.className = 'Tag';\n            this.sceneFunc(this._sceneFunc);\n        },\n        _sceneFunc: function(context) {\n            var width = this.getWidth(),\n                height = this.getHeight(),\n                pointerDirection = this.getPointerDirection(),\n                pointerWidth = this.getPointerWidth(),\n                pointerHeight = this.getPointerHeight(),\n                cornerRadius = Math.min(this.getCornerRadius(), width / 2, height / 2);\n\n            context.beginPath();\n            if (!cornerRadius) {\n                context.moveTo(0, 0);\n            } else {\n                context.moveTo(cornerRadius, 0);\n            }\n\n            if (pointerDirection === UP) {\n                context.lineTo((width - pointerWidth) / 2, 0);\n                context.lineTo(width / 2, -1 * pointerHeight);\n                context.lineTo((width + pointerWidth) / 2, 0);\n            }\n\n            if(!cornerRadius) {\n                context.lineTo(width, 0);\n            } else {\n                context.lineTo(width - cornerRadius, 0);\n                context.arc(width - cornerRadius, cornerRadius, cornerRadius, Math.PI * 3 / 2, 0, false);\n            }\n\n            if (pointerDirection === RIGHT) {\n                context.lineTo(width, (height - pointerHeight) / 2);\n                context.lineTo(width + pointerWidth, height / 2);\n                context.lineTo(width, (height + pointerHeight) / 2);\n            }\n\n            if(!cornerRadius) {\n                context.lineTo(width, height);\n            } else {\n                context.lineTo(width, height - cornerRadius);\n                context.arc(width - cornerRadius, height - cornerRadius, cornerRadius, 0, Math.PI / 2, false);\n            }\n\n            if (pointerDirection === DOWN) {\n                context.lineTo((width + pointerWidth) / 2, height);\n                context.lineTo(width / 2, height + pointerHeight);\n                context.lineTo((width - pointerWidth) / 2, height);\n            }\n\n            if(!cornerRadius) {\n                context.lineTo(0, height);\n            } else {\n                context.lineTo(cornerRadius, height);\n                context.arc(cornerRadius, height - cornerRadius, cornerRadius, Math.PI / 2, Math.PI, false);\n            }\n\n            if (pointerDirection === LEFT) {\n                context.lineTo(0, (height + pointerHeight) / 2);\n                context.lineTo(-1 * pointerWidth, height / 2);\n                context.lineTo(0, (height - pointerHeight) / 2);\n            }\n\n            if(cornerRadius) {\n                context.lineTo(0, cornerRadius);\n                context.arc(cornerRadius, cornerRadius, cornerRadius, Math.PI, Math.PI * 3 / 2, false);\n            }\n\n            context.closePath();\n            context.fillStrokeShape(this);\n        },\n        getSelfRect: function() {\n            var x = 0,\n                y = 0,\n                pointerWidth = this.getPointerWidth(),\n                pointerHeight = this.getPointerHeight(),\n                direction = this.pointerDirection(),\n                width = this.getWidth(),\n                height = this.getHeight();\n\n            if (direction === UP) {\n                y -= pointerHeight;\n                height += pointerHeight;\n            } else if (direction === DOWN) {\n                height += pointerHeight;\n            } else if (direction === LEFT) {\n                // ARGH!!! I have no idea why should I used magic 1.5!!!!!!!!!\n                x -= pointerWidth * 1.5;\n                width += pointerWidth;\n            } else if (direction === RIGHT) {\n                width += pointerWidth * 1.5;\n            }\n            return {\n                x: x,\n                y: y,\n                width: width,\n                height: height\n            };\n        }\n    };\n\n    Konva.Util.extend(Konva.Tag, Konva.Shape);\n    Konva.Factory.addGetterSetter(Konva.Tag, 'pointerDirection', NONE);\n\n    /**\n     * set pointer Direction\n     * @name setPointerDirection\n     * @method\n     * @memberof Konva.Tag.prototype\n     * @param {String} pointerDirection can be up, right, down, left, or none.  The\n     *  default is none\n     */\n\n     /**\n     * get pointer Direction\n     * @name getPointerDirection\n     * @method\n     * @memberof Konva.Tag.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Tag, 'pointerWidth', 0);\n\n    /**\n     * set pointer width\n     * @name setPointerWidth\n     * @method\n     * @memberof Konva.Tag.prototype\n     * @param {Number} pointerWidth\n     */\n\n     /**\n     * get pointer width\n     * @name getPointerWidth\n     * @method\n     * @memberof Konva.Tag.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Tag, 'pointerHeight', 0);\n\n    /**\n     * set pointer height\n     * @name setPointerHeight\n     * @method\n     * @memberof Konva.Tag.prototype\n     * @param {Number} pointerHeight\n     */\n\n     /**\n     * get pointer height\n     * @name getPointerHeight\n     * @method\n     * @memberof Konva.Tag.prototype\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Tag, 'cornerRadius', 0);\n\n    /**\n     * set corner radius\n     * @name setCornerRadius\n     * @method\n     * @memberof Konva.Tag.prototype\n     * @param {Number} corner radius\n     */\n\n    /**\n     * get corner radius\n     * @name getCornerRadius\n     * @method\n     * @memberof Konva.Tag.prototype\n     */\n\n    Konva.Collection.mapMethods(Konva.Tag);\n})();\n\n(function() {\n    'use strict';\n    /**\n     * Arrow constructor\n     * @constructor\n     * @memberof Konva\n     * @augments Konva.Shape\n     * @param {Object} config\n     * @param {Array} config.points\n     * @param {Number} [config.tension] Higher values will result in a more curvy line.  A value of 0 will result in no interpolation.\n     *   The default is 0\n     * @param {Number} config.pointerLength\n     * @param {Number} config.pointerWidth\n     * @param {String} [config.fill] fill color\n     * @param {Image} [config.fillPatternImage] fill pattern image\n     * @param {Number} [config.fillPatternX]\n     * @param {Number} [config.fillPatternY]\n     * @param {Object} [config.fillPatternOffset] object with x and y component\n     * @param {Number} [config.fillPatternOffsetX] \n     * @param {Number} [config.fillPatternOffsetY] \n     * @param {Object} [config.fillPatternScale] object with x and y component\n     * @param {Number} [config.fillPatternScaleX]\n     * @param {Number} [config.fillPatternScaleY]\n     * @param {Number} [config.fillPatternRotation]\n     * @param {String} [config.fillPatternRepeat] can be \"repeat\", \"repeat-x\", \"repeat-y\", or \"no-repeat\".  The default is \"no-repeat\"\n     * @param {Object} [config.fillLinearGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientStartPointX]\n     * @param {Number} [config.fillLinearGradientStartPointY]\n     * @param {Object} [config.fillLinearGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillLinearGradientEndPointX]\n     * @param {Number} [config.fillLinearGradientEndPointY]\n     * @param {Array} [config.fillLinearGradientColorStops] array of color stops\n     * @param {Object} [config.fillRadialGradientStartPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientStartPointX]\n     * @param {Number} [config.fillRadialGradientStartPointY]\n     * @param {Object} [config.fillRadialGradientEndPoint] object with x and y component\n     * @param {Number} [config.fillRadialGradientEndPointX] \n     * @param {Number} [config.fillRadialGradientEndPointY] \n     * @param {Number} [config.fillRadialGradientStartRadius]\n     * @param {Number} [config.fillRadialGradientEndRadius]\n     * @param {Array} [config.fillRadialGradientColorStops] array of color stops\n     * @param {Boolean} [config.fillEnabled] flag which enables or disables the fill.  The default value is true\n     * @param {String} [config.fillPriority] can be color, linear-gradient, radial-graident, or pattern.  The default value is color.  The fillPriority property makes it really easy to toggle between different fill types.  For example, if you want to toggle between a fill color style and a fill pattern style, simply set the fill property and the fillPattern properties, and then use setFillPriority('color') to render the shape with a color fill, or use setFillPriority('pattern') to render the shape with the pattern fill configuration\n     * @param {String} [config.stroke] stroke color\n     * @param {Number} [config.strokeWidth] stroke width\n     * @param {Boolean} [config.strokeHitEnabled] flag which enables or disables stroke hit region.  The default is true\n     * @param {Boolean} [config.perfectDrawEnabled] flag which enables or disables using buffer canvas.  The default is true\n     * @param {Boolean} [config.shadowForStrokeEnabled] flag which enables or disables shasow for stroke.  The default is true\n     * @param {Boolean} [config.strokeScaleEnabled] flag which enables or disables stroke scale.  The default is true\n     * @param {Boolean} [config.strokeEnabled] flag which enables or disables the stroke.  The default value is true\n     * @param {String} [config.lineJoin] can be miter, round, or bevel.  The default\n     *  is miter\n     * @param {String} [config.lineCap] can be butt, round, or sqare.  The default\n     *  is butt\n     * @param {String} [config.shadowColor]\n     * @param {Number} [config.shadowBlur]\n     * @param {Object} [config.shadowOffset] object with x and y component\n     * @param {Number} [config.shadowOffsetX]\n     * @param {Number} [config.shadowOffsetY]\n     * @param {Number} [config.shadowOpacity] shadow opacity.  Can be any real number\n     *  between 0 and 1\n     * @param {Boolean} [config.shadowEnabled] flag which enables or disables the shadow.  The default value is true\n     * @param {Array} [config.dash]\n     * @param {Boolean} [config.dashEnabled] flag which enables or disables the dashArray.  The default value is true\n     * @param {Number} [config.x]\n     * @param {Number} [config.y]\n     * @param {Number} [config.width]\n     * @param {Number} [config.height]\n     * @param {Boolean} [config.visible]\n     * @param {Boolean} [config.listening] whether or not the node is listening for events\n     * @param {String} [config.id] unique id\n     * @param {String} [config.name] non-unique name\n     * @param {Number} [config.opacity] determines node opacity.  Can be any number between 0 and 1\n     * @param {Object} [config.scale] set scale\n     * @param {Number} [config.scaleX] set scale x\n     * @param {Number} [config.scaleY] set scale y\n     * @param {Number} [config.rotation] rotation in degrees\n     * @param {Object} [config.offset] offset from center point and rotation point\n     * @param {Number} [config.offsetX] set offset x\n     * @param {Number} [config.offsetY] set offset y\n     * @param {Boolean} [config.draggable] makes the node draggable.  When stages are draggable, you can drag and drop\n     *  the entire stage by dragging any portion of the stage\n     * @param {Number} [config.dragDistance]\n     * @param {Function} [config.dragBoundFunc]\n     * @example\n     * var line = new Konva.Line({\n     *   points: [73, 70, 340, 23, 450, 60, 500, 20],\n     *   stroke: 'red',\n     *   tension: 1,\n     *   pointerLength : 10,\n     *   pointerWidth : 12\n     * });\n     */\n    Konva.Arrow = function(config) {\n        this.____init(config);\n    };\n\n    Konva.Arrow.prototype = {\n        ____init: function(config) {\n            // call super constructor\n            Konva.Line.call(this, config);\n            this.className = 'Arrow';\n        },\n        _sceneFunc: function(ctx) {\n            Konva.Line.prototype._sceneFunc.apply(this, arguments);\n            var PI2 = Math.PI * 2;\n            var points = this.points();\n            var n = points.length;\n            var dx = points[n - 2] - points[n - 4];\n            var dy = points[n - 1] - points[n - 3];\n            var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n            var length = this.pointerLength();\n            var width = this.pointerWidth();\n\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[n - 2], points[n - 1]);\n            ctx.rotate(radians);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n\n            if (this.pointerAtBeginning()) {\n                ctx.save();\n                ctx.translate(points[0], points[1]);\n                dx = points[2] - points[0];\n                dy = points[3] - points[1];\n                ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n                ctx.moveTo(0, 0);\n                ctx.lineTo(-length, width / 2);\n                ctx.lineTo(-length, -width / 2);\n                ctx.closePath();\n                ctx.restore();\n            }\n            ctx.fillStrokeShape(this);\n        }\n    };\n\n    Konva.Util.extend(Konva.Arrow, Konva.Line);\n    /**\n     * get/set pointerLength\n     * @name pointerLength\n     * @method\n     * @memberof Konva.Arrow.prototype\n     * @param {Number} Length of pointer of arrow.\n     *   The default is 10.\n     * @returns {Number}\n     * @example\n     * // get tension\n     * var pointerLength = line.pointerLength();\n     *\n     * // set tension\n     * line.pointerLength(15);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arrow, 'pointerLength', 10);\n    /**\n     * get/set pointerWidth\n     * @name pointerWidth\n     * @method\n     * @memberof Konva.Arrow.prototype\n     * @param {Number} Width of pointer of arrow.\n     *   The default is 10.\n     * @returns {Number}\n     * @example\n     * // get tension\n     * var pointerWidth = line.pointerWidth();\n     *\n     * // set tension\n     * line.pointerWidth(15);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arrow, 'pointerWidth', 10);\n    /**\n     * get/set pointerAtBeginning\n     * @name pointerAtBeginning\n     * @method\n     * @memberof Konva.Arrow.prototype\n     * @param {Number} Should pointer displayed at beginning of arrow.\n     *   The default is false.\n     * @returns {Boolean}\n     * @example\n     * // get tension\n     * var pointerAtBeginning = line.pointerAtBeginning();\n     *\n     * // set tension\n     * line.pointerAtBeginning(true);\n     */\n\n    Konva.Factory.addGetterSetter(Konva.Arrow, 'pointerAtBeginning', false);\n    Konva.Collection.mapMethods(Konva.Arrow);\n\n})();\n\n/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34va29udmEva29udmEuanM/YTUzMSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qXG4gKiBLb252YSBKYXZhU2NyaXB0IEZyYW1ld29yayB2MS4xLjRcbiAqIGh0dHA6Ly9rb252YWpzLmdpdGh1Yi5pby9cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgb3IgR1BMIFZlcnNpb24gMiBsaWNlbnNlcy5cbiAqIERhdGU6IFR1ZSBTZXAgMTMgMjAxNlxuICpcbiAqIE9yaWdpbmFsIHdvcmsgQ29weXJpZ2h0IChDKSAyMDExIC0gMjAxMyBieSBFcmljIFJvd2VsbCAoS2luZXRpY0pTKVxuICogTW9kaWZpZWQgd29yayBDb3B5cmlnaHQgKEMpIDIwMTQgLSAyMDE1IGJ5IEFudG9uIExhdnJlbm92IChLb252YSlcbiAqXG4gKiBAbGljZW5zZVxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqL1xuXG4vLyBydW50aW1lIGNoZWNrIGZvciBhbHJlYWR5IGluY2x1ZGVkIEtvbnZhXG4oZnVuY3Rpb24oZ2xvYmFsKXtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogQG5hbWVzcGFjZSBLb252YVxuICAgICAqL1xuXG4gICAgdmFyIFBJX09WRVJfMTgwID0gTWF0aC5QSSAvIDE4MDtcblxuICAgIHZhciBLb252YSA9IHtcbiAgICAgICAgLy8gcHVibGljXG4gICAgICAgIHZlcnNpb246ICcxLjEuNCcsXG5cbiAgICAgICAgLy8gcHJpdmF0ZVxuICAgICAgICBzdGFnZXM6IFtdLFxuICAgICAgICBpZENvdW50ZXI6IDAsXG4gICAgICAgIGlkczoge30sXG4gICAgICAgIG5hbWVzOiB7fSxcbiAgICAgICAgc2hhcGVzOiB7fSxcbiAgICAgICAgbGlzdGVuQ2xpY2tUYXA6IGZhbHNlLFxuICAgICAgICBpbkRibENsaWNrV2luZG93OiBmYWxzZSxcblxuICAgICAgICAvLyBjb25maWd1cmF0aW9uc1xuICAgICAgICBlbmFibGVUcmFjZTogZmFsc2UsXG4gICAgICAgIHRyYWNlQXJyTWF4OiAxMDAsXG4gICAgICAgIGRibENsaWNrV2luZG93OiA0MDAsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHbG9iYWwgcGl4ZWwgcmF0aW8gY29uZmlndXJhdGlvbi4gS29udmFKUyBhdXRvbWF0aWNhbGx5IGRldGVjdCBwaXhlbCByYXRpbyBvZiBjdXJyZW50IGRldmljZS5cbiAgICAgICAgICogQnV0IHlvdSBtYXkgb3ZlcnJpZGUgc3VjaCBwcm9wZXJ0eSwgaWYgeW91IHdhbnQgdG8gdXNlIHlvdXIgdmFsdWUuXG4gICAgICAgICAqIEBwcm9wZXJ0eSBwaXhlbFJhdGlvXG4gICAgICAgICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogS29udmEucGl4ZWxSYXRpbyA9IDE7XG4gICAgICAgICAqL1xuICAgICAgICBwaXhlbFJhdGlvOiB1bmRlZmluZWQsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEcmFnIGRpc3RhbmNlIHByb3BlcnR5LiBJZiB5b3Ugc3RhcnQgdG8gZHJhZyBhIG5vZGUgeW91IG1heSB3YW50IHRvIHdhaXQgdW50aWwgcG9pbnRlciBpcyBtb3ZlZCB0byBzb21lIGRpc3RhbmNlIGZyb20gc3RhcnQgcG9pbnQsXG4gICAgICAgICAqIG9ubHkgdGhlbiBzdGFydCBkcmFnZ2luZy5cbiAgICAgICAgICogQHByb3BlcnR5IGRyYWdEaXN0YW5jZVxuICAgICAgICAgKiBAZGVmYXVsdCAwXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBLb252YS5kcmFnRGlzdGFuY2UgPSAxMDtcbiAgICAgICAgICovXG4gICAgICAgIGRyYWdEaXN0YW5jZTogMCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZSBkZWdyZWUgdmFsdWVzIGZvciBhbmdsZSBwcm9wZXJ0aWVzLiBZb3UgbWF5IHNldCB0aGlzIHByb3BlcnR5IHRvIGZhbHNlIGlmIHlvdSB3YW50IHRvIHVzZSByYWRpYW50IHZhbHVlcy5cbiAgICAgICAgICogQHByb3BlcnR5IGFuZ2xlRGVnXG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIG5vZGUucm90YXRpb24oNDUpOyAvLyA0NSBkZWdyZWVzXG4gICAgICAgICAqIEtvbnZhLmFuZ2xlRGVnID0gZmFsc2U7XG4gICAgICAgICAqIG5vZGUucm90YXRpb24oTWF0aC5QSSAvIDIpOyAvLyBQSS8yIHJhZGlhblxuICAgICAgICAgKi9cbiAgICAgICAgYW5nbGVEZWc6IHRydWUsXG4gICAgICAgICAvKipcbiAgICAgICAgICogU2hvdyBkaWZmZXJlbnQgd2FybmluZ3MgYWJvdXQgZXJyb3JzIG9yIHdyb25nIEFQSSB1c2FnZVxuICAgICAgICAgKiBAcHJvcGVydHkgc2hvd1dhcm5pbmdzXG4gICAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIEtvbnZhLnNob3dXYXJuaW5ncyA9IGZhbHNlO1xuICAgICAgICAgKi9cbiAgICAgICAgc2hvd1dhcm5pbmdzOiB0cnVlLFxuXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG5hbWVzcGFjZSBGaWx0ZXJzXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAgICAgKi9cbiAgICAgICAgRmlsdGVyczoge30sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgd2hldGhlciBvciBub3QgZHJhZyBhbmQgZHJvcCBpcyBjdXJyZW50bHkgYWN0aXZlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICAgICAqL1xuICAgICAgICBpc0RyYWdnaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkZCA9IEtvbnZhLkREO1xuXG4gICAgICAgICAgICAvLyBpZiBERCBpcyBub3QgaW5jbHVkZWQgd2l0aCB0aGUgYnVpbGQsIHRoZW5cbiAgICAgICAgICAgIC8vIGRyYWcgYW5kIGRyb3AgaXMgbm90IGV2ZW4gcG9zc2libGVcbiAgICAgICAgICAgIGlmIChkZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZC5pc0RyYWdnaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiByZXR1cm5zIHdoZXRoZXIgb3Igbm90IGEgZHJhZyBhbmQgZHJvcCBvcGVyYXRpb24gaXMgcmVhZHksIGJ1dCBtYXlcbiAgICAgICAgKiAgbm90IG5lY2Vzc2FyaWx5IGhhdmUgc3RhcnRlZFxuICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgICAgKi9cbiAgICAgICAgaXNEcmFnUmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGRkID0gS29udmEuREQ7XG5cbiAgICAgICAgICAgIC8vIGlmIEREIGlzIG5vdCBpbmNsdWRlZCB3aXRoIHRoZSBidWlsZCwgdGhlblxuICAgICAgICAgICAgLy8gZHJhZyBhbmQgZHJvcCBpcyBub3QgZXZlbiBwb3NzaWJsZVxuICAgICAgICAgICAgaWYgKGRkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhZGQubm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgX2FkZElkOiBmdW5jdGlvbihub2RlLCBpZCkge1xuICAgICAgICAgICAgaWYoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaWRzW2lkXSA9IG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9yZW1vdmVJZDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgICAgIGlmKGlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5pZHNbaWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfYWRkTmFtZTogZnVuY3Rpb24obm9kZSwgbmFtZSkge1xuICAgICAgICAgICAgaWYobmFtZSkge1xuICAgICAgICAgICAgICAgIGlmKCF0aGlzLm5hbWVzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZXNbbmFtZV0gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lc1tuYW1lXS5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfcmVtb3ZlTmFtZTogZnVuY3Rpb24obmFtZSwgX2lkKSB7XG4gICAgICAgICAgICBpZighbmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBub2RlcyA9IHRoaXMubmFtZXNbbmFtZV07XG4gICAgICAgICAgICBpZighbm9kZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IodmFyIG4gPSAwOyBuIDwgbm9kZXMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbm8gPSBub2Rlc1tuXTtcbiAgICAgICAgICAgICAgICBpZihuby5faWQgPT09IF9pZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UobiwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobm9kZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubmFtZXNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldEFuZ2xlOiBmdW5jdGlvbihhbmdsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5nbGVEZWcgPyBhbmdsZSAqIFBJX09WRVJfMTgwIDogYW5nbGU7XG4gICAgICAgIH0sXG4gICAgICAgIF9kZXRlY3RJRTogZnVuY3Rpb24odWEpIHtcbiAgICAgICAgICAgIHZhciBtc2llID0gdWEuaW5kZXhPZignbXNpZSAnKTtcbiAgICAgICAgICAgIGlmIChtc2llID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIElFIDEwIG9yIG9sZGVyID0+IHJldHVybiB2ZXJzaW9uIG51bWJlclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh1YS5zdWJzdHJpbmcobXNpZSArIDUsIHVhLmluZGV4T2YoJy4nLCBtc2llKSksIDEwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRyaWRlbnQgPSB1YS5pbmRleE9mKCd0cmlkZW50LycpO1xuICAgICAgICAgICAgaWYgKHRyaWRlbnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gSUUgMTEgPT4gcmV0dXJuIHZlcnNpb24gbnVtYmVyXG4gICAgICAgICAgICAgICAgdmFyIHJ2ID0gdWEuaW5kZXhPZigncnY6Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHVhLnN1YnN0cmluZyhydiArIDMsIHVhLmluZGV4T2YoJy4nLCBydikpLCAxMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBlZGdlID0gdWEuaW5kZXhPZignZWRnZS8nKTtcbiAgICAgICAgICAgIGlmIChlZGdlID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIEVkZ2UgKElFIDEyKykgPT4gcmV0dXJuIHZlcnNpb24gbnVtYmVyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHVhLnN1YnN0cmluZyhlZGdlICsgNSwgdWEuaW5kZXhPZignLicsIGVkZ2UpKSwgMTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBvdGhlciBicm93c2VyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIF9wYXJzZVVBOiBmdW5jdGlvbih1c2VyQWdlbnQpIHtcbiAgICAgICAgICAgIHZhciB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIC8vIGpRdWVyeSBVQSByZWdleFxuICAgICAgICAgICAgICAgIG1hdGNoID0gLyhjaHJvbWUpWyBcXC9dKFtcXHcuXSspLy5leGVjKCB1YSApIHx8XG4gICAgICAgICAgICAgICAgLyh3ZWJraXQpWyBcXC9dKFtcXHcuXSspLy5leGVjKCB1YSApIHx8XG4gICAgICAgICAgICAgICAgLyhvcGVyYSkoPzouKnZlcnNpb258KVsgXFwvXShbXFx3Ll0rKS8uZXhlYyggdWEgKSB8fFxuICAgICAgICAgICAgICAgIC8obXNpZSkgKFtcXHcuXSspLy5leGVjKCB1YSApIHx8XG4gICAgICAgICAgICAgICAgdWEuaW5kZXhPZignY29tcGF0aWJsZScpIDwgMCAmJiAvKG1vemlsbGEpKD86Lio/IHJ2OihbXFx3Ll0rKXwpLy5leGVjKCB1YSApIHx8XG4gICAgICAgICAgICAgICAgW10sXG5cbiAgICAgICAgICAgICAgICAvLyBhZGRpbmcgbW9iaWxlIGZsYWcgYXMgd2VsbFxuICAgICAgICAgICAgICAgIG1vYmlsZSA9ICEhKHVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZHxCbGFja0JlcnJ5fGlQaG9uZXxpUGFkfGlQb2R8T3BlcmEgTWluaXxJRU1vYmlsZS9pKSksXG4gICAgICAgICAgICAgICAgaWVNb2JpbGUgPSAhISh1c2VyQWdlbnQubWF0Y2goL0lFTW9iaWxlL2kpKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBicm93c2VyOiBtYXRjaFsgMSBdIHx8ICcnLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IG1hdGNoWyAyIF0gfHwgJzAnLFxuICAgICAgICAgICAgICAgIGlzSUU6IEtvbnZhLl9kZXRlY3RJRSh1YSksXG4gICAgICAgICAgICAgICAgLy8gYWRkaW5nIG1vYmlsZSBmbGFiXG4gICAgICAgICAgICAgICAgbW9iaWxlOiBtb2JpbGUsXG4gICAgICAgICAgICAgICAgaWVNb2JpbGU6IGllTW9iaWxlICAvLyBJZiB0aGlzIGlzIHRydWUgKGkuZS4sIFdQOCksIHRoZW4gS29udmEgdG91Y2ggZXZlbnRzIGFyZSBleGVjdXRlZCBpbnN0ZWFkIG9mIGVxdWl2YWxlbnQgS29udmEgbW91c2UgZXZlbnRzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAvLyB1c2VyIGFnZW50XG4gICAgICAgIFVBOiB1bmRlZmluZWRcbiAgICB9O1xuXG4gICAgdmFyIGdsb2IgPVxuICAgICAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6XG4gICAgICAgIHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDpcbiAgICAgICAgdHlwZW9mIFdvcmtlckdsb2JhbFNjb3BlICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTtcblxuXG4gICAgS29udmEuVUEgPSBLb252YS5fcGFyc2VVQSgoZ2xvYi5uYXZpZ2F0b3IgJiYgZ2xvYi5uYXZpZ2F0b3IudXNlckFnZW50KSB8fCAnJyk7XG5cblxuICAgIGlmIChnbG9iLktvbnZhKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICAnS29udmEgaW5zdGFuY2UgaXMgYWxyZWFkeSBleGlzdCBpbiBjdXJyZW50IGV2aXJvbWVudC4gJyArXG4gICAgICAgICAgICAnUGxlYXNlIHVzZSBvbmx5IG9uZSBpbnN0YW5jZS4nXG4gICAgICAgICk7XG4gICAgfVxuICAgIGdsb2IuS29udmEgPSBLb252YTtcbiAgICBLb252YS5nbG9iYWwgPSBnbG9iO1xuXG5cbiAgICBpZiggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIHJ1bnRpbWUtY2hlY2sgZm9yIGJyb3dzZXJpZnkgYW5kIG53LmpzIChub2RlLXdlYmtpdClcbiAgICAgICAgaWYoZ2xvYi53aW5kb3cgJiYgZ2xvYi53aW5kb3cuZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIEtvbnZhLmRvY3VtZW50ID0gZ2xvYi53aW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgICAgICBLb252YS53aW5kb3cgPSBnbG9iLndpbmRvdztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgICAgICAgICAgLy8gb25seSBDb21tb25KUy1saWtlIGVudmlyb21lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcbiAgICAgICAgICAgIC8vIGxpa2UgTm9kZS5cbiAgICAgICAgICAgIHZhciBDYW52YXMgPSByZXF1aXJlKCdjYW52YXMnKTtcbiAgICAgICAgICAgIHZhciBqc2RvbSA9IHJlcXVpcmUoJ2pzZG9tJykuanNkb207XG5cbiAgICAgICAgICAgIEtvbnZhLndpbmRvdyA9IGpzZG9tKCc8IURPQ1RZUEUgaHRtbD48aHRtbD48aGVhZD48L2hlYWQ+PGJvZHk+PC9ib2R5PjwvaHRtbD4nKS5kZWZhdWx0VmlldztcbiAgICAgICAgICAgIEtvbnZhLmRvY3VtZW50ID0gS29udmEud2luZG93LmRvY3VtZW50O1xuICAgICAgICAgICAgS29udmEud2luZG93LkltYWdlID0gQ2FudmFzLkltYWdlO1xuICAgICAgICAgICAgS29udmEuX25vZGVDYW52YXMgPSBDYW52YXM7XG4gICAgICAgIH1cbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBLb252YTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbHNlIGlmKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuICAgICAgICBkZWZpbmUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gS29udmE7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBLb252YS5kb2N1bWVudCA9IGRvY3VtZW50O1xuICAgIEtvbnZhLndpbmRvdyA9IHdpbmRvdztcbn0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogZ2xvYmFsKTtcblxuLyplc2xpbnQtZGlzYWJsZSAgZXFlcWVxLCBuby1jb25kLWFzc2lnbiwgbm8tZW1wdHkqL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBDb2xsZWN0aW9uIGNvbnN0cnVjdG9yLiAgQ29sbGVjdGlvbiBleHRlbmRzXG4gICAgICogIEFycmF5LiAgVGhpcyBjbGFzcyBpcyB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGgge0BsaW5rIEtvbnZhLkNvbnRhaW5lciNnZXR9XG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICovXG4gICAgS29udmEuQ29sbGVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSwgbGVuZ3RoID0gYXJncy5sZW5ndGgsIGkgPSAwO1xuXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICBmb3IoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXNbaV0gPSBhcmdzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgS29udmEuQ29sbGVjdGlvbi5wcm90b3R5cGUgPSBbXTtcbiAgICAvKipcbiAgICAgKiBpdGVyYXRlIHRocm91Z2ggbm9kZSBhcnJheSBhbmQgcnVuIGEgZnVuY3Rpb24gZm9yIGVhY2ggbm9kZS5cbiAgICAgKiAgVGhlIG5vZGUgYW5kIGluZGV4IGlzIHBhc3NlZCBpbnRvIHRoZSBmdW5jdGlvblxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29sbGVjdGlvbi5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgYWxsIG5vZGVzIHdpdGggbmFtZSBmb28gaW5zaWRlIGxheWVyLCBhbmQgc2V0IHggdG8gMTAgZm9yIGVhY2hcbiAgICAgKiBsYXllci5nZXQoJy5mb28nKS5lYWNoKGZ1bmN0aW9uKHNoYXBlLCBuKSB7XG4gICAgICogICBzaGFwZS5zZXRYKDEwKTtcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5Db2xsZWN0aW9uLnByb3RvdHlwZS5lYWNoID0gZnVuY3Rpb24oZnVuYykge1xuICAgICAgICBmb3IodmFyIG4gPSAwOyBuIDwgdGhpcy5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgZnVuYyh0aGlzW25dLCBuKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogY29udmVydCBjb2xsZWN0aW9uIGludG8gYW4gYXJyYXlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbGxlY3Rpb24ucHJvdG90eXBlXG4gICAgICovXG4gICAgS29udmEuQ29sbGVjdGlvbi5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJyID0gW10sXG4gICAgICAgICAgICBsZW4gPSB0aGlzLmxlbmd0aCxcbiAgICAgICAgICAgIG47XG5cbiAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGFyci5wdXNoKHRoaXNbbl0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBjb252ZXJ0IGFycmF5IGludG8gYSBjb2xsZWN0aW9uXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Db2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyXG4gICAgICovXG4gICAgS29udmEuQ29sbGVjdGlvbi50b0NvbGxlY3Rpb24gPSBmdW5jdGlvbihhcnIpIHtcbiAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBuZXcgS29udmEuQ29sbGVjdGlvbigpLFxuICAgICAgICAgICAgbGVuID0gYXJyLmxlbmd0aCxcbiAgICAgICAgICAgIG47XG5cbiAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaChhcnJbbl0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuICAgIH07XG5cbiAgICAvLyBtYXAgb25lIG1ldGhvZCBieSBpdCdzIG5hbWVcbiAgICBLb252YS5Db2xsZWN0aW9uLl9tYXBNZXRob2QgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgICAgIEtvbnZhLkNvbGxlY3Rpb24ucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaTtcblxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXNbaV1bbWV0aG9kTmFtZV0uYXBwbHkodGhpc1tpXSwgYXJncyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMgPSBmdW5jdGlvbihjb25zdHJ1Y3Rvcikge1xuICAgICAgICB2YXIgcHJvdCA9IGNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgZm9yKHZhciBtZXRob2ROYW1lIGluIHByb3QpIHtcbiAgICAgICAgICAgIEtvbnZhLkNvbGxlY3Rpb24uX21hcE1ldGhvZChtZXRob2ROYW1lKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKlxuICAgICogTGFzdCB1cGRhdGVkIE5vdmVtYmVyIDIwMTFcbiAgICAqIEJ5IFNpbW9uIFNhcnJpc1xuICAgICogd3d3LnNpbW9uc2FycmlzLmNvbVxuICAgICogc2FycmlzQGFjbS5vcmdcbiAgICAqXG4gICAgKiBGcmVlIHRvIHVzZSBhbmQgZGlzdHJpYnV0ZSBhdCB3aWxsXG4gICAgKiBTbyBsb25nIGFzIHlvdSBhcmUgbmljZSB0byBwZW9wbGUsIGV0Y1xuICAgICovXG5cbiAgICAvKlxuICAgICogVGhlIHVzYWdlIG9mIHRoaXMgY2xhc3Mgd2FzIGluc3BpcmVkIGJ5IHNvbWUgb2YgdGhlIHdvcmsgZG9uZSBieSBhIGZvcmtlZFxuICAgICogcHJvamVjdCwgS2luZXRpY0pTLUV4dCBieSBXYXBwd29ya3MsIHdoaWNoIGlzIGJhc2VkIG9uIFNpbW9uJ3MgVHJhbnNmb3JtXG4gICAgKiBjbGFzcy4gIE1vZGlmaWVkIGJ5IEVyaWMgUm93ZWxsXG4gICAgKi9cblxuICAgIC8qKlxuICAgICAqIFRyYW5zZm9ybSBjb25zdHJ1Y3RvclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFttXSBPcHRpb25hbCBzaXgtZWxlbWVudCBtYXRyaXhcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKi9cbiAgICBLb252YS5UcmFuc2Zvcm0gPSBmdW5jdGlvbihtKSB7XG4gICAgICAgIHRoaXMubSA9IChtICYmIG0uc2xpY2UoKSkgfHwgWzEsIDAsIDAsIDEsIDAsIDBdO1xuICAgIH07XG5cbiAgICBLb252YS5UcmFuc2Zvcm0ucHJvdG90eXBlID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29weSBLb252YS5UcmFuc2Zvcm0gb2JqZWN0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRyYW5zZm9ybS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLlRyYW5zZm9ybX1cbiAgICAgICAgICovXG4gICAgICAgIGNvcHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBLb252YS5UcmFuc2Zvcm0odGhpcy5tKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybSBwb2ludFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UcmFuc2Zvcm0ucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwb2ludCAyRCBwb2ludCh4LCB5KVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSAyRCBwb2ludCh4LCB5KVxuICAgICAgICAgKi9cbiAgICAgICAgcG9pbnQ6IGZ1bmN0aW9uKHBvaW50KSB7XG4gICAgICAgICAgICB2YXIgbSA9IHRoaXMubTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogbVswXSAqIHBvaW50LnggKyBtWzJdICogcG9pbnQueSArIG1bNF0sXG4gICAgICAgICAgICAgICAgeTogbVsxXSAqIHBvaW50LnggKyBtWzNdICogcG9pbnQueSArIG1bNV1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBcHBseSB0cmFuc2xhdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UcmFuc2Zvcm0ucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICB0cmFuc2xhdGU6IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgICAgICAgIHRoaXMubVs0XSArPSB0aGlzLm1bMF0gKiB4ICsgdGhpcy5tWzJdICogeTtcbiAgICAgICAgICAgIHRoaXMubVs1XSArPSB0aGlzLm1bMV0gKiB4ICsgdGhpcy5tWzNdICogeTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQXBwbHkgc2NhbGVcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHJhbnNmb3JtLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gc3hcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHN5XG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICBzY2FsZTogZnVuY3Rpb24oc3gsIHN5KSB7XG4gICAgICAgICAgICB0aGlzLm1bMF0gKj0gc3g7XG4gICAgICAgICAgICB0aGlzLm1bMV0gKj0gc3g7XG4gICAgICAgICAgICB0aGlzLm1bMl0gKj0gc3k7XG4gICAgICAgICAgICB0aGlzLm1bM10gKj0gc3k7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFwcGx5IHJvdGF0aW9uXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRyYW5zZm9ybS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHJhZCAgQW5nbGUgaW4gcmFkaWFuc1xuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuVHJhbnNmb3JtfVxuICAgICAgICAgKi9cbiAgICAgICAgcm90YXRlOiBmdW5jdGlvbihyYWQpIHtcbiAgICAgICAgICAgIHZhciBjID0gTWF0aC5jb3MocmFkKTtcbiAgICAgICAgICAgIHZhciBzID0gTWF0aC5zaW4ocmFkKTtcbiAgICAgICAgICAgIHZhciBtMTEgPSB0aGlzLm1bMF0gKiBjICsgdGhpcy5tWzJdICogcztcbiAgICAgICAgICAgIHZhciBtMTIgPSB0aGlzLm1bMV0gKiBjICsgdGhpcy5tWzNdICogcztcbiAgICAgICAgICAgIHZhciBtMjEgPSB0aGlzLm1bMF0gKiAtcyArIHRoaXMubVsyXSAqIGM7XG4gICAgICAgICAgICB2YXIgbTIyID0gdGhpcy5tWzFdICogLXMgKyB0aGlzLm1bM10gKiBjO1xuICAgICAgICAgICAgdGhpcy5tWzBdID0gbTExO1xuICAgICAgICAgICAgdGhpcy5tWzFdID0gbTEyO1xuICAgICAgICAgICAgdGhpcy5tWzJdID0gbTIxO1xuICAgICAgICAgICAgdGhpcy5tWzNdID0gbTIyO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXR1cm5zIHRoZSB0cmFuc2xhdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UcmFuc2Zvcm0ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9IDJEIHBvaW50KHgsIHkpXG4gICAgICAgICAqL1xuICAgICAgICBnZXRUcmFuc2xhdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IHRoaXMubVs0XSxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLm1bNV1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBcHBseSBza2V3XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRyYW5zZm9ybS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHN4XG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzeVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuVHJhbnNmb3JtfVxuICAgICAgICAgKi9cbiAgICAgICAgc2tldzogZnVuY3Rpb24oc3gsIHN5KSB7XG4gICAgICAgICAgICB2YXIgbTExID0gdGhpcy5tWzBdICsgdGhpcy5tWzJdICogc3k7XG4gICAgICAgICAgICB2YXIgbTEyID0gdGhpcy5tWzFdICsgdGhpcy5tWzNdICogc3k7XG4gICAgICAgICAgICB2YXIgbTIxID0gdGhpcy5tWzJdICsgdGhpcy5tWzBdICogc3g7XG4gICAgICAgICAgICB2YXIgbTIyID0gdGhpcy5tWzNdICsgdGhpcy5tWzFdICogc3g7XG4gICAgICAgICAgICB0aGlzLm1bMF0gPSBtMTE7XG4gICAgICAgICAgICB0aGlzLm1bMV0gPSBtMTI7XG4gICAgICAgICAgICB0aGlzLm1bMl0gPSBtMjE7XG4gICAgICAgICAgICB0aGlzLm1bM10gPSBtMjI7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmFuc2Zvcm0gbXVsdGlwbGljYXRpb25cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHJhbnNmb3JtLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0tvbnZhLlRyYW5zZm9ybX0gbWF0cml4XG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICBtdWx0aXBseTogZnVuY3Rpb24obWF0cml4KSB7XG4gICAgICAgICAgICB2YXIgbTExID0gdGhpcy5tWzBdICogbWF0cml4Lm1bMF0gKyB0aGlzLm1bMl0gKiBtYXRyaXgubVsxXTtcbiAgICAgICAgICAgIHZhciBtMTIgPSB0aGlzLm1bMV0gKiBtYXRyaXgubVswXSArIHRoaXMubVszXSAqIG1hdHJpeC5tWzFdO1xuXG4gICAgICAgICAgICB2YXIgbTIxID0gdGhpcy5tWzBdICogbWF0cml4Lm1bMl0gKyB0aGlzLm1bMl0gKiBtYXRyaXgubVszXTtcbiAgICAgICAgICAgIHZhciBtMjIgPSB0aGlzLm1bMV0gKiBtYXRyaXgubVsyXSArIHRoaXMubVszXSAqIG1hdHJpeC5tWzNdO1xuXG4gICAgICAgICAgICB2YXIgZHggPSB0aGlzLm1bMF0gKiBtYXRyaXgubVs0XSArIHRoaXMubVsyXSAqIG1hdHJpeC5tWzVdICsgdGhpcy5tWzRdO1xuICAgICAgICAgICAgdmFyIGR5ID0gdGhpcy5tWzFdICogbWF0cml4Lm1bNF0gKyB0aGlzLm1bM10gKiBtYXRyaXgubVs1XSArIHRoaXMubVs1XTtcblxuICAgICAgICAgICAgdGhpcy5tWzBdID0gbTExO1xuICAgICAgICAgICAgdGhpcy5tWzFdID0gbTEyO1xuICAgICAgICAgICAgdGhpcy5tWzJdID0gbTIxO1xuICAgICAgICAgICAgdGhpcy5tWzNdID0gbTIyO1xuICAgICAgICAgICAgdGhpcy5tWzRdID0gZHg7XG4gICAgICAgICAgICB0aGlzLm1bNV0gPSBkeTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogSW52ZXJ0IHRoZSBtYXRyaXhcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHJhbnNmb3JtLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuVHJhbnNmb3JtfVxuICAgICAgICAgKi9cbiAgICAgICAgaW52ZXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkID0gMSAvICh0aGlzLm1bMF0gKiB0aGlzLm1bM10gLSB0aGlzLm1bMV0gKiB0aGlzLm1bMl0pO1xuICAgICAgICAgICAgdmFyIG0wID0gdGhpcy5tWzNdICogZDtcbiAgICAgICAgICAgIHZhciBtMSA9IC10aGlzLm1bMV0gKiBkO1xuICAgICAgICAgICAgdmFyIG0yID0gLXRoaXMubVsyXSAqIGQ7XG4gICAgICAgICAgICB2YXIgbTMgPSB0aGlzLm1bMF0gKiBkO1xuICAgICAgICAgICAgdmFyIG00ID0gZCAqICh0aGlzLm1bMl0gKiB0aGlzLm1bNV0gLSB0aGlzLm1bM10gKiB0aGlzLm1bNF0pO1xuICAgICAgICAgICAgdmFyIG01ID0gZCAqICh0aGlzLm1bMV0gKiB0aGlzLm1bNF0gLSB0aGlzLm1bMF0gKiB0aGlzLm1bNV0pO1xuICAgICAgICAgICAgdGhpcy5tWzBdID0gbTA7XG4gICAgICAgICAgICB0aGlzLm1bMV0gPSBtMTtcbiAgICAgICAgICAgIHRoaXMubVsyXSA9IG0yO1xuICAgICAgICAgICAgdGhpcy5tWzNdID0gbTM7XG4gICAgICAgICAgICB0aGlzLm1bNF0gPSBtNDtcbiAgICAgICAgICAgIHRoaXMubVs1XSA9IG01O1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gbWF0cml4XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRyYW5zZm9ybS5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGdldE1hdHJpeDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IHRvIGFic29sdXRlIHBvc2l0aW9uIHZpYSB0cmFuc2xhdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UcmFuc2Zvcm0ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqIEBhdXRob3IgZXJpY2Ryb3dlbGxcbiAgICAgICAgICovXG4gICAgICAgIHNldEFic29sdXRlUG9zaXRpb246IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgICAgICAgIHZhciBtMCA9IHRoaXMubVswXSxcbiAgICAgICAgICAgICAgICBtMSA9IHRoaXMubVsxXSxcbiAgICAgICAgICAgICAgICBtMiA9IHRoaXMubVsyXSxcbiAgICAgICAgICAgICAgICBtMyA9IHRoaXMubVszXSxcbiAgICAgICAgICAgICAgICBtNCA9IHRoaXMubVs0XSxcbiAgICAgICAgICAgICAgICBtNSA9IHRoaXMubVs1XSxcbiAgICAgICAgICAgICAgICB5dCA9ICgobTAgKiAoeSAtIG01KSkgLSAobTEgKiAoeCAtIG00KSkpIC8gKChtMCAqIG0zKSAtIChtMSAqIG0yKSksXG4gICAgICAgICAgICAgICAgeHQgPSAoeCAtIG00IC0gKG0yICogeXQpKSAvIG0wO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFuc2xhdGUoeHQsIHl0KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBDT05TVEFOVFNcbiAgICB2YXIgQ09OVEVYVF8yRCA9ICcyZCcsXG4gICAgICAgIE9CSkVDVF9BUlJBWSA9ICdbb2JqZWN0IEFycmF5XScsXG4gICAgICAgIE9CSkVDVF9OVU1CRVIgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICAgICAgT0JKRUNUX1NUUklORyA9ICdbb2JqZWN0IFN0cmluZ10nLFxuICAgICAgICBQSV9PVkVSX0RFRzE4MCA9IE1hdGguUEkgLyAxODAsXG4gICAgICAgIERFRzE4MF9PVkVSX1BJID0gMTgwIC8gTWF0aC5QSSxcbiAgICAgICAgSEFTSCA9ICcjJyxcbiAgICAgICAgRU1QVFlfU1RSSU5HID0gJycsXG4gICAgICAgIFpFUk8gPSAnMCcsXG4gICAgICAgIEtPTlZBX1dBUk5JTkcgPSAnS29udmEgd2FybmluZzogJyxcbiAgICAgICAgS09OVkFfRVJST1IgPSAnS29udmEgZXJyb3I6ICcsXG4gICAgICAgIFJHQl9QQVJFTiA9ICdyZ2IoJyxcbiAgICAgICAgQ09MT1JTID0ge1xuICAgICAgICAgICAgYWxpY2VibHVlOiBbMjQwLCAyNDgsIDI1NV0sXG4gICAgICAgICAgICBhbnRpcXVld2hpdGU6IFsyNTAsIDIzNSwgMjE1XSxcbiAgICAgICAgICAgIGFxdWE6IFswLCAyNTUsIDI1NV0sXG4gICAgICAgICAgICBhcXVhbWFyaW5lOiBbMTI3LCAyNTUsIDIxMl0sXG4gICAgICAgICAgICBhenVyZTogWzI0MCwgMjU1LCAyNTVdLFxuICAgICAgICAgICAgYmVpZ2U6IFsyNDUsIDI0NSwgMjIwXSxcbiAgICAgICAgICAgIGJpc3F1ZTogWzI1NSwgMjI4LCAxOTZdLFxuICAgICAgICAgICAgYmxhY2s6IFswLCAwLCAwXSxcbiAgICAgICAgICAgIGJsYW5jaGVkYWxtb25kOiBbMjU1LCAyMzUsIDIwNV0sXG4gICAgICAgICAgICBibHVlOiBbMCwgMCwgMjU1XSxcbiAgICAgICAgICAgIGJsdWV2aW9sZXQ6IFsxMzgsIDQzLCAyMjZdLFxuICAgICAgICAgICAgYnJvd246IFsxNjUsIDQyLCA0Ml0sXG4gICAgICAgICAgICBidXJseXdvb2Q6IFsyMjIsIDE4NCwgMTM1XSxcbiAgICAgICAgICAgIGNhZGV0Ymx1ZTogWzk1LCAxNTgsIDE2MF0sXG4gICAgICAgICAgICBjaGFydHJldXNlOiBbMTI3LCAyNTUsIDBdLFxuICAgICAgICAgICAgY2hvY29sYXRlOiBbMjEwLCAxMDUsIDMwXSxcbiAgICAgICAgICAgIGNvcmFsOiBbMjU1LCAxMjcsIDgwXSxcbiAgICAgICAgICAgIGNvcm5mbG93ZXJibHVlOiBbMTAwLCAxNDksIDIzN10sXG4gICAgICAgICAgICBjb3Juc2lsazogWzI1NSwgMjQ4LCAyMjBdLFxuICAgICAgICAgICAgY3JpbXNvbjogWzIyMCwgMjAsIDYwXSxcbiAgICAgICAgICAgIGN5YW46IFswLCAyNTUsIDI1NV0sXG4gICAgICAgICAgICBkYXJrYmx1ZTogWzAsIDAsIDEzOV0sXG4gICAgICAgICAgICBkYXJrY3lhbjogWzAsIDEzOSwgMTM5XSxcbiAgICAgICAgICAgIGRhcmtnb2xkZW5yb2Q6IFsxODQsIDEzMiwgMTFdLFxuICAgICAgICAgICAgZGFya2dyYXk6IFsxNjksIDE2OSwgMTY5XSxcbiAgICAgICAgICAgIGRhcmtncmVlbjogWzAsIDEwMCwgMF0sXG4gICAgICAgICAgICBkYXJrZ3JleTogWzE2OSwgMTY5LCAxNjldLFxuICAgICAgICAgICAgZGFya2toYWtpOiBbMTg5LCAxODMsIDEwN10sXG4gICAgICAgICAgICBkYXJrbWFnZW50YTogWzEzOSwgMCwgMTM5XSxcbiAgICAgICAgICAgIGRhcmtvbGl2ZWdyZWVuOiBbODUsIDEwNywgNDddLFxuICAgICAgICAgICAgZGFya29yYW5nZTogWzI1NSwgMTQwLCAwXSxcbiAgICAgICAgICAgIGRhcmtvcmNoaWQ6IFsxNTMsIDUwLCAyMDRdLFxuICAgICAgICAgICAgZGFya3JlZDogWzEzOSwgMCwgMF0sXG4gICAgICAgICAgICBkYXJrc2FsbW9uOiBbMjMzLCAxNTAsIDEyMl0sXG4gICAgICAgICAgICBkYXJrc2VhZ3JlZW46IFsxNDMsIDE4OCwgMTQzXSxcbiAgICAgICAgICAgIGRhcmtzbGF0ZWJsdWU6IFs3MiwgNjEsIDEzOV0sXG4gICAgICAgICAgICBkYXJrc2xhdGVncmF5OiBbNDcsIDc5LCA3OV0sXG4gICAgICAgICAgICBkYXJrc2xhdGVncmV5OiBbNDcsIDc5LCA3OV0sXG4gICAgICAgICAgICBkYXJrdHVycXVvaXNlOiBbMCwgMjA2LCAyMDldLFxuICAgICAgICAgICAgZGFya3Zpb2xldDogWzE0OCwgMCwgMjExXSxcbiAgICAgICAgICAgIGRlZXBwaW5rOiBbMjU1LCAyMCwgMTQ3XSxcbiAgICAgICAgICAgIGRlZXBza3libHVlOiBbMCwgMTkxLCAyNTVdLFxuICAgICAgICAgICAgZGltZ3JheTogWzEwNSwgMTA1LCAxMDVdLFxuICAgICAgICAgICAgZGltZ3JleTogWzEwNSwgMTA1LCAxMDVdLFxuICAgICAgICAgICAgZG9kZ2VyYmx1ZTogWzMwLCAxNDQsIDI1NV0sXG4gICAgICAgICAgICBmaXJlYnJpY2s6IFsxNzgsIDM0LCAzNF0sXG4gICAgICAgICAgICBmbG9yYWx3aGl0ZTogWzI1NSwgMjU1LCAyNDBdLFxuICAgICAgICAgICAgZm9yZXN0Z3JlZW46IFszNCwgMTM5LCAzNF0sXG4gICAgICAgICAgICBmdWNoc2lhOiBbMjU1LCAwLCAyNTVdLFxuICAgICAgICAgICAgZ2FpbnNib3JvOiBbMjIwLCAyMjAsIDIyMF0sXG4gICAgICAgICAgICBnaG9zdHdoaXRlOiBbMjQ4LCAyNDgsIDI1NV0sXG4gICAgICAgICAgICBnb2xkOiBbMjU1LCAyMTUsIDBdLFxuICAgICAgICAgICAgZ29sZGVucm9kOiBbMjE4LCAxNjUsIDMyXSxcbiAgICAgICAgICAgIGdyYXk6IFsxMjgsIDEyOCwgMTI4XSxcbiAgICAgICAgICAgIGdyZWVuOiBbMCwgMTI4LCAwXSxcbiAgICAgICAgICAgIGdyZWVueWVsbG93OiBbMTczLCAyNTUsIDQ3XSxcbiAgICAgICAgICAgIGdyZXk6IFsxMjgsIDEyOCwgMTI4XSxcbiAgICAgICAgICAgIGhvbmV5ZGV3OiBbMjQwLCAyNTUsIDI0MF0sXG4gICAgICAgICAgICBob3RwaW5rOiBbMjU1LCAxMDUsIDE4MF0sXG4gICAgICAgICAgICBpbmRpYW5yZWQ6IFsyMDUsIDkyLCA5Ml0sXG4gICAgICAgICAgICBpbmRpZ286IFs3NSwgMCwgMTMwXSxcbiAgICAgICAgICAgIGl2b3J5OiBbMjU1LCAyNTUsIDI0MF0sXG4gICAgICAgICAgICBraGFraTogWzI0MCwgMjMwLCAxNDBdLFxuICAgICAgICAgICAgbGF2ZW5kZXI6IFsyMzAsIDIzMCwgMjUwXSxcbiAgICAgICAgICAgIGxhdmVuZGVyYmx1c2g6IFsyNTUsIDI0MCwgMjQ1XSxcbiAgICAgICAgICAgIGxhd25ncmVlbjogWzEyNCwgMjUyLCAwXSxcbiAgICAgICAgICAgIGxlbW9uY2hpZmZvbjogWzI1NSwgMjUwLCAyMDVdLFxuICAgICAgICAgICAgbGlnaHRibHVlOiBbMTczLCAyMTYsIDIzMF0sXG4gICAgICAgICAgICBsaWdodGNvcmFsOiBbMjQwLCAxMjgsIDEyOF0sXG4gICAgICAgICAgICBsaWdodGN5YW46IFsyMjQsIDI1NSwgMjU1XSxcbiAgICAgICAgICAgIGxpZ2h0Z29sZGVucm9keWVsbG93OiBbMjUwLCAyNTAsIDIxMF0sXG4gICAgICAgICAgICBsaWdodGdyYXk6IFsyMTEsIDIxMSwgMjExXSxcbiAgICAgICAgICAgIGxpZ2h0Z3JlZW46IFsxNDQsIDIzOCwgMTQ0XSxcbiAgICAgICAgICAgIGxpZ2h0Z3JleTogWzIxMSwgMjExLCAyMTFdLFxuICAgICAgICAgICAgbGlnaHRwaW5rOiBbMjU1LCAxODIsIDE5M10sXG4gICAgICAgICAgICBsaWdodHNhbG1vbjogWzI1NSwgMTYwLCAxMjJdLFxuICAgICAgICAgICAgbGlnaHRzZWFncmVlbjogWzMyLCAxNzgsIDE3MF0sXG4gICAgICAgICAgICBsaWdodHNreWJsdWU6IFsxMzUsIDIwNiwgMjUwXSxcbiAgICAgICAgICAgIGxpZ2h0c2xhdGVncmF5OiBbMTE5LCAxMzYsIDE1M10sXG4gICAgICAgICAgICBsaWdodHNsYXRlZ3JleTogWzExOSwgMTM2LCAxNTNdLFxuICAgICAgICAgICAgbGlnaHRzdGVlbGJsdWU6IFsxNzYsIDE5NiwgMjIyXSxcbiAgICAgICAgICAgIGxpZ2h0eWVsbG93OiBbMjU1LCAyNTUsIDIyNF0sXG4gICAgICAgICAgICBsaW1lOiBbMCwgMjU1LCAwXSxcbiAgICAgICAgICAgIGxpbWVncmVlbjogWzUwLCAyMDUsIDUwXSxcbiAgICAgICAgICAgIGxpbmVuOiBbMjUwLCAyNDAsIDIzMF0sXG4gICAgICAgICAgICBtYWdlbnRhOiBbMjU1LCAwLCAyNTVdLFxuICAgICAgICAgICAgbWFyb29uOiBbMTI4LCAwLCAwXSxcbiAgICAgICAgICAgIG1lZGl1bWFxdWFtYXJpbmU6IFsxMDIsIDIwNSwgMTcwXSxcbiAgICAgICAgICAgIG1lZGl1bWJsdWU6IFswLCAwLCAyMDVdLFxuICAgICAgICAgICAgbWVkaXVtb3JjaGlkOiBbMTg2LCA4NSwgMjExXSxcbiAgICAgICAgICAgIG1lZGl1bXB1cnBsZTogWzE0NywgMTEyLCAyMTldLFxuICAgICAgICAgICAgbWVkaXVtc2VhZ3JlZW46IFs2MCwgMTc5LCAxMTNdLFxuICAgICAgICAgICAgbWVkaXVtc2xhdGVibHVlOiBbMTIzLCAxMDQsIDIzOF0sXG4gICAgICAgICAgICBtZWRpdW1zcHJpbmdncmVlbjogWzAsIDI1MCwgMTU0XSxcbiAgICAgICAgICAgIG1lZGl1bXR1cnF1b2lzZTogWzcyLCAyMDksIDIwNF0sXG4gICAgICAgICAgICBtZWRpdW12aW9sZXRyZWQ6IFsxOTksIDIxLCAxMzNdLFxuICAgICAgICAgICAgbWlkbmlnaHRibHVlOiBbMjUsIDI1LCAxMTJdLFxuICAgICAgICAgICAgbWludGNyZWFtOiBbMjQ1LCAyNTUsIDI1MF0sXG4gICAgICAgICAgICBtaXN0eXJvc2U6IFsyNTUsIDIyOCwgMjI1XSxcbiAgICAgICAgICAgIG1vY2Nhc2luOiBbMjU1LCAyMjgsIDE4MV0sXG4gICAgICAgICAgICBuYXZham93aGl0ZTogWzI1NSwgMjIyLCAxNzNdLFxuICAgICAgICAgICAgbmF2eTogWzAsIDAsIDEyOF0sXG4gICAgICAgICAgICBvbGRsYWNlOiBbMjUzLCAyNDUsIDIzMF0sXG4gICAgICAgICAgICBvbGl2ZTogWzEyOCwgMTI4LCAwXSxcbiAgICAgICAgICAgIG9saXZlZHJhYjogWzEwNywgMTQyLCAzNV0sXG4gICAgICAgICAgICBvcmFuZ2U6IFsyNTUsIDE2NSwgMF0sXG4gICAgICAgICAgICBvcmFuZ2VyZWQ6IFsyNTUsIDY5LCAwXSxcbiAgICAgICAgICAgIG9yY2hpZDogWzIxOCwgMTEyLCAyMTRdLFxuICAgICAgICAgICAgcGFsZWdvbGRlbnJvZDogWzIzOCwgMjMyLCAxNzBdLFxuICAgICAgICAgICAgcGFsZWdyZWVuOiBbMTUyLCAyNTEsIDE1Ml0sXG4gICAgICAgICAgICBwYWxldHVycXVvaXNlOiBbMTc1LCAyMzgsIDIzOF0sXG4gICAgICAgICAgICBwYWxldmlvbGV0cmVkOiBbMjE5LCAxMTIsIDE0N10sXG4gICAgICAgICAgICBwYXBheWF3aGlwOiBbMjU1LCAyMzksIDIxM10sXG4gICAgICAgICAgICBwZWFjaHB1ZmY6IFsyNTUsIDIxOCwgMTg1XSxcbiAgICAgICAgICAgIHBlcnU6IFsyMDUsIDEzMywgNjNdLFxuICAgICAgICAgICAgcGluazogWzI1NSwgMTkyLCAyMDNdLFxuICAgICAgICAgICAgcGx1bTogWzIyMSwgMTYwLCAyMDNdLFxuICAgICAgICAgICAgcG93ZGVyYmx1ZTogWzE3NiwgMjI0LCAyMzBdLFxuICAgICAgICAgICAgcHVycGxlOiBbMTI4LCAwLCAxMjhdLFxuICAgICAgICAgICAgcmViZWNjYXB1cnBsZTogWzEwMiwgNTEsIDE1M10sXG4gICAgICAgICAgICByZWQ6IFsyNTUsIDAsIDBdLFxuICAgICAgICAgICAgcm9zeWJyb3duOiBbMTg4LCAxNDMsIDE0M10sXG4gICAgICAgICAgICByb3lhbGJsdWU6IFs2NSwgMTA1LCAyMjVdLFxuICAgICAgICAgICAgc2FkZGxlYnJvd246IFsxMzksIDY5LCAxOV0sXG4gICAgICAgICAgICBzYWxtb246IFsyNTAsIDEyOCwgMTE0XSxcbiAgICAgICAgICAgIHNhbmR5YnJvd246IFsyNDQsIDE2NCwgOTZdLFxuICAgICAgICAgICAgc2VhZ3JlZW46IFs0NiwgMTM5LCA4N10sXG4gICAgICAgICAgICBzZWFzaGVsbDogWzI1NSwgMjQ1LCAyMzhdLFxuICAgICAgICAgICAgc2llbm5hOiBbMTYwLCA4MiwgNDVdLFxuICAgICAgICAgICAgc2lsdmVyOiBbMTkyLCAxOTIsIDE5Ml0sXG4gICAgICAgICAgICBza3libHVlOiBbMTM1LCAyMDYsIDIzNV0sXG4gICAgICAgICAgICBzbGF0ZWJsdWU6IFsxMDYsIDkwLCAyMDVdLFxuICAgICAgICAgICAgc2xhdGVncmF5OiBbMTE5LCAxMjgsIDE0NF0sXG4gICAgICAgICAgICBzbGF0ZWdyZXk6IFsxMTksIDEyOCwgMTQ0XSxcbiAgICAgICAgICAgIHNub3c6IFsyNTUsIDI1NSwgMjUwXSxcbiAgICAgICAgICAgIHNwcmluZ2dyZWVuOiBbMCwgMjU1LCAxMjddLFxuICAgICAgICAgICAgc3RlZWxibHVlOiBbNzAsIDEzMCwgMTgwXSxcbiAgICAgICAgICAgIHRhbjogWzIxMCwgMTgwLCAxNDBdLFxuICAgICAgICAgICAgdGVhbDogWzAsIDEyOCwgMTI4XSxcbiAgICAgICAgICAgIHRoaXN0bGU6IFsyMTYsIDE5MSwgMjE2XSxcbiAgICAgICAgICAgIHRyYW5zcGFyZW50OiBbMjU1LCAyNTUsIDI1NSwgMF0sXG4gICAgICAgICAgICB0b21hdG86IFsyNTUsIDk5LCA3MV0sXG4gICAgICAgICAgICB0dXJxdW9pc2U6IFs2NCwgMjI0LCAyMDhdLFxuICAgICAgICAgICAgdmlvbGV0OiBbMjM4LCAxMzAsIDIzOF0sXG4gICAgICAgICAgICB3aGVhdDogWzI0NSwgMjIyLCAxNzldLFxuICAgICAgICAgICAgd2hpdGU6IFsyNTUsIDI1NSwgMjU1XSxcbiAgICAgICAgICAgIHdoaXRlc21va2U6IFsyNDUsIDI0NSwgMjQ1XSxcbiAgICAgICAgICAgIHllbGxvdzogWzI1NSwgMjU1LCAwXSxcbiAgICAgICAgICAgIHllbGxvd2dyZWVuOiBbMTU0LCAyMDUsIDVdXG4gICAgICAgIH0sXG5cbiAgICAgICAgUkdCX1JFR0VYID0gL3JnYlxcKChcXGR7MSwzfSksKFxcZHsxLDN9KSwoXFxkezEsM30pXFwpLztcblxuICAgIC8qKlxuICAgICAqIEBuYW1lc3BhY2UgVXRpbFxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqL1xuICAgIEtvbnZhLlV0aWwgPSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGNoZXJyeS1waWNrZWQgdXRpbGl0aWVzIGZyb20gdW5kZXJzY29yZS5qc1xuICAgICAgICAgKi9cbiAgICAgICAgX2lzRWxlbWVudDogZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PSAxKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2lzRnVuY3Rpb246IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuICEhKG9iaiAmJiBvYmouY29uc3RydWN0b3IgJiYgb2JqLmNhbGwgJiYgb2JqLmFwcGx5KTtcbiAgICAgICAgfSxcbiAgICAgICAgX2lzT2JqZWN0OiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAoISFvYmogJiYgb2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QpO1xuICAgICAgICB9LFxuICAgICAgICBfaXNBcnJheTogZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09IE9CSkVDVF9BUlJBWTtcbiAgICAgICAgfSxcbiAgICAgICAgX2lzTnVtYmVyOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gT0JKRUNUX05VTUJFUjtcbiAgICAgICAgfSxcbiAgICAgICAgX2lzU3RyaW5nOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gT0JKRUNUX1NUUklORztcbiAgICAgICAgfSxcbiAgICAgICAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlXG4gICAgICAgIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1blxuICAgICAgICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247XG4gICAgICAgIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzXG4gICAgICAgIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLlxuICAgICAgICBfdGhyb3R0bGU6IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIG9wdHMpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7XG4gICAgICAgICAgICB2YXIgdGltZW91dCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXMgPSAwO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBvcHRzIHx8IHt9O1xuICAgICAgICAgICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFwcmV2aW91cyAmJiBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0gbm93O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcmVtYWluaW5nID0gd2FpdCAtIChub3cgLSBwcmV2aW91cyk7XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSBub3c7XG4gICAgICAgICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRpbWVvdXQgJiYgb3B0aW9ucy50cmFpbGluZyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCByZW1haW5pbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgLypcbiAgICAgICAgICogb3RoZXIgdXRpbHNcbiAgICAgICAgICovXG4gICAgICAgIF9oYXNNZXRob2RzOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHZhciBuYW1lcyA9IFtdLFxuICAgICAgICAgICAgICAgIGtleTtcblxuICAgICAgICAgICAgZm9yKGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZih0aGlzLl9pc0Z1bmN0aW9uKG9ialtrZXldKSkge1xuICAgICAgICAgICAgICAgICAgICBuYW1lcy5wdXNoKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hbWVzLmxlbmd0aCA+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGlzVmFsaWRTZWxlY3RvcjogZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpcnN0Q2hhciA9IHNlbGVjdG9yWzBdO1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0Q2hhciA9PT0gJyMnIHx8IGZpcnN0Q2hhciA9PT0gJy4nIHx8IGZpcnN0Q2hhciA9PT0gZmlyc3RDaGFyLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZUNhbnZhc0VsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IEtvbnZhLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgICAgICAgLy8gb24gc29tZSBlbnZpcm9ubWVudHMgY2FudmFzLnN0eWxlIGlzIHJlYWRvbmx5XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbnZhcy5zdHlsZSA9IGNhbnZhcy5zdHlsZSB8fCB7fTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjYW52YXM7XG4gICAgICAgIH0sXG4gICAgICAgIGlzQnJvd3NlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKHR5cGVvZiBleHBvcnRzICE9PSAnb2JqZWN0Jyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9pc0luRG9jdW1lbnQ6IGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICB3aGlsZShlbCA9IGVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZihlbCA9PSBLb252YS5kb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIF9zaW1wbGlmeUFycmF5OiBmdW5jdGlvbihhcnIpIHtcbiAgICAgICAgICAgIHZhciByZXRBcnIgPSBbXSxcbiAgICAgICAgICAgICAgICBsZW4gPSBhcnIubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHV0aWwgPSBLb252YS5VdGlsLFxuICAgICAgICAgICAgICAgIG4sIHZhbDtcblxuICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gYXJyW25dO1xuICAgICAgICAgICAgICAgIGlmICh1dGlsLl9pc051bWJlcih2YWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IE1hdGgucm91bmQodmFsICogMTAwMCkgLyAxMDAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICghdXRpbC5faXNTdHJpbmcodmFsKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXRBcnIucHVzaCh2YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmV0QXJyO1xuICAgICAgICB9LFxuICAgICAgICAvKlxuICAgICAgICAgKiBhcmcgY2FuIGJlIGFuIGltYWdlIG9iamVjdCBvciBpbWFnZSBkYXRhXG4gICAgICAgICAqL1xuICAgICAgICBfZ2V0SW1hZ2U6IGZ1bmN0aW9uKGFyZywgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBpbWFnZU9iaiwgY2FudmFzO1xuXG4gICAgICAgICAgICAvLyBpZiBhcmcgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgICAgICAgIGlmKCFhcmcpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgYXJnIGlzIGFscmVhZHkgYW4gaW1hZ2Ugb2JqZWN0XG4gICAgICAgICAgICBlbHNlIGlmKHRoaXMuX2lzRWxlbWVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soYXJnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgYXJnIGlzIGEgc3RyaW5nLCB0aGVuIGl0J3MgYSBkYXRhIHVybFxuICAgICAgICAgICAgZWxzZSBpZih0aGlzLl9pc1N0cmluZyhhcmcpKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VPYmogPSBuZXcgS29udmEud2luZG93LkltYWdlKCk7XG4gICAgICAgICAgICAgICAgaW1hZ2VPYmoub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGltYWdlT2JqKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGltYWdlT2JqLnNyYyA9IGFyZztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pZiBhcmcgaXMgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGRhdGEgcHJvcGVydHksIGl0J3MgYW4gaW1hZ2Ugb2JqZWN0XG4gICAgICAgICAgICBlbHNlIGlmKGFyZy5kYXRhKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gYXJnLndpZHRoO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBhcmcuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIHZhciBfY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KENPTlRFWFRfMkQpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0LnB1dEltYWdlRGF0YShhcmcsIDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMuX2dldEltYWdlKGNhbnZhcy50b0RhdGFVUkwoKSwgY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRSR0JBU3RyaW5nOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIHZhciByZWQgPSBvYmoucmVkIHx8IDAsXG4gICAgICAgICAgICAgICAgZ3JlZW4gPSBvYmouZ3JlZW4gfHwgMCxcbiAgICAgICAgICAgICAgICBibHVlID0gb2JqLmJsdWUgfHwgMCxcbiAgICAgICAgICAgICAgICBhbHBoYSA9IG9iai5hbHBoYSB8fCAxO1xuXG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgICdyZ2JhKCcsXG4gICAgICAgICAgICAgICAgcmVkLFxuICAgICAgICAgICAgICAgICcsJyxcbiAgICAgICAgICAgICAgICBncmVlbixcbiAgICAgICAgICAgICAgICAnLCcsXG4gICAgICAgICAgICAgICAgYmx1ZSxcbiAgICAgICAgICAgICAgICAnLCcsXG4gICAgICAgICAgICAgICAgYWxwaGEsXG4gICAgICAgICAgICAgICAgJyknXG4gICAgICAgICAgICBdLmpvaW4oRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3JnYlRvSGV4OiBmdW5jdGlvbihyLCBnLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gKCgxIDw8IDI0KSArIChyIDw8IDE2KSArIChnIDw8IDgpICsgYikudG9TdHJpbmcoMTYpLnNsaWNlKDEpO1xuICAgICAgICB9LFxuICAgICAgICBfaGV4VG9SZ2I6IGZ1bmN0aW9uKGhleCkge1xuICAgICAgICAgICAgaGV4ID0gaGV4LnJlcGxhY2UoSEFTSCwgRU1QVFlfU1RSSU5HKTtcbiAgICAgICAgICAgIHZhciBiaWdpbnQgPSBwYXJzZUludChoZXgsIDE2KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcjogKGJpZ2ludCA+PiAxNikgJiAyNTUsXG4gICAgICAgICAgICAgICAgZzogKGJpZ2ludCA+PiA4KSAmIDI1NSxcbiAgICAgICAgICAgICAgICBiOiBiaWdpbnQgJiAyNTVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gcmFuZG9tIGhleCBjb2xvclxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5VdGlsLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0UmFuZG9tQ29sb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHJhbmRDb2xvciA9IChNYXRoLnJhbmRvbSgpICogMHhGRkZGRkYgPDwgMCkudG9TdHJpbmcoMTYpO1xuICAgICAgICAgICAgd2hpbGUgKHJhbmRDb2xvci5sZW5ndGggPCA2KSB7XG4gICAgICAgICAgICAgICAgcmFuZENvbG9yID0gWkVSTyArIHJhbmRDb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBIQVNIICsgcmFuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIHZhbHVlIHdpdGggZGVmYXVsdCBmYWxsYmFja1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5VdGlsLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbih2YWwsIGRlZikge1xuICAgICAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgUkdCIGNvbXBvbmVudHMgb2YgYSBjb2xvclxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5VdGlsLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29sb3JcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogLy8gZWFjaCBvZiB0aGUgZm9sbG93aW5nIGV4YW1wbGVzIHJldHVybiB7cjowLCBnOjAsIGI6MjU1fVxuICAgICAgICAgKiB2YXIgcmdiID0gS29udmEuVXRpbC5nZXRSR0IoJ2JsdWUnKTtcbiAgICAgICAgICogdmFyIHJnYiA9IEtvbnZhLlV0aWwuZ2V0UkdCKCcjMDAwMGZmJyk7XG4gICAgICAgICAqIHZhciByZ2IgPSBLb252YS5VdGlsLmdldFJHQigncmdiKDAsMCwyNTUpJyk7XG4gICAgICAgICAqL1xuICAgICAgICBnZXRSR0I6IGZ1bmN0aW9uKGNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgcmdiO1xuICAgICAgICAgICAgLy8gY29sb3Igc3RyaW5nXG4gICAgICAgICAgICBpZiAoY29sb3IgaW4gQ09MT1JTKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gQ09MT1JTW2NvbG9yXTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByOiByZ2JbMF0sXG4gICAgICAgICAgICAgICAgICAgIGc6IHJnYlsxXSxcbiAgICAgICAgICAgICAgICAgICAgYjogcmdiWzJdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGhleFxuICAgICAgICAgICAgZWxzZSBpZiAoY29sb3JbMF0gPT09IEhBU0gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGV4VG9SZ2IoY29sb3Iuc3Vic3RyaW5nKDEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHJnYiBzdHJpbmdcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbG9yLnN1YnN0cigwLCA0KSA9PT0gUkdCX1BBUkVOKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gUkdCX1JFR0VYLmV4ZWMoY29sb3IucmVwbGFjZSgvIC9nLCAnJykpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHI6IHBhcnNlSW50KHJnYlsxXSwgMTApLFxuICAgICAgICAgICAgICAgICAgICBnOiBwYXJzZUludChyZ2JbMl0sIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgYjogcGFyc2VJbnQocmdiWzNdLCAxMClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZGVmYXVsdFxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcjogMCxcbiAgICAgICAgICAgICAgICAgICAgZzogMCxcbiAgICAgICAgICAgICAgICAgICAgYjogMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGNvbnZlcnQgYW55IGNvbG9yIHN0cmluZyB0byBSR0JBIG9iamVjdFxuICAgICAgICAvLyBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9jb21wb25lbnQvY29sb3ItcGFyc2VyXG4gICAgICAgIGNvbG9yVG9SR0JBOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIHN0ciA9IHN0ciB8fCAnYmxhY2snO1xuICAgICAgICAgICAgcmV0dXJuIEtvbnZhLlV0aWwuX25hbWVkQ29sb3JUb1JCQShzdHIpXG4gICAgICAgICAgICAgICAgfHwgS29udmEuVXRpbC5faGV4M0NvbG9yVG9SR0JBKHN0cilcbiAgICAgICAgICAgICAgICB8fCBLb252YS5VdGlsLl9oZXg2Q29sb3JUb1JHQkEoc3RyKVxuICAgICAgICAgICAgICAgIHx8IEtvbnZhLlV0aWwuX3JnYkNvbG9yVG9SR0JBKHN0cilcbiAgICAgICAgICAgICAgICB8fCBLb252YS5VdGlsLl9yZ2JhQ29sb3JUb1JHQkEoc3RyKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gUGFyc2UgbmFtZWQgY3NzIGNvbG9yLiBMaWtlIFwiZ3JlZW5cIlxuICAgICAgICBfbmFtZWRDb2xvclRvUkJBOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIHZhciBjID0gQ09MT1JTW3N0ci50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgICAgIGlmICghYykge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByOiBjWzBdLFxuICAgICAgICAgICAgICAgIGc6IGNbMV0sXG4gICAgICAgICAgICAgICAgYjogY1syXSxcbiAgICAgICAgICAgICAgICBhOiAxXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAvLyBQYXJzZSByZ2IobiwgbiwgbilcbiAgICAgICAgX3JnYkNvbG9yVG9SR0JBOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIGlmIChzdHIuaW5kZXhPZigncmdiKCcpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gc3RyLm1hdGNoKC9yZ2JcXCgoW14pXSspXFwpLylbMV07XG4gICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gc3RyLnNwbGl0KC8gKiwgKi8pLm1hcChOdW1iZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHI6IHBhcnRzWzBdLFxuICAgICAgICAgICAgICAgICAgICBnOiBwYXJ0c1sxXSxcbiAgICAgICAgICAgICAgICAgICAgYjogcGFydHNbMl0sXG4gICAgICAgICAgICAgICAgICAgIGE6IDFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBQYXJzZSByZ2JhKG4sIG4sIG4sIG4pXG4gICAgICAgIF9yZ2JhQ29sb3JUb1JHQkE6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgaWYgKHN0ci5pbmRleE9mKCdyZ2JhKCcpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gc3RyLm1hdGNoKC9yZ2JhXFwoKFteKV0rKVxcKS8pWzFdO1xuICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IHN0ci5zcGxpdCgvICosICovKS5tYXAoTnVtYmVyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByOiBwYXJ0c1swXSxcbiAgICAgICAgICAgICAgICAgICAgZzogcGFydHNbMV0sXG4gICAgICAgICAgICAgICAgICAgIGI6IHBhcnRzWzJdLFxuICAgICAgICAgICAgICAgICAgICBhOiBwYXJ0c1szXVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgLy8gUGFyc2UgI25ubm5ublxuICAgICAgICBfaGV4NkNvbG9yVG9SR0JBOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIGlmICgoc3RyWzBdID09PSAnIycpICYmIChzdHIubGVuZ3RoID09PSA3KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHI6IHBhcnNlSW50KHN0ci5zbGljZSgxLCAzKSwgMTYpLFxuICAgICAgICAgICAgICAgICAgICBnOiBwYXJzZUludChzdHIuc2xpY2UoMywgNSksIDE2KSxcbiAgICAgICAgICAgICAgICAgICAgYjogcGFyc2VJbnQoc3RyLnNsaWNlKDUsIDcpLCAxNiksXG4gICAgICAgICAgICAgICAgICAgIGE6IDFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBQYXJzZSAjbm5uXG4gICAgICAgIF9oZXgzQ29sb3JUb1JHQkE6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgaWYgKChzdHJbMF0gPT09ICcjJykgJiYgKHN0ci5sZW5ndGggPT09IDQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcjogcGFyc2VJbnQoc3RyWzFdICsgc3RyWzFdLCAxNiksXG4gICAgICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50KHN0clsyXSArIHN0clsyXSwgMTYpLFxuICAgICAgICAgICAgICAgICAgICBiOiBwYXJzZUludChzdHJbM10gKyBzdHJbM10sIDE2KSxcbiAgICAgICAgICAgICAgICAgICAgYTogMVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIG8xIHRha2VzIHByZWNlZGVuY2Ugb3ZlciBvMlxuICAgICAgICBfbWVyZ2U6IGZ1bmN0aW9uKG8xLCBvMikge1xuICAgICAgICAgICAgdmFyIHJldE9iaiA9IHRoaXMuX2Nsb25lKG8yKTtcbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluIG8xKSB7XG4gICAgICAgICAgICAgICAgaWYodGhpcy5faXNPYmplY3QobzFba2V5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0T2JqW2tleV0gPSB0aGlzLl9tZXJnZShvMVtrZXldLCByZXRPYmpba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXRPYmpba2V5XSA9IG8xW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldE9iajtcbiAgICAgICAgfSxcbiAgICAgICAgY2xvbmVPYmplY3Q6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgdmFyIHJldE9iaiA9IHt9O1xuICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYodGhpcy5faXNPYmplY3Qob2JqW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldE9ialtrZXldID0gdGhpcy5jbG9uZU9iamVjdChvYmpba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX2lzQXJyYXkob2JqW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldE9ialtrZXldID0gdGhpcy5jbG9uZUFycmF5KG9ialtrZXldKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXRPYmpba2V5XSA9IG9ialtrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXRPYmo7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb25lQXJyYXk6IGZ1bmN0aW9uKGFycikge1xuICAgICAgICAgICAgcmV0dXJuIGFyci5zbGljZSgwKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2RlZ1RvUmFkOiBmdW5jdGlvbihkZWcpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWcgKiBQSV9PVkVSX0RFRzE4MDtcbiAgICAgICAgfSxcbiAgICAgICAgX3JhZFRvRGVnOiBmdW5jdGlvbihyYWQpIHtcbiAgICAgICAgICAgIHJldHVybiByYWQgKiBERUcxODBfT1ZFUl9QSTtcbiAgICAgICAgfSxcbiAgICAgICAgX2NhcGl0YWxpemU6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGhyb3c6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEtPTlZBX0VSUk9SICsgc3RyKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoS09OVkFfRVJST1IgKyBzdHIpO1xuICAgICAgICB9LFxuICAgICAgICB3YXJuOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBJRTkgb24gV2luZG93czcgNjRiaXQgd2lsbCB0aHJvdyBhIEpTIGVycm9yXG4gICAgICAgICAgICAgKiBpZiB3ZSBkb24ndCB1c2Ugd2luZG93LmNvbnNvbGUgaW4gdGhlIGNvbmRpdGlvbmFsXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmKEtvbnZhLmdsb2JhbC5jb25zb2xlICYmIGNvbnNvbGUud2FybiAmJiBLb252YS5zaG93V2FybmluZ3MpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oS09OVkFfV0FSTklORyArIHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGV4dGVuZDogZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gQ3RvcigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBDdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7XG4gICAgICAgICAgICB2YXIgb2xkUHJvdG8gPSBjaGlsZC5wcm90b3R5cGU7XG4gICAgICAgICAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgQ3RvcigpO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9sZFByb3RvKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9sZFByb3RvLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQucHJvdG90eXBlW2tleV0gPSBvbGRQcm90b1trZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7XG4gICAgICAgICAgICAvLyBjcmVhdGUgcmVmZXJlbmNlIHRvIHBhcmVudFxuICAgICAgICAgICAgY2hpbGQuc3VwZXIgPSBwYXJlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBhZGRzIG1ldGhvZHMgdG8gYSBjb25zdHJ1Y3RvciBwcm90b3R5cGVcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVXRpbC5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29uc3RydWN0b3JcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IG1ldGhvZHNcbiAgICAgICAgICovXG4gICAgICAgIGFkZE1ldGhvZHM6IGZ1bmN0aW9uKGNvbnN0cnVjdG9yLCBtZXRob2RzKSB7XG4gICAgICAgICAgICB2YXIga2V5O1xuXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBtZXRob2RzKSB7XG4gICAgICAgICAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlW2tleV0gPSBtZXRob2RzW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRDb250cm9sUG9pbnRzOiBmdW5jdGlvbih4MCwgeTAsIHgxLCB5MSwgeDIsIHkyLCB0KSB7XG4gICAgICAgICAgICB2YXIgZDAxID0gTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDAsIDIpICsgTWF0aC5wb3coeTEgLSB5MCwgMikpLFxuICAgICAgICAgICAgICAgIGQxMiA9IE1hdGguc3FydChNYXRoLnBvdyh4MiAtIHgxLCAyKSArIE1hdGgucG93KHkyIC0geTEsIDIpKSxcbiAgICAgICAgICAgICAgICBmYSA9IHQgKiBkMDEgLyAoZDAxICsgZDEyKSxcbiAgICAgICAgICAgICAgICBmYiA9IHQgKiBkMTIgLyAoZDAxICsgZDEyKSxcbiAgICAgICAgICAgICAgICBwMXggPSB4MSAtIGZhICogKHgyIC0geDApLFxuICAgICAgICAgICAgICAgIHAxeSA9IHkxIC0gZmEgKiAoeTIgLSB5MCksXG4gICAgICAgICAgICAgICAgcDJ4ID0geDEgKyBmYiAqICh4MiAtIHgwKSxcbiAgICAgICAgICAgICAgICBwMnkgPSB5MSArIGZiICogKHkyIC0geTApO1xuXG4gICAgICAgICAgICByZXR1cm4gW3AxeCwgcDF5LCBwMngsIHAyeV07XG4gICAgICAgIH0sXG4gICAgICAgIF9leHBhbmRQb2ludHM6IGZ1bmN0aW9uKHAsIHRlbnNpb24pIHtcbiAgICAgICAgICAgIHZhciBsZW4gPSBwLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhbGxQb2ludHMgPSBbXSxcbiAgICAgICAgICAgICAgICBuLCBjcDtcblxuICAgICAgICAgICAgZm9yIChuID0gMjsgbiA8IGxlbiAtIDI7IG4gKz0gMikge1xuICAgICAgICAgICAgICAgIGNwID0gS29udmEuVXRpbC5fZ2V0Q29udHJvbFBvaW50cyhwW24gLSAyXSwgcFtuIC0gMV0sIHBbbl0sIHBbbiArIDFdLCBwW24gKyAyXSwgcFtuICsgM10sIHRlbnNpb24pO1xuICAgICAgICAgICAgICAgIGFsbFBvaW50cy5wdXNoKGNwWzBdKTtcbiAgICAgICAgICAgICAgICBhbGxQb2ludHMucHVzaChjcFsxXSk7XG4gICAgICAgICAgICAgICAgYWxsUG9pbnRzLnB1c2gocFtuXSk7XG4gICAgICAgICAgICAgICAgYWxsUG9pbnRzLnB1c2gocFtuICsgMV0pO1xuICAgICAgICAgICAgICAgIGFsbFBvaW50cy5wdXNoKGNwWzJdKTtcbiAgICAgICAgICAgICAgICBhbGxQb2ludHMucHVzaChjcFszXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhbGxQb2ludHM7XG4gICAgICAgIH0sXG4gICAgICAgIF9yZW1vdmVMYXN0TGV0dGVyOiBmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIHN0ci5sZW5ndGggLSAxKTtcbiAgICAgICAgfSxcbiAgICAgICAgZWFjaDogZnVuY3Rpb24ob2JqLCBmdW5jKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgZnVuYyhrZXksIG9ialtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldFByb2plY3Rpb25Ub1NlZ21lbnQ6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCB4MywgeTMpIHtcbiAgICAgICAgICAgIHZhciB4LCB5LCBkaXN0O1xuXG4gICAgICAgICAgICB2YXIgcGQyID0gKHgxIC0geDIpICogKHgxIC0geDIpICsgKHkxIC0geTIpICogKHkxIC0geTIpO1xuICAgICAgICAgICAgaWYocGQyID09IDApIHtcbiAgICAgICAgICAgICAgICB4ID0geDE7XG4gICAgICAgICAgICAgICAgeSA9IHkxO1xuICAgICAgICAgICAgICAgIGRpc3QgPSAoeDMgLSB4MikgKiAoeDMgLSB4MikgKyAoeTMgLSB5MikgKiAoeTMgLSB5Mik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB1ID0gKCh4MyAtIHgxKSAqICh4MiAtIHgxKSArICh5MyAtIHkxKSAqICh5MiAtIHkxKSkgLyBwZDI7XG4gICAgICAgICAgICAgICAgaWYodSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IHgxO1xuICAgICAgICAgICAgICAgICAgICB5ID0geTE7XG4gICAgICAgICAgICAgICAgICAgIGRpc3QgPSAoeDEgLSB4MykgKiAoeDEgLSB4MykgKyAoeTEgLSB5MykgKiAoeTEgLSB5Myk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1ID4gMS4wKSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4MjtcbiAgICAgICAgICAgICAgICAgICAgeSA9IHkyO1xuICAgICAgICAgICAgICAgICAgICBkaXN0ID0gKHgyIC0geDMpICogKHgyIC0geDMpICsgKHkyIC0geTMpICogKHkyIC0geTMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSB4MSArIHUgKiAoeDIgLSB4MSk7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB5MSArIHUgKiAoeTIgLSB5MSk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3QgPSAoeCAtIHgzKSAqICh4IC0geDMpICsgKHkgLSB5MykgKiAoeSAtIHkzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW3gsIHksIGRpc3RdO1xuICAgICAgICB9LFxuICAgICAgICAvLyBsaW5lIGFzIGFycmF5IG9mIHBvaW50cy5cbiAgICAgICAgLy8gbGluZSBtaWdodCBiZSBjbG9zZWRcbiAgICAgICAgX2dldFByb2plY3Rpb25Ub0xpbmU6IGZ1bmN0aW9uKHB0LCBsaW5lLCBpc0Nsb3NlZCkge1xuICAgICAgICAgICAgdmFyIHBjID0gS29udmEuVXRpbC5jbG9uZU9iamVjdChwdCk7XG4gICAgICAgICAgICB2YXIgZGlzdCA9IE51bWJlci5NQVhfVkFMVUU7XG4gICAgICAgICAgICBsaW5lLmZvckVhY2goZnVuY3Rpb24ocDEsIGkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQ2xvc2VkICYmIGkgPT09IGxpbmUubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwMiA9IGxpbmVbKGkgKyAxKSAlIGxpbmUubGVuZ3RoXTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvaiA9IEtvbnZhLlV0aWwuX2dldFByb2plY3Rpb25Ub1NlZ21lbnQocDEueCwgcDEueSwgcDIueCwgcDIueSwgcHQueCwgcHQueSk7XG4gICAgICAgICAgICAgICAgdmFyIHB4ID0gcHJvalswXSwgcHkgPSBwcm9qWzFdLCBwZGlzdCA9IHByb2pbMl07XG4gICAgICAgICAgICAgICAgaWYgKHBkaXN0IDwgZGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBwYy54ID0gcHg7XG4gICAgICAgICAgICAgICAgICAgIHBjLnkgPSBweTtcbiAgICAgICAgICAgICAgICAgICAgZGlzdCA9IHBkaXN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHBjO1xuICAgICAgICB9LFxuICAgICAgICBfcHJlcGFyZUFycmF5Rm9yVHdlZW46IGZ1bmN0aW9uKHN0YXJ0QXJyYXksIGVuZEFycmF5LCBpc0Nsb3NlZCkge1xuICAgICAgICAgICAgdmFyIG4sIHN0YXJ0ID0gW10sIGVuZCA9IFtdO1xuICAgICAgICAgICAgaWYgKHN0YXJ0QXJyYXkubGVuZ3RoID4gZW5kQXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBlbmRBcnJheTtcbiAgICAgICAgICAgICAgICBlbmRBcnJheSA9IHN0YXJ0QXJyYXk7XG4gICAgICAgICAgICAgICAgc3RhcnRBcnJheSA9IHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgc3RhcnRBcnJheS5sZW5ndGg7IG4gKz0gMikge1xuICAgICAgICAgICAgICAgIHN0YXJ0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB4OiBzdGFydEFycmF5W25dLFxuICAgICAgICAgICAgICAgICAgICB5OiBzdGFydEFycmF5W24gKyAxXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGVuZEFycmF5Lmxlbmd0aDsgbiArPSAyKSB7XG4gICAgICAgICAgICAgICAgZW5kLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB4OiBlbmRBcnJheVtuXSxcbiAgICAgICAgICAgICAgICAgICAgeTogZW5kQXJyYXlbbiArIDFdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgdmFyIG5ld1N0YXJ0ID0gW107XG4gICAgICAgICAgICBlbmQuZm9yRWFjaChmdW5jdGlvbihwb2ludCkge1xuICAgICAgICAgICAgICAgIHZhciBwciA9IEtvbnZhLlV0aWwuX2dldFByb2plY3Rpb25Ub0xpbmUocG9pbnQsIHN0YXJ0LCBpc0Nsb3NlZCk7XG4gICAgICAgICAgICAgICAgbmV3U3RhcnQucHVzaChwci54KTtcbiAgICAgICAgICAgICAgICBuZXdTdGFydC5wdXNoKHByLnkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3U3RhcnQ7XG4gICAgICAgIH0sXG4gICAgICAgIF9wcmVwYXJlVG9TdHJpbmdpZnk6IGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgdmFyIGRlc2M7XG5cbiAgICAgICAgICAgIG9iai52aXNpdGVkQnlDaXJjdWxhclJlZmVyZW5jZVJlbW92YWwgPSB0cnVlO1xuXG4gICAgICAgICAgICBmb3IodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoIShvYmouaGFzT3duUHJvcGVydHkoa2V5KSAmJiBvYmpba2V5XSAmJiB0eXBlb2Ygb2JqW2tleV0gPT0gJ29iamVjdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7XG4gICAgICAgICAgICAgICAgaWYgKG9ialtrZXldLnZpc2l0ZWRCeUNpcmN1bGFyUmVmZXJlbmNlUmVtb3ZhbCB8fCBLb252YS5VdGlsLl9pc0VsZW1lbnQob2JqW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXNjLmNvbmZpZ3VyYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9ialtrZXldO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEtvbnZhLlV0aWwuX3ByZXBhcmVUb1N0cmluZ2lmeShvYmpba2V5XSkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc2MuY29uZmlndXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb2JqW2tleV07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVsZXRlIG9iai52aXNpdGVkQnlDaXJjdWxhclJlZmVyZW5jZVJlbW92YWw7XG5cbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyBjYWxjdWxhdGUgcGl4ZWwgcmF0aW9cbiAgICB2YXIgY2FudmFzID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCksXG4gICAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSxcbiAgICAgICAgX3BpeGVsUmF0aW8gPSAoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBkZXZpY2VQaXhlbFJhdGlvID0gS29udmEud2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSxcbiAgICAgICAgICAgIGJhY2tpbmdTdG9yZVJhdGlvID0gY29udGV4dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvXG4gICAgICAgICAgICAgICAgfHwgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvXG4gICAgICAgICAgICAgICAgfHwgY29udGV4dC5tc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW9cbiAgICAgICAgICAgICAgICB8fCBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvXG4gICAgICAgICAgICAgICAgfHwgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvXG4gICAgICAgICAgICAgICAgfHwgMTtcbiAgICAgICAgICAgIHJldHVybiBkZXZpY2VQaXhlbFJhdGlvIC8gYmFja2luZ1N0b3JlUmF0aW87XG4gICAgICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBDYW52YXMgUmVuZGVyZXIgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYWJzdHJhY3RcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy53aWR0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb25maWcuaGVpZ2h0XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5waXhlbFJhdGlvIEtvbnZhSlMgYXV0b21hdGljYWxseSBoYW5kbGVzIHBpeGVsIHJhdGlvIGFkanVzdG1lbnRzIGluIG9yZGVyIHRvIHJlbmRlciBjcmlzcCBkcmF3aW5nc1xuICAgICAqICBvbiBhbGwgZGV2aWNlcy4gTW9zdCBkZXNrdG9wcywgbG93IGVuZCB0YWJsZXRzLCBhbmQgbG93IGVuZCBwaG9uZXMsIGhhdmUgZGV2aWNlIHBpeGVsIHJhdGlvc1xuICAgICAqICBvZiAxLiAgU29tZSBoaWdoIGVuZCB0YWJsZXRzIGFuZCBwaG9uZXMsIGxpa2UgaVBob25lcyBhbmQgaVBhZHMgKG5vdCB0aGUgbWluaSkgaGF2ZSBhIGRldmljZSBwaXhlbCByYXRpb1xuICAgICAqICBvZiAyLiAgU29tZSBNYWNib29rIFByb3MsIGFuZCBpTWFjcyBhbHNvIGhhdmUgYSBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgMi4gIFNvbWUgaGlnaCBlbmQgQW5kcm9pZCBkZXZpY2VzIGhhdmUgcGl4ZWxcbiAgICAgKiAgcmF0aW9zIG9mIDIgb3IgMy4gIFNvbWUgYnJvd3NlcnMgbGlrZSBGaXJlZm94IGFsbG93IHlvdSB0byBjb25maWd1cmUgdGhlIHBpeGVsIHJhdGlvIG9mIHRoZSB2aWV3cG9ydC4gIFVubGVzcyBvdGhlcndpc2VcbiAgICAgKiAgc3BlY2lmaWVkLCB0aGUgcGl4ZWwgcmF0aW8gd2lsbCBiZSBkZWZhdWx0ZWQgdG8gdGhlIGFjdHVhbCBkZXZpY2UgcGl4ZWwgcmF0aW8uICBZb3UgY2FuIG92ZXJyaWRlIHRoZSBkZXZpY2UgcGl4ZWxcbiAgICAgKiAgcmF0aW8gZm9yIHNwZWNpYWwgc2l0dWF0aW9ucywgb3IsIGlmIHlvdSBkb24ndCB3YW50IHRoZSBwaXhlbCByYXRpbyB0byBiZSB0YWtlbiBpbnRvIGFjY291bnQsIHlvdSBjYW4gc2V0IGl0IHRvIDEuXG4gICAgICovXG4gICAgS29udmEuQ2FudmFzID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuaW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5DYW52YXMucHJvdG90eXBlID0ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIHZhciBjb25mID0gY29uZmlnIHx8IHt9O1xuXG4gICAgICAgICAgICB2YXIgcGl4ZWxSYXRpbyA9IGNvbmYucGl4ZWxSYXRpbyB8fCBLb252YS5waXhlbFJhdGlvIHx8IF9waXhlbFJhdGlvO1xuXG4gICAgICAgICAgICB0aGlzLnBpeGVsUmF0aW8gPSBwaXhlbFJhdGlvO1xuICAgICAgICAgICAgdGhpcy5fY2FudmFzID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG5cbiAgICAgICAgICAgIC8vIHNldCBpbmxpbmUgc3R5bGVzXG4gICAgICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUucGFkZGluZyA9IDA7XG4gICAgICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUubWFyZ2luID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcy5zdHlsZS5ib3JkZXIgPSAwO1xuICAgICAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnO1xuICAgICAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAgIHRoaXMuX2NhbnZhcy5zdHlsZS50b3AgPSAwO1xuICAgICAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLmxlZnQgPSAwO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGNhbnZhcyBjb250ZXh0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNhbnZhcy5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0NhbnZhc0NvbnRleHR9IGNvbnRleHRcbiAgICAgICAgICovXG4gICAgICAgIGdldENvbnRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBwaXhlbCByYXRpb1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5DYW52YXMucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IHBpeGVsIHJhdGlvXG4gICAgICAgICAqL1xuICAgICAgICBnZXRQaXhlbFJhdGlvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBpeGVsUmF0aW87XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgcGl4ZWwgcmF0aW9cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ2FudmFzLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcGl4ZWxSYXRpbyBLb252YUpTIGF1dG9tYXRpY2FsbHkgaGFuZGxlcyBwaXhlbCByYXRpbyBhZHVzdG1lbnRzIGluIG9yZGVyIHRvIHJlbmRlciBjcmlzcCBkcmF3aW5nc1xuICAgICAgICAgKiAgb24gYWxsIGRldmljZXMuIE1vc3QgZGVza3RvcHMsIGxvdyBlbmQgdGFibGV0cywgYW5kIGxvdyBlbmQgcGhvbmVzLCBoYXZlIGRldmljZSBwaXhlbCByYXRpb3NcbiAgICAgICAgICogIG9mIDEuICBTb21lIGhpZ2ggZW5kIHRhYmxldHMgYW5kIHBob25lcywgbGlrZSBpUGhvbmVzIGFuZCBpUGFkcyBoYXZlIGEgZGV2aWNlIHBpeGVsIHJhdGlvXG4gICAgICAgICAqICBvZiAyLiAgU29tZSBNYWNib29rIFByb3MsIGFuZCBpTWFjcyBhbHNvIGhhdmUgYSBkZXZpY2UgcGl4ZWwgcmF0aW8gb2YgMi4gIFNvbWUgaGlnaCBlbmQgQW5kcm9pZCBkZXZpY2VzIGhhdmUgcGl4ZWxcbiAgICAgICAgICogIHJhdGlvcyBvZiAyIG9yIDMuICBTb21lIGJyb3dzZXJzIGxpa2UgRmlyZWZveCBhbGxvdyB5b3UgdG8gY29uZmlndXJlIHRoZSBwaXhlbCByYXRpbyBvZiB0aGUgdmlld3BvcnQuICBVbmxlc3Mgb3RoZXJ3aXNlXG4gICAgICAgICAqICBzcGVjaWZpY2VkLCB0aGUgcGl4ZWwgcmF0aW8gd2lsbCBiZSBkZWZhdWx0ZWQgdG8gdGhlIGFjdHVhbCBkZXZpY2UgcGl4ZWwgcmF0aW8uICBZb3UgY2FuIG92ZXJyaWRlIHRoZSBkZXZpY2UgcGl4ZWxcbiAgICAgICAgICogIHJhdGlvIGZvciBzcGVjaWFsIHNpdHVhdGlvbnMsIG9yLCBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgcGl4ZWwgcmF0aW8gdG8gYmUgdGFrZW4gaW50byBhY2NvdW50LCB5b3UgY2FuIHNldCBpdCB0byAxLlxuICAgICAgICAgKi9cbiAgICAgICAgc2V0UGl4ZWxSYXRpbzogZnVuY3Rpb24ocGl4ZWxSYXRpbykge1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzUmF0aW8gPSB0aGlzLnBpeGVsUmF0aW87XG4gICAgICAgICAgICB0aGlzLnBpeGVsUmF0aW8gPSBwaXhlbFJhdGlvO1xuICAgICAgICAgICAgdGhpcy5zZXRTaXplKHRoaXMuZ2V0V2lkdGgoKSAvIHByZXZpb3VzUmF0aW8sIHRoaXMuZ2V0SGVpZ2h0KCkgLyBwcmV2aW91c1JhdGlvKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNldCB3aWR0aFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5DYW52YXMucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxuICAgICAgICAgKi9cbiAgICAgICAgc2V0V2lkdGg6IGZ1bmN0aW9uKHdpZHRoKSB7XG4gICAgICAgICAgICAvLyB0YWtlIGludG8gYWNjb3VudCBwaXhlbCByYXRpb1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMuX2NhbnZhcy53aWR0aCA9IHdpZHRoICogdGhpcy5waXhlbFJhdGlvO1xuICAgICAgICAgICAgdGhpcy5fY2FudmFzLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuXG4gICAgICAgICAgICB2YXIgcGl4ZWxSYXRpbyA9IHRoaXMucGl4ZWxSYXRpbyxcbiAgICAgICAgICAgICAgICBfY29udGV4dCA9IHRoaXMuZ2V0Q29udGV4dCgpLl9jb250ZXh0O1xuICAgICAgICAgICAgX2NvbnRleHQuc2NhbGUocGl4ZWxSYXRpbywgcGl4ZWxSYXRpbyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgaGVpZ2h0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNhbnZhcy5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodFxuICAgICAgICAgKi9cbiAgICAgICAgc2V0SGVpZ2h0OiBmdW5jdGlvbihoZWlnaHQpIHtcbiAgICAgICAgICAgIC8vIHRha2UgaW50byBhY2NvdW50IHBpeGVsIHJhdGlvXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuX2NhbnZhcy5oZWlnaHQgPSBoZWlnaHQgKiB0aGlzLnBpeGVsUmF0aW87XG4gICAgICAgICAgICB0aGlzLl9jYW52YXMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIHZhciBwaXhlbFJhdGlvID0gdGhpcy5waXhlbFJhdGlvLFxuICAgICAgICAgICAgICAgIF9jb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KCkuX2NvbnRleHQ7XG4gICAgICAgICAgICBfY29udGV4dC5zY2FsZShwaXhlbFJhdGlvLCBwaXhlbFJhdGlvKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB3aWR0aFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5DYW52YXMucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IHdpZHRoXG4gICAgICAgICAqL1xuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy53aWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBoZWlnaHRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ2FudmFzLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBoZWlnaHRcbiAgICAgICAgICovXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgc2l6ZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5DYW52YXMucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaGVpZ2h0XG4gICAgICAgICAqL1xuICAgICAgICBzZXRTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLnNldFdpZHRoKHdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0SGVpZ2h0KGhlaWdodCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0byBkYXRhIHVybFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5DYW52YXMucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtaW1lVHlwZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcXVhbGl0eSBiZXR3ZWVuIDAgYW5kIDEgZm9yIGpwZyBtaW1lIHR5cGVzXG4gICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IGRhdGEgdXJsIHN0cmluZ1xuICAgICAgICAgKi9cbiAgICAgICAgdG9EYXRhVVJMOiBmdW5jdGlvbihtaW1lVHlwZSwgcXVhbGl0eSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGNhbGwgZmFpbHMgKGR1ZSB0byBicm93c2VyIGJ1ZywgbGlrZSBpbiBGaXJlZm94IDMuNiksXG4gICAgICAgICAgICAgICAgLy8gdGhlbiByZXZlcnQgdG8gcHJldmlvdXMgbm8tcGFyYW1ldGVyIGltYWdlL3BuZyBiZWhhdmlvclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYW52YXMudG9EYXRhVVJMKG1pbWVUeXBlLCBxdWFsaXR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FudmFzLnRvRGF0YVVSTCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdVbmFibGUgdG8gZ2V0IGRhdGEgVVJMLiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLlNjZW5lQ2FudmFzID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHZhciBjb25mID0gY29uZmlnIHx8IHt9O1xuICAgICAgICB2YXIgd2lkdGggPSBjb25mLndpZHRoIHx8IDAsXG4gICAgICAgICAgICBoZWlnaHQgPSBjb25mLmhlaWdodCB8fCAwO1xuXG4gICAgICAgIEtvbnZhLkNhbnZhcy5jYWxsKHRoaXMsIGNvbmYpO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBuZXcgS29udmEuU2NlbmVDb250ZXh0KHRoaXMpO1xuICAgICAgICB0aGlzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgfTtcblxuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLlNjZW5lQ2FudmFzLCBLb252YS5DYW52YXMpO1xuXG4gICAgS29udmEuSGl0Q2FudmFzID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHZhciBjb25mID0gY29uZmlnIHx8IHt9O1xuICAgICAgICB2YXIgd2lkdGggPSBjb25mLndpZHRoIHx8IDAsXG4gICAgICAgICAgICBoZWlnaHQgPSBjb25mLmhlaWdodCB8fCAwO1xuXG4gICAgICAgIEtvbnZhLkNhbnZhcy5jYWxsKHRoaXMsIGNvbmYpO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBuZXcgS29udmEuSGl0Q29udGV4dCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRTaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB0aGlzLmhpdENhbnZhcyA9IHRydWU7XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5IaXRDYW52YXMsIEtvbnZhLkNhbnZhcyk7XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIENPTU1BID0gJywnLFxuICAgICAgICBPUEVOX1BBUkVOID0gJygnLFxuICAgICAgICBDTE9TRV9QQVJFTiA9ICcpJyxcbiAgICAgICAgT1BFTl9QQVJFTl9CUkFDS0VUID0gJyhbJyxcbiAgICAgICAgQ0xPU0VfQlJBQ0tFVF9QQVJFTiA9ICddKScsXG4gICAgICAgIFNFTUlDT0xPTiA9ICc7JyxcbiAgICAgICAgRE9VQkxFX1BBUkVOID0gJygpJyxcbiAgICAgICAgLy8gRU1QVFlfU1RSSU5HID0gJycsXG4gICAgICAgIEVRVUFMUyA9ICc9JyxcbiAgICAgICAgLy8gU0VUID0gJ3NldCcsXG4gICAgICAgIENPTlRFWFRfTUVUSE9EUyA9IFtcbiAgICAgICAgICAgICdhcmMnLFxuICAgICAgICAgICAgJ2FyY1RvJyxcbiAgICAgICAgICAgICdiZWdpblBhdGgnLFxuICAgICAgICAgICAgJ2JlemllckN1cnZlVG8nLFxuICAgICAgICAgICAgJ2NsZWFyUmVjdCcsXG4gICAgICAgICAgICAnY2xpcCcsXG4gICAgICAgICAgICAnY2xvc2VQYXRoJyxcbiAgICAgICAgICAgICdjcmVhdGVMaW5lYXJHcmFkaWVudCcsXG4gICAgICAgICAgICAnY3JlYXRlUGF0dGVybicsXG4gICAgICAgICAgICAnY3JlYXRlUmFkaWFsR3JhZGllbnQnLFxuICAgICAgICAgICAgJ2RyYXdJbWFnZScsXG4gICAgICAgICAgICAnZmlsbCcsXG4gICAgICAgICAgICAnZmlsbFRleHQnLFxuICAgICAgICAgICAgJ2dldEltYWdlRGF0YScsXG4gICAgICAgICAgICAnY3JlYXRlSW1hZ2VEYXRhJyxcbiAgICAgICAgICAgICdsaW5lVG8nLFxuICAgICAgICAgICAgJ21vdmVUbycsXG4gICAgICAgICAgICAncHV0SW1hZ2VEYXRhJyxcbiAgICAgICAgICAgICdxdWFkcmF0aWNDdXJ2ZVRvJyxcbiAgICAgICAgICAgICdyZWN0JyxcbiAgICAgICAgICAgICdyZXN0b3JlJyxcbiAgICAgICAgICAgICdyb3RhdGUnLFxuICAgICAgICAgICAgJ3NhdmUnLFxuICAgICAgICAgICAgJ3NjYWxlJyxcbiAgICAgICAgICAgICdzZXRMaW5lRGFzaCcsXG4gICAgICAgICAgICAnc2V0VHJhbnNmb3JtJyxcbiAgICAgICAgICAgICdzdHJva2UnLFxuICAgICAgICAgICAgJ3N0cm9rZVRleHQnLFxuICAgICAgICAgICAgJ3RyYW5zZm9ybScsXG4gICAgICAgICAgICAndHJhbnNsYXRlJ1xuICAgICAgICBdO1xuXG4gICAgdmFyIENPTlRFWFRfUFJPUEVSVElFUyA9IFsnZmlsbFN0eWxlJywgJ3N0cm9rZVN0eWxlJywgJ3NoYWRvd0NvbG9yJywgJ3NoYWRvd0JsdXInLCAnc2hhZG93T2Zmc2V0WCcsXG4gICAgICAgICdzaGFkb3dPZmZzZXRZJywgJ2xpbmVDYXAnLCAnbGluZUpvaW4nLCAnbGluZVdpZHRoJywgJ21pdGVyTGltaXQnLCAnZm9udCcsICd0ZXh0QWxpZ24nLCAndGV4dEJhc2VsaW5lJyxcbiAgICAgICAgJ2dsb2JhbEFscGhhJywgJ2dsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiddO1xuXG4gICAgLyoqXG4gICAgICogQ2FudmFzIENvbnRleHQgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYWJzdHJhY3RcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKi9cbiAgICBLb252YS5Db250ZXh0ID0gZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgICAgIHRoaXMuaW5pdChjYW52YXMpO1xuICAgIH07XG5cbiAgICBLb252YS5Db250ZXh0LnByb3RvdHlwZSA9IHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQgPSBjYW52YXMuX2NhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgICAgICBpZiAoS29udmEuZW5hYmxlVHJhY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNlQXJyID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlVHJhY2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGZpbGwgc2hhcGVcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGV4dC5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtLb252YS5TaGFwZX0gc2hhcGVcbiAgICAgICAgICovXG4gICAgICAgIGZpbGxTaGFwZTogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIGlmKHNoYXBlLmdldEZpbGxFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxsKHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0cm9rZSBzaGFwZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250ZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0tvbnZhLlNoYXBlfSBzaGFwZVxuICAgICAgICAgKi9cbiAgICAgICAgc3Ryb2tlU2hhcGU6IGZ1bmN0aW9uKHNoYXBlKSB7XG4gICAgICAgICAgICBpZihzaGFwZS5nZXRTdHJva2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdHJva2Uoc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZmlsbCB0aGVuIHN0cm9rZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250ZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0tvbnZhLlNoYXBlfSBzaGFwZVxuICAgICAgICAgKi9cbiAgICAgICAgZmlsbFN0cm9rZVNoYXBlOiBmdW5jdGlvbihzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGZpbGxFbmFibGVkID0gc2hhcGUuZ2V0RmlsbEVuYWJsZWQoKTtcbiAgICAgICAgICAgIGlmKGZpbGxFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsbChzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihzaGFwZS5nZXRTdHJva2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdHJva2Uoc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGNvbnRleHQgdHJhY2UgaWYgdHJhY2UgaXMgZW5hYmxlZFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250ZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHJlbGF4ZWQgaWYgZmFsc2UsIHJldHVybiBzdHJpY3QgY29udGV4dCB0cmFjZSwgd2hpY2ggaW5jbHVkZXMgbWV0aG9kIG5hbWVzLCBtZXRob2QgcGFyYW1ldGVyc1xuICAgICAgICAgKiAgcHJvcGVydGllcywgYW5kIHByb3BlcnR5IHZhbHVlcy4gIElmIHRydWUsIHJldHVybiByZWxheGVkIGNvbnRleHQgdHJhY2UsIHdoaWNoIG9ubHkgcmV0dXJucyBtZXRob2QgbmFtZXMgYW5kXG4gICAgICAgICAqICBwcm9wZXJpdGVzLlxuICAgICAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0VHJhY2U6IGZ1bmN0aW9uKHJlbGF4ZWQpIHtcbiAgICAgICAgICAgIHZhciB0cmFjZUFyciA9IHRoaXMudHJhY2VBcnIsXG4gICAgICAgICAgICAgICAgbGVuID0gdHJhY2VBcnIubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHN0ciA9ICcnLFxuICAgICAgICAgICAgICAgIG4sIHRyYWNlLCBtZXRob2QsIGFyZ3M7XG5cbiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIHRyYWNlID0gdHJhY2VBcnJbbl07XG4gICAgICAgICAgICAgICAgbWV0aG9kID0gdHJhY2UubWV0aG9kO1xuXG4gICAgICAgICAgICAgICAgLy8gbWV0aG9kc1xuICAgICAgICAgICAgICAgIGlmIChtZXRob2QpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJncyA9IHRyYWNlLmFyZ3M7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSBtZXRob2Q7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWxheGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gRE9VQkxFX1BBUkVOO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEtvbnZhLlV0aWwuX2lzQXJyYXkoYXJnc1swXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gT1BFTl9QQVJFTl9CUkFDS0VUICsgYXJncy5qb2luKENPTU1BKSArIENMT1NFX0JSQUNLRVRfUEFSRU47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gT1BFTl9QQVJFTiArIGFyZ3Muam9pbihDT01NQSkgKyBDTE9TRV9QQVJFTjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBwcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSB0cmFjZS5wcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWxheGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gRVFVQUxTICsgdHJhY2UudmFsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RyICs9IFNFTUlDT0xPTjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNsZWFyIHRyYWNlIGlmIHRyYWNlIGlzIGVuYWJsZWRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGV4dC5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGNsZWFyVHJhY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50cmFjZUFyciA9IFtdO1xuICAgICAgICB9LFxuICAgICAgICBfdHJhY2U6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICAgICAgdmFyIHRyYWNlQXJyID0gdGhpcy50cmFjZUFycixcbiAgICAgICAgICAgICAgICBsZW47XG5cbiAgICAgICAgICAgIHRyYWNlQXJyLnB1c2goc3RyKTtcbiAgICAgICAgICAgIGxlbiA9IHRyYWNlQXJyLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKGxlbiA+PSBLb252YS50cmFjZUFyck1heCkge1xuICAgICAgICAgICAgICAgIHRyYWNlQXJyLnNoaWZ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXNldCBjYW52YXMgY29udGV4dCB0cmFuc2Zvcm1cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGV4dC5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBwaXhlbFJhdGlvID0gdGhpcy5nZXRDYW52YXMoKS5nZXRQaXhlbFJhdGlvKCk7XG4gICAgICAgICAgICB0aGlzLnNldFRyYW5zZm9ybSgxICogcGl4ZWxSYXRpbywgMCwgMCwgMSAqIHBpeGVsUmF0aW8sIDAsIDApO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGNhbnZhc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250ZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuQ2FudmFzfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0Q2FudmFzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNsZWFyIGNhbnZhc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250ZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gW2JvdW5kc11cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMueF1cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMueV1cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMud2lkdGhdXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbYm91bmRzLmhlaWdodF1cbiAgICAgICAgICovXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbihib3VuZHMpIHtcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSB0aGlzLmdldENhbnZhcygpO1xuXG4gICAgICAgICAgICBpZiAoYm91bmRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclJlY3QoYm91bmRzLnggfHwgMCwgYm91bmRzLnkgfHwgMCwgYm91bmRzLndpZHRoIHx8IDAsIGJvdW5kcy5oZWlnaHQgfHwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyUmVjdCgwLCAwLCBjYW52YXMuZ2V0V2lkdGgoKSAvIGNhbnZhcy5waXhlbFJhdGlvLCBjYW52YXMuZ2V0SGVpZ2h0KCkgLyBjYW52YXMucGl4ZWxSYXRpbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9hcHBseUxpbmVDYXA6IGZ1bmN0aW9uKHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgbGluZUNhcCA9IHNoYXBlLmdldExpbmVDYXAoKTtcbiAgICAgICAgICAgIGlmKGxpbmVDYXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHIoJ2xpbmVDYXAnLCBsaW5lQ2FwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2FwcGx5T3BhY2l0eTogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBhYnNPcGFjaXR5ID0gc2hhcGUuZ2V0QWJzb2x1dGVPcGFjaXR5KCk7XG4gICAgICAgICAgICBpZihhYnNPcGFjaXR5ICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdnbG9iYWxBbHBoYScsIGFic09wYWNpdHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfYXBwbHlMaW5lSm9pbjogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBsaW5lSm9pbiA9IHNoYXBlLmdldExpbmVKb2luKCk7XG4gICAgICAgICAgICBpZihsaW5lSm9pbikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignbGluZUpvaW4nLCBsaW5lSm9pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNldEF0dHI6IGZ1bmN0aW9uKGF0dHIsIHZhbCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dFthdHRyXSA9IHZhbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBjb250ZXh0IHBhc3MgdGhyb3VnaCBtZXRob2RzXG4gICAgICAgIGFyYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuYXJjKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0sIGFbNV0pO1xuICAgICAgICB9LFxuICAgICAgICBiZWdpblBhdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgfSxcbiAgICAgICAgYmV6aWVyQ3VydmVUbzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuYmV6aWVyQ3VydmVUbyhhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdLCBhWzVdKTtcbiAgICAgICAgfSxcbiAgICAgICAgY2xlYXJSZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5jbGVhclJlY3QoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7XG4gICAgICAgIH0sXG4gICAgICAgIGNsaXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5jbGlwKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb3NlUGF0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVJbWFnZURhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICBpZihhLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZUltYWdlRGF0YShhWzBdLCBhWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVJbWFnZURhdGEoYVswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZUxpbmVhckdyYWRpZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuY3JlYXRlTGluZWFyR3JhZGllbnQoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7XG4gICAgICAgIH0sXG4gICAgICAgIGNyZWF0ZVBhdHRlcm46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5jcmVhdGVQYXR0ZXJuKGFbMF0sIGFbMV0pO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVSYWRpYWxHcmFkaWVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LmNyZWF0ZVJhZGlhbEdyYWRpZW50KGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0sIGFbNV0pO1xuICAgICAgICB9LFxuICAgICAgICBkcmF3SW1hZ2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHMsXG4gICAgICAgICAgICAgICAgX2NvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuXG4gICAgICAgICAgICBpZihhLmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0LmRyYXdJbWFnZShhWzBdLCBhWzFdLCBhWzJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYS5sZW5ndGggPT09IDUpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dC5kcmF3SW1hZ2UoYVswXSwgYVsxXSwgYVsyXSwgYVszXSwgYVs0XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGEubGVuZ3RoID09PSA5KSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQuZHJhd0ltYWdlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0sIGFbNV0sIGFbNl0sIGFbN10sIGFbOF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpc1BvaW50SW5QYXRoOiBmdW5jdGlvbih4LCB5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5pc1BvaW50SW5QYXRoKHgsIHkpO1xuICAgICAgICB9LFxuICAgICAgICBmaWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuZmlsbCgpO1xuICAgICAgICB9LFxuICAgICAgICBmaWxsUmVjdDogZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5maWxsUmVjdCh4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfSxcbiAgICAgICAgc3Ryb2tlUmVjdDogZnVuY3Rpb24oeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VSZWN0KHgsIHksIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9LFxuICAgICAgICBmaWxsVGV4dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuZmlsbFRleHQoYVswXSwgYVsxXSwgYVsyXSk7XG4gICAgICAgIH0sXG4gICAgICAgIG1lYXN1cmVUZXh0OiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dCh0ZXh0KTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0SW1hZ2VEYXRhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuZ2V0SW1hZ2VEYXRhKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10pO1xuICAgICAgICB9LFxuICAgICAgICBsaW5lVG86IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LmxpbmVUbyhhWzBdLCBhWzFdKTtcbiAgICAgICAgfSxcbiAgICAgICAgbW92ZVRvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5tb3ZlVG8oYVswXSwgYVsxXSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnJlY3QoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7XG4gICAgICAgIH0sXG4gICAgICAgIHB1dEltYWdlRGF0YTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQucHV0SW1hZ2VEYXRhKGFbMF0sIGFbMV0sIGFbMl0pO1xuICAgICAgICB9LFxuICAgICAgICBxdWFkcmF0aWNDdXJ2ZVRvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10pO1xuICAgICAgICB9LFxuICAgICAgICByZXN0b3JlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICB9LFxuICAgICAgICByb3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnJvdGF0ZShhWzBdKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2F2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnNhdmUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2NhbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnNjYWxlKGFbMF0sIGFbMV0pO1xuICAgICAgICB9LFxuICAgICAgICBzZXRMaW5lRGFzaDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cyxcbiAgICAgICAgICAgICAgICBfY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7XG5cbiAgICAgICAgICAgIC8vIHdvcmtzIGZvciBDaHJvbWUgYW5kIElFMTFcbiAgICAgICAgICAgIGlmKHRoaXMuX2NvbnRleHQuc2V0TGluZURhc2gpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dC5zZXRMaW5lRGFzaChhWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHZlcmlmaWVkIHRoYXQgdGhpcyB3b3JrcyBpbiBmaXJlZm94XG4gICAgICAgICAgICBlbHNlIGlmKCdtb3pEYXNoJyBpbiBfY29udGV4dCkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm1vekRhc2ggPSBhWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZG9lcyBub3QgY3VycmVudGx5IHdvcmsgZm9yIFNhZmFyaVxuICAgICAgICAgICAgZWxzZSBpZignd2Via2l0TGluZURhc2gnIGluIF9jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQud2Via2l0TGluZURhc2ggPSBhWzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBubyBzdXBwb3J0IGZvciBJRTkgYW5kIElFMTBcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0TGluZURhc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQuZ2V0TGluZURhc2goKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0VHJhbnNmb3JtOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5zZXRUcmFuc2Zvcm0oYVswXSwgYVsxXSwgYVsyXSwgYVszXSwgYVs0XSwgYVs1XSk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0cm9rZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB9LFxuICAgICAgICBzdHJva2VUZXh0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC5zdHJva2VUZXh0KGFbMF0sIGFbMV0sIGFbMl0pO1xuICAgICAgICB9LFxuICAgICAgICB0cmFuc2Zvcm06IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB0aGlzLl9jb250ZXh0LnRyYW5zZm9ybShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdLCBhWzVdKTtcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNsYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBhID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dC50cmFuc2xhdGUoYVswXSwgYVsxXSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9lbmFibGVUcmFjZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgbGVuID0gQ09OVEVYVF9NRVRIT0RTLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBfc2ltcGxpZnlBcnJheSA9IEtvbnZhLlV0aWwuX3NpbXBsaWZ5QXJyYXksXG4gICAgICAgICAgICAgICAgb3JpZ1NldHRlciA9IHRoaXMuc2V0QXR0cixcbiAgICAgICAgICAgICAgICBuLCBhcmdzO1xuXG4gICAgICAgICAgICAvLyB0byBwcmV2ZW50IGNyZWF0aW5nIHNjb3BlIGZ1bmN0aW9uIGF0IGVhY2ggbG9vcFxuICAgICAgICAgICAgdmFyIGZ1bmMgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcmlnTWV0aG9kID0gdGhhdFttZXRob2ROYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldDtcblxuICAgICAgICAgICAgICAgICAgICB0aGF0W21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gX3NpbXBsaWZ5QXJyYXkoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXQgPSBvcmlnTWV0aG9kLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3RyYWNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogYXJnc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gbWV0aG9kc1xuICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgZnVuYyhDT05URVhUX01FVEhPRFNbbl0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhdHRyc1xuICAgICAgICAgICAgdGhhdC5zZXRBdHRyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgb3JpZ1NldHRlci5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIHRoYXQuX3RyYWNlKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IGFyZ3VtZW50c1swXSxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBhcmd1bWVudHNbMV1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgQ09OVEVYVF9QUk9QRVJUSUVTLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS29udmEuQ29udGV4dC5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0W3Byb3BdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHRbcHJvcF0gPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgS29udmEuU2NlbmVDb250ZXh0ID0gZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgICAgIEtvbnZhLkNvbnRleHQuY2FsbCh0aGlzLCBjYW52YXMpO1xuICAgIH07XG5cbiAgICBLb252YS5TY2VuZUNvbnRleHQucHJvdG90eXBlID0ge1xuICAgICAgICBfZmlsbENvbG9yOiBmdW5jdGlvbihzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGZpbGwgPSBzaGFwZS5maWxsKCk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignZmlsbFN0eWxlJywgZmlsbCk7XG4gICAgICAgICAgICBzaGFwZS5fZmlsbEZ1bmModGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9maWxsUGF0dGVybjogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBmaWxsUGF0dGVyblggPSBzaGFwZS5nZXRGaWxsUGF0dGVyblgoKSxcbiAgICAgICAgICAgICAgICBmaWxsUGF0dGVyblkgPSBzaGFwZS5nZXRGaWxsUGF0dGVyblkoKSxcbiAgICAgICAgICAgICAgICBmaWxsUGF0dGVyblNjYWxlID0gc2hhcGUuZ2V0RmlsbFBhdHRlcm5TY2FsZSgpLFxuICAgICAgICAgICAgICAgIGZpbGxQYXR0ZXJuUm90YXRpb24gPSBLb252YS5nZXRBbmdsZShzaGFwZS5nZXRGaWxsUGF0dGVyblJvdGF0aW9uKCkpLFxuICAgICAgICAgICAgICAgIGZpbGxQYXR0ZXJuT2Zmc2V0ID0gc2hhcGUuZ2V0RmlsbFBhdHRlcm5PZmZzZXQoKTtcblxuICAgICAgICAgICAgaWYoZmlsbFBhdHRlcm5YIHx8IGZpbGxQYXR0ZXJuWSkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKGZpbGxQYXR0ZXJuWCB8fCAwLCBmaWxsUGF0dGVyblkgfHwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihmaWxsUGF0dGVyblJvdGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGUoZmlsbFBhdHRlcm5Sb3RhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihmaWxsUGF0dGVyblNjYWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FsZShmaWxsUGF0dGVyblNjYWxlLngsIGZpbGxQYXR0ZXJuU2NhbGUueSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihmaWxsUGF0dGVybk9mZnNldCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlKC0xICogZmlsbFBhdHRlcm5PZmZzZXQueCwgLTEgKiBmaWxsUGF0dGVybk9mZnNldC55KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdmaWxsU3R5bGUnLCB0aGlzLmNyZWF0ZVBhdHRlcm4oc2hhcGUuZ2V0RmlsbFBhdHRlcm5JbWFnZSgpLCBzaGFwZS5nZXRGaWxsUGF0dGVyblJlcGVhdCgpIHx8ICdyZXBlYXQnKSk7XG4gICAgICAgICAgICB0aGlzLmZpbGwoKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2ZpbGxMaW5lYXJHcmFkaWVudDogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IHNoYXBlLmdldEZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnQoKSxcbiAgICAgICAgICAgICAgICBlbmQgPSBzaGFwZS5nZXRGaWxsTGluZWFyR3JhZGllbnRFbmRQb2ludCgpLFxuICAgICAgICAgICAgICAgIGNvbG9yU3RvcHMgPSBzaGFwZS5nZXRGaWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKCksXG4gICAgICAgICAgICAgICAgZ3JkID0gdGhpcy5jcmVhdGVMaW5lYXJHcmFkaWVudChzdGFydC54LCBzdGFydC55LCBlbmQueCwgZW5kLnkpO1xuXG4gICAgICAgICAgICBpZiAoY29sb3JTdG9wcykge1xuICAgICAgICAgICAgICAgIC8vIGJ1aWxkIGNvbG9yIHN0b3BzXG4gICAgICAgICAgICAgICAgZm9yKHZhciBuID0gMDsgbiA8IGNvbG9yU3RvcHMubGVuZ3RoOyBuICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JkLmFkZENvbG9yU3RvcChjb2xvclN0b3BzW25dLCBjb2xvclN0b3BzW24gKyAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignZmlsbFN0eWxlJywgZ3JkKTtcbiAgICAgICAgICAgICAgICBzaGFwZS5fZmlsbEZ1bmModGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9maWxsUmFkaWFsR3JhZGllbnQ6IGZ1bmN0aW9uKHNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBzaGFwZS5nZXRGaWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50KCksXG4gICAgICAgICAgICAgICAgZW5kID0gc2hhcGUuZ2V0RmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnQoKSxcbiAgICAgICAgICAgICAgICBzdGFydFJhZGl1cyA9IHNoYXBlLmdldEZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzKCksXG4gICAgICAgICAgICAgICAgZW5kUmFkaXVzID0gc2hhcGUuZ2V0RmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzKCksXG4gICAgICAgICAgICAgICAgY29sb3JTdG9wcyA9IHNoYXBlLmdldEZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHMoKSxcbiAgICAgICAgICAgICAgICBncmQgPSB0aGlzLmNyZWF0ZVJhZGlhbEdyYWRpZW50KHN0YXJ0LngsIHN0YXJ0LnksIHN0YXJ0UmFkaXVzLCBlbmQueCwgZW5kLnksIGVuZFJhZGl1cyk7XG5cbiAgICAgICAgICAgIC8vIGJ1aWxkIGNvbG9yIHN0b3BzXG4gICAgICAgICAgICBmb3IodmFyIG4gPSAwOyBuIDwgY29sb3JTdG9wcy5sZW5ndGg7IG4gKz0gMikge1xuICAgICAgICAgICAgICAgIGdyZC5hZGRDb2xvclN0b3AoY29sb3JTdG9wc1tuXSwgY29sb3JTdG9wc1tuICsgMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdmaWxsU3R5bGUnLCBncmQpO1xuICAgICAgICAgICAgdGhpcy5maWxsKCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9maWxsOiBmdW5jdGlvbihzaGFwZSkge1xuICAgICAgICAgICAgdmFyIGhhc0NvbG9yID0gc2hhcGUuZmlsbCgpLFxuICAgICAgICAgICAgICAgIGhhc1BhdHRlcm4gPSBzaGFwZS5nZXRGaWxsUGF0dGVybkltYWdlKCksXG4gICAgICAgICAgICAgICAgaGFzTGluZWFyR3JhZGllbnQgPSBzaGFwZS5nZXRGaWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKCksXG4gICAgICAgICAgICAgICAgaGFzUmFkaWFsR3JhZGllbnQgPSBzaGFwZS5nZXRGaWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzKCksXG4gICAgICAgICAgICAgICAgZmlsbFByaW9yaXR5ID0gc2hhcGUuZ2V0RmlsbFByaW9yaXR5KCk7XG5cbiAgICAgICAgICAgIC8vIHByaW9yaXR5IGZpbGxzXG4gICAgICAgICAgICBpZihoYXNDb2xvciAmJiBmaWxsUHJpb3JpdHkgPT09ICdjb2xvcicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxsQ29sb3Ioc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihoYXNQYXR0ZXJuICYmIGZpbGxQcmlvcml0eSA9PT0gJ3BhdHRlcm4nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsbFBhdHRlcm4oc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihoYXNMaW5lYXJHcmFkaWVudCAmJiBmaWxsUHJpb3JpdHkgPT09ICdsaW5lYXItZ3JhZGllbnQnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsbExpbmVhckdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoaGFzUmFkaWFsR3JhZGllbnQgJiYgZmlsbFByaW9yaXR5ID09PSAncmFkaWFsLWdyYWRpZW50Jykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbGxSYWRpYWxHcmFkaWVudChzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBub3cganVzdCB0cnkgYW5kIGZpbGwgd2l0aCB3aGF0ZXZlciBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgIGVsc2UgaWYoaGFzQ29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxsQ29sb3Ioc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihoYXNQYXR0ZXJuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsbFBhdHRlcm4oc2hhcGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihoYXNMaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbGxMaW5lYXJHcmFkaWVudChzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGhhc1JhZGlhbEdyYWRpZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsbFJhZGlhbEdyYWRpZW50KHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX3N0cm9rZTogZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgIHZhciBkYXNoID0gc2hhcGUuZGFzaCgpLFxuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBzdHJva2VTY2FsZUVuYWJsZWQgZm9yIFRleHRcbiAgICAgICAgICAgICAgICBzdHJva2VTY2FsZUVuYWJsZWQgPSAoc2hhcGUuZ2V0U3Ryb2tlU2NhbGVFbmFibGVkKCkgfHwgKHNoYXBlIGluc3RhbmNlb2YgS29udmEuVGV4dCkpO1xuXG4gICAgICAgICAgICBpZihzaGFwZS5oYXNTdHJva2UoKSkge1xuICAgICAgICAgICAgICAgIGlmICghc3Ryb2tlU2NhbGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9hcHBseUxpbmVDYXAoc2hhcGUpO1xuICAgICAgICAgICAgICAgIGlmKGRhc2ggJiYgc2hhcGUuZGFzaEVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldExpbmVEYXNoKGRhc2gpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignbGluZVdpZHRoJywgc2hhcGUuc3Ryb2tlV2lkdGgoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdzdHJva2VTdHlsZScsIHNoYXBlLnN0cm9rZSgpKTtcblxuICAgICAgICAgICAgICAgIGlmICghc2hhcGUuZ2V0U2hhZG93Rm9yU3Ryb2tlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignc2hhZG93Q29sb3InLCAncmdiYSgwLDAsMCwwKScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzaGFwZS5fc3Ryb2tlRnVuYyh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGlmICghc3Ryb2tlU2NhbGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2FwcGx5U2hhZG93OiBmdW5jdGlvbihzaGFwZSkge1xuICAgICAgICAgICAgdmFyIHV0aWwgPSBLb252YS5VdGlsLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdXRpbC5nZXQoc2hhcGUuZ2V0U2hhZG93UkdCQSgpLCAnYmxhY2snKSxcbiAgICAgICAgICAgICAgICBibHVyID0gdXRpbC5nZXQoc2hhcGUuZ2V0U2hhZG93Qmx1cigpLCA1KSxcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSB1dGlsLmdldChzaGFwZS5nZXRTaGFkb3dPZmZzZXQoKSwge1xuICAgICAgICAgICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgICAgICAgICB5OiAwXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZ2V0IHRoaXMgaW5mbyBmcm9tIHRyYW5zZm9ybT8/XG4gICAgICAgICAgICAgICAgc2NhbGUgPSBzaGFwZS5nZXRBYnNvbHV0ZVNjYWxlKCksXG4gICAgICAgICAgICAgICAgc2NhbGVYID0gc2NhbGUueCxcbiAgICAgICAgICAgICAgICBzY2FsZVkgPSBzY2FsZS55O1xuXG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd0NvbG9yJywgY29sb3IpO1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdzaGFkb3dCbHVyJywgYmx1cik7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd09mZnNldFgnLCBvZmZzZXQueCAqIHNjYWxlWCk7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHIoJ3NoYWRvd09mZnNldFknLCBvZmZzZXQueSAqIHNjYWxlWSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLlNjZW5lQ29udGV4dCwgS29udmEuQ29udGV4dCk7XG5cbiAgICBLb252YS5IaXRDb250ZXh0ID0gZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgICAgIEtvbnZhLkNvbnRleHQuY2FsbCh0aGlzLCBjYW52YXMpO1xuICAgIH07XG5cbiAgICBLb252YS5IaXRDb250ZXh0LnByb3RvdHlwZSA9IHtcbiAgICAgICAgX2ZpbGw6IGZ1bmN0aW9uKHNoYXBlKSB7XG4gICAgICAgICAgICB0aGlzLnNhdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cignZmlsbFN0eWxlJywgc2hhcGUuY29sb3JLZXkpO1xuICAgICAgICAgICAgc2hhcGUuX2ZpbGxGdW5jSGl0KHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5yZXN0b3JlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zdHJva2U6IGZ1bmN0aW9uKHNoYXBlKSB7XG4gICAgICAgICAgICBpZihzaGFwZS5oYXNTdHJva2UoKSAmJiBzaGFwZS5zdHJva2VIaXRFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgc3Ryb2tlU2NhbGVFbmFibGVkIGZvciBUZXh0XG4gICAgICAgICAgICAgICAgdmFyIHN0cm9rZVNjYWxlRW5hYmxlZCA9IChzaGFwZS5nZXRTdHJva2VTY2FsZUVuYWJsZWQoKSB8fCAoc2hhcGUgaW5zdGFuY2VvZiBLb252YS5UZXh0KSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzdHJva2VTY2FsZUVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9hcHBseUxpbmVDYXAoc2hhcGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cignbGluZVdpZHRoJywgc2hhcGUuc3Ryb2tlV2lkdGgoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyKCdzdHJva2VTdHlsZScsIHNoYXBlLmNvbG9yS2V5KTtcbiAgICAgICAgICAgICAgICBzaGFwZS5fc3Ryb2tlRnVuY0hpdCh0aGlzKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0cm9rZVNjYWxlRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLkhpdENvbnRleHQsIEtvbnZhLkNvbnRleHQpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyBDT05TVEFOVFNcbiAgICB2YXIgR0VUID0gJ2dldCcsXG4gICAgICAgIFNFVCA9ICdzZXQnO1xuXG4gICAgS29udmEuRmFjdG9yeSA9IHtcbiAgICAgICAgYWRkR2V0dGVyU2V0dGVyOiBmdW5jdGlvbihjb25zdHJ1Y3RvciwgYXR0ciwgZGVmLCB2YWxpZGF0b3IsIGFmdGVyKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEdldHRlcihjb25zdHJ1Y3RvciwgYXR0ciwgZGVmKTtcbiAgICAgICAgICAgIHRoaXMuYWRkU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGFmdGVyKTtcbiAgICAgICAgICAgIHRoaXMuYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihjb25zdHJ1Y3RvciwgYXR0cik7XG4gICAgICAgIH0sXG4gICAgICAgIGFkZEdldHRlcjogZnVuY3Rpb24oY29uc3RydWN0b3IsIGF0dHIsIGRlZikge1xuICAgICAgICAgICAgdmFyIG1ldGhvZCA9IEdFVCArIEtvbnZhLlV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG5cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXMuYXR0cnNbYXR0cl07XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA9PT0gdW5kZWZpbmVkID8gZGVmIDogdmFsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkU2V0dGVyOiBmdW5jdGlvbihjb25zdHJ1Y3RvciwgYXR0ciwgdmFsaWRhdG9yLCBhZnRlcikge1xuICAgICAgICAgICAgdmFyIG1ldGhvZCA9IFNFVCArIEtvbnZhLlV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG5cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRvcikge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWxpZGF0b3IuY2FsbCh0aGlzLCB2YWwpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEF0dHIoYXR0ciwgdmFsKTtcblxuICAgICAgICAgICAgICAgIGlmIChhZnRlcikge1xuICAgICAgICAgICAgICAgICAgICBhZnRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkQ29tcG9uZW50c0dldHRlclNldHRlcjogZnVuY3Rpb24oY29uc3RydWN0b3IsIGF0dHIsIGNvbXBvbmVudHMsIHZhbGlkYXRvciwgYWZ0ZXIpIHtcbiAgICAgICAgICAgIHZhciBsZW4gPSBjb21wb25lbnRzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBjYXBpdGFsaXplID0gS29udmEuVXRpbC5fY2FwaXRhbGl6ZSxcbiAgICAgICAgICAgICAgICBnZXR0ZXIgPSBHRVQgKyBjYXBpdGFsaXplKGF0dHIpLFxuICAgICAgICAgICAgICAgIHNldHRlciA9IFNFVCArIGNhcGl0YWxpemUoYXR0ciksXG4gICAgICAgICAgICAgICAgbiwgY29tcG9uZW50O1xuXG4gICAgICAgICAgICAvLyBnZXR0ZXJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtnZXR0ZXJdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJldCA9IHt9O1xuXG4gICAgICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudHNbbl07XG4gICAgICAgICAgICAgICAgICAgIHJldFtjb21wb25lbnRdID0gdGhpcy5nZXRBdHRyKGF0dHIgKyBjYXBpdGFsaXplKGNvbXBvbmVudCkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzZXR0ZXJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtzZXR0ZXJdID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9sZFZhbCA9IHRoaXMuYXR0cnNbYXR0cl0sXG4gICAgICAgICAgICAgICAgICAgIGtleTtcblxuICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsaWRhdG9yLmNhbGwodGhpcywgdmFsKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWwuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0QXR0cihhdHRyICsgY2FwaXRhbGl6ZShrZXkpLCB2YWxba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZUV2ZW50KGF0dHIsIG9sZFZhbCwgdmFsKTtcblxuICAgICAgICAgICAgICAgIGlmIChhZnRlcikge1xuICAgICAgICAgICAgICAgICAgICBhZnRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyKTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcjogZnVuY3Rpb24oY29uc3RydWN0b3IsIGF0dHIpIHtcbiAgICAgICAgICAgIHZhciBjYXBpdGFsaXplZEF0dHIgPSBLb252YS5VdGlsLl9jYXBpdGFsaXplKGF0dHIpLFxuICAgICAgICAgICAgICAgIHNldHRlciA9IFNFVCArIGNhcGl0YWxpemVkQXR0cixcbiAgICAgICAgICAgICAgICBnZXR0ZXIgPSBHRVQgKyBjYXBpdGFsaXplZEF0dHI7XG5cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVthdHRyXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIHNldHRpbmdcbiAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW3NldHRlcl0oYXJndW1lbnRzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGdldHRpbmdcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1tnZXR0ZXJdKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBhZGREZXByZWNhdGVkR2V0dGVyU2V0dGVyOiBmdW5jdGlvbihjb25zdHJ1Y3RvciwgYXR0ciwgZGVmLCB2YWxpZGF0b3IpIHtcbiAgICAgICAgICAgIHZhciBtZXRob2QgPSBHRVQgKyBLb252YS5VdGlsLl9jYXBpdGFsaXplKGF0dHIpO1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBhdHRyICsgJyBwcm9wZXJ0eSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgc29vbi4gTG9vayBhdCBLb252YSBjaGFuZ2UgbG9nIGZvciBtb3JlIGluZm9ybWF0aW9uLic7XG4gICAgICAgICAgICBjb25zdHJ1Y3Rvci5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIEtvbnZhLlV0aWwuZXJyb3IobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHRoaXMuYXR0cnNbYXR0cl07XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbCA9PT0gdW5kZWZpbmVkID8gZGVmIDogdmFsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuYWRkU2V0dGVyKGNvbnN0cnVjdG9yLCBhdHRyLCB2YWxpZGF0b3IsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBLb252YS5VdGlsLmVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoY29uc3RydWN0b3IsIGF0dHIpO1xuICAgICAgICB9LFxuICAgICAgICBiYWNrQ29tcGF0OiBmdW5jdGlvbihjb25zdHJ1Y3RvciwgbWV0aG9kcykge1xuICAgICAgICAgICAgS29udmEuVXRpbC5lYWNoKG1ldGhvZHMsIGZ1bmN0aW9uKG9sZE1ldGhvZE5hbWUsIG5ld01ldGhvZE5hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gY29uc3RydWN0b3IucHJvdG90eXBlW25ld01ldGhvZE5hbWVdO1xuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yLnByb3RvdHlwZVtvbGRNZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgICAgICBLb252YS5VdGlsLmVycm9yKG9sZE1ldGhvZE5hbWUgKyAnIG1ldGhvZCBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgc29vbi4gVXNlICcgKyBuZXdNZXRob2ROYW1lICsgJyBpbnN0ZWFkJyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhZnRlclNldEZpbHRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLlZhbGlkYXRvcnMgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBSR0JDb21wb25lbnQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyNTU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbCA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCk7XG4gICAgICAgIH0sXG4gICAgICAgIGFscGhhQ29tcG9uZW50OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgIGlmICh2YWwgPiAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaHJvbWUgZG9lcyBub3QgaG9ub3IgYWxwaGEgdmFsdWVzIG9mIDBcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbCA8IDAuMDAwMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwLjAwMDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuKGZ1bmN0aW9uKEtvbnZhKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIENPTlNUQU5UU1xuICAgIHZhciBBQlNPTFVURV9PUEFDSVRZID0gJ2Fic29sdXRlT3BhY2l0eScsXG4gICAgICAgIEFCU09MVVRFX1RSQU5TRk9STSA9ICdhYnNvbHV0ZVRyYW5zZm9ybScsXG4gICAgICAgIEFCU09MVVRFX1NDQUxFID0gJ2Fic29sdXRlU2NhbGUnLFxuICAgICAgICBDSEFOR0UgPSAnQ2hhbmdlJyxcbiAgICAgICAgQ0hJTERSRU4gPSAnY2hpbGRyZW4nLFxuICAgICAgICBET1QgPSAnLicsXG4gICAgICAgIEVNUFRZX1NUUklORyA9ICcnLFxuICAgICAgICBHRVQgPSAnZ2V0JyxcbiAgICAgICAgSUQgPSAnaWQnLFxuICAgICAgICBLT05WQSA9ICdrb252YScsXG4gICAgICAgIExJU1RFTklORyA9ICdsaXN0ZW5pbmcnLFxuICAgICAgICBNT1VTRUVOVEVSID0gJ21vdXNlZW50ZXInLFxuICAgICAgICBNT1VTRUxFQVZFID0gJ21vdXNlbGVhdmUnLFxuICAgICAgICBOQU1FID0gJ25hbWUnLFxuICAgICAgICBTRVQgPSAnc2V0JyxcbiAgICAgICAgU0hBUEUgPSAnU2hhcGUnLFxuICAgICAgICBTUEFDRSA9ICcgJyxcbiAgICAgICAgU1RBR0UgPSAnc3RhZ2UnLFxuICAgICAgICBUUkFOU0ZPUk0gPSAndHJhbnNmb3JtJyxcbiAgICAgICAgVVBQRVJfU1RBR0UgPSAnU3RhZ2UnLFxuICAgICAgICBWSVNJQkxFID0gJ3Zpc2libGUnLFxuICAgICAgICBDTE9ORV9CTEFDS19MSVNUID0gWydpZCddLFxuXG4gICAgICAgIFRSQU5TRk9STV9DSEFOR0VfU1RSID0gW1xuICAgICAgICAgICAgJ3hDaGFuZ2Uua29udmEnLFxuICAgICAgICAgICAgJ3lDaGFuZ2Uua29udmEnLFxuICAgICAgICAgICAgJ3NjYWxlWENoYW5nZS5rb252YScsXG4gICAgICAgICAgICAnc2NhbGVZQ2hhbmdlLmtvbnZhJyxcbiAgICAgICAgICAgICdza2V3WENoYW5nZS5rb252YScsXG4gICAgICAgICAgICAnc2tld1lDaGFuZ2Uua29udmEnLFxuICAgICAgICAgICAgJ3JvdGF0aW9uQ2hhbmdlLmtvbnZhJyxcbiAgICAgICAgICAgICdvZmZzZXRYQ2hhbmdlLmtvbnZhJyxcbiAgICAgICAgICAgICdvZmZzZXRZQ2hhbmdlLmtvbnZhJyxcbiAgICAgICAgICAgICd0cmFuc2Zvcm1zRW5hYmxlZENoYW5nZS5rb252YSdcbiAgICAgICAgXS5qb2luKFNQQUNFKSxcblxuICAgICAgICBTQ0FMRV9DSEFOR0VfU1RSID0gW1xuICAgICAgICAgICAgJ3NjYWxlWENoYW5nZS5rb252YScsXG4gICAgICAgICAgICAnc2NhbGVZQ2hhbmdlLmtvbnZhJ1xuICAgICAgICBdLmpvaW4oU1BBQ0UpO1xuXG4gICAgLyoqXG4gICAgICogTm9kZSBjb25zdHJ1Y3Rvci4gTm9kZXMgYXJlIGVudGl0aWVzIHRoYXQgY2FuIGJlIHRyYW5zZm9ybWVkLCBsYXllcmVkLFxuICAgICAqIGFuZCBoYXZlIGJvdW5kIGV2ZW50cy4gVGhlIHN0YWdlLCBsYXllcnMsIGdyb3VwcywgYW5kIHNoYXBlcyBhbGwgZXh0ZW5kIE5vZGUuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGFic3RyYWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICovXG4gICAgS29udmEuTm9kZSA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlV0aWwuYWRkTWV0aG9kcyhLb252YS5Ob2RlLCB7XG4gICAgICAgIF9pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuX2lkID0gS29udmEuaWRDb3VudGVyKys7XG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzID0ge307XG4gICAgICAgICAgICB0aGlzLmF0dHJzID0ge307XG4gICAgICAgICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgICAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cnMoY29uZmlnKTtcblxuICAgICAgICAgICAgLy8gZXZlbnQgYmluZGluZ3MgZm9yIGNhY2hlIGhhbmRsaW5nXG4gICAgICAgICAgICB0aGlzLm9uKFRSQU5TRk9STV9DSEFOR0VfU1RSLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKFRSQU5TRk9STSk7XG4gICAgICAgICAgICAgICAgdGhhdC5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKEFCU09MVVRFX1RSQU5TRk9STSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5vbihTQ0FMRV9DSEFOR0VfU1RSLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfU0NBTEUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMub24oJ3Zpc2libGVDaGFuZ2Uua29udmEnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoVklTSUJMRSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub24oJ2xpc3RlbmluZ0NoYW5nZS5rb252YScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShMSVNURU5JTkcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm9uKCdvcGFjaXR5Q2hhbmdlLmtvbnZhJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKEFCU09MVVRFX09QQUNJVFkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9jbGVhckNhY2hlOiBmdW5jdGlvbihhdHRyKXtcbiAgICAgICAgICAgIGlmIChhdHRyKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2NhY2hlW2F0dHJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldENhY2hlOiBmdW5jdGlvbihhdHRyLCBwcml2YXRlR2V0dGVyKXtcbiAgICAgICAgICAgIHZhciBjYWNoZSA9IHRoaXMuX2NhY2hlW2F0dHJdO1xuXG4gICAgICAgICAgICAvLyBpZiBub3QgY2FjaGVkLCB3ZSBuZWVkIHRvIHNldCBpdCB1c2luZyB0aGUgcHJpdmF0ZSBnZXR0ZXIgbWV0aG9kLlxuICAgICAgICAgICAgaWYgKGNhY2hlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZVthdHRyXSA9IHByaXZhdGVHZXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlW2F0dHJdO1xuICAgICAgICB9LFxuICAgICAgICAvKlxuICAgICAgICAgKiB3aGVuIHRoZSBsb2dpYyBmb3IgYSBjYWNoZWQgcmVzdWx0IGRlcGVuZHMgb24gYW5jZXN0b3IgcHJvcGFnYXRpb24sIHVzZSB0aGlzXG4gICAgICAgICAqIG1ldGhvZCB0byBjbGVhciBzZWxmIGFuZCBjaGlsZHJlbiBjYWNoZVxuICAgICAgICAgKi9cbiAgICAgICAgX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZTogZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgdGhpcy5fY2xlYXJDYWNoZShhdHRyKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldENoaWxkcmVuKCkuZWFjaChmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShhdHRyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogY2xlYXIgY2FjaGVkIGNhbnZhc1xuICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgKiBAcmV0dXJucyB7S29udmEuTm9kZX1cbiAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAqIG5vZGUuY2xlYXJDYWNoZSgpO1xuICAgICAgICAqL1xuICAgICAgICBjbGVhckNhY2hlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9jYWNoZS5jYW52YXM7XG4gICAgICAgICAgICB0aGlzLl9maWx0ZXJVcFRvRGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAqICBjYWNoZSBub2RlIHRvIGltcHJvdmUgZHJhd2luZyBwZXJmb3JtYW5jZSwgYXBwbHkgZmlsdGVycywgb3IgY3JlYXRlIG1vcmUgYWNjdXJhdGVcbiAgICAgICAgKiAgaGl0IHJlZ2lvbnMuIEZvciBhbGwgYmFzaWMgc2hhcGVzIHNpemUgb2YgY2FjaGUgY2FudmFzIHdpbGwgYmUgYXV0b21hdGljYWxseSBkZXRlY3RlZC5cbiAgICAgICAgKiAgSWYgeW91IG5lZWQgdG8gY2FjaGUgeW91ciBjdXN0b20gYEtvbnZhLlNoYXBlYCBpbnN0YW5jZSB5b3UgaGF2ZSB0byBwYXNzIHNoYXBlJ3MgYm91bmRpbmcgYm94XG4gICAgICAgICogIHByb3BlcnRpZXMuIExvb2sgYXQgW2xpbmsgdG8gZGVtbyBwYWdlXShsaW5rIHRvIGRlbW8gcGFnZSkgZm9yIG1vcmUgaW5mb3JtYXRpb24uXG4gICAgICAgICogQG1ldGhvZFxuICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnXVxuICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0XSAgaW5jcmVhc2UgY2FudmFzIHNpemUgYnkgYG9mZnNldGAgcGl4ZWwgaW4gYWxsIGRpcmVjdGlvbnMuXG4gICAgICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYXdCb3JkZXJdIHdoZW4gc2V0IHRvIHRydWUsIGEgcmVkIGJvcmRlciB3aWxsIGJlIGRyYXduIGFyb3VuZCB0aGUgY2FjaGVkXG4gICAgICAgICogIHJlZ2lvbiBmb3IgZGVidWdnaW5nIHB1cnBvc2VzXG4gICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgKiAvLyBjYWNoZSBhIHNoYXBlIHdpdGggdGhlIHgseSBwb3NpdGlvbiBvZiB0aGUgYm91bmRpbmcgYm94IGF0IHRoZSBjZW50ZXIgYW5kXG4gICAgICAgICogLy8gdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIGJvdW5kaW5nIGJveCBlcXVhbCB0byB0aGUgd2lkdGggYW5kIGhlaWdodCBvZlxuICAgICAgICAqIC8vIHRoZSBzaGFwZSBvYnRhaW5lZCBmcm9tIHNoYXBlLndpZHRoKCkgYW5kIHNoYXBlLmhlaWdodCgpXG4gICAgICAgICogaW1hZ2UuY2FjaGUoKTtcbiAgICAgICAgKlxuICAgICAgICAqIC8vIGNhY2hlIGEgbm9kZSBhbmQgZGVmaW5lIHRoZSBib3VuZGluZyBib3ggcG9zaXRpb24gYW5kIHNpemVcbiAgICAgICAgKiBub2RlLmNhY2hlKHtcbiAgICAgICAgKiAgIHg6IC0zMCxcbiAgICAgICAgKiAgIHk6IC0zMCxcbiAgICAgICAgKiAgIHdpZHRoOiAxMDAsXG4gICAgICAgICogICBoZWlnaHQ6IDIwMFxuICAgICAgICAqIH0pO1xuICAgICAgICAqXG4gICAgICAgICogLy8gY2FjaGUgYSBub2RlIGFuZCBkcmF3IGEgcmVkIGJvcmRlciBhcm91bmQgdGhlIGJvdW5kaW5nIGJveFxuICAgICAgICAqIC8vIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXNcbiAgICAgICAgKiBub2RlLmNhY2hlKHtcbiAgICAgICAgKiAgIHg6IC0zMCxcbiAgICAgICAgKiAgIHk6IC0zMCxcbiAgICAgICAgKiAgIHdpZHRoOiAxMDAsXG4gICAgICAgICogICBoZWlnaHQ6IDIwMCxcbiAgICAgICAgKiAgIG9mZnNldCA6IDEwLFxuICAgICAgICAqICAgZHJhd0JvcmRlcjogdHJ1ZVxuICAgICAgICAqIH0pO1xuICAgICAgICAqL1xuICAgICAgICBjYWNoZTogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgY29uZiA9IGNvbmZpZyB8fCB7fSxcbiAgICAgICAgICAgICAgICByZWN0ID0gdGhpcy5nZXRDbGllbnRSZWN0KHRydWUpLFxuICAgICAgICAgICAgICAgIHdpZHRoID0gY29uZi53aWR0aCB8fCByZWN0LndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IGNvbmYuaGVpZ2h0IHx8IHJlY3QuaGVpZ2h0LFxuICAgICAgICAgICAgICAgIHggPSBjb25mLnggfHwgcmVjdC54LFxuICAgICAgICAgICAgICAgIHkgPSBjb25mLnkgfHwgcmVjdC55LFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IGNvbmYub2Zmc2V0IHx8IDAsXG4gICAgICAgICAgICAgICAgZHJhd0JvcmRlciA9IGNvbmYuZHJhd0JvcmRlciB8fCBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKCF3aWR0aCB8fCAhaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaWR0aCBvciBoZWlnaHQgb2YgY2FjaGluZyBjb25maWd1cmF0aW9uIGVxdWFscyAwLicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aWR0aCArPSBvZmZzZXQgKiAyO1xuICAgICAgICAgICAgaGVpZ2h0ICs9IG9mZnNldCAqIDI7XG5cbiAgICAgICAgICAgIHggLT0gb2Zmc2V0O1xuICAgICAgICAgICAgeSAtPSBvZmZzZXQ7XG5cblxuICAgICAgICAgICAgdmFyIGNhY2hlZFNjZW5lQ2FudmFzID0gbmV3IEtvbnZhLlNjZW5lQ2FudmFzKHtcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2FjaGVkRmlsdGVyQ2FudmFzID0gbmV3IEtvbnZhLlNjZW5lQ2FudmFzKHtcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2FjaGVkSGl0Q2FudmFzID0gbmV3IEtvbnZhLkhpdENhbnZhcyh7XG4gICAgICAgICAgICAgICAgcGl4ZWxSYXRpbzogMSxcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgc2NlbmVDb250ZXh0ID0gY2FjaGVkU2NlbmVDYW52YXMuZ2V0Q29udGV4dCgpLFxuICAgICAgICAgICAgaGl0Q29udGV4dCA9IGNhY2hlZEhpdENhbnZhcy5nZXRDb250ZXh0KCk7XG5cbiAgICAgICAgICAgIGNhY2hlZEhpdENhbnZhcy5pc0NhY2hlID0gdHJ1ZTtcblxuICAgICAgICAgICAgdGhpcy5jbGVhckNhY2hlKCk7XG5cbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBoaXRDb250ZXh0LnNhdmUoKTtcblxuICAgICAgICAgICAgc2NlbmVDb250ZXh0LnRyYW5zbGF0ZSgteCwgLXkpO1xuICAgICAgICAgICAgaGl0Q29udGV4dC50cmFuc2xhdGUoLXgsIC15KTtcblxuICAgICAgICAgICAgdGhpcy5kcmF3U2NlbmUoY2FjaGVkU2NlbmVDYW52YXMsIHRoaXMsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5kcmF3SGl0KGNhY2hlZEhpdENhbnZhcywgdGhpcywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIHNjZW5lQ29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICBoaXRDb250ZXh0LnJlc3RvcmUoKTtcblxuICAgICAgICAgICAgLy8gdGhpcyB3aWxsIGRyYXcgYSByZWQgYm9yZGVyIGFyb3VuZCB0aGUgY2FjaGVkIGJveCBmb3JcbiAgICAgICAgICAgIC8vIGRlYnVnZ2luZyBwdXJwb3Nlc1xuICAgICAgICAgICAgaWYgKGRyYXdCb3JkZXIpIHtcbiAgICAgICAgICAgICAgICBzY2VuZUNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIHNjZW5lQ29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBzY2VuZUNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBzY2VuZUNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICAgICAgc2NlbmVDb250ZXh0LnNldEF0dHIoJ3N0cm9rZVN0eWxlJywgJ3JlZCcpO1xuICAgICAgICAgICAgICAgIHNjZW5lQ29udGV4dC5zZXRBdHRyKCdsaW5lV2lkdGgnLCA1KTtcbiAgICAgICAgICAgICAgICBzY2VuZUNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgc2NlbmVDb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY2FjaGUuY2FudmFzID0ge1xuICAgICAgICAgICAgICAgIHNjZW5lOiBjYWNoZWRTY2VuZUNhbnZhcyxcbiAgICAgICAgICAgICAgICBmaWx0ZXI6IGNhY2hlZEZpbHRlckNhbnZhcyxcbiAgICAgICAgICAgICAgICBoaXQ6IGNhY2hlZEhpdENhbnZhcyxcbiAgICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICAgIHk6IHlcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0dXJuIGNsaWVudCByZWN0YW5nbGUge3gsIHksIHdpZHRoLCBoZWlnaHR9IG9mIG5vZGUuIFRoaXMgcmVjdGFuZ2xlIGFsc28gaW5jbHVkZSBhbGwgc3R5bGluZyAoc3Ryb2tlcywgc2hhZG93cywgZXRjKS5cbiAgICAgICAgICogVGhlIHJlY3RhbmdsZSBwb3NpdGlvbiBpcyByZWxhdGl2ZSB0byBwYXJlbnQgY29udGFpbmVyLlxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtza2lwVHJhbnNmb3JtXSBmbGFnIHNob3VsZCB3ZSBza2lwIHRyYW5zZm9ybWF0aW9uIHRvIHJlY3RhbmdsZVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSByZWN0IHdpdGgge3gsIHksIHdpZHRoLCBoZWlnaHR9IHByb3BlcnRpZXNcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogdmFyIHJlY3QgPSBuZXcgS29udmEuUmVjdCh7XG4gICAgICAgICAqICAgICAgd2lkdGggOiAxMDAsXG4gICAgICAgICAqICAgICAgaGVpZ2h0IDogMTAwLFxuICAgICAgICAgKiAgICAgIHggOiA1MCxcbiAgICAgICAgICogICAgICB5IDogNTAsXG4gICAgICAgICAqICAgICAgc3Ryb2tlV2lkdGggOiA0LFxuICAgICAgICAgKiAgICAgIHN0cm9rZSA6ICdibGFjaycsXG4gICAgICAgICAqICAgICAgb2Zmc2V0WCA6IDUwLFxuICAgICAgICAgKiAgICAgIHNjYWxlWSA6IDJcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCBjbGllbnQgcmVjdCB3aXRob3V0IHRoaW5rIG9mZiB0cmFuc2Zvcm1hdGlvbnMgKHBvc2l0aW9uLCByb3RhdGlvbiwgc2NhbGUsIG9mZnNldCwgZXRjKVxuICAgICAgICAgKiByZWN0LmdldENsaWVudFJlY3QodHJ1ZSk7XG4gICAgICAgICAqIC8vIHJldHVybnMge1xuICAgICAgICAgKiAvLyAgICAgeCA6IC0yLCAgIC8vIHR3byBwaXhlbHMgZm9yIHN0cm9rZSAvIDJcbiAgICAgICAgICogLy8gICAgIHkgOiAtMixcbiAgICAgICAgICogLy8gICAgIHdpZHRoIDogMTA0LCAvLyBpbmNyZWFzZWQgYnkgNCBmb3Igc3Ryb2tlXG4gICAgICAgICAqIC8vICAgICBoZWlnaHQgOiAxMDRcbiAgICAgICAgICogLy99XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCBjbGllbnQgcmVjdCB3aXRoIHRyYW5zZm9ybWF0aW9uIGFwcGxpZWRcbiAgICAgICAgICogcmVjdC5nZXRDbGllbnRSZWN0KCk7XG4gICAgICAgICAqIC8vIHJldHVybnMgT2JqZWN0IHt4OiAtMiwgeTogNDYsIHdpZHRoOiAxMDQsIGhlaWdodDogMjA4fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0Q2xpZW50UmVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBhYnN0cmFjdCBtZXRob2RcbiAgICAgICAgICAgIC8vIHJlZGVmaW5lIGluIENvbnRhaW5lciBhbmQgU2hhcGVcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignYWJzdHJhY3QgXCJnZXRDbGllbnRSZWN0XCIgbWV0aG9kIGNhbGwnKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3RyYW5zZm9ybWVkUmVjdDogZnVuY3Rpb24ocmVjdCkge1xuICAgICAgICAgICAgdmFyIHBvaW50cyA9IFtcbiAgICAgICAgICAgICAgICB7eDogcmVjdC54LCB5OiByZWN0Lnl9LFxuICAgICAgICAgICAgICAgIHt4OiByZWN0LnggKyByZWN0LndpZHRoLCB5OiByZWN0Lnl9LFxuICAgICAgICAgICAgICAgIHt4OiByZWN0LnggKyByZWN0LndpZHRoLCB5OiByZWN0LnkgKyByZWN0LmhlaWdodH0sXG4gICAgICAgICAgICAgICAge3g6IHJlY3QueCwgeTogcmVjdC55ICsgcmVjdC5oZWlnaHR9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgdmFyIG1pblgsIG1pblksIG1heFgsIG1heFk7XG4gICAgICAgICAgICB2YXIgdHJhbnMgPSB0aGlzLmdldFRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24ocG9pbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhbnNmb3JtZWQgPSB0cmFucy5wb2ludChwb2ludCk7XG4gICAgICAgICAgICAgICAgaWYgKG1pblggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtaW5YID0gbWF4WCA9IHRyYW5zZm9ybWVkLng7XG4gICAgICAgICAgICAgICAgICAgIG1pblkgPSBtYXhZID0gdHJhbnNmb3JtZWQueTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIHRyYW5zZm9ybWVkLngpO1xuICAgICAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB0cmFuc2Zvcm1lZC55KTtcbiAgICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgdHJhbnNmb3JtZWQueCk7XG4gICAgICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIHRyYW5zZm9ybWVkLnkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IG1pblgsXG4gICAgICAgICAgICAgICAgeTogbWluWSxcbiAgICAgICAgICAgICAgICB3aWR0aDogbWF4WCAtIG1pblgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBtYXhZIC0gbWluWVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgX2RyYXdDYWNoZWRTY2VuZUNhbnZhczogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBjb250ZXh0Ll9hcHBseU9wYWNpdHkodGhpcyk7XG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZS5jYW52YXMueCxcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZS5jYW52YXMueVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdmFyIGNhY2hlQ2FudmFzID0gdGhpcy5fZ2V0Q2FjaGVkU2NlbmVDYW52YXMoKTtcbiAgICAgICAgICAgIHZhciByYXRpbyA9IGNhY2hlQ2FudmFzLnBpeGVsUmF0aW87XG5cbiAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGNhY2hlQ2FudmFzLl9jYW52YXMsIDAsIDAsIGNhY2hlQ2FudmFzLndpZHRoIC8gcmF0aW8sIGNhY2hlQ2FudmFzLmhlaWdodCAvIHJhdGlvKTtcbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICB9LFxuICAgICAgICBfZHJhd0NhY2hlZEhpdENhbnZhczogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGNhY2hlZENhbnZhcyA9IHRoaXMuX2NhY2hlLmNhbnZhcyxcbiAgICAgICAgICAgICAgICBoaXRDYW52YXMgPSBjYWNoZWRDYW52YXMuaGl0O1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZS5jYW52YXMueCxcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZS5jYW52YXMueVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGhpdENhbnZhcy5fY2FudmFzLCAwLCAwKTtcbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICB9LFxuICAgICAgICBfZ2V0Q2FjaGVkU2NlbmVDYW52YXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGZpbHRlcnMgPSB0aGlzLmZpbHRlcnMoKSxcbiAgICAgICAgICAgICAgICBjYWNoZWRDYW52YXMgPSB0aGlzLl9jYWNoZS5jYW52YXMsXG4gICAgICAgICAgICAgICAgc2NlbmVDYW52YXMgPSBjYWNoZWRDYW52YXMuc2NlbmUsXG4gICAgICAgICAgICAgICAgZmlsdGVyQ2FudmFzID0gY2FjaGVkQ2FudmFzLmZpbHRlcixcbiAgICAgICAgICAgICAgICBmaWx0ZXJDb250ZXh0ID0gZmlsdGVyQ2FudmFzLmdldENvbnRleHQoKSxcbiAgICAgICAgICAgICAgICBsZW4sIGltYWdlRGF0YSwgbiwgZmlsdGVyO1xuXG4gICAgICAgICAgICBpZiAoZmlsdGVycykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fZmlsdGVyVXBUb0RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhdGlvID0gc2NlbmVDYW52YXMucGl4ZWxSYXRpbztcblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuID0gZmlsdGVycy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDb250ZXh0LmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvcHkgY2FjaGVkIGNhbnZhcyBvbnRvIGZpbHRlciBjb250ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDb250ZXh0LmRyYXdJbWFnZShzY2VuZUNhbnZhcy5fY2FudmFzLCAwLCAwLCBzY2VuZUNhbnZhcy5nZXRXaWR0aCgpIC8gcmF0aW8sIHNjZW5lQ2FudmFzLmdldEhlaWdodCgpIC8gcmF0aW8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhID0gZmlsdGVyQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgZmlsdGVyQ2FudmFzLmdldFdpZHRoKCksIGZpbHRlckNhbnZhcy5nZXRIZWlnaHQoKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IGZpbHRlcnMgdG8gZmlsdGVyIGNvbnRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IGZpbHRlcnNbbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWx0ZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS29udmEuVXRpbC5lcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRmlsdGVyIHNob3VsZCBiZSB0eXBlIG9mIGZ1bmN0aW9uLCBidXQgZ290ICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgZmlsdGVyKSArICcgaW5zdGVkLiBQbGVhc2UgY2hlY2sgY29ycmVjdCBmaWx0ZXJzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyLmNhbGwodGhpcywgaW1hZ2VEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJDb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEtvbnZhLlV0aWwuZXJyb3IoJ1VuYWJsZSB0byBhcHBseSBmaWx0ZXIuICcgKyBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXJDYW52YXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc2NlbmVDYW52YXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBiaW5kIGV2ZW50cyB0byB0aGUgbm9kZS4gS29udmFKUyBzdXBwb3J0cyBtb3VzZW92ZXIsIG1vdXNlbW92ZSxcbiAgICAgICAgICogIG1vdXNlb3V0LCBtb3VzZWVudGVyLCBtb3VzZWxlYXZlLCBtb3VzZWRvd24sIG1vdXNldXAsIHdoZWVsLCBjbGljaywgZGJsY2xpY2ssIHRvdWNoc3RhcnQsIHRvdWNobW92ZSxcbiAgICAgICAgICogIHRvdWNoZW5kLCB0YXAsIGRibHRhcCwgZHJhZ3N0YXJ0LCBkcmFnbW92ZSwgYW5kIGRyYWdlbmQgZXZlbnRzLiBUaGUgS29udmEgU3RhZ2Ugc3VwcG9ydHNcbiAgICAgICAgICogIGNvbnRlbnRNb3VzZW92ZXIsIGNvbnRlbnRNb3VzZW1vdmUsIGNvbnRlbnRNb3VzZW91dCwgY29udGVudE1vdXNlZG93biwgY29udGVudE1vdXNldXAsIGNvbnRlbnRXaGVlbFxuICAgICAgICAgKiAgY29udGVudENsaWNrLCBjb250ZW50RGJsY2xpY2ssIGNvbnRlbnRUb3VjaHN0YXJ0LCBjb250ZW50VG91Y2htb3ZlLCBjb250ZW50VG91Y2hlbmQsIGNvbnRlbnRUYXAsXG4gICAgICAgICAqICBhbmQgY29udGVudERibFRhcC4gIFBhc3MgaW4gYSBzdHJpbmcgb2YgZXZlbnRzIGRlbGltbWl0ZWQgYnkgYSBzcGFjZSB0byBiaW5kIG11bHRpcGxlIGV2ZW50cyBhdCBvbmNlXG4gICAgICAgICAqICBzdWNoIGFzICdtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUnLiBJbmNsdWRlIGEgbmFtZXNwYWNlIHRvIGJpbmQgYW5cbiAgICAgICAgICogIGV2ZW50IGJ5IG5hbWUgc3VjaCBhcyAnY2xpY2suZm9vYmFyJy5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGV2dFN0ciBlLmcuICdjbGljaycsICdtb3VzZWRvd24gdG91Y2hzdGFydCcsICdtb3VzZWRvd24uZm9vIHRvdWNoc3RhcnQuZm9vJ1xuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIFRoZSBoYW5kbGVyIGZ1bmN0aW9uIGlzIHBhc3NlZCBhbiBldmVudCBvYmplY3RcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIGFkZCBjbGljayBsaXN0ZW5lclxuICAgICAgICAgKiBub2RlLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgKiAgIGNvbnNvbGUubG9nKCd5b3UgY2xpY2tlZCBtZSEnKTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCB0aGUgdGFyZ2V0IG5vZGVcbiAgICAgICAgICogbm9kZS5vbignY2xpY2snLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZyhldnQudGFyZ2V0KTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIHN0b3AgZXZlbnQgcHJvcGFnYXRpb25cbiAgICAgICAgICogbm9kZS5vbignY2xpY2snLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICogICBldnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGJpbmQgbXVsdGlwbGUgbGlzdGVuZXJzXG4gICAgICAgICAqIG5vZGUub24oJ2NsaWNrIHRvdWNoc3RhcnQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZygneW91IGNsaWNrZWQvdG91Y2hlZCBtZSEnKTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIG5hbWVzcGFjZSBsaXN0ZW5lclxuICAgICAgICAgKiBub2RlLm9uKCdjbGljay5mb28nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZygneW91IGNsaWNrZWQvdG91Y2hlZCBtZSEnKTtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCB0aGUgZXZlbnQgdHlwZVxuICAgICAgICAgKiBub2RlLm9uKCdjbGljayB0YXAnLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICogICB2YXIgZXZlbnRUeXBlID0gZXZ0LnR5cGU7XG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBnZXQgbmF0aXZlIGV2ZW50IG9iamVjdFxuICAgICAgICAgKiBub2RlLm9uKCdjbGljayB0YXAnLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICogICB2YXIgbmF0aXZlRXZlbnQgPSBldnQuZXZ0O1xuICAgICAgICAgKiB9KTtcbiAgICAgICAgICpcbiAgICAgICAgICogLy8gZm9yIGNoYW5nZSBldmVudHMsIGdldCB0aGUgb2xkIGFuZCBuZXcgdmFsXG4gICAgICAgICAqIG5vZGUub24oJ3hDaGFuZ2UnLCBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICogICB2YXIgb2xkVmFsID0gZXZ0Lm9sZFZhbDtcbiAgICAgICAgICogICB2YXIgbmV3VmFsID0gZXZ0Lm5ld1ZhbDtcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCBldmVudCB0YXJnZXRzXG4gICAgICAgICAqIC8vIHdpdGggZXZlbnQgZGVsZWdhdGlvbnNcbiAgICAgICAgICogbGF5ZXIub24oJ2NsaWNrJywgJ0dyb3VwJywgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAqICAgdmFyIHNoYXBlID0gZXZ0LnRhcmdldDtcbiAgICAgICAgICogICB2YXIgZ3JvdXAgPSBldnRuLmN1cnJlbnRUYXJnZXI7XG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgb246IGZ1bmN0aW9uKGV2dFN0ciwgaGFuZGxlcikge1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGVsZWdhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBldmVudHMgPSBldnRTdHIuc3BsaXQoU1BBQ0UpLFxuICAgICAgICAgICAgICAgIGxlbiA9IGV2ZW50cy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgbiwgZXZlbnQsIHBhcnRzLCBiYXNlRXZlbnQsIG5hbWU7XG5cbiAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogbG9vcCB0aHJvdWdoIHR5cGVzIGFuZCBhdHRhY2ggZXZlbnQgbGlzdGVuZXJzIHRvXG4gICAgICAgICAgICAgKiBlYWNoIG9uZS4gIGVnLiAnY2xpY2sgbW91c2VvdmVyLm5hbWVzcGFjZSBtb3VzZW91dCdcbiAgICAgICAgICAgICAqIHdpbGwgY3JlYXRlIHRocmVlIGV2ZW50IGJpbmRpbmdzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZvcihuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudHNbbl07XG4gICAgICAgICAgICAgICAgcGFydHMgPSBldmVudC5zcGxpdChET1QpO1xuICAgICAgICAgICAgICAgIGJhc2VFdmVudCA9IHBhcnRzWzBdO1xuICAgICAgICAgICAgICAgIG5hbWUgPSBwYXJ0c1sxXSB8fCBFTVBUWV9TVFJJTkc7XG5cbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgZXZlbnRzIGFycmF5IGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgICAgICBpZighdGhpcy5ldmVudExpc3RlbmVyc1tiYXNlRXZlbnRdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnNbYmFzZUV2ZW50XSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnNbYmFzZUV2ZW50XS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogaGFuZGxlclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlbW92ZSBldmVudCBiaW5kaW5ncyBmcm9tIHRoZSBub2RlLiBQYXNzIGluIGEgc3RyaW5nIG9mXG4gICAgICAgICAqICBldmVudCB0eXBlcyBkZWxpbW1pdGVkIGJ5IGEgc3BhY2UgdG8gcmVtb3ZlIG11bHRpcGxlIGV2ZW50XG4gICAgICAgICAqICBiaW5kaW5ncyBhdCBvbmNlIHN1Y2ggYXMgJ21vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZScuXG4gICAgICAgICAqICBpbmNsdWRlIGEgbmFtZXNwYWNlIHRvIHJlbW92ZSBhbiBldmVudCBiaW5kaW5nIGJ5IG5hbWVcbiAgICAgICAgICogIHN1Y2ggYXMgJ2NsaWNrLmZvb2JhcicuIElmIHlvdSBvbmx5IGdpdmUgYSBuYW1lIGxpa2UgJy5mb29iYXInLFxuICAgICAgICAgKiAgYWxsIGV2ZW50cyBpbiB0aGF0IG5hbWVzcGFjZSB3aWxsIGJlIHJlbW92ZWQuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldnRTdHIgZS5nLiAnY2xpY2snLCAnbW91c2Vkb3duIHRvdWNoc3RhcnQnLCAnLmZvb2JhcidcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIHJlbW92ZSBsaXN0ZW5lclxuICAgICAgICAgKiBub2RlLm9mZignY2xpY2snKTtcbiAgICAgICAgICpcbiAgICAgICAgICogLy8gcmVtb3ZlIG11bHRpcGxlIGxpc3RlbmVyc1xuICAgICAgICAgKiBub2RlLm9mZignY2xpY2sgdG91Y2hzdGFydCcpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyByZW1vdmUgbGlzdGVuZXIgYnkgbmFtZVxuICAgICAgICAgKiBub2RlLm9mZignY2xpY2suZm9vJyk7XG4gICAgICAgICAqL1xuICAgICAgICBvZmY6IGZ1bmN0aW9uKGV2dFN0cikge1xuICAgICAgICAgICAgdmFyIGV2ZW50cyA9IChldnRTdHIgfHwgJycpLnNwbGl0KFNQQUNFKSxcbiAgICAgICAgICAgICAgICBsZW4gPSBldmVudHMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIG4sIHQsIGV2ZW50LCBwYXJ0cywgYmFzZUV2ZW50LCBuYW1lO1xuXG4gICAgICAgICAgICBpZiAoIWV2dFN0cikge1xuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgZXZlbnRzXG4gICAgICAgICAgICAgICAgZm9yKHQgaW4gdGhpcy5ldmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vZmYodCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICBldmVudCA9IGV2ZW50c1tuXTtcbiAgICAgICAgICAgICAgICBwYXJ0cyA9IGV2ZW50LnNwbGl0KERPVCk7XG4gICAgICAgICAgICAgICAgYmFzZUV2ZW50ID0gcGFydHNbMF07XG4gICAgICAgICAgICAgICAgbmFtZSA9IHBhcnRzWzFdO1xuXG4gICAgICAgICAgICAgICAgaWYoYmFzZUV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZXZlbnRMaXN0ZW5lcnNbYmFzZUV2ZW50XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb2ZmKGJhc2VFdmVudCwgbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcih0IGluIHRoaXMuZXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29mZih0LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvLyBzb21lIGV2ZW50IGFsaWFzZXMgZm9yIHRoaXJkIHBhcnR5IGludGVncmF0aW9uIGxpa2UgSGFtbWVySlNcbiAgICAgICAgZGlzcGF0Y2hFdmVudDogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICB2YXIgZSA9IHtcbiAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLFxuICAgICAgICAgICAgICB0eXBlOiBldnQudHlwZSxcbiAgICAgICAgICAgICAgZXZ0OiBldnRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmZpcmUoZXZ0LnR5cGUsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKHR5cGUsIGhhbmRsZXIpIHtcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgdG8gcGFzcyBuYXRpdmUgZXZlbnQgdG8gaGFuZGxlclxuICAgICAgICAgICAgdGhpcy5vbih0eXBlLCBmdW5jdGlvbihldnQpe1xuICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBldnQuZXZ0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMub2ZmKHR5cGUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGxpa2Ugbm9kZS5vblxuICAgICAgICBfZGVsZWdhdGU6IGZ1bmN0aW9uKGV2ZW50LCBzZWxlY3RvciwgaGFuZGxlcikge1xuICAgICAgICAgICAgdmFyIHN0b3BOb2RlID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMub24oZXZlbnQsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRzID0gZXZ0LnRhcmdldC5maW5kQW5jZXN0b3JzKHNlbGVjdG9yLCB0cnVlLCBzdG9wTm9kZSk7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0ID0gS29udmEuVXRpbC5jbG9uZU9iamVjdChldnQpO1xuICAgICAgICAgICAgICAgICAgICBldnQuY3VycmVudFRhcmdldCA9IHRhcmdldHNbaV07XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbCh0YXJnZXRzW2ldLCBldnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogcmVtb3ZlIHNlbGYgZnJvbSBwYXJlbnQsIGJ1dCBkb24ndCBkZXN0cm95XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBub2RlLnJlbW92ZSgpO1xuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpO1xuXG4gICAgICAgICAgICBpZihwYXJlbnQgJiYgcGFyZW50LmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50LmNoaWxkcmVuLnNwbGljZSh0aGlzLmluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBwYXJlbnQuX3NldENoaWxkcmVuSW5kaWNlcygpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZXZlcnkgY2FjaGVkIGF0dHIgdGhhdCBpcyBjYWxjdWxhdGVkIHZpYSBub2RlIHRyZWVcbiAgICAgICAgICAgIC8vIHRyYXZlcnNhbCBtdXN0IGJlIGNsZWFyZWQgd2hlbiByZW1vdmluZyBhIG5vZGVcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShTVEFHRSk7XG4gICAgICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfVFJBTlNGT1JNKTtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShWSVNJQkxFKTtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyU2VsZkFuZERlc2NlbmRhbnRDYWNoZShMSVNURU5JTkcpO1xuICAgICAgICAgICAgdGhpcy5fY2xlYXJTZWxmQW5kRGVzY2VuZGFudENhY2hlKEFCU09MVVRFX09QQUNJVFkpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlbW92ZSBhbmQgZGVzdHJveSBzZWxmXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIG5vZGUuZGVzdHJveSgpO1xuICAgICAgICAgKi9cbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgZnJvbSBpZHMgYW5kIG5hbWVzIGhhc2hlc1xuICAgICAgICAgICAgS29udmEuX3JlbW92ZUlkKHRoaXMuZ2V0SWQoKSk7XG4gICAgICAgICAgICBLb252YS5fcmVtb3ZlTmFtZSh0aGlzLmdldE5hbWUoKSwgdGhpcy5faWQpO1xuXG4gICAgICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgYXR0clxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gYXR0clxuICAgICAgICAgKiBAcmV0dXJucyB7SW50ZWdlcnxTdHJpbmd8T2JqZWN0fEFycmF5fVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiB2YXIgeCA9IG5vZGUuZ2V0QXR0cigneCcpO1xuICAgICAgICAgKi9cbiAgICAgICAgZ2V0QXR0cjogZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgdmFyIG1ldGhvZCA9IEdFVCArIEtvbnZhLlV0aWwuX2NhcGl0YWxpemUoYXR0cik7XG4gICAgICAgICAgICBpZihLb252YS5VdGlsLl9pc0Z1bmN0aW9uKHRoaXNbbWV0aG9kXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1ttZXRob2RdKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBvdGhlcndpc2UgZ2V0IGRpcmVjdGx5XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyc1thdHRyXTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogZ2V0IGFuY2VzdG9yc1xuICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgKiBAcmV0dXJucyB7S29udmEuQ29sbGVjdGlvbn1cbiAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAqIHNoYXBlLmdldEFuY2VzdG9ycygpLmVhY2goZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAqICAgY29uc29sZS5sb2cobm9kZS5nZXRJZCgpKTtcbiAgICAgICAgKiB9KVxuICAgICAgICAqL1xuICAgICAgICBnZXRBbmNlc3RvcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCksXG4gICAgICAgICAgICAgICAgYW5jZXN0b3JzID0gbmV3IEtvbnZhLkNvbGxlY3Rpb24oKTtcblxuICAgICAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHBhcmVudCk7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LmdldFBhcmVudCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYW5jZXN0b3JzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGF0dHJzIG9iamVjdCBsaXRlcmFsXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRBdHRyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycyB8fCB7fTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNldCBtdWx0aXBsZSBhdHRycyBhdCBvbmNlIHVzaW5nIGFuIG9iamVjdCBsaXRlcmFsXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgb2JqZWN0IGNvbnRhaW5pbmcga2V5IHZhbHVlIHBhaXJzXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBub2RlLnNldEF0dHJzKHtcbiAgICAgICAgICogICB4OiA1LFxuICAgICAgICAgKiAgIGZpbGw6ICdyZWQnXG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgc2V0QXR0cnM6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdmFyIGtleSwgbWV0aG9kO1xuXG4gICAgICAgICAgICBpZighY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3Ioa2V5IGluIGNvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IENISUxEUkVOKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZXRob2QgPSBTRVQgKyBLb252YS5VdGlsLl9jYXBpdGFsaXplKGtleSk7XG4gICAgICAgICAgICAgICAgLy8gdXNlIHNldHRlciBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICBpZihLb252YS5VdGlsLl9pc0Z1bmN0aW9uKHRoaXNbbWV0aG9kXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1ttZXRob2RdKGNvbmZpZ1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHNldCBkaXJlY3RseVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyKGtleSwgY29uZmlnW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGV0ZXJtaW5lIGlmIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHMgYnkgdGFraW5nIGludG8gYWNjb3VudCBhbmNlc3RvcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBhcmVudCAgICB8IFNlbGYgICAgICB8IGlzTGlzdGVuaW5nXG4gICAgICAgICAqIGxpc3RlbmluZyB8IGxpc3RlbmluZyB8XG4gICAgICAgICAqIC0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tXG4gICAgICAgICAqIFQgICAgICAgICB8IFQgICAgICAgICB8IFRcbiAgICAgICAgICogVCAgICAgICAgIHwgRiAgICAgICAgIHwgRlxuICAgICAgICAgKiBGICAgICAgICAgfCBUICAgICAgICAgfCBUXG4gICAgICAgICAqIEYgICAgICAgICB8IEYgICAgICAgICB8IEZcbiAgICAgICAgICogLS0tLS0tLS0tLSstLS0tLS0tLS0tLSstLS0tLS0tLS0tLS1cbiAgICAgICAgICogVCAgICAgICAgIHwgSSAgICAgICAgIHwgVFxuICAgICAgICAgKiBGICAgICAgICAgfCBJICAgICAgICAgfCBGXG4gICAgICAgICAqIEkgICAgICAgICB8IEkgICAgICAgICB8IFRcbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBpc0xpc3RlbmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUoTElTVEVOSU5HLCB0aGlzLl9pc0xpc3RlbmluZyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9pc0xpc3RlbmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbGlzdGVuaW5nID0gdGhpcy5nZXRMaXN0ZW5pbmcoKSxcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpO1xuXG4gICAgICAgICAgICAvLyB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIGEgc2ltcGxpZmljYXRpb24gb2YgdGhlIHRydXRoIHRhYmxlIGFib3ZlLlxuICAgICAgICAgICAgLy8gcGxlYXNlIG1vZGlmeSBjYXJlZnVsbHlcbiAgICAgICAgICAgIGlmIChsaXN0ZW5pbmcgPT09ICdpbmhlcml0Jykge1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5pc0xpc3RlbmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RlbmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZSBpZiBub2RlIGlzIHZpc2libGUgYnkgdGFraW5nIGludG8gYWNjb3VudCBhbmNlc3RvcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBhcmVudCAgICB8IFNlbGYgICAgICB8IGlzVmlzaWJsZVxuICAgICAgICAgKiB2aXNpYmxlICAgfCB2aXNpYmxlICAgfFxuICAgICAgICAgKiAtLS0tLS0tLS0tKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tLVxuICAgICAgICAgKiBUICAgICAgICAgfCBUICAgICAgICAgfCBUXG4gICAgICAgICAqIFQgICAgICAgICB8IEYgICAgICAgICB8IEZcbiAgICAgICAgICogRiAgICAgICAgIHwgVCAgICAgICAgIHwgVFxuICAgICAgICAgKiBGICAgICAgICAgfCBGICAgICAgICAgfCBGXG4gICAgICAgICAqIC0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tXG4gICAgICAgICAqIFQgICAgICAgICB8IEkgICAgICAgICB8IFRcbiAgICAgICAgICogRiAgICAgICAgIHwgSSAgICAgICAgIHwgRlxuICAgICAgICAgKiBJICAgICAgICAgfCBJICAgICAgICAgfCBUXG5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBpc1Zpc2libGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKFZJU0lCTEUsIHRoaXMuX2lzVmlzaWJsZSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9pc1Zpc2libGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHZpc2libGUgPSB0aGlzLmdldFZpc2libGUoKSxcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0aGlzLmdldFBhcmVudCgpO1xuXG4gICAgICAgICAgICAvLyB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIGEgc2ltcGxpZmljYXRpb24gb2YgdGhlIHRydXRoIHRhYmxlIGFib3ZlLlxuICAgICAgICAgICAgLy8gcGxlYXNlIG1vZGlmeSBjYXJlZnVsbHlcbiAgICAgICAgICAgIGlmICh2aXNpYmxlID09PSAnaW5oZXJpdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQuaXNWaXNpYmxlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlzaWJsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZSBpZiBsaXN0ZW5pbmcgaXMgZW5hYmxlZCBieSB0YWtpbmcgaW50byBhY2NvdW50IGRlc2NlbmRhbnRzLiAgSWYgc2VsZiBvciBhbnkgY2hpbGRyZW5cbiAgICAgICAgICogaGF2ZSBfaXNMaXN0ZW5pbmdFbmFibGVkIHNldCB0byB0cnVlLCB0aGVuIHNlbGYgYWxzbyBoYXMgbGlzdGVuaW5nIGVuYWJsZWQuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgc2hvdWxkRHJhd0hpdDogZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgICAgICAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldExheWVyKCk7XG4gICAgICAgICAgICByZXR1cm4gKGNhbnZhcyAmJiBjYW52YXMuaXNDYWNoZSkgfHwgKGxheWVyICYmIGxheWVyLmhpdEdyYXBoRW5hYmxlZCgpKVxuICAgICAgICAgICAgICAgICYmIHRoaXMuaXNMaXN0ZW5pbmcoKSAmJiB0aGlzLmlzVmlzaWJsZSgpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogc2hvdyBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKi9cbiAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGhpZGUgbm9kZS4gIEhpZGRlbiBub2RlcyBhcmUgbm8gbG9uZ2VyIGRldGVjdGFibGVcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqL1xuICAgICAgICBoaWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB6SW5kZXggcmVsYXRpdmUgdG8gdGhlIG5vZGUncyBzaWJsaW5ncyB3aG8gc2hhcmUgdGhlIHNhbWUgcGFyZW50XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0WkluZGV4OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluZGV4IHx8IDA7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgYWJzb2x1dGUgei1pbmRleCB3aGljaCB0YWtlcyBpbnRvIGFjY291bnQgc2libGluZ1xuICAgICAgICAgKiAgYW5kIGFuY2VzdG9yIGluZGljZXNcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0ludGVnZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRBYnNvbHV0ZVpJbmRleDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgZGVwdGggPSB0aGlzLmdldERlcHRoKCksXG4gICAgICAgICAgICAgICAgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgaW5kZXggPSAwLFxuICAgICAgICAgICAgICAgIG5vZGVzLCBsZW4sIG4sIGNoaWxkO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBhZGRDaGlsZHJlbihjaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIG5vZGVzID0gW107XG4gICAgICAgICAgICAgICAgbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvcihuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkID0gY2hpbGRyZW5bbl07XG4gICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoY2hpbGQubm9kZVR5cGUgIT09IFNIQVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlcyA9IG5vZGVzLmNvbmNhdChjaGlsZC5nZXRDaGlsZHJlbigpLnRvQXJyYXkoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZihjaGlsZC5faWQgPT09IHRoYXQuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gbGVuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYobm9kZXMubGVuZ3RoID4gMCAmJiBub2Rlc1swXS5nZXREZXB0aCgpIDw9IGRlcHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZENoaWxkcmVuKG5vZGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih0aGF0Lm5vZGVUeXBlICE9PSBVUFBFUl9TVEFHRSkge1xuICAgICAgICAgICAgICAgIGFkZENoaWxkcmVuKHRoYXQuZ2V0U3RhZ2UoKS5nZXRDaGlsZHJlbigpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IG5vZGUgZGVwdGggaW4gbm9kZSB0cmVlLiAgUmV0dXJucyBhbiBpbnRlZ2VyLlxuICAgICAgICAgKiAgZS5nLiBTdGFnZSBkZXB0aCB3aWxsIGFsd2F5cyBiZSAwLiAgTGF5ZXJzIHdpbGwgYWx3YXlzIGJlIDEuICBHcm91cHMgYW5kIFNoYXBlcyB3aWxsIGFsd2F5c1xuICAgICAgICAgKiAgYmUgPj0gMlxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7SW50ZWdlcn1cbiAgICAgICAgICovXG4gICAgICAgIGdldERlcHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBkZXB0aCA9IDAsXG4gICAgICAgICAgICAgICAgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cbiAgICAgICAgICAgIHdoaWxlKHBhcmVudCkge1xuICAgICAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkZXB0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0UG9zaXRpb246IGZ1bmN0aW9uKHBvcykge1xuICAgICAgICAgICAgdGhpcy5zZXRYKHBvcy54KTtcbiAgICAgICAgICAgIHRoaXMuc2V0WShwb3MueSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0UG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB4OiB0aGlzLmdldFgoKSxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLmdldFkoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBhYnNvbHV0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSBzdGFnZSBjb250YWluZXIgZGl2XG4gICAgICAgICAqIG9yIHJlbGF0aXZlIHRvIHBhc3NlZCBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFt0b3BdIG9wdGlvbmFsIHBhcmVudCBub2RlXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0QWJzb2x1dGVQb3NpdGlvbjogZnVuY3Rpb24odG9wKSB7XG4gICAgICAgICAgICB2YXIgYWJzb2x1dGVNYXRyaXggPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCksXG4gICAgICAgICAgICAgICAgYWJzb2x1dGVUcmFuc2Zvcm0gPSBuZXcgS29udmEuVHJhbnNmb3JtKCksXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTtcblxuICAgICAgICAgICAgLy8gY2xvbmUgdGhlIG1hdHJpeCBhcnJheVxuICAgICAgICAgICAgYWJzb2x1dGVUcmFuc2Zvcm0ubSA9IGFic29sdXRlTWF0cml4LnNsaWNlKCk7XG4gICAgICAgICAgICBhYnNvbHV0ZVRyYW5zZm9ybS50cmFuc2xhdGUob2Zmc2V0LngsIG9mZnNldC55KTtcblxuICAgICAgICAgICAgcmV0dXJuIGFic29sdXRlVHJhbnNmb3JtLmdldFRyYW5zbGF0aW9uKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgYWJzb2x1dGUgcG9zaXRpb25cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBvc1xuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9zLnhcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy55XG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0QWJzb2x1dGVQb3NpdGlvbjogZnVuY3Rpb24ocG9zKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ1RyYW5zID0gdGhpcy5fY2xlYXJUcmFuc2Zvcm0oKSxcbiAgICAgICAgICAgICAgICBpdDtcblxuICAgICAgICAgICAgLy8gZG9uJ3QgY2xlYXIgdHJhbnNsYXRpb25cbiAgICAgICAgICAgIHRoaXMuYXR0cnMueCA9IG9yaWdUcmFucy54O1xuICAgICAgICAgICAgdGhpcy5hdHRycy55ID0gb3JpZ1RyYW5zLnk7XG4gICAgICAgICAgICBkZWxldGUgb3JpZ1RyYW5zLng7XG4gICAgICAgICAgICBkZWxldGUgb3JpZ1RyYW5zLnk7XG5cbiAgICAgICAgICAgIC8vIHVucmF2ZWwgdHJhbnNmb3JtXG4gICAgICAgICAgICBpdCA9IHRoaXMuZ2V0QWJzb2x1dGVUcmFuc2Zvcm0oKTtcblxuICAgICAgICAgICAgaXQuaW52ZXJ0KCk7XG4gICAgICAgICAgICBpdC50cmFuc2xhdGUocG9zLngsIHBvcy55KTtcbiAgICAgICAgICAgIHBvcyA9IHtcbiAgICAgICAgICAgICAgICB4OiB0aGlzLmF0dHJzLnggKyBpdC5nZXRUcmFuc2xhdGlvbigpLngsXG4gICAgICAgICAgICAgICAgeTogdGhpcy5hdHRycy55ICsgaXQuZ2V0VHJhbnNsYXRpb24oKS55XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLnNldFBvc2l0aW9uKHt4OiBwb3MueCwgeTogcG9zLnl9KTtcbiAgICAgICAgICAgIHRoaXMuX3NldFRyYW5zZm9ybShvcmlnVHJhbnMpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3NldFRyYW5zZm9ybTogZnVuY3Rpb24odHJhbnMpIHtcbiAgICAgICAgICAgIHZhciBrZXk7XG5cbiAgICAgICAgICAgIGZvcihrZXkgaW4gdHJhbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJzW2tleV0gPSB0cmFuc1trZXldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKFRSQU5TRk9STSk7XG4gICAgICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfVFJBTlNGT1JNKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2NsZWFyVHJhbnNmb3JtOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0cmFucyA9IHtcbiAgICAgICAgICAgICAgICB4OiB0aGlzLmdldFgoKSxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLmdldFkoKSxcbiAgICAgICAgICAgICAgICByb3RhdGlvbjogdGhpcy5nZXRSb3RhdGlvbigpLFxuICAgICAgICAgICAgICAgIHNjYWxlWDogdGhpcy5nZXRTY2FsZVgoKSxcbiAgICAgICAgICAgICAgICBzY2FsZVk6IHRoaXMuZ2V0U2NhbGVZKCksXG4gICAgICAgICAgICAgICAgb2Zmc2V0WDogdGhpcy5nZXRPZmZzZXRYKCksXG4gICAgICAgICAgICAgICAgb2Zmc2V0WTogdGhpcy5nZXRPZmZzZXRZKCksXG4gICAgICAgICAgICAgICAgc2tld1g6IHRoaXMuZ2V0U2tld1goKSxcbiAgICAgICAgICAgICAgICBza2V3WTogdGhpcy5nZXRTa2V3WSgpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmF0dHJzLnggPSAwO1xuICAgICAgICAgICAgdGhpcy5hdHRycy55ID0gMDtcbiAgICAgICAgICAgIHRoaXMuYXR0cnMucm90YXRpb24gPSAwO1xuICAgICAgICAgICAgdGhpcy5hdHRycy5zY2FsZVggPSAxO1xuICAgICAgICAgICAgdGhpcy5hdHRycy5zY2FsZVkgPSAxO1xuICAgICAgICAgICAgdGhpcy5hdHRycy5vZmZzZXRYID0gMDtcbiAgICAgICAgICAgIHRoaXMuYXR0cnMub2Zmc2V0WSA9IDA7XG4gICAgICAgICAgICB0aGlzLmF0dHJzLnNrZXdYID0gMDtcbiAgICAgICAgICAgIHRoaXMuYXR0cnMuc2tld1kgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKFRSQU5TRk9STSk7XG4gICAgICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmREZXNjZW5kYW50Q2FjaGUoQUJTT0xVVEVfVFJBTlNGT1JNKTtcblxuICAgICAgICAgICAgLy8gcmV0dXJuIG9yaWdpbmFsIHRyYW5zZm9ybVxuICAgICAgICAgICAgcmV0dXJuIHRyYW5zO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSBub2RlIGJ5IGFuIGFtb3VudCByZWxhdGl2ZSB0byBpdHMgY3VycmVudCBwb3NpdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gY2hhbmdlXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjaGFuZ2UueFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gY2hhbmdlLnlcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIG1vdmUgbm9kZSBpbiB4IGRpcmVjdGlvbiBieSAxcHggYW5kIHkgZGlyZWN0aW9uIGJ5IDJweFxuICAgICAgICAgKiBub2RlLm1vdmUoe1xuICAgICAgICAgKiAgIHg6IDEsXG4gICAgICAgICAqICAgeTogMilcbiAgICAgICAgICogfSk7XG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlOiBmdW5jdGlvbihjaGFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VYID0gY2hhbmdlLngsXG4gICAgICAgICAgICAgICAgY2hhbmdlWSA9IGNoYW5nZS55LFxuICAgICAgICAgICAgICAgIHggPSB0aGlzLmdldFgoKSxcbiAgICAgICAgICAgICAgICB5ID0gdGhpcy5nZXRZKCk7XG5cbiAgICAgICAgICAgIGlmKGNoYW5nZVggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHggKz0gY2hhbmdlWDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoY2hhbmdlWSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgeSArPSBjaGFuZ2VZO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNldFBvc2l0aW9uKHt4OiB4LCB5OiB5fSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX2VhY2hBbmNlc3RvclJldmVyc2U6IGZ1bmN0aW9uKGZ1bmMsIHRvcCkge1xuICAgICAgICAgICAgdmFyIGZhbWlseSA9IFtdLFxuICAgICAgICAgICAgICAgIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50KCksXG4gICAgICAgICAgICAgICAgbGVuLCBuO1xuXG4gICAgICAgICAgICAvLyBpZiB0b3Agbm9kZSBpcyBkZWZpbmVkLCBhbmQgdGhpcyBub2RlIGlzIHRvcCBub2RlLFxuICAgICAgICAgICAgLy8gdGhlcmUncyBubyBuZWVkIHRvIGJ1aWxkIGEgZmFtaWx5IHRyZWUuICBqdXN0IGV4ZWN1dGVcbiAgICAgICAgICAgIC8vIGZ1bmMgd2l0aCB0aGlzIGJlY2F1c2UgaXQgd2lsbCBiZSB0aGUgb25seSBub2RlXG4gICAgICAgICAgICBpZiAodG9wICYmIHRvcC5faWQgPT09IHRoaXMuX2lkKSB7XG4gICAgICAgICAgICAgICAgZnVuYyh0aGlzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmFtaWx5LnVuc2hpZnQodGhpcyk7XG5cbiAgICAgICAgICAgIHdoaWxlKHBhcmVudCAmJiAoIXRvcCB8fCBwYXJlbnQuX2lkICE9PSB0b3AuX2lkKSkge1xuICAgICAgICAgICAgICAgIGZhbWlseS51bnNoaWZ0KHBhcmVudCk7XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGVuID0gZmFtaWx5Lmxlbmd0aDtcbiAgICAgICAgICAgIGZvcihuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgZnVuYyhmYW1pbHlbbl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogcm90YXRlIG5vZGUgYnkgYW4gYW1vdW50IGluIGRlZ3JlZXMgcmVsYXRpdmUgdG8gaXRzIGN1cnJlbnQgcm90YXRpb25cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHRoZXRhXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKi9cbiAgICAgICAgcm90YXRlOiBmdW5jdGlvbih0aGV0YSkge1xuICAgICAgICAgICAgdGhpcy5zZXRSb3RhdGlvbih0aGlzLmdldFJvdGF0aW9uKCkgKyB0aGV0YSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIG1vdmUgbm9kZSB0byB0aGUgdG9wIG9mIGl0cyBzaWJsaW5nc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIG1vdmVUb1RvcDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdOb2RlIGhhcyBubyBwYXJlbnQuIG1vdmVUb1RvcCBmdW5jdGlvbiBpcyBpZ25vcmVkLicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4ucHVzaCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Ll9zZXRDaGlsZHJlbkluZGljZXMoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSBub2RlIHVwXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBmbGFnIGlzIG1vdmVkIG9yIG5vdFxuICAgICAgICAgKi9cbiAgICAgICAgbW92ZVVwOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ05vZGUgaGFzIG5vIHBhcmVudC4gbW92ZVVwIGZ1bmN0aW9uIGlzIGlnbm9yZWQuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleCxcbiAgICAgICAgICAgICAgICBsZW4gPSB0aGlzLnBhcmVudC5nZXRDaGlsZHJlbigpLmxlbmd0aDtcbiAgICAgICAgICAgIGlmKGluZGV4IDwgbGVuIC0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKGluZGV4ICsgMSwgMCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3NldENoaWxkcmVuSW5kaWNlcygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSBub2RlIGRvd25cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlRG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdOb2RlIGhhcyBubyBwYXJlbnQuIG1vdmVEb3duIGZ1bmN0aW9uIGlzIGlnbm9yZWQuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgIGlmKGluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKGluZGV4IC0gMSwgMCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3NldENoaWxkcmVuSW5kaWNlcygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSBub2RlIHRvIHRoZSBib3R0b20gb2YgaXRzIHNpYmxpbmdzXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgbW92ZVRvQm90dG9tOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ05vZGUgaGFzIG5vIHBhcmVudC4gbW92ZVRvQm90dG9tIGZ1bmN0aW9uIGlzIGlnbm9yZWQuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgIGlmKGluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4udW5zaGlmdCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRyZW5JbmRpY2VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgekluZGV4IHJlbGF0aXZlIHRvIHNpYmxpbmdzXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gekluZGV4XG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0WkluZGV4OiBmdW5jdGlvbih6SW5kZXgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ05vZGUgaGFzIG5vIHBhcmVudC4gekluZGV4IHBhcmFtZXRlciBpcyBpZ25vcmVkLicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKHpJbmRleCwgMCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRyZW5JbmRpY2VzKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBhYnNvbHV0ZSBvcGFjaXR5XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRBYnNvbHV0ZU9wYWNpdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKEFCU09MVVRFX09QQUNJVFksIHRoaXMuX2dldEFic29sdXRlT3BhY2l0eSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRBYnNvbHV0ZU9wYWNpdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGFic09wYWNpdHkgPSB0aGlzLmdldE9wYWNpdHkoKTtcbiAgICAgICAgICAgIGlmKHRoaXMuZ2V0UGFyZW50KCkpIHtcbiAgICAgICAgICAgICAgICBhYnNPcGFjaXR5ICo9IHRoaXMuZ2V0UGFyZW50KCkuZ2V0QWJzb2x1dGVPcGFjaXR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWJzT3BhY2l0eTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIG1vdmUgbm9kZSB0byBhbm90aGVyIGNvbnRhaW5lclxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0NvbnRhaW5lcn0gbmV3Q29udGFpbmVyXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiAvLyBtb3ZlIG5vZGUgZnJvbSBjdXJyZW50IGxheWVyIGludG8gbGF5ZXIyXG4gICAgICAgICAqIG5vZGUubW92ZVRvKGxheWVyMik7XG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlVG86IGZ1bmN0aW9uKG5ld0NvbnRhaW5lcikge1xuICAgICAgICAgICAgLy8gZG8gbm90aGluZyBpZiBuZXcgY29udGFpbmVyIGlzIGFscmVhZHkgcGFyZW50XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRQYXJlbnQoKSAhPT0gbmV3Q29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBuZXdDb250YWluZXIuYWRkKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb252ZXJ0IE5vZGUgaW50byBhbiBvYmplY3QgZm9yIHNlcmlhbGl6YXRpb24uICBSZXR1cm5zIGFuIG9iamVjdC5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHRvT2JqZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBvYmogPSB7fSxcbiAgICAgICAgICAgICAgICBhdHRycyA9IHRoaXMuZ2V0QXR0cnMoKSxcbiAgICAgICAgICAgICAgICBrZXksIHZhbCwgZ2V0dGVyLCBkZWZhdWx0VmFsdWU7XG5cbiAgICAgICAgICAgIG9iai5hdHRycyA9IHt9O1xuXG4gICAgICAgICAgICBmb3Ioa2V5IGluIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gYXR0cnNba2V5XTtcbiAgICAgICAgICAgICAgICBnZXR0ZXIgPSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGF0dHIgdmFsdWUgc28gdGhhdCB3ZSBjYW4gZXh0cmFjdCB0aGUgZGVmYXVsdCB2YWx1ZSBmcm9tIHRoZSBnZXR0ZXJcbiAgICAgICAgICAgICAgICBkZWxldGUgYXR0cnNba2V5XTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWUgPSBnZXR0ZXIgPyBnZXR0ZXIuY2FsbCh0aGlzKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgLy8gcmVzdG9yZSBhdHRyIHZhbHVlXG4gICAgICAgICAgICAgICAgYXR0cnNba2V5XSA9IHZhbDtcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlICE9PSB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmF0dHJzW2tleV0gPSB2YWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvYmouY2xhc3NOYW1lID0gdGhpcy5nZXRDbGFzc05hbWUoKTtcbiAgICAgICAgICAgIHJldHVybiBLb252YS5VdGlsLl9wcmVwYXJlVG9TdHJpbmdpZnkob2JqKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbnZlcnQgTm9kZSBpbnRvIGEgSlNPTiBzdHJpbmcuICBSZXR1cm5zIGEgSlNPTiBzdHJpbmcuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9fVxuICAgICAgICAgKi9cbiAgICAgICAgdG9KU09OOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvT2JqZWN0KCkpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IHBhcmVudCBjb250YWluZXJcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRQYXJlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGFsbCBhbmNlc3Ryb3MgKHBhcmVudCB0aGVuIHBhcmVudCBvZiB0aGUgcGFyZW50LCBldGMpIG9mIHRoZSBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc2VsZWN0b3JdIHNlbGVjdG9yIGZvciBzZWFyY2hcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBbaW5jbHVkZVNlbGZdIHNob3cgd2UgdGhpbmsgdGhhdCBub2RlIGlzIGFuY2VzdHJvIGl0c2VsZj9cbiAgICAgICAgICogQHBhcmFtIHtLb252YS5Ob2RlfSBbc3RvcE5vZGVdIG9wdGlvbmFsIG5vZGUgd2hlcmUgd2UgbmVlZCB0byBzdG9wIHNlYXJjaGluZyAob25lIG9mIGFuY2VzdG9ycylcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fSBbYW5jZXN0b3JzXVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiAvLyBnZXQgb25lIG9mIHRoZSBwYXJlbnQgZ3JvdXBcbiAgICAgICAgICogdmFyIHBhcmVudEdyb3VwcyA9IG5vZGUuZmluZEFuY2VzdG9ycygnR3JvdXAnKTtcbiAgICAgICAgICovXG4gICAgICAgIGZpbmRBbmNlc3RvcnM6IGZ1bmN0aW9uKHNlbGVjdG9yLCBpbmNsdWRlU2VsZiwgc3RvcE5vZGUpIHtcbiAgICAgICAgICAgIHZhciByZXMgPSBbXTtcblxuICAgICAgICAgICAgaWYgKGluY2x1ZGVTZWxmICYmIHRoaXMuX2lzTWF0Y2goc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2godGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYW5jZXN0b3IgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHdoaWxlKGFuY2VzdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yID09PSBzdG9wTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3IuX2lzTWF0Y2goc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKGFuY2VzdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGFuY2VzdG9yIChwYXJlbnQgb3IgcGFyZW50IG9mIHRoZSBwYXJlbnQsIGV0Yykgb2YgdGhlIG5vZGUgdGhhdCBtYXRjaCBwYXNzZWQgc2VsZWN0b3JcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IFtzZWxlY3Rvcl0gc2VsZWN0b3IgZm9yIHNlYXJjaFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtpbmNsdWRlU2VsZl0gc2hvdyB3ZSB0aGluayB0aGF0IG5vZGUgaXMgYW5jZXN0cm8gaXRzZWxmP1xuICAgICAgICAgKiBAcGFyYW0ge0tvbnZhLk5vZGV9IFtzdG9wTm9kZV0gb3B0aW9uYWwgbm9kZSB3aGVyZSB3ZSBuZWVkIHRvIHN0b3Agc2VhcmNoaW5nIChvbmUgb2YgYW5jZXN0b3JzKVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuTm9kZX0gYW5jZXN0b3JcbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogLy8gZ2V0IG9uZSBvZiB0aGUgcGFyZW50IGdyb3VwXG4gICAgICAgICAqIHZhciBncm91cCA9IG5vZGUuZmluZEFuY2VzdG9ycygnLm15Z3JvdXAnKTtcbiAgICAgICAgICovXG4gICAgICAgIGZpbmRBbmNlc3RvcjogZnVuY3Rpb24oc2VsZWN0b3IsIGluY2x1ZGVTZWxmLCBzdG9wTm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZEFuY2VzdG9ycyhzZWxlY3RvciwgaW5jbHVkZVNlbGYsIHN0b3BOb2RlKVswXTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaXMgY3VycmVudCBub2RlIG1hdGNoIHBhc3NlZCBzZWxlY3Rvcj9cbiAgICAgICAgX2lzTWF0Y2g6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBpZiAoIXNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlbGVjdG9yQXJyID0gc2VsZWN0b3IucmVwbGFjZSgvIC9nLCAnJykuc3BsaXQoJywnKSxcbiAgICAgICAgICAgICAgICBsZW4gPSBzZWxlY3RvckFyci5sZW5ndGgsXG4gICAgICAgICAgICAgICAgbiwgc2VsO1xuXG4gICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICBzZWwgPSBzZWxlY3RvckFycltuXTtcbiAgICAgICAgICAgICAgICBpZiAoIUtvbnZhLlV0aWwuaXNWYWxpZFNlbGVjdG9yKHNlbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdTZWxlY3RvciBcIicgKyBzZWwgKyAnXCIgaXMgaW52YWxpZC4gQWxsb3dlZCBzZWxlY3RvcnMgZXhhbXBsZXMgYXJlIFwiI2Zvb1wiLCBcIi5iYXJcIiBvciBcIkdyb3VwXCIuJyk7XG4gICAgICAgICAgICAgICAgICAgIEtvbnZhLlV0aWwud2FybignSWYgeW91IGhhdmUgYSBjdXN0b20gc2hhcGUgd2l0aCBzdWNoIGNsYXNzTmFtZSwgcGxlYXNlIGNoYW5nZSBpdCB0byBzdGFydCB3aXRoIHVwcGVyIGxldHRlciBsaWtlIFwiVHJpYW5nbGVcIi4nKTtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdLb252YSBpcyBhd2Vzb21lLCByaWdodD8nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gaWQgc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBpZihzZWwuY2hhckF0KDApID09PSAnIycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaWQoKSA9PT0gc2VsLnNsaWNlKDEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBuYW1lIHNlbGVjdG9yXG4gICAgICAgICAgICAgICAgZWxzZSBpZihzZWwuY2hhckF0KDApID09PSAnLicpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTmFtZShzZWwuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZ2V0KHNlbCkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBsYXllciBhbmNlc3RvclxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuTGF5ZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRMYXllcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQgPyBwYXJlbnQuZ2V0TGF5ZXIoKSA6IG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgc3RhZ2UgYW5jZXN0b3JcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLlN0YWdlfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0U3RhZ2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKFNUQUdFLCB0aGlzLl9nZXRTdGFnZSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRTdGFnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnQoKTtcbiAgICAgICAgICAgIGlmKHBhcmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJlbnQuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBmaXJlIGV2ZW50XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFR5cGUgZXZlbnQgdHlwZS4gIGNhbiBiZSBhIHJlZ3VsYXIgZXZlbnQsIGxpa2UgY2xpY2ssIG1vdXNlb3Zlciwgb3IgbW91c2VvdXQsIG9yIGl0IGNhbiBiZSBhIGN1c3RvbSBldmVudCwgbGlrZSBteUN1c3RvbUV2ZW50XG4gICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IFtldnRdIGV2ZW50IG9iamVjdFxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtidWJibGVdIHNldHRpbmcgdGhlIHZhbHVlIHRvIGZhbHNlLCBvciBsZWF2aW5nIGl0IHVuZGVmaW5lZCwgd2lsbCByZXN1bHQgaW4gdGhlIGV2ZW50XG4gICAgICAgICAqICBub3QgYnViYmxpbmcuICBTZXR0aW5nIHRoZSB2YWx1ZSB0byB0cnVlIHdpbGwgcmVzdWx0IGluIHRoZSBldmVudCBidWJibGluZy5cbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIG1hbnVhbGx5IGZpcmUgY2xpY2sgZXZlbnRcbiAgICAgICAgICogbm9kZS5maXJlKCdjbGljaycpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBmaXJlIGN1c3RvbSBldmVudFxuICAgICAgICAgKiBub2RlLmZpcmUoJ2ZvbycpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBmaXJlIGN1c3RvbSBldmVudCB3aXRoIGN1c3RvbSBldmVudCBvYmplY3RcbiAgICAgICAgICogbm9kZS5maXJlKCdmb28nLCB7XG4gICAgICAgICAqICAgYmFyOiAxMFxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICpcbiAgICAgICAgICogLy8gZmlyZSBjbGljayBldmVudCB0aGF0IGJ1YmJsZXNcbiAgICAgICAgICogbm9kZS5maXJlKCdjbGljaycsIG51bGwsIHRydWUpO1xuICAgICAgICAgKi9cbiAgICAgICAgZmlyZTogZnVuY3Rpb24oZXZlbnRUeXBlLCBldnQsIGJ1YmJsZSkge1xuICAgICAgICAgICAgZXZ0ID0gZXZ0IHx8IHt9O1xuICAgICAgICAgICAgZXZ0LnRhcmdldCA9IGV2dC50YXJnZXQgfHwgdGhpcztcbiAgICAgICAgICAgIC8vIGJ1YmJsZVxuICAgICAgICAgICAgaWYgKGJ1YmJsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVBbmRCdWJibGUoZXZlbnRUeXBlLCBldnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbm8gYnViYmxlXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlKGV2ZW50VHlwZSwgZXZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGFic29sdXRlIHRyYW5zZm9ybSBvZiB0aGUgbm9kZSB3aGljaCB0YWtlcyBpbnRvXG4gICAgICAgICAqICBhY2NvdW50IGl0cyBhbmNlc3RvciB0cmFuc2Zvcm1zXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICBnZXRBYnNvbHV0ZVRyYW5zZm9ybTogZnVuY3Rpb24odG9wKSB7XG4gICAgICAgICAgICAvLyBpZiB1c2luZyBhbiBhcmd1bWVudCwgd2UgY2FuJ3QgY2FjaGUgdGhlIHJlc3VsdC5cbiAgICAgICAgICAgIGlmICh0b3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vIGFyZ3VtZW50LCB3ZSBjYW4gY2FjaGUgdGhlIHJlc3VsdFxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKEFCU09MVVRFX1RSQU5TRk9STSwgdGhpcy5fZ2V0QWJzb2x1dGVUcmFuc2Zvcm0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfZ2V0QWJzb2x1dGVUcmFuc2Zvcm06IGZ1bmN0aW9uKHRvcCkge1xuICAgICAgICAgICAgdmFyIGF0ID0gbmV3IEtvbnZhLlRyYW5zZm9ybSgpLFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybXNFbmFibGVkLCB0cmFucztcblxuICAgICAgICAgICAgLy8gc3RhcnQgd2l0aCBzdGFnZSBhbmQgdHJhdmVyc2UgZG93bndhcmRzIHRvIHNlbGZcbiAgICAgICAgICAgIHRoaXMuX2VhY2hBbmNlc3RvclJldmVyc2UoZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybXNFbmFibGVkID0gbm9kZS50cmFuc2Zvcm1zRW5hYmxlZCgpO1xuICAgICAgICAgICAgICAgIHRyYW5zID0gbm9kZS5nZXRUcmFuc2Zvcm0oKTtcblxuICAgICAgICAgICAgICAgIGlmICh0cmFuc2Zvcm1zRW5hYmxlZCA9PT0gJ2FsbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgYXQubXVsdGlwbHkodHJhbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0cmFuc2Zvcm1zRW5hYmxlZCA9PT0gJ3Bvc2l0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBhdC50cmFuc2xhdGUobm9kZS54KCksIG5vZGUueSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0b3ApO1xuICAgICAgICAgICAgcmV0dXJuIGF0O1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGFic29sdXRlIHNjYWxlIG9mIHRoZSBub2RlIHdoaWNoIHRha2VzIGludG9cbiAgICAgICAgICogIGFjY291bnQgaXRzIGFuY2VzdG9yIHNjYWxlc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuVHJhbnNmb3JtfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0QWJzb2x1dGVTY2FsZTogZnVuY3Rpb24odG9wKSB7XG4gICAgICAgICAgICAvLyBpZiB1c2luZyBhbiBhcmd1bWVudCwgd2UgY2FuJ3QgY2FjaGUgdGhlIHJlc3VsdC5cbiAgICAgICAgICAgIGlmICh0b3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vIGFyZ3VtZW50LCB3ZSBjYW4gY2FjaGUgdGhlIHJlc3VsdFxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKEFCU09MVVRFX1NDQUxFLCB0aGlzLl9nZXRBYnNvbHV0ZVNjYWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldEFic29sdXRlU2NhbGU6IGZ1bmN0aW9uKHRvcCkge1xuICAgICAgICAgICAgdmFyIHNjYWxlWCA9IDEsIHNjYWxlWSA9IDE7XG5cbiAgICAgICAgICAgIC8vIHN0YXJ0IHdpdGggc3RhZ2UgYW5kIHRyYXZlcnNlIGRvd253YXJkcyB0byBzZWxmXG4gICAgICAgICAgICB0aGlzLl9lYWNoQW5jZXN0b3JSZXZlcnNlKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBzY2FsZVggKj0gbm9kZS5zY2FsZVgoKTtcbiAgICAgICAgICAgICAgICBzY2FsZVkgKj0gbm9kZS5zY2FsZVkoKTtcbiAgICAgICAgICAgIH0sIHRvcCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IHNjYWxlWCxcbiAgICAgICAgICAgICAgICB5OiBzY2FsZVlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgdHJhbnNmb3JtIG9mIHRoZSBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5UcmFuc2Zvcm19XG4gICAgICAgICAqL1xuICAgICAgICBnZXRUcmFuc2Zvcm06IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKFRSQU5TRk9STSwgdGhpcy5fZ2V0VHJhbnNmb3JtKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2dldFRyYW5zZm9ybTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbSA9IG5ldyBLb252YS5UcmFuc2Zvcm0oKSxcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5nZXRYKCksXG4gICAgICAgICAgICAgICAgeSA9IHRoaXMuZ2V0WSgpLFxuICAgICAgICAgICAgICAgIHJvdGF0aW9uID0gS29udmEuZ2V0QW5nbGUodGhpcy5nZXRSb3RhdGlvbigpKSxcbiAgICAgICAgICAgICAgICBzY2FsZVggPSB0aGlzLmdldFNjYWxlWCgpLFxuICAgICAgICAgICAgICAgIHNjYWxlWSA9IHRoaXMuZ2V0U2NhbGVZKCksXG4gICAgICAgICAgICAgICAgc2tld1ggPSB0aGlzLmdldFNrZXdYKCksXG4gICAgICAgICAgICAgICAgc2tld1kgPSB0aGlzLmdldFNrZXdZKCksXG4gICAgICAgICAgICAgICAgb2Zmc2V0WCA9IHRoaXMuZ2V0T2Zmc2V0WCgpLFxuICAgICAgICAgICAgICAgIG9mZnNldFkgPSB0aGlzLmdldE9mZnNldFkoKTtcblxuICAgICAgICAgICAgaWYoeCAhPT0gMCB8fCB5ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgbS50cmFuc2xhdGUoeCwgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihyb3RhdGlvbiAhPT0gMCkge1xuICAgICAgICAgICAgICAgIG0ucm90YXRlKHJvdGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHNrZXdYICE9PSAwIHx8IHNrZXdZICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgbS5za2V3KHNrZXdYLCBza2V3WSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihzY2FsZVggIT09IDEgfHwgc2NhbGVZICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgbS5zY2FsZShzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihvZmZzZXRYICE9PSAwIHx8IG9mZnNldFkgIT09IDApIHtcbiAgICAgICAgICAgICAgICBtLnRyYW5zbGF0ZSgtMSAqIG9mZnNldFgsIC0xICogb2Zmc2V0WSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBtO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogY2xvbmUgbm9kZS4gIFJldHVybnMgYSBuZXcgTm9kZSBpbnN0YW5jZSB3aXRoIGlkZW50aWNhbCBhdHRyaWJ1dGVzLiAgWW91IGNhbiBhbHNvIG92ZXJyaWRlXG4gICAgICAgICAqICB0aGUgbm9kZSBwcm9wZXJ0aWVzIHdpdGggYW4gb2JqZWN0IGxpdGVyYWwsIGVuYWJsaW5nIHlvdSB0byB1c2UgYW4gZXhpc3Rpbmcgbm9kZSBhcyBhIHRlbXBsYXRlXG4gICAgICAgICAqICBmb3IgYW5vdGhlciBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogb3ZlcnJpZGUgYXR0cnNcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIHNpbXBsZSBjbG9uZVxuICAgICAgICAgKiB2YXIgY2xvbmUgPSBub2RlLmNsb25lKCk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGNsb25lIGEgbm9kZSBhbmQgb3ZlcnJpZGUgdGhlIHggcG9zaXRpb25cbiAgICAgICAgICogdmFyIGNsb25lID0gcmVjdC5jbG9uZSh7XG4gICAgICAgICAqICAgeDogNVxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICovXG4gICAgICAgIGNsb25lOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIC8vIGluc3RhbnRpYXRlIG5ldyBub2RlXG4gICAgICAgICAgICB2YXIgYXR0cnMgPSBLb252YS5VdGlsLmNsb25lT2JqZWN0KHRoaXMuYXR0cnMpLFxuICAgICAgICAgICAgICAgIGtleSwgYWxsTGlzdGVuZXJzLCBsZW4sIG4sIGxpc3RlbmVyO1xuICAgICAgICAgICAgLy8gZmlsdGVyIGJsYWNrIGF0dHJzXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIENMT05FX0JMQUNLX0xJU1QpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmxvY2tBdHRyID0gQ0xPTkVfQkxBQ0tfTElTVFtpXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgYXR0cnNbYmxvY2tBdHRyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGFwcGx5IGF0dHIgb3ZlcnJpZGVzXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBhdHRyc1trZXldID0gb2JqW2tleV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBub2RlID0gbmV3IHRoaXMuY29uc3RydWN0b3IoYXR0cnMpO1xuICAgICAgICAgICAgLy8gY29weSBvdmVyIGxpc3RlbmVyc1xuICAgICAgICAgICAgZm9yKGtleSBpbiB0aGlzLmV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICAgICAgICAgICAgYWxsTGlzdGVuZXJzID0gdGhpcy5ldmVudExpc3RlbmVyc1trZXldO1xuICAgICAgICAgICAgICAgIGxlbiA9IGFsbExpc3RlbmVycy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIgPSBhbGxMaXN0ZW5lcnNbbl07XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIGRvbid0IGluY2x1ZGUga29udmEgbmFtZXNwYWNlZCBsaXN0ZW5lcnMgYmVjYXVzZVxuICAgICAgICAgICAgICAgICAgICAgKiAgdGhlc2UgYXJlIGdlbmVyYXRlZCBieSB0aGUgY29uc3RydWN0b3JzXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBpZihsaXN0ZW5lci5uYW1lLmluZGV4T2YoS09OVkEpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgbGlzdGVuZXJzIGFycmF5IGRvZXNuJ3QgZXhpc3QsIHRoZW4gY3JlYXRlIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICBpZighbm9kZS5ldmVudExpc3RlbmVyc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5ldmVudExpc3RlbmVyc1trZXldID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLmV2ZW50TGlzdGVuZXJzW2tleV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZXMgYSBjb21wb3NpdGUgZGF0YSBVUkwuIElmIE1JTUUgdHlwZSBpcyBub3RcbiAgICAgICAgICogc3BlY2lmaWVkLCB0aGVuIFwiaW1hZ2UvcG5nXCIgd2lsbCByZXN1bHQuIEZvciBcImltYWdlL2pwZWdcIiwgc3BlY2lmeSBhIHF1YWxpdHlcbiAgICAgICAgICogbGV2ZWwgYXMgcXVhbGl0eSAocmFuZ2UgMC4wIC0gMS4wKVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm1pbWVUeXBlXSBjYW4gYmUgXCJpbWFnZS9wbmdcIiBvciBcImltYWdlL2pwZWdcIi5cbiAgICAgICAgICogIFwiaW1hZ2UvcG5nXCIgaXMgdGhlIGRlZmF1bHRcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF0geCBwb3NpdGlvbiBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XSB5IHBvc2l0aW9uIG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXSB3aWR0aCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdIGhlaWdodCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5xdWFsaXR5XSBqcGVnIHF1YWxpdHkuICBJZiB1c2luZyBhbiBcImltYWdlL2pwZWdcIiBtaW1lVHlwZSxcbiAgICAgICAgICogIHlvdSBjYW4gc3BlY2lmeSB0aGUgcXVhbGl0eSBmcm9tIDAgdG8gMSwgd2hlcmUgMCBpcyB2ZXJ5IHBvb3IgcXVhbGl0eSBhbmQgMVxuICAgICAgICAgKiAgaXMgdmVyeSBoaWdoIHF1YWxpdHlcbiAgICAgICAgICogQHBhcmVtdCB7TnVtYmVyfSBbY29uZmlnLnBpeGVsUmF0aW9dIHBpeGVsUmF0aW8gb2Ygb3VwdXQgaW1hZ2UgdXJsLiBEZWZhdWx0IGlzIDFcbiAgICAgICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHRvRGF0YVVSTDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcgPSBjb25maWcgfHwge307XG5cbiAgICAgICAgICAgIHZhciBtaW1lVHlwZSA9IGNvbmZpZy5taW1lVHlwZSB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHF1YWxpdHkgPSBjb25maWcucXVhbGl0eSB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpLFxuICAgICAgICAgICAgICAgIHggPSBjb25maWcueCB8fCAwLFxuICAgICAgICAgICAgICAgIHkgPSBjb25maWcueSB8fCAwLFxuICAgICAgICAgICAgICAgIHBpeGVsUmF0aW8gPSBjb25maWcucGl4ZWxSYXRpbyB8fCAxLFxuICAgICAgICAgICAgICAgIGNhbnZhcyA9IG5ldyBLb252YS5TY2VuZUNhbnZhcyh7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjb25maWcud2lkdGggfHwgdGhpcy5nZXRXaWR0aCgpIHx8IChzdGFnZSA/IHN0YWdlLmdldFdpZHRoKCkgOiAwKSxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBjb25maWcuaGVpZ2h0IHx8IHRoaXMuZ2V0SGVpZ2h0KCkgfHwgKHN0YWdlID8gc3RhZ2UuZ2V0SGVpZ2h0KCkgOiAwKSxcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxSYXRpbzogcGl4ZWxSYXRpb1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgpO1xuXG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcblxuICAgICAgICAgICAgaWYoeCB8fCB5KSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoLTEgKiB4LCAtMSAqIHkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRyYXdTY2VuZShjYW52YXMpO1xuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKG1pbWVUeXBlLCBxdWFsaXR5KTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbnZlcnRzIG5vZGUgaW50byBhbiBpbWFnZS4gIFNpbmNlIHRoZSB0b0ltYWdlXG4gICAgICAgICAqICBtZXRob2QgaXMgYXN5bmNocm9ub3VzLCBhIGNhbGxiYWNrIGlzIHJlcXVpcmVkLiAgdG9JbWFnZSBpcyBtb3N0IGNvbW1vbmx5IHVzZWRcbiAgICAgICAgICogIHRvIGNhY2hlIGNvbXBsZXggZHJhd2luZ3MgYXMgYW4gaW1hZ2Ugc28gdGhhdCB0aGV5IGRvbid0IGhhdmUgdG8gY29uc3RhbnRseSBiZSByZWRyYXduXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29uZmlnLmNhbGxiYWNrIGZ1bmN0aW9uIGV4ZWN1dGVkIHdoZW4gdGhlIGNvbXBvc2l0ZSBoYXMgY29tcGxldGVkXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm1pbWVUeXBlXSBjYW4gYmUgXCJpbWFnZS9wbmdcIiBvciBcImltYWdlL2pwZWdcIi5cbiAgICAgICAgICogIFwiaW1hZ2UvcG5nXCIgaXMgdGhlIGRlZmF1bHRcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF0geCBwb3NpdGlvbiBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XSB5IHBvc2l0aW9uIG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXSB3aWR0aCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdIGhlaWdodCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5xdWFsaXR5XSBqcGVnIHF1YWxpdHkuICBJZiB1c2luZyBhbiBcImltYWdlL2pwZWdcIiBtaW1lVHlwZSxcbiAgICAgICAgICogIHlvdSBjYW4gc3BlY2lmeSB0aGUgcXVhbGl0eSBmcm9tIDAgdG8gMSwgd2hlcmUgMCBpcyB2ZXJ5IHBvb3IgcXVhbGl0eSBhbmQgMVxuICAgICAgICAgKiAgaXMgdmVyeSBoaWdoIHF1YWxpdHlcbiAgICAgICAgICogQHBhcmVtdCB7TnVtYmVyfSBbY29uZmlnLnBpeGVsUmF0aW9dIHBpeGVsUmF0aW8gb2Ygb3VwdXQgaW1hZ2UuICBEZWZhdWx0IGlzIDEuXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIHZhciBpbWFnZSA9IG5vZGUudG9JbWFnZSh7XG4gICAgICAgICAqICAgY2FsbGJhY2s6IGZ1bmN0aW9uKGltZykge1xuICAgICAgICAgKiAgICAgLy8gZG8gc3R1ZmYgd2l0aCBpbWdcbiAgICAgICAgICogICB9XG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgdG9JbWFnZTogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICBpZiAoIWNvbmZpZyB8fCAhY29uZmlnLmNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgJ2NhbGxiYWNrIHJlcXVpcmVkIGZvciB0b0ltYWdlIG1ldGhvZCBjb25maWcgYXJndW1lbnQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgS29udmEuVXRpbC5fZ2V0SW1hZ2UodGhpcy50b0RhdGFVUkwoY29uZmlnKSwgZnVuY3Rpb24oaW1nKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmNhbGxiYWNrKGltZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0U2l6ZTogZnVuY3Rpb24oc2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRXaWR0aChzaXplLndpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0SGVpZ2h0KHNpemUuaGVpZ2h0KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuZ2V0V2lkdGgoKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMuZ2V0SGVpZ2h0KClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJzLndpZHRoIHx8IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5oZWlnaHQgfHwgMDtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBjbGFzcyBuYW1lLCB3aGljaCBtYXkgcmV0dXJuIFN0YWdlLCBMYXllciwgR3JvdXAsIG9yIHNoYXBlIGNsYXNzIG5hbWVzIGxpa2UgUmVjdCwgQ2lyY2xlLCBUZXh0LCBldGMuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NOYW1lIHx8IHRoaXMubm9kZVR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgdGhlIG5vZGUgdHlwZSwgd2hpY2ggbWF5IHJldHVybiBTdGFnZSwgTGF5ZXIsIEdyb3VwLCBvciBOb2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRUeXBlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5vZGVUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBnZXREcmFnRGlzdGFuY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gY29tcGFyZSB3aXRoIHVuZGVmaW5lZCBiZWNhdXNlIHdlIG5lZWQgdG8gdHJhY2sgMCB2YWx1ZVxuICAgICAgICAgICAgaWYgKHRoaXMuYXR0cnMuZHJhZ0Rpc3RhbmNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5kcmFnRGlzdGFuY2U7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmdldERyYWdEaXN0YW5jZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS29udmEuZHJhZ0Rpc3RhbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfZ2V0OiBmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NOYW1lID09PSBzZWxlY3RvciB8fCB0aGlzLm5vZGVUeXBlID09PSBzZWxlY3RvciA/IFt0aGlzXSA6IFtdO1xuICAgICAgICB9LFxuICAgICAgICBfb2ZmOiBmdW5jdGlvbih0eXBlLCBuYW1lKSB7XG4gICAgICAgICAgICB2YXIgZXZ0TGlzdGVuZXJzID0gdGhpcy5ldmVudExpc3RlbmVyc1t0eXBlXSxcbiAgICAgICAgICAgICAgICBpLCBldnROYW1lO1xuXG4gICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBldnRMaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBldnROYW1lID0gZXZ0TGlzdGVuZXJzW2ldLm5hbWU7XG4gICAgICAgICAgICAgICAgLy8gdGhlIGZvbGxvd2luZyB0d28gY29uZGl0aW9ucyBtdXN0IGJlIHRydWUgaW4gb3JkZXIgdG8gcmVtb3ZlIGEgaGFuZGxlcjpcbiAgICAgICAgICAgICAgICAvLyAxKSB0aGUgY3VycmVudCBldmVudCBuYW1lIGNhbm5vdCBiZSBrb252YSB1bmxlc3MgdGhlIGV2ZW50IG5hbWUgaXMga29udmFcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzIGVuYWJsZXMgZGV2ZWxvcGVycyB0byBmb3JjZSByZW1vdmUgYSBrb252YSBzcGVjaWZpYyBsaXN0ZW5lciBmb3Igd2hhdGV2ZXIgcmVhc29uXG4gICAgICAgICAgICAgICAgLy8gMikgYW4gZXZlbnQgbmFtZSBpcyBub3Qgc3BlY2lmaWVkLCBvciBpZiBvbmUgaXMgc3BlY2lmaWVkLCBpdCBtYXRjaGVzIHRoZSBjdXJyZW50IGV2ZW50IG5hbWVcbiAgICAgICAgICAgICAgICBpZigoZXZ0TmFtZSAhPT0gJ2tvbnZhJyB8fCBuYW1lID09PSAna29udmEnKSAmJiAoIW5hbWUgfHwgZXZ0TmFtZSA9PT0gbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0TGlzdGVuZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYoZXZ0TGlzdGVuZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZXZlbnRMaXN0ZW5lcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfZmlyZUNoYW5nZUV2ZW50OiBmdW5jdGlvbihhdHRyLCBvbGRWYWwsIG5ld1ZhbCkge1xuICAgICAgICAgICAgdGhpcy5fZmlyZShhdHRyICsgQ0hBTkdFLCB7XG4gICAgICAgICAgICAgICAgb2xkVmFsOiBvbGRWYWwsXG4gICAgICAgICAgICAgICAgbmV3VmFsOiBuZXdWYWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBzZXRJZDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgICAgIHZhciBvbGRJZCA9IHRoaXMuZ2V0SWQoKTtcblxuICAgICAgICAgICAgS29udmEuX3JlbW92ZUlkKG9sZElkKTtcbiAgICAgICAgICAgIEtvbnZhLl9hZGRJZCh0aGlzLCBpZCk7XG4gICAgICAgICAgICB0aGlzLl9zZXRBdHRyKElELCBpZCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0TmFtZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgdmFyIG9sZE5hbWVzID0gKHRoaXMuZ2V0TmFtZSgpIHx8ICcnKS5zcGxpdCgvXFxzL2cpO1xuICAgICAgICAgICAgdmFyIG5ld05hbWVzID0gKG5hbWUgfHwgJycpLnNwbGl0KC9cXHMvZyk7XG4gICAgICAgICAgICB2YXIgc3VibmFtZSwgaTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgc3VibmFtZXNcbiAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IG9sZE5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3VibmFtZSA9IG9sZE5hbWVzW2ldO1xuICAgICAgICAgICAgICAgIGlmICgobmV3TmFtZXMuaW5kZXhPZihzdWJuYW1lKSkgPT09IC0xICYmIHN1Ym5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuX3JlbW92ZU5hbWUoc3VibmFtZSwgdGhpcy5faWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIG5ldyBuYW1lc1xuICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgbmV3TmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzdWJuYW1lID0gbmV3TmFtZXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKChvbGROYW1lcy5pbmRleE9mKHN1Ym5hbWUpID09PSAtMSkgJiYgc3VibmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBLb252YS5fYWRkTmFtZSh0aGlzLCBzdWJuYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NldEF0dHIoTkFNRSwgbmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLy8gbmFtaW5nIG1ldGhvZHNcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGFkZCBuYW1lIHRvIG5vZGVcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIG5vZGUubmFtZSgncmVkJyk7XG4gICAgICAgICAqIG5vZGUuYWRkTmFtZSgnc2VsZWN0ZWQnKTtcbiAgICAgICAgICogbm9kZS5uYW1lKCk7IC8vIHJldHVybiAncmVkIHNlbGVjdGVkJ1xuICAgICAgICAgKi9cbiAgICAgICAgYWRkTmFtZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmhhc05hbWUobmFtZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2xkTmFtZSA9IHRoaXMubmFtZSgpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdOYW1lID0gb2xkTmFtZSA/IChvbGROYW1lICsgJyAnICsgbmFtZSkgOiBuYW1lO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TmFtZShuZXdOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogY2hlY2sgaXMgbm9kZSBoYXMgbmFtZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogbm9kZS5uYW1lKCdyZWQnKTtcbiAgICAgICAgICogbm9kZS5oYXNOYW1lKCdyZWQnKTsgICAvLyByZXR1cm4gdHJ1ZVxuICAgICAgICAgKiBub2RlLmhhc05hbWUoJ3NlbGVjdGVkJyk7IC8vIHJldHVybiBmYWxzZVxuICAgICAgICAgKi9cbiAgICAgICAgaGFzTmFtZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgdmFyIG5hbWVzID0gKHRoaXMubmFtZSgpIHx8ICcnKS5zcGxpdCgvXFxzL2cpO1xuICAgICAgICAgICAgcmV0dXJuIG5hbWVzLmluZGV4T2YobmFtZSkgIT09IC0xO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogcmVtb3ZlIG5hbWUgZnJvbSBub2RlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBub2RlLm5hbWUoJ3JlZCBzZWxlY3RlZCcpO1xuICAgICAgICAgKiBub2RlLnJlbW92ZU5hbWUoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAqIG5vZGUuaGFzTmFtZSgnc2VsZWN0ZWQnKTsgLy8gcmV0dXJuIGZhbHNlXG4gICAgICAgICAqIG5vZGUubmFtZSgpOyAvLyByZXR1cm4gJ3JlZCdcbiAgICAgICAgICovXG4gICAgICAgIHJlbW92ZU5hbWU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBuYW1lcyA9ICh0aGlzLm5hbWUoKSB8fCAnJykuc3BsaXQoL1xccy9nKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IG5hbWVzLmluZGV4T2YobmFtZSk7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgbmFtZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE5hbWUobmFtZXMuam9pbignICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IGF0dHJcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJcbiAgICAgICAgICogQHBhcmFtIHsqfSB2YWxcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIG5vZGUuc2V0QXR0cigneCcsIDUpO1xuICAgICAgICAgKi9cbiAgICAgICAgc2V0QXR0cjogZnVuY3Rpb24oYXR0ciwgdmFsKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kID0gU0VUICsgS29udmEuVXRpbC5fY2FwaXRhbGl6ZShhdHRyKSxcbiAgICAgICAgICAgICAgICBmdW5jID0gdGhpc1ttZXRob2RdO1xuXG4gICAgICAgICAgICBpZihLb252YS5VdGlsLl9pc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgICAgICAgICAgICAgZnVuYy5jYWxsKHRoaXMsIHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBvdGhlcndpc2Ugc2V0IGRpcmVjdGx5XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyKGF0dHIsIHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3NldEF0dHI6IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICAgICAgICB2YXIgb2xkVmFsO1xuICAgICAgICAgICAgb2xkVmFsID0gdGhpcy5hdHRyc1trZXldO1xuICAgICAgICAgICAgaWYgKG9sZFZhbCA9PT0gdmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICBkZWxldGUgdGhpcy5hdHRyc1trZXldO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5hdHRyc1trZXldID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZUV2ZW50KGtleSwgb2xkVmFsLCB2YWwpO1xuICAgICAgICB9LFxuICAgICAgICBfc2V0Q29tcG9uZW50QXR0cjogZnVuY3Rpb24oa2V5LCBjb21wb25lbnQsIHZhbCkge1xuICAgICAgICAgICAgdmFyIG9sZFZhbDtcbiAgICAgICAgICAgIGlmKHZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgb2xkVmFsID0gdGhpcy5hdHRyc1trZXldO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFvbGRWYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHZhbHVlIHRvIGRlZmF1bHQgdmFsdWUgdXNpbmcgZ2V0QXR0clxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJzW2tleV0gPSB0aGlzLmdldEF0dHIoa2V5KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJzW2tleV1bY29tcG9uZW50XSA9IHZhbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlRXZlbnQoa2V5LCBvbGRWYWwsIHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9maXJlQW5kQnViYmxlOiBmdW5jdGlvbihldmVudFR5cGUsIGV2dCwgY29tcGFyZVNoYXBlKSB7XG4gICAgICAgICAgICB2YXIgb2theVRvUnVuID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYoZXZ0ICYmIHRoaXMubm9kZVR5cGUgPT09IFNIQVBFKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnRhcmdldCA9IHRoaXM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKGV2ZW50VHlwZSA9PT0gTU9VU0VFTlRFUiAmJiBjb21wYXJlU2hhcGUgJiYgKHRoaXMuX2lkID09PSBjb21wYXJlU2hhcGUuX2lkIHx8ICh0aGlzLmlzQW5jZXN0b3JPZiAmJiB0aGlzLmlzQW5jZXN0b3JPZihjb21wYXJlU2hhcGUpKSkpIHtcbiAgICAgICAgICAgICAgICBva2F5VG9SdW4gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoZXZlbnRUeXBlID09PSBNT1VTRUxFQVZFICYmIGNvbXBhcmVTaGFwZSAmJiAodGhpcy5faWQgPT09IGNvbXBhcmVTaGFwZS5faWQgfHwgKHRoaXMuaXNBbmNlc3Rvck9mICYmIHRoaXMuaXNBbmNlc3Rvck9mKGNvbXBhcmVTaGFwZSkpKSkge1xuICAgICAgICAgICAgICAgIG9rYXlUb1J1biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYob2theVRvUnVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZShldmVudFR5cGUsIGV2dCk7XG5cbiAgICAgICAgICAgICAgICAvLyBzaW11bGF0ZSBldmVudCBidWJibGluZ1xuICAgICAgICAgICAgICAgIHZhciBzdG9wQnViYmxlID1cbiAgICAgICAgICAgICAgICAgICAgKGV2ZW50VHlwZSA9PT0gTU9VU0VFTlRFUiB8fCBldmVudFR5cGUgPT09IE1PVVNFTEVBVkUpICYmXG4gICAgICAgICAgICAgICAgICAgICgoY29tcGFyZVNoYXBlICYmIGNvbXBhcmVTaGFwZS5pc0FuY2VzdG9yT2YgJiYgY29tcGFyZVNoYXBlLmlzQW5jZXN0b3JPZih0aGlzKSAmJiAhY29tcGFyZVNoYXBlLmlzQW5jZXN0b3JPZih0aGlzLnBhcmVudCkpKTtcbiAgICAgICAgICAgICAgICBpZigoZXZ0ICYmICFldnQuY2FuY2VsQnViYmxlIHx8ICFldnQpICYmIHRoaXMucGFyZW50ICYmIHRoaXMucGFyZW50LmlzTGlzdGVuaW5nKCkgJiYgKCFzdG9wQnViYmxlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGFyZVNoYXBlICYmIGNvbXBhcmVTaGFwZS5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVBbmRCdWJibGUuY2FsbCh0aGlzLnBhcmVudCwgZXZlbnRUeXBlLCBldnQsIGNvbXBhcmVTaGFwZS5wYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlyZUFuZEJ1YmJsZS5jYWxsKHRoaXMucGFyZW50LCBldmVudFR5cGUsIGV2dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9maXJlOiBmdW5jdGlvbihldmVudFR5cGUsIGV2dCkge1xuICAgICAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuZXZlbnRMaXN0ZW5lcnNbZXZlbnRUeXBlXSxcbiAgICAgICAgICAgICAgICBpO1xuXG4gICAgICAgICAgICBldnQgPSBldnQgfHwge307XG4gICAgICAgICAgICBldnQuY3VycmVudFRhcmdldCA9IHRoaXM7XG4gICAgICAgICAgICBldnQudHlwZSA9IGV2ZW50VHlwZTtcblxuICAgICAgICAgICAgaWYgKGV2ZW50cykge1xuICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBldmVudHNbaV0uaGFuZGxlci5jYWxsKHRoaXMsIGV2dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZHJhdyBib3RoIHNjZW5lIGFuZCBoaXQgZ3JhcGhzLiAgSWYgdGhlIG5vZGUgYmVpbmcgZHJhd24gaXMgdGhlIHN0YWdlLCBhbGwgb2YgdGhlIGxheWVycyB3aWxsIGJlIGNsZWFyZWQgYW5kIHJlZHJhd25cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0tvbnZhLk5vZGV9XG4gICAgICAgICAqL1xuICAgICAgICBkcmF3OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhd1NjZW5lKCk7XG4gICAgICAgICAgICB0aGlzLmRyYXdIaXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBjcmVhdGUgbm9kZSB3aXRoIEpTT04gc3RyaW5nIG9yIGFuIE9iamVjdC4gIERlLXNlcmlhbGl6dGlvbiBkb2VzIG5vdCBnZW5lcmF0ZSBjdXN0b21cbiAgICAgKiAgc2hhcGUgZHJhd2luZyBmdW5jdGlvbnMsIGltYWdlcywgb3IgZXZlbnQgaGFuZGxlcnMgKHRoaXMgd291bGQgbWFrZSB0aGVcbiAgICAgKiAgc2VyaWFsaXplZCBvYmplY3QgaHVnZSkuICBJZiB5b3VyIGFwcCB1c2VzIGN1c3RvbSBzaGFwZXMsIGltYWdlcywgYW5kXG4gICAgICogIGV2ZW50IGhhbmRsZXJzIChpdCBwcm9iYWJseSBkb2VzKSwgdGhlbiB5b3UgbmVlZCB0byBzZWxlY3QgdGhlIGFwcHJvcHJpYXRlXG4gICAgICogIHNoYXBlcyBhZnRlciBsb2FkaW5nIHRoZSBzdGFnZSBhbmQgc2V0IHRoZXNlIHByb3BlcnRpZXMgdmlhIG9uKCksIHNldERyYXdGdW5jKCksXG4gICAgICogIGFuZCBzZXRJbWFnZSgpIG1ldGhvZHNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IGpzb24gc3RyaW5nIG9yIG9iamVjdFxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gW2NvbnRhaW5lcl0gb3B0aW9uYWwgY29udGFpbmVyIGRvbSBlbGVtZW50IHVzZWQgb25seSBpZiB5b3UncmVcbiAgICAgKiAgY3JlYXRpbmcgYSBzdGFnZSBub2RlXG4gICAgICovXG4gICAgS29udmEuTm9kZS5jcmVhdGUgPSBmdW5jdGlvbihkYXRhLCBjb250YWluZXIpIHtcbiAgICAgICAgaWYgKEtvbnZhLlV0aWwuX2lzU3RyaW5nKGRhdGEpKSB7XG4gICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlTm9kZShkYXRhLCBjb250YWluZXIpO1xuICAgIH07XG4gICAgS29udmEuTm9kZS5fY3JlYXRlTm9kZSA9IGZ1bmN0aW9uKG9iaiwgY29udGFpbmVyKSB7XG4gICAgICAgIHZhciBjbGFzc05hbWUgPSBLb252YS5Ob2RlLnByb3RvdHlwZS5nZXRDbGFzc05hbWUuY2FsbChvYmopLFxuICAgICAgICAgICAgY2hpbGRyZW4gPSBvYmouY2hpbGRyZW4sXG4gICAgICAgICAgICBubywgbGVuLCBuO1xuXG4gICAgICAgIC8vIGlmIGNvbnRhaW5lciB3YXMgcGFzc2VkIGluLCBhZGQgaXQgdG8gYXR0cnNcbiAgICAgICAgaWYoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBvYmouYXR0cnMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB9XG5cbiAgICAgICAgbm8gPSBuZXcgS29udmFbY2xhc3NOYW1lXShvYmouYXR0cnMpO1xuICAgICAgICBpZihjaGlsZHJlbikge1xuICAgICAgICAgICAgbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICBuby5hZGQodGhpcy5fY3JlYXRlTm9kZShjaGlsZHJlbltuXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5vO1xuICAgIH07XG5cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PSBhZGQgZ2V0dGVycyBzZXR0ZXJzID09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdwb3NpdGlvbicpO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgbm9kZSBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcbiAgICAgKiBAbmFtZSBwb3NpdGlvblxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcG9zXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy55XG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBwb3NpdGlvblxuICAgICAqIHZhciBwb3NpdGlvbiA9IG5vZGUucG9zaXRpb24oKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBwb3NpdGlvblxuICAgICAqIG5vZGUucG9zaXRpb24oe1xuICAgICAqICAgeDogNVxuICAgICAqICAgeTogMTBcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICd4JywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHggcG9zaXRpb25cbiAgICAgKiBAbmFtZSB4XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB4XG4gICAgICogdmFyIHggPSBub2RlLngoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB4XG4gICAgICogbm9kZS54KDUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ3knLCAwKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgeSBwb3NpdGlvblxuICAgICAqIEBuYW1lIHlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKiBAcmV0dXJucyB7SW50ZWdlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB5XG4gICAgICogdmFyIHkgPSBub2RlLnkoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB5XG4gICAgICogbm9kZS55KDUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ29wYWNpdHknLCAxKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgb3BhY2l0eS4gIE9wYWNpdHkgdmFsdWVzIHJhbmdlIGZyb20gMCB0byAxLlxuICAgICAqICBBIG5vZGUgd2l0aCBhbiBvcGFjaXR5IG9mIDAgaXMgZnVsbHkgdHJhbnNwYXJlbnQsIGFuZCBhIG5vZGVcbiAgICAgKiAgd2l0aCBhbiBvcGFjaXR5IG9mIDEgaXMgZnVsbHkgb3BhcXVlXG4gICAgICogQG5hbWUgb3BhY2l0eVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3BhY2l0eVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgb3BhY2l0eVxuICAgICAqIHZhciBvcGFjaXR5ID0gbm9kZS5vcGFjaXR5KCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgb3BhY2l0eVxuICAgICAqIG5vZGUub3BhY2l0eSgwLjUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXIoS29udmEuTm9kZSwgJ25hbWUnKTtcbiAgICBLb252YS5GYWN0b3J5LmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ25hbWUnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgbmFtZVxuICAgICAqIEBuYW1lIG5hbWVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IG5hbWVcbiAgICAgKiB2YXIgbmFtZSA9IG5vZGUubmFtZSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IG5hbWVcbiAgICAgKiBub2RlLm5hbWUoJ2ZvbycpO1xuICAgICAqXG4gICAgICogLy8gYWxzbyBub2RlIG1heSBoYXZlIG11bHRpcGxlIG5hbWVzIChhcyBjc3MgY2xhc3NlcylcbiAgICAgKiBub2RlLm5hbWUoJ2ZvbyBiYXInKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyKEtvbnZhLk5vZGUsICdpZCcpO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnaWQnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgaWQuIElkIGlzIGdsb2JhbCBmb3Igd2hvbGUgcGFnZS5cbiAgICAgKiBAbmFtZSBpZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGlkXG4gICAgICogdmFyIG5hbWUgPSBub2RlLmlkKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgaWRcbiAgICAgKiBub2RlLmlkKCdmb28nKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdyb3RhdGlvbicsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQG5hbWUgcm90YXRpb25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJvdGF0aW9uXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogdmFyIHJvdGF0aW9uID0gbm9kZS5yb3RhdGlvbigpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBub2RlLnJvdGF0aW9uKDQ1KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihLb252YS5Ob2RlLCAnc2NhbGUnLCBbJ3gnLCAneSddKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2NhbGVcbiAgICAgKiBAbmFtZSBzY2FsZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY2FsZS54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNjYWxlLnlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzY2FsZVxuICAgICAqIHZhciBzY2FsZSA9IG5vZGUuc2NhbGUoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzY2FsZVxuICAgICAqIHNoYXBlLnNjYWxlKHtcbiAgICAgKiAgIHg6IDJcbiAgICAgKiAgIHk6IDNcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdzY2FsZVgnLCAxKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2NhbGUgeFxuICAgICAqIEBuYW1lIHNjYWxlWFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc2NhbGUgeFxuICAgICAqIHZhciBzY2FsZVggPSBub2RlLnNjYWxlWCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNjYWxlIHhcbiAgICAgKiBub2RlLnNjYWxlWCgyKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdzY2FsZVknLCAxKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2NhbGUgeVxuICAgICAqIEBuYW1lIHNjYWxlWVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc2NhbGUgeVxuICAgICAqIHZhciBzY2FsZVkgPSBub2RlLnNjYWxlWSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNjYWxlIHlcbiAgICAgKiBub2RlLnNjYWxlWSgyKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihLb252YS5Ob2RlLCAnc2tldycsIFsneCcsICd5J10pO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBza2V3XG4gICAgICogQG5hbWUgc2tld1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBza2V3XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNrZXcueFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBza2V3LnlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBza2V3XG4gICAgICogdmFyIHNrZXcgPSBub2RlLnNrZXcoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBza2V3XG4gICAgICogbm9kZS5za2V3KHtcbiAgICAgKiAgIHg6IDIwXG4gICAgICogICB5OiAxMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ3NrZXdYJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHNrZXcgeFxuICAgICAqIEBuYW1lIHNrZXdYXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBza2V3IHhcbiAgICAgKiB2YXIgc2tld1ggPSBub2RlLnNrZXdYKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc2tldyB4XG4gICAgICogbm9kZS5za2V3WCgzKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdza2V3WScsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBza2V3IHlcbiAgICAgKiBAbmFtZSBza2V3WVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc2tldyB5XG4gICAgICogdmFyIHNrZXdZID0gbm9kZS5za2V3WSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNrZXcgeVxuICAgICAqIG5vZGUuc2tld1koMyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ29mZnNldCcsIFsneCcsICd5J10pO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBvZmZzZXQuICBPZmZzZXRzIHRoZSBkZWZhdWx0IHBvc2l0aW9uIGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2Zmc2V0XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldC54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldC55XG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBvZmZzZXRcbiAgICAgKiB2YXIgb2Zmc2V0ID0gbm9kZS5vZmZzZXQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBvZmZzZXRcbiAgICAgKiBub2RlLm9mZnNldCh7XG4gICAgICogICB4OiAyMFxuICAgICAqICAgeTogMTBcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdvZmZzZXRYJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IG9mZnNldCB4XG4gICAgICogQG5hbWUgb2Zmc2V0WFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgb2Zmc2V0IHhcbiAgICAgKiB2YXIgb2Zmc2V0WCA9IG5vZGUub2Zmc2V0WCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IG9mZnNldCB4XG4gICAgICogbm9kZS5vZmZzZXRYKDMpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ29mZnNldFknLCAwKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgb2Zmc2V0IHlcbiAgICAgKiBAbmFtZSBvZmZzZXRZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBvZmZzZXQgeVxuICAgICAqIHZhciBvZmZzZXRZID0gbm9kZS5vZmZzZXRZKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgb2Zmc2V0IHlcbiAgICAgKiBub2RlLm9mZnNldFkoMyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZFNldHRlcihLb252YS5Ob2RlLCAnZHJhZ0Rpc3RhbmNlJyk7XG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdkcmFnRGlzdGFuY2UnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZHJhZyBkaXN0YW5jZVxuICAgICAqIEBuYW1lIGRyYWdEaXN0YW5jZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZGlzdGFuY2VcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGRyYWcgZGlzdGFuY2VcbiAgICAgKiB2YXIgZHJhZ0Rpc3RhbmNlID0gbm9kZS5kcmFnRGlzdGFuY2UoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBkaXN0YW5jZVxuICAgICAqIC8vIG5vZGUgc3RhcnRzIGRyYWdnaW5nIG9ubHkgaWYgcG9pbnRlciBtb3ZlZCBtb3JlIHRoZW4gMyBwaXhlbHNcbiAgICAgKiBub2RlLmRyYWdEaXN0YW5jZSgzKTtcbiAgICAgKiAvLyBvciBzZXQgZ2xvYmFsbHlcbiAgICAgKiBLb252YS5kcmFnRGlzdGFuY2UgPSAzO1xuICAgICAqL1xuXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZFNldHRlcihLb252YS5Ob2RlLCAnd2lkdGgnLCAwKTtcbiAgICBLb252YS5GYWN0b3J5LmFkZE92ZXJsb2FkZWRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ3dpZHRoJyk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCB3aWR0aFxuICAgICAqIEBuYW1lIHdpZHRoXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgd2lkdGhcbiAgICAgKiB2YXIgd2lkdGggPSBub2RlLndpZHRoKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgd2lkdGhcbiAgICAgKiBub2RlLndpZHRoKDEwMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZFNldHRlcihLb252YS5Ob2RlLCAnaGVpZ2h0JywgMCk7XG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdoZWlnaHQnKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGhlaWdodFxuICAgICAqIEBuYW1lIGhlaWdodFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaGVpZ2h0XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBoZWlnaHRcbiAgICAgKiB2YXIgaGVpZ2h0ID0gbm9kZS5oZWlnaHQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBoZWlnaHRcbiAgICAgKiBub2RlLmhlaWdodCgxMDApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ2xpc3RlbmluZycsICdpbmhlcml0Jyk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBsaXN0ZW5pZyBhdHRyLiAgSWYgeW91IG5lZWQgdG8gZGV0ZXJtaW5lIGlmIGEgbm9kZSBpcyBsaXN0ZW5pbmcgb3Igbm90XG4gICAgICogICBieSB0YWtpbmcgaW50byBhY2NvdW50IGl0cyBwYXJlbnRzLCB1c2UgdGhlIGlzTGlzdGVuaW5nKCkgbWV0aG9kXG4gICAgICogQG5hbWUgbGlzdGVuaW5nXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbnxTdHJpbmd9IGxpc3RlbmluZyBDYW4gYmUgXCJpbmhlcml0XCIsIHRydWUsIG9yIGZhbHNlLiAgVGhlIGRlZmF1bHQgaXMgXCJpbmhlcml0XCIuXG4gICAgICogQHJldHVybnMge0Jvb2xlYW58U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGxpc3RlbmluZyBhdHRyXG4gICAgICogdmFyIGxpc3RlbmluZyA9IG5vZGUubGlzdGVuaW5nKCk7XG4gICAgICpcbiAgICAgKiAvLyBzdG9wIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogbm9kZS5saXN0ZW5pbmcoZmFsc2UpO1xuICAgICAqXG4gICAgICogLy8gbGlzdGVuIGZvciBldmVudHNcbiAgICAgKiBub2RlLmxpc3RlbmluZyh0cnVlKTtcbiAgICAgKlxuICAgICAqIC8vIGxpc3RlbiB0byBldmVudHMgYWNjb3JkaW5nIHRvIHRoZSBwYXJlbnRcbiAgICAgKiBub2RlLmxpc3RlbmluZygnaW5oZXJpdCcpO1xuICAgICAqL1xuXG5cblxuICAgICAvKipcbiAgICAgICogZ2V0L3NldCBwcmV2ZW50RGVmYXVsdFxuICAgICAgKiBCeSBkZWZhdWx0IGFsbCBzaGFwZXMgd2lsbCBwcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3VyXG4gICAgICAqIG9mIGEgYnJvd3NlciBvbiBhIHBvaW50ZXIgbW92ZSBvciB0YXAuXG4gICAgICAqIHRoYXQgd2lsbCBwcmV2ZW50IG5hdGl2ZSBzY3JvbGxpbmcgd2hlbiB5b3UgYXJlIHRyeWluZyB0byBkcmFnJmRyb3AgYSBub2RlXG4gICAgICAqIGJ1dCBzb21ldGltZXMgeW91IG1heSBuZWVkIHRvIGVuYWJsZSBkZWZhdWx0IGFjdGlvbnNcbiAgICAgICogaW4gdGhhdCBjYXNlIHlvdSBjYW4gc2V0IHRoZSBwcm9wZXJ0eSB0byBmYWxzZVxuICAgICAgKiBAbmFtZSBwcmV2ZW50RGVmYXVsdFxuICAgICAgKiBAbWV0aG9kXG4gICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAgKiBAcGFyYW0ge051bWJlcn0gcHJldmVudERlZmF1bHRcbiAgICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgICogQGV4YW1wbGVcbiAgICAgICogLy8gZ2V0IHByZXZlbnREZWZhdWx0XG4gICAgICAqIHZhciBzaG91bGRQcmV2ZW50ID0gc2hhcGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICpcbiAgICAgICogLy8gc2V0IHByZXZlbnREZWZhdWx0XG4gICAgICAqIHNoYXBlLnByZXZlbnREZWZhdWx0KGZhbHNlKTtcbiAgICAgICovXG5cbiAgICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ3ByZXZlbnREZWZhdWx0JywgdHJ1ZSk7XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZmlsdGVycycsIHVuZGVmaW5lZCwgZnVuY3Rpb24odmFsKSB7dGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTsgcmV0dXJuIHZhbDsgfSk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWx0ZXJzLiAgRmlsdGVycyBhcmUgYXBwbGllZCB0byBjYWNoZWQgY2FudmFzZXNcbiAgICAgKiBAbmFtZSBmaWx0ZXJzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGZpbHRlcnMgYXJyYXkgb2YgZmlsdGVyc1xuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWx0ZXJzXG4gICAgICogdmFyIGZpbHRlcnMgPSBub2RlLmZpbHRlcnMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBhIHNpbmdsZSBmaWx0ZXJcbiAgICAgKiBub2RlLmNhY2hlKCk7XG4gICAgICogbm9kZS5maWx0ZXJzKFtLb252YS5GaWx0ZXJzLkJsdXJdKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBtdWx0aXBsZSBmaWx0ZXJzXG4gICAgICogbm9kZS5jYWNoZSgpO1xuICAgICAqIG5vZGUuZmlsdGVycyhbXG4gICAgICogICBLb252YS5GaWx0ZXJzLkJsdXIsXG4gICAgICogICBLb252YS5GaWx0ZXJzLlNlcGlhLFxuICAgICAqICAgS29udmEuRmlsdGVycy5JbnZlcnRcbiAgICAgKiBdKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICd2aXNpYmxlJywgJ2luaGVyaXQnKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHZpc2libGUgYXR0ci4gIENhbiBiZSBcImluaGVyaXRcIiwgdHJ1ZSwgb3IgZmFsc2UuICBUaGUgZGVmYXVsdCBpcyBcImluaGVyaXRcIi5cbiAgICAgKiAgIElmIHlvdSBuZWVkIHRvIGRldGVybWluZSBpZiBhIG5vZGUgaXMgdmlzaWJsZSBvciBub3RcbiAgICAgKiAgIGJ5IHRha2luZyBpbnRvIGFjY291bnQgaXRzIHBhcmVudHMsIHVzZSB0aGUgaXNWaXNpYmxlKCkgbWV0aG9kXG4gICAgICogQG5hbWUgdmlzaWJsZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW58U3RyaW5nfSB2aXNpYmxlXG4gICAgICogQHJldHVybnMge0Jvb2xlYW58U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHZpc2libGUgYXR0clxuICAgICAqIHZhciB2aXNpYmxlID0gbm9kZS52aXNpYmxlKCk7XG4gICAgICpcbiAgICAgKiAvLyBtYWtlIGludmlzaWJsZVxuICAgICAqIG5vZGUudmlzaWJsZShmYWxzZSk7XG4gICAgICpcbiAgICAgKiAvLyBtYWtlIHZpc2libGVcbiAgICAgKiBub2RlLnZpc2libGUodHJ1ZSk7XG4gICAgICpcbiAgICAgKiAvLyBtYWtlIHZpc2libGUgYWNjb3JkaW5nIHRvIHRoZSBwYXJlbnRcbiAgICAgKiBub2RlLnZpc2libGUoJ2luaGVyaXQnKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICd0cmFuc2Zvcm1zRW5hYmxlZCcsICdhbGwnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgdHJhbnNmb3JtcyB0aGF0IGFyZSBlbmFibGVkLiAgQ2FuIGJlIFwiYWxsXCIsIFwibm9uZVwiLCBvciBcInBvc2l0aW9uXCIuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBcImFsbFwiXG4gICAgICogQG5hbWUgdHJhbnNmb3Jtc0VuYWJsZWRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGVuYWJsZWRcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZW5hYmxlIHBvc2l0aW9uIHRyYW5zZm9ybSBvbmx5IHRvIGltcHJvdmUgZHJhdyBwZXJmb3JtYW5jZVxuICAgICAqIG5vZGUudHJhbnNmb3Jtc0VuYWJsZWQoJ3Bvc2l0aW9uJyk7XG4gICAgICpcbiAgICAgKiAvLyBlbmFibGUgYWxsIHRyYW5zZm9ybXNcbiAgICAgKiBub2RlLnRyYW5zZm9ybXNFbmFibGVkKCdhbGwnKTtcbiAgICAgKi9cblxuXG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IG5vZGUgc2l6ZVxuICAgICAqIEBuYW1lIHNpemVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNpemVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc2l6ZS53aWR0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzaXplLmhlaWdodFxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgbm9kZSBzaXplXG4gICAgICogdmFyIHNpemUgPSBub2RlLnNpemUoKTtcbiAgICAgKiB2YXIgeCA9IHNpemUueDtcbiAgICAgKiB2YXIgeSA9IHNpemUueTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzaXplXG4gICAgICogbm9kZS5zaXplKHtcbiAgICAgKiAgIHdpZHRoOiAxMDAsXG4gICAgICogICBoZWlnaHQ6IDIwMFxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnc2l6ZScpO1xuXG4gICAgS29udmEuRmFjdG9yeS5iYWNrQ29tcGF0KEtvbnZhLk5vZGUsIHtcbiAgICAgICAgcm90YXRlRGVnOiAncm90YXRlJyxcbiAgICAgICAgc2V0Um90YXRpb25EZWc6ICdzZXRSb3RhdGlvbicsXG4gICAgICAgIGdldFJvdGF0aW9uRGVnOiAnZ2V0Um90YXRpb24nXG4gICAgfSk7XG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuTm9kZSk7XG59KShLb252YSk7XG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIC8qKlxyXG4gICAgKiBHcmF5c2NhbGUgRmlsdGVyXHJcbiAgICAqIEBmdW5jdGlvblxyXG4gICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xyXG4gICAgKiBAcGFyYW0ge09iamVjdH0gaW1hZ2VEYXRhXHJcbiAgICAqIEBleGFtcGxlXHJcbiAgICAqIG5vZGUuY2FjaGUoKTtcclxuICAgICogbm9kZS5maWx0ZXJzKFtLb252YS5GaWx0ZXJzLkdyYXlzY2FsZV0pO1xyXG4gICAgKi9cclxuICAgIEtvbnZhLkZpbHRlcnMuR3JheXNjYWxlID0gZnVuY3Rpb24oaW1hZ2VEYXRhKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YSxcclxuICAgICAgICAgICAgbGVuID0gZGF0YS5sZW5ndGgsXHJcbiAgICAgICAgICAgIGksIGJyaWdodG5lc3M7XHJcblxyXG4gICAgICAgIGZvcihpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XHJcbiAgICAgICAgICAgIGJyaWdodG5lc3MgPSAwLjM0ICogZGF0YVtpXSArIDAuNSAqIGRhdGFbaSArIDFdICsgMC4xNiAqIGRhdGFbaSArIDJdO1xyXG4gICAgICAgICAgICAvLyByZWRcclxuICAgICAgICAgICAgZGF0YVtpXSA9IGJyaWdodG5lc3M7XHJcbiAgICAgICAgICAgIC8vIGdyZWVuXHJcbiAgICAgICAgICAgIGRhdGFbaSArIDFdID0gYnJpZ2h0bmVzcztcclxuICAgICAgICAgICAgLy8gYmx1ZVxyXG4gICAgICAgICAgICBkYXRhW2kgKyAyXSA9IGJyaWdodG5lc3M7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIEJyaWdodGVuIEZpbHRlci5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuQnJpZ2h0ZW5dKTtcbiAgICAgKiBub2RlLmJyaWdodG5lc3MoMC44KTtcbiAgICAgKi9cbiAgICBLb252YS5GaWx0ZXJzLkJyaWdodGVuID0gZnVuY3Rpb24oaW1hZ2VEYXRhKSB7XG4gICAgICAgIHZhciBicmlnaHRuZXNzID0gdGhpcy5icmlnaHRuZXNzKCkgKiAyNTUsXG4gICAgICAgICAgICBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICBsZW4gPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgICAgIC8vIHJlZFxuICAgICAgICAgICAgZGF0YVtpXSArPSBicmlnaHRuZXNzO1xuICAgICAgICAgICAgLy8gZ3JlZW5cbiAgICAgICAgICAgIGRhdGFbaSArIDFdICs9IGJyaWdodG5lc3M7XG4gICAgICAgICAgICAvLyBibHVlXG4gICAgICAgICAgICBkYXRhW2kgKyAyXSArPSBicmlnaHRuZXNzO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdicmlnaHRuZXNzJywgMCwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGZpbHRlciBicmlnaHRuZXNzLiAgVGhlIGJyaWdodG5lc3MgaXMgYSBudW1iZXIgYmV0d2VlbiAtMSBhbmQgMS4mbmJzcDsgUG9zaXRpdmUgdmFsdWVzXG4gICAgKiAgYnJpZ2h0ZW4gdGhlIHBpeGVscyBhbmQgbmVnYXRpdmUgdmFsdWVzIGRhcmtlbiB0aGVtLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5CcmlnaHRlbn0gZmlsdGVyLlxuICAgICogQG5hbWUgYnJpZ2h0bmVzc1xuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge051bWJlcn0gYnJpZ2h0bmVzcyB2YWx1ZSBiZXR3ZWVuIC0xIGFuZCAxXG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICovXG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIC8qKlxyXG4gICAgKiBJbnZlcnQgRmlsdGVyXHJcbiAgICAqIEBmdW5jdGlvblxyXG4gICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xyXG4gICAgKiBAcGFyYW0ge09iamVjdH0gaW1hZ2VEYXRhXHJcbiAgICAqIEBleGFtcGxlXHJcbiAgICAqIG5vZGUuY2FjaGUoKTtcclxuICAgICogbm9kZS5maWx0ZXJzKFtLb252YS5GaWx0ZXJzLkludmVydF0pO1xyXG4gICAgKi9cclxuICAgIEtvbnZhLkZpbHRlcnMuSW52ZXJ0ID0gZnVuY3Rpb24oaW1hZ2VEYXRhKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YSxcclxuICAgICAgICAgICAgbGVuID0gZGF0YS5sZW5ndGgsXHJcbiAgICAgICAgICAgIGk7XHJcblxyXG4gICAgICAgIGZvcihpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XHJcbiAgICAgICAgICAgIC8vIHJlZFxyXG4gICAgICAgICAgICBkYXRhW2ldID0gMjU1IC0gZGF0YVtpXTtcclxuICAgICAgICAgICAgLy8gZ3JlZW5cclxuICAgICAgICAgICAgZGF0YVtpICsgMV0gPSAyNTUgLSBkYXRhW2kgKyAxXTtcclxuICAgICAgICAgICAgLy8gYmx1ZVxyXG4gICAgICAgICAgICBkYXRhW2kgKyAyXSA9IDI1NSAtIGRhdGFbaSArIDJdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0pKCk7XHJcblxuLypcbiB0aGUgR2F1c3MgZmlsdGVyXG4gbWFzdGVyIHJlcG86IGh0dHBzOi8vZ2l0aHViLmNvbS9wYXZlbHBvd2VyL2tpbmV0aWNqc0dhdXNzRmlsdGVyXG4qL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKlxuXG4gICAgIFN0YWNrQmx1ciAtIGEgZmFzdCBhbG1vc3QgR2F1c3NpYW4gQmx1ciBGb3IgQ2FudmFzXG5cbiAgICAgVmVyc2lvbjogICAwLjVcbiAgICAgQXV0aG9yOiAgICBNYXJpbyBLbGluZ2VtYW5uXG4gICAgIENvbnRhY3Q6ICAgbWFyaW9AcXVhc2ltb25kby5jb21cbiAgICAgV2Vic2l0ZTogICBodHRwOi8vd3d3LnF1YXNpbW9uZG8uY29tL1N0YWNrQmx1ckZvckNhbnZhc1xuICAgICBUd2l0dGVyOiAgIEBxdWFzaW1vbmRvXG5cbiAgICAgSW4gY2FzZSB5b3UgZmluZCB0aGlzIGNsYXNzIHVzZWZ1bCAtIGVzcGVjaWFsbHkgaW4gY29tbWVyY2lhbCBwcm9qZWN0cyAtXG4gICAgIEkgYW0gbm90IHRvdGFsbHkgdW5oYXBweSBmb3IgYSBzbWFsbCBkb25hdGlvbiB0byBteSBQYXlQYWwgYWNjb3VudFxuICAgICBtYXJpb0BxdWFzaW1vbmRvLmRlXG5cbiAgICAgT3Igc3VwcG9ydCBtZSBvbiBmbGF0dHI6XG4gICAgIGh0dHBzOi8vZmxhdHRyLmNvbS90aGluZy83Mjc5MS9TdGFja0JsdXItYS1mYXN0LWFsbW9zdC1HYXVzc2lhbi1CbHVyLUVmZmVjdC1mb3ItQ2FudmFzSmF2YXNjcmlwdFxuXG4gICAgIENvcHlyaWdodCAoYykgMjAxMCBNYXJpbyBLbGluZ2VtYW5uXG5cbiAgICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb25cbiAgICAgb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb25cbiAgICAgZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0XG4gICAgIHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLFxuICAgICBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICAgICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGVcbiAgICAgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmdcbiAgICAgY29uZGl0aW9uczpcblxuICAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZVxuICAgICBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELFxuICAgICBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVNcbiAgICAgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbiAgICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFRcbiAgICAgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksXG4gICAgIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lOR1xuICAgICBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SXG4gICAgIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIEJsdXJTdGFjaygpIHtcbiAgICAgICAgdGhpcy5yID0gMDtcbiAgICAgICAgdGhpcy5nID0gMDtcbiAgICAgICAgdGhpcy5iID0gMDtcbiAgICAgICAgdGhpcy5hID0gMDtcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgbXVsX3RhYmxlID0gW1xuICAgICAgICA1MTIsIDUxMiwgNDU2LCA1MTIsIDMyOCwgNDU2LCAzMzUsIDUxMiwgNDA1LCAzMjgsIDI3MSwgNDU2LCAzODgsIDMzNSwgMjkyLCA1MTIsXG4gICAgICAgIDQ1NCwgNDA1LCAzNjQsIDMyOCwgMjk4LCAyNzEsIDQ5NiwgNDU2LCA0MjAsIDM4OCwgMzYwLCAzMzUsIDMxMiwgMjkyLCAyNzMsIDUxMixcbiAgICAgICAgNDgyLCA0NTQsIDQyOCwgNDA1LCAzODMsIDM2NCwgMzQ1LCAzMjgsIDMxMiwgMjk4LCAyODQsIDI3MSwgMjU5LCA0OTYsIDQ3NSwgNDU2LFxuICAgICAgICA0MzcsIDQyMCwgNDA0LCAzODgsIDM3NCwgMzYwLCAzNDcsIDMzNSwgMzIzLCAzMTIsIDMwMiwgMjkyLCAyODIsIDI3MywgMjY1LCA1MTIsXG4gICAgICAgIDQ5NywgNDgyLCA0NjgsIDQ1NCwgNDQxLCA0MjgsIDQxNywgNDA1LCAzOTQsIDM4MywgMzczLCAzNjQsIDM1NCwgMzQ1LCAzMzcsIDMyOCxcbiAgICAgICAgMzIwLCAzMTIsIDMwNSwgMjk4LCAyOTEsIDI4NCwgMjc4LCAyNzEsIDI2NSwgMjU5LCA1MDcsIDQ5NiwgNDg1LCA0NzUsIDQ2NSwgNDU2LFxuICAgICAgICA0NDYsIDQzNywgNDI4LCA0MjAsIDQxMiwgNDA0LCAzOTYsIDM4OCwgMzgxLCAzNzQsIDM2NywgMzYwLCAzNTQsIDM0NywgMzQxLCAzMzUsXG4gICAgICAgIDMyOSwgMzIzLCAzMTgsIDMxMiwgMzA3LCAzMDIsIDI5NywgMjkyLCAyODcsIDI4MiwgMjc4LCAyNzMsIDI2OSwgMjY1LCAyNjEsIDUxMixcbiAgICAgICAgNTA1LCA0OTcsIDQ4OSwgNDgyLCA0NzUsIDQ2OCwgNDYxLCA0NTQsIDQ0NywgNDQxLCA0MzUsIDQyOCwgNDIyLCA0MTcsIDQxMSwgNDA1LFxuICAgICAgICAzOTksIDM5NCwgMzg5LCAzODMsIDM3OCwgMzczLCAzNjgsIDM2NCwgMzU5LCAzNTQsIDM1MCwgMzQ1LCAzNDEsIDMzNywgMzMyLCAzMjgsXG4gICAgICAgIDMyNCwgMzIwLCAzMTYsIDMxMiwgMzA5LCAzMDUsIDMwMSwgMjk4LCAyOTQsIDI5MSwgMjg3LCAyODQsIDI4MSwgMjc4LCAyNzQsIDI3MSxcbiAgICAgICAgMjY4LCAyNjUsIDI2MiwgMjU5LCAyNTcsIDUwNywgNTAxLCA0OTYsIDQ5MSwgNDg1LCA0ODAsIDQ3NSwgNDcwLCA0NjUsIDQ2MCwgNDU2LFxuICAgICAgICA0NTEsIDQ0NiwgNDQyLCA0MzcsIDQzMywgNDI4LCA0MjQsIDQyMCwgNDE2LCA0MTIsIDQwOCwgNDA0LCA0MDAsIDM5NiwgMzkyLCAzODgsXG4gICAgICAgIDM4NSwgMzgxLCAzNzcsIDM3NCwgMzcwLCAzNjcsIDM2MywgMzYwLCAzNTcsIDM1NCwgMzUwLCAzNDcsIDM0NCwgMzQxLCAzMzgsIDMzNSxcbiAgICAgICAgMzMyLCAzMjksIDMyNiwgMzIzLCAzMjAsIDMxOCwgMzE1LCAzMTIsIDMxMCwgMzA3LCAzMDQsIDMwMiwgMjk5LCAyOTcsIDI5NCwgMjkyLFxuICAgICAgICAyODksIDI4NywgMjg1LCAyODIsIDI4MCwgMjc4LCAyNzUsIDI3MywgMjcxLCAyNjksIDI2NywgMjY1LCAyNjMsIDI2MSwgMjU5XG4gICAgXTtcblxuICAgIHZhciBzaGdfdGFibGUgPSBbXG4gICAgICAgIDksIDExLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxNiwgMTcsXG4gICAgICAgIDE3LCAxNywgMTcsIDE3LCAxNywgMTcsIDE4LCAxOCwgMTgsIDE4LCAxOCwgMTgsIDE4LCAxOCwgMTgsIDE5LFxuICAgICAgICAxOSwgMTksIDE5LCAxOSwgMTksIDE5LCAxOSwgMTksIDE5LCAxOSwgMTksIDE5LCAxOSwgMjAsIDIwLCAyMCxcbiAgICAgICAgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjAsIDIwLCAyMCwgMjEsXG4gICAgICAgIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLFxuICAgICAgICAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjEsIDIxLCAyMSwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMixcbiAgICAgICAgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsXG4gICAgICAgIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIyLCAyMiwgMjIsIDIzLFxuICAgICAgICAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMyxcbiAgICAgICAgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsXG4gICAgICAgIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLCAyMywgMjMsIDIzLFxuICAgICAgICAyMywgMjMsIDIzLCAyMywgMjMsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCxcbiAgICAgICAgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsXG4gICAgICAgIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LFxuICAgICAgICAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCxcbiAgICAgICAgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNCwgMjQsIDI0LCAyNFxuICAgIF07XG5cbiAgICBmdW5jdGlvbiBmaWx0ZXJHYXVzc0JsdXJSR0JBKCBpbWFnZURhdGEsIHJhZGl1cykge1xuXG4gICAgICAgIHZhciBwaXhlbHMgPSBpbWFnZURhdGEuZGF0YSxcbiAgICAgICAgICAgIHdpZHRoID0gaW1hZ2VEYXRhLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0ID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICB2YXIgeCwgeSwgaSwgcCwgeXAsIHlpLCB5dywgcl9zdW0sIGdfc3VtLCBiX3N1bSwgYV9zdW0sXG4gICAgICAgICAgICByX291dF9zdW0sIGdfb3V0X3N1bSwgYl9vdXRfc3VtLCBhX291dF9zdW0sXG4gICAgICAgICAgICByX2luX3N1bSwgZ19pbl9zdW0sIGJfaW5fc3VtLCBhX2luX3N1bSxcbiAgICAgICAgICAgIHByLCBwZywgcGIsIHBhLCByYnM7XG5cbiAgICAgICAgdmFyIGRpdiA9IHJhZGl1cyArIHJhZGl1cyArIDEsXG4gICAgICAgICAgICB3aWR0aE1pbnVzMSA9IHdpZHRoIC0gMSxcbiAgICAgICAgICAgIGhlaWdodE1pbnVzMSA9IGhlaWdodCAtIDEsXG4gICAgICAgICAgICByYWRpdXNQbHVzMSA9IHJhZGl1cyArIDEsXG4gICAgICAgICAgICBzdW1GYWN0b3IgPSByYWRpdXNQbHVzMSAqICggcmFkaXVzUGx1czEgKyAxICkgLyAyLFxuICAgICAgICAgICAgc3RhY2tTdGFydCA9IG5ldyBCbHVyU3RhY2soKSxcbiAgICAgICAgICAgIHN0YWNrRW5kID0gbnVsbCxcbiAgICAgICAgICAgIHN0YWNrID0gc3RhY2tTdGFydCxcbiAgICAgICAgICAgIHN0YWNrSW4gPSBudWxsLFxuICAgICAgICAgICAgc3RhY2tPdXQgPSBudWxsLFxuICAgICAgICAgICAgbXVsX3N1bSA9IG11bF90YWJsZVtyYWRpdXNdLFxuICAgICAgICAgICAgc2hnX3N1bSA9IHNoZ190YWJsZVtyYWRpdXNdO1xuXG4gICAgICAgIGZvciAoIGkgPSAxOyBpIDwgZGl2OyBpKysgKSB7XG4gICAgICAgICAgICBzdGFjayA9IHN0YWNrLm5leHQgPSBuZXcgQmx1clN0YWNrKCk7XG4gICAgICAgICAgICBpZiAoIGkgPT09IHJhZGl1c1BsdXMxICl7XG4gICAgICAgICAgICAgICAgc3RhY2tFbmQgPSBzdGFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN0YWNrLm5leHQgPSBzdGFja1N0YXJ0O1xuXG4gICAgICAgIHl3ID0geWkgPSAwO1xuXG4gICAgICAgIGZvciAoIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KysgKVxuICAgICAgICB7XG4gICAgICAgICAgICByX2luX3N1bSA9IGdfaW5fc3VtID0gYl9pbl9zdW0gPSBhX2luX3N1bSA9IHJfc3VtID0gZ19zdW0gPSBiX3N1bSA9IGFfc3VtID0gMDtcblxuICAgICAgICAgICAgcl9vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAoIHByID0gcGl4ZWxzW3lpXSApO1xuICAgICAgICAgICAgZ19vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAoIHBnID0gcGl4ZWxzW3lpICsgMV0gKTtcbiAgICAgICAgICAgIGJfb3V0X3N1bSA9IHJhZGl1c1BsdXMxICogKCBwYiA9IHBpeGVsc1t5aSArIDJdICk7XG4gICAgICAgICAgICBhX291dF9zdW0gPSByYWRpdXNQbHVzMSAqICggcGEgPSBwaXhlbHNbeWkgKyAzXSApO1xuXG4gICAgICAgICAgICByX3N1bSArPSBzdW1GYWN0b3IgKiBwcjtcbiAgICAgICAgICAgIGdfc3VtICs9IHN1bUZhY3RvciAqIHBnO1xuICAgICAgICAgICAgYl9zdW0gKz0gc3VtRmFjdG9yICogcGI7XG4gICAgICAgICAgICBhX3N1bSArPSBzdW1GYWN0b3IgKiBwYTtcblxuICAgICAgICAgICAgc3RhY2sgPSBzdGFja1N0YXJ0O1xuXG4gICAgICAgICAgICBmb3IoIGkgPSAwOyBpIDwgcmFkaXVzUGx1czE7IGkrKyApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhY2suciA9IHByO1xuICAgICAgICAgICAgICAgIHN0YWNrLmcgPSBwZztcbiAgICAgICAgICAgICAgICBzdGFjay5iID0gcGI7XG4gICAgICAgICAgICAgICAgc3RhY2suYSA9IHBhO1xuICAgICAgICAgICAgICAgIHN0YWNrID0gc3RhY2submV4dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yKCBpID0gMTsgaSA8IHJhZGl1c1BsdXMxOyBpKysgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHAgPSB5aSArICgoIHdpZHRoTWludXMxIDwgaSA/IHdpZHRoTWludXMxIDogaSApIDw8IDIgKTtcbiAgICAgICAgICAgICAgICByX3N1bSArPSAoIHN0YWNrLnIgPSAoIHByID0gcGl4ZWxzW3BdKSkgKiAoIHJicyA9IHJhZGl1c1BsdXMxIC0gaSApO1xuICAgICAgICAgICAgICAgIGdfc3VtICs9ICggc3RhY2suZyA9ICggcGcgPSBwaXhlbHNbcCArIDFdKSkgKiByYnM7XG4gICAgICAgICAgICAgICAgYl9zdW0gKz0gKCBzdGFjay5iID0gKCBwYiA9IHBpeGVsc1twICsgMl0pKSAqIHJicztcbiAgICAgICAgICAgICAgICBhX3N1bSArPSAoIHN0YWNrLmEgPSAoIHBhID0gcGl4ZWxzW3AgKyAzXSkpICogcmJzO1xuXG4gICAgICAgICAgICAgICAgcl9pbl9zdW0gKz0gcHI7XG4gICAgICAgICAgICAgICAgZ19pbl9zdW0gKz0gcGc7XG4gICAgICAgICAgICAgICAgYl9pbl9zdW0gKz0gcGI7XG4gICAgICAgICAgICAgICAgYV9pbl9zdW0gKz0gcGE7XG5cbiAgICAgICAgICAgICAgICBzdGFjayA9IHN0YWNrLm5leHQ7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgc3RhY2tJbiA9IHN0YWNrU3RhcnQ7XG4gICAgICAgICAgICBzdGFja091dCA9IHN0YWNrRW5kO1xuICAgICAgICAgICAgZm9yICggeCA9IDA7IHggPCB3aWR0aDsgeCsrIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwaXhlbHNbeWkgKyAzXSA9IHBhID0gKGFfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bTtcbiAgICAgICAgICAgICAgICBpZiAoIHBhICE9PSAwIClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHBhID0gMjU1IC8gcGE7XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc1t5aV0gPSAoKHJfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bSkgKiBwYTtcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3lpICsgMV0gPSAoKGdfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bSkgKiBwYTtcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3lpICsgMl0gPSAoKGJfc3VtICogbXVsX3N1bSkgPj4gc2hnX3N1bSkgKiBwYTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwaXhlbHNbeWldID0gcGl4ZWxzW3lpICsgMV0gPSBwaXhlbHNbeWkgKyAyXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcl9zdW0gLT0gcl9vdXRfc3VtO1xuICAgICAgICAgICAgICAgIGdfc3VtIC09IGdfb3V0X3N1bTtcbiAgICAgICAgICAgICAgICBiX3N1bSAtPSBiX291dF9zdW07XG4gICAgICAgICAgICAgICAgYV9zdW0gLT0gYV9vdXRfc3VtO1xuXG4gICAgICAgICAgICAgICAgcl9vdXRfc3VtIC09IHN0YWNrSW4ucjtcbiAgICAgICAgICAgICAgICBnX291dF9zdW0gLT0gc3RhY2tJbi5nO1xuICAgICAgICAgICAgICAgIGJfb3V0X3N1bSAtPSBzdGFja0luLmI7XG4gICAgICAgICAgICAgICAgYV9vdXRfc3VtIC09IHN0YWNrSW4uYTtcblxuICAgICAgICAgICAgICAgIHAgPSAoeXcgKyAoICggcCA9IHggKyByYWRpdXMgKyAxICkgPCB3aWR0aE1pbnVzMSA/IHAgOiB3aWR0aE1pbnVzMSApICkgPDwgMjtcblxuICAgICAgICAgICAgICAgIHJfaW5fc3VtICs9ICggc3RhY2tJbi5yID0gcGl4ZWxzW3BdKTtcbiAgICAgICAgICAgICAgICBnX2luX3N1bSArPSAoIHN0YWNrSW4uZyA9IHBpeGVsc1twICsgMV0pO1xuICAgICAgICAgICAgICAgIGJfaW5fc3VtICs9ICggc3RhY2tJbi5iID0gcGl4ZWxzW3AgKyAyXSk7XG4gICAgICAgICAgICAgICAgYV9pbl9zdW0gKz0gKCBzdGFja0luLmEgPSBwaXhlbHNbcCArIDNdKTtcblxuICAgICAgICAgICAgICAgIHJfc3VtICs9IHJfaW5fc3VtO1xuICAgICAgICAgICAgICAgIGdfc3VtICs9IGdfaW5fc3VtO1xuICAgICAgICAgICAgICAgIGJfc3VtICs9IGJfaW5fc3VtO1xuICAgICAgICAgICAgICAgIGFfc3VtICs9IGFfaW5fc3VtO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tJbiA9IHN0YWNrSW4ubmV4dDtcblxuICAgICAgICAgICAgICAgIHJfb3V0X3N1bSArPSAoIHByID0gc3RhY2tPdXQuciApO1xuICAgICAgICAgICAgICAgIGdfb3V0X3N1bSArPSAoIHBnID0gc3RhY2tPdXQuZyApO1xuICAgICAgICAgICAgICAgIGJfb3V0X3N1bSArPSAoIHBiID0gc3RhY2tPdXQuYiApO1xuICAgICAgICAgICAgICAgIGFfb3V0X3N1bSArPSAoIHBhID0gc3RhY2tPdXQuYSApO1xuXG4gICAgICAgICAgICAgICAgcl9pbl9zdW0gLT0gcHI7XG4gICAgICAgICAgICAgICAgZ19pbl9zdW0gLT0gcGc7XG4gICAgICAgICAgICAgICAgYl9pbl9zdW0gLT0gcGI7XG4gICAgICAgICAgICAgICAgYV9pbl9zdW0gLT0gcGE7XG5cbiAgICAgICAgICAgICAgICBzdGFja091dCA9IHN0YWNrT3V0Lm5leHQ7XG5cbiAgICAgICAgICAgICAgICB5aSArPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeXcgKz0gd2lkdGg7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZvciAoIHggPSAwOyB4IDwgd2lkdGg7IHgrKyApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdfaW5fc3VtID0gYl9pbl9zdW0gPSBhX2luX3N1bSA9IHJfaW5fc3VtID0gZ19zdW0gPSBiX3N1bSA9IGFfc3VtID0gcl9zdW0gPSAwO1xuXG4gICAgICAgICAgICB5aSA9IHggPDwgMjtcbiAgICAgICAgICAgIHJfb3V0X3N1bSA9IHJhZGl1c1BsdXMxICogKCBwciA9IHBpeGVsc1t5aV0pO1xuICAgICAgICAgICAgZ19vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAoIHBnID0gcGl4ZWxzW3lpICsgMV0pO1xuICAgICAgICAgICAgYl9vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAoIHBiID0gcGl4ZWxzW3lpICsgMl0pO1xuICAgICAgICAgICAgYV9vdXRfc3VtID0gcmFkaXVzUGx1czEgKiAoIHBhID0gcGl4ZWxzW3lpICsgM10pO1xuXG4gICAgICAgICAgICByX3N1bSArPSBzdW1GYWN0b3IgKiBwcjtcbiAgICAgICAgICAgIGdfc3VtICs9IHN1bUZhY3RvciAqIHBnO1xuICAgICAgICAgICAgYl9zdW0gKz0gc3VtRmFjdG9yICogcGI7XG4gICAgICAgICAgICBhX3N1bSArPSBzdW1GYWN0b3IgKiBwYTtcblxuICAgICAgICAgICAgc3RhY2sgPSBzdGFja1N0YXJ0O1xuXG4gICAgICAgICAgICBmb3IoIGkgPSAwOyBpIDwgcmFkaXVzUGx1czE7IGkrKyApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhY2suciA9IHByO1xuICAgICAgICAgICAgICAgIHN0YWNrLmcgPSBwZztcbiAgICAgICAgICAgICAgICBzdGFjay5iID0gcGI7XG4gICAgICAgICAgICAgICAgc3RhY2suYSA9IHBhO1xuICAgICAgICAgICAgICAgIHN0YWNrID0gc3RhY2submV4dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeXAgPSB3aWR0aDtcblxuICAgICAgICAgICAgZm9yKCBpID0gMTsgaSA8PSByYWRpdXM7IGkrKyApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgeWkgPSAoIHlwICsgeCApIDw8IDI7XG5cbiAgICAgICAgICAgICAgICByX3N1bSArPSAoIHN0YWNrLnIgPSAoIHByID0gcGl4ZWxzW3lpXSkpICogKCByYnMgPSByYWRpdXNQbHVzMSAtIGkgKTtcbiAgICAgICAgICAgICAgICBnX3N1bSArPSAoIHN0YWNrLmcgPSAoIHBnID0gcGl4ZWxzW3lpICsgMV0pKSAqIHJicztcbiAgICAgICAgICAgICAgICBiX3N1bSArPSAoIHN0YWNrLmIgPSAoIHBiID0gcGl4ZWxzW3lpICsgMl0pKSAqIHJicztcbiAgICAgICAgICAgICAgICBhX3N1bSArPSAoIHN0YWNrLmEgPSAoIHBhID0gcGl4ZWxzW3lpICsgM10pKSAqIHJicztcblxuICAgICAgICAgICAgICAgIHJfaW5fc3VtICs9IHByO1xuICAgICAgICAgICAgICAgIGdfaW5fc3VtICs9IHBnO1xuICAgICAgICAgICAgICAgIGJfaW5fc3VtICs9IHBiO1xuICAgICAgICAgICAgICAgIGFfaW5fc3VtICs9IHBhO1xuXG4gICAgICAgICAgICAgICAgc3RhY2sgPSBzdGFjay5uZXh0O1xuXG4gICAgICAgICAgICAgICAgaWYoIGkgPCBoZWlnaHRNaW51czEgKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgeXAgKz0gd2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB5aSA9IHg7XG4gICAgICAgICAgICBzdGFja0luID0gc3RhY2tTdGFydDtcbiAgICAgICAgICAgIHN0YWNrT3V0ID0gc3RhY2tFbmQ7XG4gICAgICAgICAgICBmb3IgKCB5ID0gMDsgeSA8IGhlaWdodDsgeSsrIClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwID0geWkgPDwgMjtcbiAgICAgICAgICAgICAgICBwaXhlbHNbcCArIDNdID0gcGEgPSAoYV9zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtO1xuICAgICAgICAgICAgICAgIGlmICggcGEgPiAwIClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHBhID0gMjU1IC8gcGE7XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc1twXSA9ICgocl9zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtICkgKiBwYTtcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3AgKyAxXSA9ICgoZ19zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtICkgKiBwYTtcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW3AgKyAyXSA9ICgoYl9zdW0gKiBtdWxfc3VtKSA+PiBzaGdfc3VtICkgKiBwYTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwaXhlbHNbcF0gPSBwaXhlbHNbcCArIDFdID0gcGl4ZWxzW3AgKyAyXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcl9zdW0gLT0gcl9vdXRfc3VtO1xuICAgICAgICAgICAgICAgIGdfc3VtIC09IGdfb3V0X3N1bTtcbiAgICAgICAgICAgICAgICBiX3N1bSAtPSBiX291dF9zdW07XG4gICAgICAgICAgICAgICAgYV9zdW0gLT0gYV9vdXRfc3VtO1xuXG4gICAgICAgICAgICAgICAgcl9vdXRfc3VtIC09IHN0YWNrSW4ucjtcbiAgICAgICAgICAgICAgICBnX291dF9zdW0gLT0gc3RhY2tJbi5nO1xuICAgICAgICAgICAgICAgIGJfb3V0X3N1bSAtPSBzdGFja0luLmI7XG4gICAgICAgICAgICAgICAgYV9vdXRfc3VtIC09IHN0YWNrSW4uYTtcblxuICAgICAgICAgICAgICAgIHAgPSAoIHggKyAoKCAoIHAgPSB5ICsgcmFkaXVzUGx1czEpIDwgaGVpZ2h0TWludXMxID8gcCA6IGhlaWdodE1pbnVzMSApICogd2lkdGggKSkgPDwgMjtcblxuICAgICAgICAgICAgICAgIHJfc3VtICs9ICggcl9pbl9zdW0gKz0gKCBzdGFja0luLnIgPSBwaXhlbHNbcF0pKTtcbiAgICAgICAgICAgICAgICBnX3N1bSArPSAoIGdfaW5fc3VtICs9ICggc3RhY2tJbi5nID0gcGl4ZWxzW3AgKyAxXSkpO1xuICAgICAgICAgICAgICAgIGJfc3VtICs9ICggYl9pbl9zdW0gKz0gKCBzdGFja0luLmIgPSBwaXhlbHNbcCArIDJdKSk7XG4gICAgICAgICAgICAgICAgYV9zdW0gKz0gKCBhX2luX3N1bSArPSAoIHN0YWNrSW4uYSA9IHBpeGVsc1twICsgM10pKTtcblxuICAgICAgICAgICAgICAgIHN0YWNrSW4gPSBzdGFja0luLm5leHQ7XG5cbiAgICAgICAgICAgICAgICByX291dF9zdW0gKz0gKCBwciA9IHN0YWNrT3V0LnIgKTtcbiAgICAgICAgICAgICAgICBnX291dF9zdW0gKz0gKCBwZyA9IHN0YWNrT3V0LmcgKTtcbiAgICAgICAgICAgICAgICBiX291dF9zdW0gKz0gKCBwYiA9IHN0YWNrT3V0LmIgKTtcbiAgICAgICAgICAgICAgICBhX291dF9zdW0gKz0gKCBwYSA9IHN0YWNrT3V0LmEgKTtcblxuICAgICAgICAgICAgICAgIHJfaW5fc3VtIC09IHByO1xuICAgICAgICAgICAgICAgIGdfaW5fc3VtIC09IHBnO1xuICAgICAgICAgICAgICAgIGJfaW5fc3VtIC09IHBiO1xuICAgICAgICAgICAgICAgIGFfaW5fc3VtIC09IHBhO1xuXG4gICAgICAgICAgICAgICAgc3RhY2tPdXQgPSBzdGFja091dC5uZXh0O1xuXG4gICAgICAgICAgICAgICAgeWkgKz0gd2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCbHVyIEZpbHRlclxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBuYW1lIEJsdXJcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuQmx1cl0pO1xuICAgICAqIG5vZGUuYmx1clJhZGl1cygxMCk7XG4gICAgICovXG4gICAgS29udmEuRmlsdGVycy5CbHVyID0gZnVuY3Rpb24gQmx1cihpbWFnZURhdGEpIHtcbiAgICAgICAgdmFyIHJhZGl1cyA9IE1hdGgucm91bmQodGhpcy5ibHVyUmFkaXVzKCkpO1xuXG4gICAgICAgIGlmIChyYWRpdXMgPiAwKSB7XG4gICAgICAgICAgICBmaWx0ZXJHYXVzc0JsdXJSR0JBKGltYWdlRGF0YSwgcmFkaXVzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnYmx1clJhZGl1cycsIDAsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuXG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGJsdXIgcmFkaXVzLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5CbHVyfSBmaWx0ZXJcbiAgICAqIEBuYW1lIGJsdXJSYWRpdXNcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtJbnRlZ2VyfSByYWRpdXNcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG59KSgpO1xuXG4vKmVzbGludC1kaXNhYmxlICBtYXgtZGVwdGggKi9cbihmdW5jdGlvbigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXHRmdW5jdGlvbiBwaXhlbEF0KGlkYXRhLCB4LCB5KSB7XG5cdFx0dmFyIGlkeCA9ICh5ICogaWRhdGEud2lkdGggKyB4KSAqIDQ7XG5cdFx0dmFyIGQgPSBbXTtcblx0XHRkLnB1c2goaWRhdGEuZGF0YVtpZHgrK10sIGlkYXRhLmRhdGFbaWR4KytdLCBpZGF0YS5kYXRhW2lkeCsrXSwgaWRhdGEuZGF0YVtpZHgrK10pO1xuXHRcdHJldHVybiBkO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmdiRGlzdGFuY2UocDEsIHAyKSB7XG5cdFx0cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhwMVswXSAtIHAyWzBdLCAyKSArIE1hdGgucG93KHAxWzFdIC0gcDJbMV0sIDIpICsgTWF0aC5wb3cocDFbMl0gLSBwMlsyXSwgMikpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmdiTWVhbihwVGFiKSB7XG5cdFx0dmFyIG0gPSBbMCwgMCwgMF07XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHBUYWIubGVuZ3RoOyBpKyspIHtcblx0XHRcdG1bMF0gKz0gcFRhYltpXVswXTtcblx0XHRcdG1bMV0gKz0gcFRhYltpXVsxXTtcblx0XHRcdG1bMl0gKz0gcFRhYltpXVsyXTtcblx0XHR9XG5cblx0XHRtWzBdIC89IHBUYWIubGVuZ3RoO1xuXHRcdG1bMV0gLz0gcFRhYi5sZW5ndGg7XG5cdFx0bVsyXSAvPSBwVGFiLmxlbmd0aDtcblxuXHRcdHJldHVybiBtO1xuXHR9XG5cblx0ZnVuY3Rpb24gYmFja2dyb3VuZE1hc2soaWRhdGEsIHRocmVzaG9sZCkge1xuXHRcdHZhciByZ2J2X25vID0gcGl4ZWxBdChpZGF0YSwgMCwgMCk7XG5cdFx0dmFyIHJnYnZfbmUgPSBwaXhlbEF0KGlkYXRhLCBpZGF0YS53aWR0aCAtIDEsIDApO1xuXHRcdHZhciByZ2J2X3NvID0gcGl4ZWxBdChpZGF0YSwgMCwgaWRhdGEuaGVpZ2h0IC0gMSk7XG5cdFx0dmFyIHJnYnZfc2UgPSBwaXhlbEF0KGlkYXRhLCBpZGF0YS53aWR0aCAtIDEsIGlkYXRhLmhlaWdodCAtIDEpO1xuXG5cblx0XHR2YXIgdGhyZXMgPSB0aHJlc2hvbGQgfHwgMTA7XG5cdFx0aWYgKHJnYkRpc3RhbmNlKHJnYnZfbm8sIHJnYnZfbmUpIDwgdGhyZXMgJiYgcmdiRGlzdGFuY2Uocmdidl9uZSwgcmdidl9zZSkgPCB0aHJlcyAmJiByZ2JEaXN0YW5jZShyZ2J2X3NlLCByZ2J2X3NvKSA8IHRocmVzICYmIHJnYkRpc3RhbmNlKHJnYnZfc28sIHJnYnZfbm8pIDwgdGhyZXMpIHtcblxuXHRcdFx0Ly8gTWVhbiBjb2xvclxuXHRcdFx0dmFyIG1lYW4gPSByZ2JNZWFuKFtyZ2J2X25lLCByZ2J2X25vLCByZ2J2X3NlLCByZ2J2X3NvXSk7XG5cblx0XHRcdC8vIE1hc2sgYmFzZWQgb24gY29sb3IgZGlzdGFuY2Vcblx0XHRcdHZhciBtYXNrID0gW107XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGlkYXRhLndpZHRoICogaWRhdGEuaGVpZ2h0OyBpKyspIHtcblx0XHRcdFx0dmFyIGQgPSByZ2JEaXN0YW5jZShtZWFuLCBbaWRhdGEuZGF0YVtpICogNF0sIGlkYXRhLmRhdGFbaSAqIDQgKyAxXSwgaWRhdGEuZGF0YVtpICogNCArIDJdXSk7XG5cdFx0XHRcdG1hc2tbaV0gPSAoZCA8IHRocmVzKSA/IDAgOiAyNTU7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBtYXNrO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGFwcGx5TWFzayhpZGF0YSwgbWFzaykge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgaWRhdGEud2lkdGggKiBpZGF0YS5oZWlnaHQ7IGkrKykge1xuXHRcdFx0aWRhdGEuZGF0YVs0ICogaSArIDNdID0gbWFza1tpXTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBlcm9kZU1hc2sobWFzaywgc3csIHNoKSB7XG5cblx0XHR2YXIgd2VpZ2h0cyA9IFsxLCAxLCAxLCAxLCAwLCAxLCAxLCAxLCAxXTtcblx0XHR2YXIgc2lkZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KHdlaWdodHMubGVuZ3RoKSk7XG5cdFx0dmFyIGhhbGZTaWRlID0gTWF0aC5mbG9vcihzaWRlIC8gMik7XG5cblx0XHR2YXIgbWFza1Jlc3VsdCA9IFtdO1xuXHRcdGZvciAodmFyIHkgPSAwOyB5IDwgc2g7IHkrKykge1xuXHRcdFx0Zm9yICh2YXIgeCA9IDA7IHggPCBzdzsgeCsrKSB7XG5cblx0XHRcdFx0dmFyIHNvID0geSAqIHN3ICsgeDtcblx0XHRcdFx0dmFyIGEgPSAwO1xuXHRcdFx0XHRmb3IgKHZhciBjeSA9IDA7IGN5IDwgc2lkZTsgY3krKykge1xuXHRcdFx0XHRcdGZvciAodmFyIGN4ID0gMDsgY3ggPCBzaWRlOyBjeCsrKSB7XG5cdFx0XHRcdFx0XHR2YXIgc2N5ID0geSArIGN5IC0gaGFsZlNpZGU7XG5cdFx0XHRcdFx0XHR2YXIgc2N4ID0geCArIGN4IC0gaGFsZlNpZGU7XG5cblx0XHRcdFx0XHRcdGlmIChzY3kgPj0gMCAmJiBzY3kgPCBzaCAmJiBzY3ggPj0gMCAmJiBzY3ggPCBzdykge1xuXG5cdFx0XHRcdFx0XHRcdHZhciBzcmNPZmYgPSBzY3kgKiBzdyArIHNjeDtcblx0XHRcdFx0XHRcdFx0dmFyIHd0ID0gd2VpZ2h0c1tjeSAqIHNpZGUgKyBjeF07XG5cblx0XHRcdFx0XHRcdFx0YSArPSBtYXNrW3NyY09mZl0gKiB3dDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtYXNrUmVzdWx0W3NvXSA9IChhID09PSAyNTUgKiA4KSA/IDI1NSA6IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hc2tSZXN1bHQ7XG5cdH1cblxuXHRmdW5jdGlvbiBkaWxhdGVNYXNrKG1hc2ssIHN3LCBzaCkge1xuXG5cdFx0dmFyIHdlaWdodHMgPSBbMSwgMSwgMSwgMSwgMSwgMSwgMSwgMSwgMV07XG5cdFx0dmFyIHNpZGUgPSBNYXRoLnJvdW5kKE1hdGguc3FydCh3ZWlnaHRzLmxlbmd0aCkpO1xuXHRcdHZhciBoYWxmU2lkZSA9IE1hdGguZmxvb3Ioc2lkZSAvIDIpO1xuXG5cdFx0dmFyIG1hc2tSZXN1bHQgPSBbXTtcblx0XHRmb3IgKHZhciB5ID0gMDsgeSA8IHNoOyB5KyspIHtcblx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgc3c7IHgrKykge1xuXG5cdFx0XHRcdHZhciBzbyA9IHkgKiBzdyArIHg7XG5cdFx0XHRcdHZhciBhID0gMDtcblx0XHRcdFx0Zm9yICh2YXIgY3kgPSAwOyBjeSA8IHNpZGU7IGN5KyspIHtcblx0XHRcdFx0XHRmb3IgKHZhciBjeCA9IDA7IGN4IDwgc2lkZTsgY3grKykge1xuXHRcdFx0XHRcdFx0dmFyIHNjeSA9IHkgKyBjeSAtIGhhbGZTaWRlO1xuXHRcdFx0XHRcdFx0dmFyIHNjeCA9IHggKyBjeCAtIGhhbGZTaWRlO1xuXG5cdFx0XHRcdFx0XHRpZiAoc2N5ID49IDAgJiYgc2N5IDwgc2ggJiYgc2N4ID49IDAgJiYgc2N4IDwgc3cpIHtcblxuXHRcdFx0XHRcdFx0XHR2YXIgc3JjT2ZmID0gc2N5ICogc3cgKyBzY3g7XG5cdFx0XHRcdFx0XHRcdHZhciB3dCA9IHdlaWdodHNbY3kgKiBzaWRlICsgY3hdO1xuXG5cdFx0XHRcdFx0XHRcdGEgKz0gbWFza1tzcmNPZmZdICogd3Q7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWFza1Jlc3VsdFtzb10gPSAoYSA+PSAyNTUgKiA0KSA/IDI1NSA6IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hc2tSZXN1bHQ7XG5cdH1cblxuXHRmdW5jdGlvbiBzbW9vdGhFZGdlTWFzayhtYXNrLCBzdywgc2gpIHtcblxuXHRcdHZhciB3ZWlnaHRzID0gWzEgLyA5LCAxIC8gOSwgMSAvIDksIDEgLyA5LCAxIC8gOSwgMSAvIDksIDEgLyA5LCAxIC8gOSwgMSAvIDldO1xuXHRcdHZhciBzaWRlID0gTWF0aC5yb3VuZChNYXRoLnNxcnQod2VpZ2h0cy5sZW5ndGgpKTtcblx0XHR2YXIgaGFsZlNpZGUgPSBNYXRoLmZsb29yKHNpZGUgLyAyKTtcblxuXHRcdHZhciBtYXNrUmVzdWx0ID0gW107XG5cdFx0Zm9yICh2YXIgeSA9IDA7IHkgPCBzaDsgeSsrKSB7XG5cdFx0XHRmb3IgKHZhciB4ID0gMDsgeCA8IHN3OyB4KyspIHtcblxuXHRcdFx0XHR2YXIgc28gPSB5ICogc3cgKyB4O1xuXHRcdFx0XHR2YXIgYSA9IDA7XG5cdFx0XHRcdGZvciAodmFyIGN5ID0gMDsgY3kgPCBzaWRlOyBjeSsrKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgY3ggPSAwOyBjeCA8IHNpZGU7IGN4KyspIHtcblx0XHRcdFx0XHRcdHZhciBzY3kgPSB5ICsgY3kgLSBoYWxmU2lkZTtcblx0XHRcdFx0XHRcdHZhciBzY3ggPSB4ICsgY3ggLSBoYWxmU2lkZTtcblxuXHRcdFx0XHRcdFx0aWYgKHNjeSA+PSAwICYmIHNjeSA8IHNoICYmIHNjeCA+PSAwICYmIHNjeCA8IHN3KSB7XG5cblx0XHRcdFx0XHRcdFx0dmFyIHNyY09mZiA9IHNjeSAqIHN3ICsgc2N4O1xuXHRcdFx0XHRcdFx0XHR2YXIgd3QgPSB3ZWlnaHRzW2N5ICogc2lkZSArIGN4XTtcblxuXHRcdFx0XHRcdFx0XHRhICs9IG1hc2tbc3JjT2ZmXSAqIHd0O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdG1hc2tSZXN1bHRbc29dID0gYTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbWFza1Jlc3VsdDtcblx0fVxuXG5cdC8qKlxuXHQgKiBNYXNrIEZpbHRlclxuXHQgKiBAZnVuY3Rpb25cblx0ICogQG5hbWUgTWFza1xuXHQgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuXHQgKiBAcGFyYW0ge09iamVjdH0gaW1hZ2VEYXRhXG5cdCAqIEBleGFtcGxlXG4gICAgICogbm9kZS5jYWNoZSgpO1xuICAgICAqIG5vZGUuZmlsdGVycyhbS29udmEuRmlsdGVycy5NYXNrXSk7XG4gICAgICogbm9kZS50aHJlc2hvbGQoMjAwKTtcblx0ICovXG5cdEtvbnZhLkZpbHRlcnMuTWFzayA9IGZ1bmN0aW9uKGltYWdlRGF0YSkge1xuXHRcdC8vIERldGVjdCBwaXhlbHMgY2xvc2UgdG8gdGhlIGJhY2tncm91bmQgY29sb3Jcblx0XHR2YXIgdGhyZXNob2xkID0gdGhpcy50aHJlc2hvbGQoKSxcbiAgICAgICAgbWFzayA9IGJhY2tncm91bmRNYXNrKGltYWdlRGF0YSwgdGhyZXNob2xkKTtcblx0XHRpZiAobWFzaykge1xuXHRcdFx0Ly8gRXJvZGVcblx0XHRcdG1hc2sgPSBlcm9kZU1hc2sobWFzaywgaW1hZ2VEYXRhLndpZHRoLCBpbWFnZURhdGEuaGVpZ2h0KTtcblxuXHRcdFx0Ly8gRGlsYXRlXG5cdFx0XHRtYXNrID0gZGlsYXRlTWFzayhtYXNrLCBpbWFnZURhdGEud2lkdGgsIGltYWdlRGF0YS5oZWlnaHQpO1xuXG5cdFx0XHQvLyBHcmFkaWVudFxuXHRcdFx0bWFzayA9IHNtb290aEVkZ2VNYXNrKG1hc2ssIGltYWdlRGF0YS53aWR0aCwgaW1hZ2VEYXRhLmhlaWdodCk7XG5cblx0XHRcdC8vIEFwcGx5IG1hc2tcblx0XHRcdGFwcGx5TWFzayhpbWFnZURhdGEsIG1hc2spO1xuXG5cdFx0XHQvLyB0b2RvIDogVXBkYXRlIGhpdCByZWdpb24gZnVuY3Rpb24gYWNjb3JkaW5nIHRvIG1hc2tcblx0XHR9XG5cblx0XHRyZXR1cm4gaW1hZ2VEYXRhO1xuXHR9O1xuXG5cdEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICd0aHJlc2hvbGQnLCAwLCBudWxsLCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIFJHQiBGaWx0ZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbmFtZSBSR0JcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAYXV0aG9yIGlwcG82MTVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuUkdCXSk7XG4gICAgICogbm9kZS5ibHVlKDEyMCk7XG4gICAgICogbm9kZS5ncmVlbigyMDApO1xuICAgICAqL1xuICAgIEtvbnZhLkZpbHRlcnMuUkdCID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgICAgICB2YXIgZGF0YSA9IGltYWdlRGF0YS5kYXRhLFxuICAgICAgICAgICAgblBpeGVscyA9IGRhdGEubGVuZ3RoLFxuICAgICAgICAgICAgcmVkID0gdGhpcy5yZWQoKSxcbiAgICAgICAgICAgIGdyZWVuID0gdGhpcy5ncmVlbigpLFxuICAgICAgICAgICAgYmx1ZSA9IHRoaXMuYmx1ZSgpLFxuICAgICAgICAgICAgaSwgYnJpZ2h0bmVzcztcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgblBpeGVsczsgaSArPSA0KSB7XG4gICAgICAgICAgICBicmlnaHRuZXNzID0gKDAuMzQgKiBkYXRhW2ldICsgMC41ICogZGF0YVtpICsgMV0gKyAwLjE2ICogZGF0YVtpICsgMl0pIC8gMjU1O1xuICAgICAgICAgICAgZGF0YVtpXSA9IGJyaWdodG5lc3MgKiByZWQ7IC8vIHJcbiAgICAgICAgICAgIGRhdGFbaSArIDFdID0gYnJpZ2h0bmVzcyAqIGdyZWVuOyAvLyBnXG4gICAgICAgICAgICBkYXRhW2kgKyAyXSA9IGJyaWdodG5lc3MgKiBibHVlOyAvLyBiXG4gICAgICAgICAgICBkYXRhW2kgKyAzXSA9IGRhdGFbaSArIDNdOyAvLyBhbHBoYVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdyZWQnLCAwLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICAgICAgcmV0dXJuIDI1NTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvKipcbiAgICAqIGdldC9zZXQgZmlsdGVyIHJlZCB2YWx1ZS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuUkdCfSBmaWx0ZXIuXG4gICAgKiBAbmFtZSByZWRcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtJbnRlZ2VyfSByZWQgdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTVcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZ3JlZW4nLCAwLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICAgICAgcmV0dXJuIDI1NTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvKipcbiAgICAqIGdldC9zZXQgZmlsdGVyIGdyZWVuIHZhbHVlLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5SR0J9IGZpbHRlci5cbiAgICAqIEBuYW1lIGdyZWVuXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7SW50ZWdlcn0gZ3JlZW4gdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTVcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnYmx1ZScsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50LCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbiAgICAvKipcbiAgICAqIGdldC9zZXQgZmlsdGVyIGJsdWUgdmFsdWUuIFVzZSB3aXRoIHtAbGluayBLb252YS5GaWx0ZXJzLlJHQn0gZmlsdGVyLlxuICAgICogQG5hbWUgYmx1ZVxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge0ludGVnZXJ9IGJsdWUgdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTVcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBSR0JBIEZpbHRlclxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBuYW1lIFJHQkFcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAYXV0aG9yIGNvZGVmb1xuICAgICAqIEBleGFtcGxlXG4gICAgICogbm9kZS5jYWNoZSgpO1xuICAgICAqIG5vZGUuZmlsdGVycyhbS29udmEuRmlsdGVycy5SR0JBXSk7XG4gICAgICogbm9kZS5ibHVlKDEyMCk7XG4gICAgICogbm9kZS5ncmVlbigyMDApO1xuICAgICAqIG5vZGUuYWxwaGEoMC4zKTtcbiAgICAgKi9cbiAgICBLb252YS5GaWx0ZXJzLlJHQkEgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgIHZhciBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICBuUGl4ZWxzID0gZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICByZWQgPSB0aGlzLnJlZCgpLFxuICAgICAgICAgICAgZ3JlZW4gPSB0aGlzLmdyZWVuKCksXG4gICAgICAgICAgICBibHVlID0gdGhpcy5ibHVlKCksXG4gICAgICAgICAgICBhbHBoYSA9IHRoaXMuYWxwaGEoKSxcbiAgICAgICAgICAgIGksIGlhO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuUGl4ZWxzOyBpICs9IDQpIHtcbiAgICAgICAgICAgIGlhID0gMSAtIGFscGhhO1xuXG4gICAgICAgICAgICBkYXRhW2ldID0gcmVkICogYWxwaGEgKyBkYXRhW2ldICogaWE7IC8vIHJcbiAgICAgICAgICAgIGRhdGFbaSArIDFdID0gZ3JlZW4gKiBhbHBoYSArIGRhdGFbaSArIDFdICogaWE7IC8vIGdcbiAgICAgICAgICAgIGRhdGFbaSArIDJdID0gYmx1ZSAqIGFscGhhICsgZGF0YVtpICsgMl0gKiBpYTsgLy8gYlxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdyZWQnLCAwLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbCA+IDI1NSkge1xuICAgICAgICAgICAgcmV0dXJuIDI1NTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWwgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvKipcbiAgICAqIGdldC9zZXQgZmlsdGVyIHJlZCB2YWx1ZS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuUkdCQX0gZmlsdGVyLlxuICAgICogQG5hbWUgcmVkXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7SW50ZWdlcn0gcmVkIHZhbHVlIGJldHdlZW4gMCBhbmQgMjU1XG4gICAgKiBAcmV0dXJucyB7SW50ZWdlcn1cbiAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ2dyZWVuJywgMCwgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHRoaXMuX2ZpbHRlclVwVG9EYXRlID0gZmFsc2U7XG4gICAgICAgIGlmICh2YWwgPiAyNTUpIHtcbiAgICAgICAgICAgIHJldHVybiAyNTU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWwpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGZpbHRlciBncmVlbiB2YWx1ZS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuUkdCQX0gZmlsdGVyLlxuICAgICogQG5hbWUgZ3JlZW5cbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtJbnRlZ2VyfSBncmVlbiB2YWx1ZSBiZXR3ZWVuIDAgYW5kIDI1NVxuICAgICogQHJldHVybnMge0ludGVnZXJ9XG4gICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdibHVlJywgMCwgS29udmEuVmFsaWRhdG9ycy5SR0JDb21wb25lbnQsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuICAgIC8qKlxuICAgICogZ2V0L3NldCBmaWx0ZXIgYmx1ZSB2YWx1ZS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuUkdCQX0gZmlsdGVyLlxuICAgICogQG5hbWUgYmx1ZVxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge0ludGVnZXJ9IGJsdWUgdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTVcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnYWxwaGEnLCAxLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgdGhpcy5fZmlsdGVyVXBUb0RhdGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbCA+IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZmlsdGVyIGFscGhhIHZhbHVlLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5SR0JBfSBmaWx0ZXIuXG4gICAgICogQG5hbWUgYWxwaGFcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtGbG9hdH0gYWxwaGEgdmFsdWUgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHJldHVybnMge0Zsb2F0fVxuICAgICAqL1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgKiBIU1YgRmlsdGVyLiBBZGp1c3RzIHRoZSBodWUsIHNhdHVyYXRpb24gYW5kIHZhbHVlXG4gICAgKiBAZnVuY3Rpb25cbiAgICAqIEBuYW1lIEhTVlxuICAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcbiAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAqIEBhdXRob3IgaXBwbzYxNVxuICAgICogQGV4YW1wbGVcbiAgICAqIGltYWdlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuSFNWXSk7XG4gICAgKiBpbWFnZS52YWx1ZSgyMDApO1xuICAgICovXG5cbiAgICBLb252YS5GaWx0ZXJzLkhTViA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YSxcbiAgICAgICAgICAgIG5QaXhlbHMgPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgICAgIHYgPSBNYXRoLnBvdygyLCB0aGlzLnZhbHVlKCkpLFxuICAgICAgICAgICAgcyA9IE1hdGgucG93KDIsIHRoaXMuc2F0dXJhdGlvbigpKSxcbiAgICAgICAgICAgIGggPSBNYXRoLmFicygodGhpcy5odWUoKSkgKyAzNjApICUgMzYwLFxuICAgICAgICAgICAgaTtcblxuICAgICAgICAvLyBCYXNpcyBmb3IgdGhlIHRlY2huaXF1ZSB1c2VkOlxuICAgICAgICAvLyBodHRwOi8vYmVlc2J1enouYml6L2NvZGUvaHN2X2NvbG9yX3RyYW5zZm9ybXMucGhwXG4gICAgICAgIC8vIFYgaXMgdGhlIHZhbHVlIG11bHRpcGxpZXIgKDEgZm9yIG5vbmUsIDIgZm9yIGRvdWJsZSwgMC41IGZvciBoYWxmKVxuICAgICAgICAvLyBTIGlzIHRoZSBzYXR1cmF0aW9uIG11bHRpcGxpZXIgKDEgZm9yIG5vbmUsIDIgZm9yIGRvdWJsZSwgMC41IGZvciBoYWxmKVxuICAgICAgICAvLyBIIGlzIHRoZSBodWUgc2hpZnQgaW4gZGVncmVlcyAoMCB0byAzNjApXG4gICAgICAgIC8vIHZzdSA9IFYqUypjb3MoSCpQSS8xODApO1xuICAgICAgICAvLyB2c3cgPSBWKlMqc2luKEgqUEkvMTgwKTtcbiAgICAgICAgLy9bIC4yOTlWKy43MDF2c3UrLjE2OHZzdyAgICAuNTg3Vi0uNTg3dnN1Ky4zMzB2c3cgICAgLjExNFYtLjExNHZzdS0uNDk3dnN3IF0gW1JdXG4gICAgICAgIC8vWyAuMjk5Vi0uMjk5dnN1LS4zMjh2c3cgICAgLjU4N1YrLjQxM3ZzdSsuMDM1dnN3ICAgIC4xMTRWLS4xMTR2c3UrLjI5MnZzdyBdKltHXVxuICAgICAgICAvL1sgLjI5OVYtLjMwMHZzdSsxLjI1dnN3ICAgIC41ODdWLS41ODh2c3UtMS4wNXZzdyAgICAuMTE0VisuODg2dnN1LS4yMDN2c3cgXSBbQl1cblxuICAgICAgICAvLyBQcmVjb21wdXRlIHRoZSB2YWx1ZXMgaW4gdGhlIG1hdHJpeDpcbiAgICAgICAgdmFyIHZzdSA9IHYgKiBzICogTWF0aC5jb3MoaCAqIE1hdGguUEkgLyAxODApLFxuICAgICAgICAgICAgdnN3ID0gdiAqIHMgKiBNYXRoLnNpbihoICogTWF0aC5QSSAvIDE4MCk7XG4gICAgICAgIC8vIChyZXN1bHQgc3BvdCkoc291cmNlIHNwb3QpXG4gICAgICAgIHZhciByciA9IDAuMjk5ICogdiArIDAuNzAxICogdnN1ICsgMC4xNjcgKiB2c3csXG4gICAgICAgICAgICByZyA9IDAuNTg3ICogdiAtIDAuNTg3ICogdnN1ICsgMC4zMzAgKiB2c3csXG4gICAgICAgICAgICByYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1IC0gMC40OTcgKiB2c3c7XG4gICAgICAgIHZhciBnciA9IDAuMjk5ICogdiAtIDAuMjk5ICogdnN1IC0gMC4zMjggKiB2c3csXG4gICAgICAgICAgICBnZyA9IDAuNTg3ICogdiArIDAuNDEzICogdnN1ICsgMC4wMzUgKiB2c3csXG4gICAgICAgICAgICBnYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1ICsgMC4yOTMgKiB2c3c7XG4gICAgICAgIHZhciBiciA9IDAuMjk5ICogdiAtIDAuMzAwICogdnN1ICsgMS4yNTAgKiB2c3csXG4gICAgICAgICAgICBiZyA9IDAuNTg3ICogdiAtIDAuNTg2ICogdnN1IC0gMS4wNTAgKiB2c3csXG4gICAgICAgICAgICBiYiA9IDAuMTE0ICogdiArIDAuODg2ICogdnN1IC0gMC4yMDAgKiB2c3c7XG5cbiAgICAgICAgdmFyIHIsIGcsIGIsIGE7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICAgICAgciA9IGRhdGFbaSArIDBdO1xuICAgICAgICAgICAgZyA9IGRhdGFbaSArIDFdO1xuICAgICAgICAgICAgYiA9IGRhdGFbaSArIDJdO1xuICAgICAgICAgICAgYSA9IGRhdGFbaSArIDNdO1xuXG4gICAgICAgICAgICBkYXRhW2kgKyAwXSA9IHJyICogciArIHJnICogZyArIHJiICogYjtcbiAgICAgICAgICAgIGRhdGFbaSArIDFdID0gZ3IgKiByICsgZ2cgKiBnICsgZ2IgKiBiO1xuICAgICAgICAgICAgZGF0YVtpICsgMl0gPSBiciAqIHIgKyBiZyAqIGcgKyBiYiAqIGI7XG4gICAgICAgICAgICBkYXRhW2kgKyAzXSA9IGE7IC8vIGFscGhhXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnaHVlJywgMCwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGhzdiBodWUgaW4gZGVncmVlcy4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuSFNWfSBvciB7QGxpbmsgS29udmEuRmlsdGVycy5IU0x9IGZpbHRlci5cbiAgICAqIEBuYW1lIGh1ZVxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge051bWJlcn0gaHVlIHZhbHVlIGJldHdlZW4gMCBhbmQgMzU5XG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnc2F0dXJhdGlvbicsIDAsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuICAgIC8qKlxuICAgICogZ2V0L3NldCBoc3Ygc2F0dXJhdGlvbi4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuSFNWfSBvciB7QGxpbmsgS29udmEuRmlsdGVycy5IU0x9IGZpbHRlci5cbiAgICAqIEBuYW1lIHNhdHVyYXRpb25cbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtOdW1iZXJ9IHNhdHVyYXRpb24gMCBpcyBubyBjaGFuZ2UsIC0xLjAgaGFsdmVzIHRoZSBzYXR1cmF0aW9uLCAxLjAgZG91YmxlcywgZXRjLi5cbiAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICd2YWx1ZScsIDAsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuICAgIC8qKlxuICAgICogZ2V0L3NldCBoc3YgdmFsdWUuIFVzZSB3aXRoIHtAbGluayBLb252YS5GaWx0ZXJzLkhTVn0gZmlsdGVyLlxuICAgICogQG5hbWUgdmFsdWVcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtOdW1iZXJ9IHZhbHVlIDAgaXMgbm8gY2hhbmdlLCAtMS4wIGhhbHZlcyB0aGUgdmFsdWUsIDEuMCBkb3VibGVzLCBldGMuLlxuICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAqL1xuXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdodWUnLCAwLCBudWxsLCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcbiAgICAvKipcbiAgICAqIGdldC9zZXQgaHN2IGh1ZSBpbiBkZWdyZWVzLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5IU1Z9IG9yIHtAbGluayBLb252YS5GaWx0ZXJzLkhTTH0gZmlsdGVyLlxuICAgICogQG5hbWUgaHVlXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBodWUgdmFsdWUgYmV0d2VlbiAwIGFuZCAzNTlcbiAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdzYXR1cmF0aW9uJywgMCwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGhzdiBzYXR1cmF0aW9uLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5IU1Z9IG9yIHtAbGluayBLb252YS5GaWx0ZXJzLkhTTH0gZmlsdGVyLlxuICAgICogQG5hbWUgc2F0dXJhdGlvblxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge051bWJlcn0gc2F0dXJhdGlvbiAwIGlzIG5vIGNoYW5nZSwgLTEuMCBoYWx2ZXMgdGhlIHNhdHVyYXRpb24sIDEuMCBkb3VibGVzLCBldGMuLlxuICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ2x1bWluYW5jZScsIDAsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuICAgIC8qKlxuICAgICogZ2V0L3NldCBoc2wgbHVtaW5hbmNlLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5IU0x9IGZpbHRlci5cbiAgICAqIEBuYW1lIHZhbHVlXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSAwIGlzIG5vIGNoYW5nZSwgLTEuMCBoYWx2ZXMgdGhlIHZhbHVlLCAxLjAgZG91YmxlcywgZXRjLi5cbiAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgKi9cblxuICAgIC8qKlxuICAgICogSFNMIEZpbHRlci4gQWRqdXN0cyB0aGUgaHVlLCBzYXR1cmF0aW9uIGFuZCBsdW1pbmFuY2UgKG9yIGxpZ2h0bmVzcylcbiAgICAqIEBmdW5jdGlvblxuICAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcbiAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAqIEBhdXRob3IgaXBwbzYxNVxuICAgICogQGV4YW1wbGVcbiAgICAqIGltYWdlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuSFNMXSk7XG4gICAgKiBpbWFnZS5sdW1pbmFuY2UoMjAwKTtcbiAgICAqL1xuXG4gICAgS29udmEuRmlsdGVycy5IU0wgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgIHZhciBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICBuUGl4ZWxzID0gZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICB2ID0gMSxcbiAgICAgICAgICAgIHMgPSBNYXRoLnBvdygyLCB0aGlzLnNhdHVyYXRpb24oKSksXG4gICAgICAgICAgICBoID0gTWF0aC5hYnMoKHRoaXMuaHVlKCkpICsgMzYwKSAlIDM2MCxcbiAgICAgICAgICAgIGwgPSB0aGlzLmx1bWluYW5jZSgpICogMTI3LFxuICAgICAgICAgICAgaTtcblxuICAgICAgICAvLyBCYXNpcyBmb3IgdGhlIHRlY2huaXF1ZSB1c2VkOlxuICAgICAgICAvLyBodHRwOi8vYmVlc2J1enouYml6L2NvZGUvaHN2X2NvbG9yX3RyYW5zZm9ybXMucGhwXG4gICAgICAgIC8vIFYgaXMgdGhlIHZhbHVlIG11bHRpcGxpZXIgKDEgZm9yIG5vbmUsIDIgZm9yIGRvdWJsZSwgMC41IGZvciBoYWxmKVxuICAgICAgICAvLyBTIGlzIHRoZSBzYXR1cmF0aW9uIG11bHRpcGxpZXIgKDEgZm9yIG5vbmUsIDIgZm9yIGRvdWJsZSwgMC41IGZvciBoYWxmKVxuICAgICAgICAvLyBIIGlzIHRoZSBodWUgc2hpZnQgaW4gZGVncmVlcyAoMCB0byAzNjApXG4gICAgICAgIC8vIHZzdSA9IFYqUypjb3MoSCpQSS8xODApO1xuICAgICAgICAvLyB2c3cgPSBWKlMqc2luKEgqUEkvMTgwKTtcbiAgICAgICAgLy9bIC4yOTlWKy43MDF2c3UrLjE2OHZzdyAgICAuNTg3Vi0uNTg3dnN1Ky4zMzB2c3cgICAgLjExNFYtLjExNHZzdS0uNDk3dnN3IF0gW1JdXG4gICAgICAgIC8vWyAuMjk5Vi0uMjk5dnN1LS4zMjh2c3cgICAgLjU4N1YrLjQxM3ZzdSsuMDM1dnN3ICAgIC4xMTRWLS4xMTR2c3UrLjI5MnZzdyBdKltHXVxuICAgICAgICAvL1sgLjI5OVYtLjMwMHZzdSsxLjI1dnN3ICAgIC41ODdWLS41ODh2c3UtMS4wNXZzdyAgICAuMTE0VisuODg2dnN1LS4yMDN2c3cgXSBbQl1cblxuICAgICAgICAvLyBQcmVjb21wdXRlIHRoZSB2YWx1ZXMgaW4gdGhlIG1hdHJpeDpcbiAgICAgICAgdmFyIHZzdSA9IHYgKiBzICogTWF0aC5jb3MoaCAqIE1hdGguUEkgLyAxODApLFxuICAgICAgICAgICAgdnN3ID0gdiAqIHMgKiBNYXRoLnNpbihoICogTWF0aC5QSSAvIDE4MCk7XG4gICAgICAgIC8vIChyZXN1bHQgc3BvdCkoc291cmNlIHNwb3QpXG4gICAgICAgIHZhciByciA9IDAuMjk5ICogdiArIDAuNzAxICogdnN1ICsgMC4xNjcgKiB2c3csXG4gICAgICAgICAgICByZyA9IDAuNTg3ICogdiAtIDAuNTg3ICogdnN1ICsgMC4zMzAgKiB2c3csXG4gICAgICAgICAgICByYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1IC0gMC40OTcgKiB2c3c7XG4gICAgICAgIHZhciBnciA9IDAuMjk5ICogdiAtIDAuMjk5ICogdnN1IC0gMC4zMjggKiB2c3csXG4gICAgICAgICAgICBnZyA9IDAuNTg3ICogdiArIDAuNDEzICogdnN1ICsgMC4wMzUgKiB2c3csXG4gICAgICAgICAgICBnYiA9IDAuMTE0ICogdiAtIDAuMTE0ICogdnN1ICsgMC4yOTMgKiB2c3c7XG4gICAgICAgIHZhciBiciA9IDAuMjk5ICogdiAtIDAuMzAwICogdnN1ICsgMS4yNTAgKiB2c3csXG4gICAgICAgICAgICBiZyA9IDAuNTg3ICogdiAtIDAuNTg2ICogdnN1IC0gMS4wNTAgKiB2c3csXG4gICAgICAgICAgICBiYiA9IDAuMTE0ICogdiArIDAuODg2ICogdnN1IC0gMC4yMDAgKiB2c3c7XG5cbiAgICAgICAgdmFyIHIsIGcsIGIsIGE7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICAgICAgciA9IGRhdGFbaSArIDBdO1xuICAgICAgICAgICAgZyA9IGRhdGFbaSArIDFdO1xuICAgICAgICAgICAgYiA9IGRhdGFbaSArIDJdO1xuICAgICAgICAgICAgYSA9IGRhdGFbaSArIDNdO1xuXG4gICAgICAgICAgICBkYXRhW2kgKyAwXSA9IHJyICogciArIHJnICogZyArIHJiICogYiArIGw7XG4gICAgICAgICAgICBkYXRhW2kgKyAxXSA9IGdyICogciArIGdnICogZyArIGdiICogYiArIGw7XG4gICAgICAgICAgICBkYXRhW2kgKyAyXSA9IGJyICogciArIGJnICogZyArIGJiICogYiArIGw7XG4gICAgICAgICAgICBkYXRhW2kgKyAzXSA9IGE7IC8vIGFscGhhXG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogRW1ib3NzIEZpbHRlci5cbiAgICAgKiBQaXhhc3RpYyBMaWIgLSBFbWJvc3MgZmlsdGVyIC0gdjAuMS4wXG4gICAgICogQ29weXJpZ2h0IChjKSAyMDA4IEphY29iIFNlaWRlbGluLCBqc2VpZGVsaW5AbmloaWxvZ2ljLmRrLCBodHRwOi8vYmxvZy5uaWhpbG9naWMuZGsvXG4gICAgICogTGljZW5zZTogW2h0dHA6Ly93d3cucGl4YXN0aWMuY29tL2xpYi9saWNlbnNlLnR4dF1cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuRW1ib3NzXSk7XG4gICAgICogbm9kZS5lbWJvc3NTdHJlbmd0aCgwLjgpO1xuICAgICAqIG5vZGUuZW1ib3NzV2hpdGVMZXZlbCgwLjMpO1xuICAgICAqIG5vZGUuZW1ib3NzRGlyZWN0aW9uKCdyaWdodCcpO1xuICAgICAqIG5vZGUuZW1ib3NzQmxlbmQodHJ1ZSk7XG4gICAgICovXG4gICAgS29udmEuRmlsdGVycy5FbWJvc3MgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG5cbiAgICAgICAgLy8gcGl4YXN0aWMgc3RyZW5ndGggaXMgYmV0d2VlbiAwIGFuZCAxMC4gIEkgd2FudCBpdCBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgICAgLy8gcGl4YXN0aWMgZ3JleUxldmVsIGlzIGJldHdlZW4gMCBhbmQgMjU1LiAgSSB3YW50IGl0IGJldHdlZW4gMCBhbmQgMS4gIEFsc28sXG4gICAgICAgIC8vIGEgbWF4IHZhbHVlIG9mIGdyZXlMZXZlbCB5aWVsZHMgYSB3aGl0ZSBlbWJvc3MsIGFuZCB0aGUgbWluIHZhbHVlIHlpZWxkcyBhIGJsYWNrXG4gICAgICAgIC8vIGVtYm9zcy4gIFRoZXJlZm9yZSwgSSBjaGFuZ2VkIGdyZXlMZXZlbCB0byB3aGl0ZUxldmVsXG4gICAgICAgIHZhciBzdHJlbmd0aCA9IHRoaXMuZW1ib3NzU3RyZW5ndGgoKSAqIDEwLFxuICAgICAgICAgICAgZ3JleUxldmVsID0gdGhpcy5lbWJvc3NXaGl0ZUxldmVsKCkgKiAyNTUsXG4gICAgICAgICAgICBkaXJlY3Rpb24gPSB0aGlzLmVtYm9zc0RpcmVjdGlvbigpLFxuICAgICAgICAgICAgYmxlbmQgPSB0aGlzLmVtYm9zc0JsZW5kKCksXG4gICAgICAgICAgICBkaXJZID0gMCxcbiAgICAgICAgICAgIGRpclggPSAwLFxuICAgICAgICAgICAgZGF0YSA9IGltYWdlRGF0YS5kYXRhLFxuICAgICAgICAgICAgdyA9IGltYWdlRGF0YS53aWR0aCxcbiAgICAgICAgICAgIGggPSBpbWFnZURhdGEuaGVpZ2h0LFxuICAgICAgICAgICAgdzQgPSB3ICogNCxcbiAgICAgICAgICAgIHkgPSBoO1xuXG4gICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICd0b3AtbGVmdCc6XG4gICAgICAgICAgICAgICAgZGlyWSA9IC0xO1xuICAgICAgICAgICAgICAgIGRpclggPSAtMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RvcCc6XG4gICAgICAgICAgICAgICAgZGlyWSA9IC0xO1xuICAgICAgICAgICAgICAgIGRpclggPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndG9wLXJpZ2h0JzpcbiAgICAgICAgICAgICAgICBkaXJZID0gLTE7XG4gICAgICAgICAgICAgICAgZGlyWCA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgICAgZGlyWSA9IDA7XG4gICAgICAgICAgICAgICAgZGlyWCA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdib3R0b20tcmlnaHQnOlxuICAgICAgICAgICAgICAgIGRpclkgPSAxO1xuICAgICAgICAgICAgICAgIGRpclggPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgICAgICAgICAgICBkaXJZID0gMTtcbiAgICAgICAgICAgICAgICBkaXJYID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzpcbiAgICAgICAgICAgICAgICBkaXJZID0gMTtcbiAgICAgICAgICAgICAgICBkaXJYID0gLTE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgICAgICAgICBkaXJZID0gMDtcbiAgICAgICAgICAgICAgICBkaXJYID0gLTE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIEtvbnZhLlV0aWwuZXJyb3IoJ1Vua253byBlbWJvc3MgZGlyZWN0aW9uOiAnICsgZGlyZWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBvZmZzZXRZID0gKHkgLSAxKSAqIHc0O1xuXG4gICAgICAgICAgICB2YXIgb3RoZXJZID0gZGlyWTtcbiAgICAgICAgICAgIGlmICh5ICsgb3RoZXJZIDwgMSl7XG4gICAgICAgICAgICAgICAgb3RoZXJZID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh5ICsgb3RoZXJZID4gaCkge1xuICAgICAgICAgICAgICAgIG90aGVyWSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXRZT3RoZXIgPSAoeSAtIDEgKyBvdGhlclkpICogdyAqIDQ7XG5cbiAgICAgICAgICAgIHZhciB4ID0gdztcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0WSArICh4IC0gMSkgKiA0O1xuXG4gICAgICAgICAgICAgICAgdmFyIG90aGVyWCA9IGRpclg7XG4gICAgICAgICAgICAgICAgaWYgKHggKyBvdGhlclggPCAxKXtcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJYID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHggKyBvdGhlclggPiB3KSB7XG4gICAgICAgICAgICAgICAgICAgIG90aGVyWCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldE90aGVyID0gb2Zmc2V0WU90aGVyICsgKHggLSAxICsgb3RoZXJYKSAqIDQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgZFIgPSBkYXRhW29mZnNldF0gLSBkYXRhW29mZnNldE90aGVyXTtcbiAgICAgICAgICAgICAgICB2YXIgZEcgPSBkYXRhW29mZnNldCArIDFdIC0gZGF0YVtvZmZzZXRPdGhlciArIDFdO1xuICAgICAgICAgICAgICAgIHZhciBkQiA9IGRhdGFbb2Zmc2V0ICsgMl0gLSBkYXRhW29mZnNldE90aGVyICsgMl07XG5cbiAgICAgICAgICAgICAgICB2YXIgZGlmID0gZFI7XG4gICAgICAgICAgICAgICAgdmFyIGFic0RpZiA9IGRpZiA+IDAgPyBkaWYgOiAtZGlmO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFic0cgPSBkRyA+IDAgPyBkRyA6IC1kRztcbiAgICAgICAgICAgICAgICB2YXIgYWJzQiA9IGRCID4gMCA/IGRCIDogLWRCO1xuXG4gICAgICAgICAgICAgICAgaWYgKGFic0cgPiBhYnNEaWYpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlmID0gZEc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhYnNCID4gYWJzRGlmKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpZiA9IGRCO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRpZiAqPSBzdHJlbmd0aDtcblxuICAgICAgICAgICAgICAgIGlmIChibGVuZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGRhdGFbb2Zmc2V0XSArIGRpZjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBkYXRhW29mZnNldCArIDFdICsgZGlmO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGRhdGFbb2Zmc2V0ICsgMl0gKyBkaWY7XG5cbiAgICAgICAgICAgICAgICAgICAgZGF0YVtvZmZzZXRdID0gKHIgPiAyNTUpID8gMjU1IDogKHIgPCAwID8gMCA6IHIpO1xuICAgICAgICAgICAgICAgICAgICBkYXRhW29mZnNldCArIDFdID0gKGcgPiAyNTUpID8gMjU1IDogKGcgPCAwID8gMCA6IGcpO1xuICAgICAgICAgICAgICAgICAgICBkYXRhW29mZnNldCArIDJdID0gKGIgPiAyNTUpID8gMjU1IDogKGIgPCAwID8gMCA6IGIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncmV5ID0gZ3JleUxldmVsIC0gZGlmO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JleSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZXkgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGdyZXkgPiAyNTUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZXkgPSAyNTU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkYXRhW29mZnNldF0gPSBkYXRhW29mZnNldCArIDFdID0gZGF0YVtvZmZzZXQgKyAyXSA9IGdyZXk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IHdoaWxlICgtLXgpO1xuICAgICAgICB9IHdoaWxlICgtLXkpO1xuICAgIH07XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZW1ib3NzU3RyZW5ndGgnLCAwLjUsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuICAgIC8qKlxuICAgICogZ2V0L3NldCBlbWJvc3Mgc3RyZW5ndGguIFVzZSB3aXRoIHtAbGluayBLb252YS5GaWx0ZXJzLkVtYm9zc30gZmlsdGVyLlxuICAgICogQG5hbWUgZW1ib3NzU3RyZW5ndGhcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtOdW1iZXJ9IGxldmVsIGJldHdlZW4gMCBhbmQgMS4gIERlZmF1bHQgaXMgMC41XG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZW1ib3NzV2hpdGVMZXZlbCcsIDAuNSwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGVtYm9zcyB3aGl0ZSBsZXZlbC4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuRW1ib3NzfSBmaWx0ZXIuXG4gICAgKiBAbmFtZSBlbWJvc3NXaGl0ZUxldmVsXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7TnVtYmVyfSBlbWJvc3NXaGl0ZUxldmVsIGJldHdlZW4gMCBhbmQgMS4gIERlZmF1bHQgaXMgMC41XG4gICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZW1ib3NzRGlyZWN0aW9uJywgJ3RvcC1sZWZ0JywgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGVtYm9zcyBkaXJlY3Rpb24uIFVzZSB3aXRoIHtAbGluayBLb252YS5GaWx0ZXJzLkVtYm9zc30gZmlsdGVyLlxuICAgICogQG5hbWUgZW1ib3NzRGlyZWN0aW9uXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSBlbWJvc3NEaXJlY3Rpb24gY2FuIGJlIHRvcC1sZWZ0LCB0b3AsIHRvcC1yaWdodCwgcmlnaHQsIGJvdHRvbS1yaWdodCwgYm90dG9tLCBib3R0b20tbGVmdCBvciBsZWZ0XG4gICAgKiAgIFRoZSBkZWZhdWx0IGlzIHRvcC1sZWZ0XG4gICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZW1ib3NzQmxlbmQnLCBmYWxzZSwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGVtYm9zcyBibGVuZC4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuRW1ib3NzfSBmaWx0ZXIuXG4gICAgKiBAbmFtZSBlbWJvc3NCbGVuZFxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVtYm9zc0JsZW5kXG4gICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAqL1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgZnVuY3Rpb24gcmVtYXAoZnJvbVZhbHVlLCBmcm9tTWluLCBmcm9tTWF4LCB0b01pbiwgdG9NYXgpIHtcbiAgICAgICAgLy8gQ29tcHV0ZSB0aGUgcmFuZ2Ugb2YgdGhlIGRhdGFcbiAgICAgICAgdmFyIGZyb21SYW5nZSA9IGZyb21NYXggLSBmcm9tTWluLFxuICAgICAgICAgIHRvUmFuZ2UgPSB0b01heCAtIHRvTWluLFxuICAgICAgICAgIHRvVmFsdWU7XG5cbiAgICAgICAgLy8gSWYgZWl0aGVyIHJhbmdlIGlzIDAsIHRoZW4gdGhlIHZhbHVlIGNhbiBvbmx5IGJlIG1hcHBlZCB0byAxIHZhbHVlXG4gICAgICAgIGlmIChmcm9tUmFuZ2UgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0b01pbiArIHRvUmFuZ2UgLyAyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0b1JhbmdlID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9NaW47XG4gICAgICAgIH1cblxuICAgICAgICAvLyAoMSkgdW50cmFuc2xhdGUsICgyKSB1bnNjYWxlLCAoMykgcmVzY2FsZSwgKDQpIHJldHJhbnNsYXRlXG4gICAgICAgIHRvVmFsdWUgPSAoZnJvbVZhbHVlIC0gZnJvbU1pbikgLyBmcm9tUmFuZ2U7XG4gICAgICAgIHRvVmFsdWUgPSAodG9SYW5nZSAqIHRvVmFsdWUpICsgdG9NaW47XG5cbiAgICAgICAgcmV0dXJuIHRvVmFsdWU7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAqIEVuaGFuY2UgRmlsdGVyLiBBZGp1c3RzIHRoZSBjb2xvcnMgc28gdGhhdCB0aGV5IHNwYW4gdGhlIHdpZGVzdFxuICAgICogIHBvc3NpYmxlIHJhbmdlIChpZSAwLTI1NSkuIFBlcmZvcm1zIHcqaCBwaXhlbCByZWFkcyBhbmQgdypoIHBpeGVsXG4gICAgKiAgd3JpdGVzLlxuICAgICogQGZ1bmN0aW9uXG4gICAgKiBAbmFtZSBFbmhhbmNlXG4gICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICogQHBhcmFtIHtPYmplY3R9IGltYWdlRGF0YVxuICAgICogQGF1dGhvciBpcHBvNjE1XG4gICAgKiBAZXhhbXBsZVxuICAgICogbm9kZS5jYWNoZSgpO1xuICAgICogbm9kZS5maWx0ZXJzKFtLb252YS5GaWx0ZXJzLkVuaGFuY2VdKTtcbiAgICAqIG5vZGUuZW5oYW5jZSgwLjQpO1xuICAgICovXG4gICAgS29udmEuRmlsdGVycy5FbmhhbmNlID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xuICAgICAgICB2YXIgZGF0YSA9IGltYWdlRGF0YS5kYXRhLFxuICAgICAgICAgICAgblN1YlBpeGVscyA9IGRhdGEubGVuZ3RoLFxuICAgICAgICAgICAgck1pbiA9IGRhdGFbMF0sIHJNYXggPSByTWluLCByLFxuICAgICAgICAgICAgZ01pbiA9IGRhdGFbMV0sIGdNYXggPSBnTWluLCBnLFxuICAgICAgICAgICAgYk1pbiA9IGRhdGFbMl0sIGJNYXggPSBiTWluLCBiLFxuICAgICAgICAgICAgaTtcblxuICAgICAgICAvLyBJZiB3ZSBhcmUgbm90IGVuaGFuY2luZyBhbnl0aGluZyAtIGRvbid0IGRvIGFueSBjb21wdXRhdGlvblxuICAgICAgICB2YXIgZW5oYW5jZUFtb3VudCA9IHRoaXMuZW5oYW5jZSgpO1xuICAgICAgICBpZiggZW5oYW5jZUFtb3VudCA9PT0gMCApeyByZXR1cm47IH1cblxuICAgICAgICAvLyAxc3QgUGFzcyAtIGZpbmQgdGhlIG1pbiBhbmQgbWF4IGZvciBlYWNoIGNoYW5uZWw6XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBuU3ViUGl4ZWxzOyBpICs9IDQpIHtcbiAgICAgICAgICAgIHIgPSBkYXRhW2kgKyAwXTtcbiAgICAgICAgICAgIGlmIChyIDwgck1pbikgeyByTWluID0gcjsgfVxuICAgICAgICAgICAgZWxzZSBpZiAociA+IHJNYXgpIHsgck1heCA9IHI7IH1cbiAgICAgICAgICAgIGcgPSBkYXRhW2kgKyAxXTtcbiAgICAgICAgICAgIGlmIChnIDwgZ01pbikgeyBnTWluID0gZzsgfSBlbHNlXG4gICAgICAgICAgICBpZiAoZyA+IGdNYXgpIHsgZ01heCA9IGc7IH1cbiAgICAgICAgICAgIGIgPSBkYXRhW2kgKyAyXTtcbiAgICAgICAgICAgIGlmIChiIDwgYk1pbikgeyBiTWluID0gYjsgfSBlbHNlXG4gICAgICAgICAgICBpZiAoYiA+IGJNYXgpIHsgYk1heCA9IGI7IH1cbiAgICAgICAgICAgIC8vYSA9IGRhdGFbaSArIDNdO1xuICAgICAgICAgICAgLy9pZiAoYSA8IGFNaW4pIHsgYU1pbiA9IGE7IH0gZWxzZVxuICAgICAgICAgICAgLy9pZiAoYSA+IGFNYXgpIHsgYU1heCA9IGE7IH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZXJlIGlzIG9ubHkgMSBsZXZlbCAtIGRvbid0IHJlbWFwXG4gICAgICAgIGlmKCByTWF4ID09PSByTWluICl7IHJNYXggPSAyNTU7IHJNaW4gPSAwOyB9XG4gICAgICAgIGlmKCBnTWF4ID09PSBnTWluICl7IGdNYXggPSAyNTU7IGdNaW4gPSAwOyB9XG4gICAgICAgIGlmKCBiTWF4ID09PSBiTWluICl7IGJNYXggPSAyNTU7IGJNaW4gPSAwOyB9XG5cbiAgICAgICAgdmFyIHJNaWQsIHJHb2FsTWF4LCByR29hbE1pbixcbiAgICAgICAgICAgIGdNaWQsIGdHb2FsTWF4LCBnR29hbE1pbixcbiAgICAgICAgICAgIGJNaWQsIGJHb2FsTWF4LCBiR29hbE1pbjtcblxuICAgICAgICAvLyBJZiB0aGUgZW5oYW5jZW1lbnQgaXMgcG9zaXRpdmUgLSBzdHJldGNoIHRoZSBoaXN0b2dyYW1cbiAgICAgICAgaWYgKCBlbmhhbmNlQW1vdW50ID4gMCApe1xuICAgICAgICAgICAgckdvYWxNYXggPSByTWF4ICsgZW5oYW5jZUFtb3VudCAqICgyNTUgLSByTWF4KTtcbiAgICAgICAgICAgIHJHb2FsTWluID0gck1pbiAtIGVuaGFuY2VBbW91bnQgKiAock1pbiAtIDApO1xuICAgICAgICAgICAgZ0dvYWxNYXggPSBnTWF4ICsgZW5oYW5jZUFtb3VudCAqICgyNTUgLSBnTWF4KTtcbiAgICAgICAgICAgIGdHb2FsTWluID0gZ01pbiAtIGVuaGFuY2VBbW91bnQgKiAoZ01pbiAtIDApO1xuICAgICAgICAgICAgYkdvYWxNYXggPSBiTWF4ICsgZW5oYW5jZUFtb3VudCAqICgyNTUgLSBiTWF4KTtcbiAgICAgICAgICAgIGJHb2FsTWluID0gYk1pbiAtIGVuaGFuY2VBbW91bnQgKiAoYk1pbiAtIDApO1xuICAgICAgICAvLyBJZiB0aGUgZW5oYW5jZW1lbnQgaXMgbmVnYXRpdmUgLSAgIGNvbXByZXNzIHRoZSBoaXN0b2dyYW1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJNaWQgPSAock1heCArIHJNaW4pICogMC41O1xuICAgICAgICAgICAgckdvYWxNYXggPSByTWF4ICsgZW5oYW5jZUFtb3VudCAqIChyTWF4IC0gck1pZCk7XG4gICAgICAgICAgICByR29hbE1pbiA9IHJNaW4gKyBlbmhhbmNlQW1vdW50ICogKHJNaW4gLSByTWlkKTtcbiAgICAgICAgICAgIGdNaWQgPSAoZ01heCArIGdNaW4pICogMC41O1xuICAgICAgICAgICAgZ0dvYWxNYXggPSBnTWF4ICsgZW5oYW5jZUFtb3VudCAqIChnTWF4IC0gZ01pZCk7XG4gICAgICAgICAgICBnR29hbE1pbiA9IGdNaW4gKyBlbmhhbmNlQW1vdW50ICogKGdNaW4gLSBnTWlkKTtcbiAgICAgICAgICAgIGJNaWQgPSAoYk1heCArIGJNaW4pICogMC41O1xuICAgICAgICAgICAgYkdvYWxNYXggPSBiTWF4ICsgZW5oYW5jZUFtb3VudCAqIChiTWF4IC0gYk1pZCk7XG4gICAgICAgICAgICBiR29hbE1pbiA9IGJNaW4gKyBlbmhhbmNlQW1vdW50ICogKGJNaW4gLSBiTWlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBhc3MgMiAtIHJlbWFwIGV2ZXJ5dGhpbmcsIGV4Y2VwdCB0aGUgYWxwaGFcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5TdWJQaXhlbHM7IGkgKz0gNCkge1xuICAgICAgICAgICAgZGF0YVtpICsgMF0gPSByZW1hcChkYXRhW2kgKyAwXSwgck1pbiwgck1heCwgckdvYWxNaW4sIHJHb2FsTWF4KTtcbiAgICAgICAgICAgIGRhdGFbaSArIDFdID0gcmVtYXAoZGF0YVtpICsgMV0sIGdNaW4sIGdNYXgsIGdHb2FsTWluLCBnR29hbE1heCk7XG4gICAgICAgICAgICBkYXRhW2kgKyAyXSA9IHJlbWFwKGRhdGFbaSArIDJdLCBiTWluLCBiTWF4LCBiR29hbE1pbiwgYkdvYWxNYXgpO1xuICAgICAgICAgICAgLy9kYXRhW2kgKyAzXSA9IHJlbWFwKGRhdGFbaSArIDNdLCBhTWluLCBhTWF4LCBhR29hbE1pbiwgYUdvYWxNYXgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdlbmhhbmNlJywgMCwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG5cbiAgICAvKipcbiAgICAqIGdldC9zZXQgZW5oYW5jZS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuRW5oYW5jZX0gZmlsdGVyLlxuICAgICogQG5hbWUgZW5oYW5jZVxuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgKiBAcGFyYW0ge0Zsb2F0fSBhbW91bnRcbiAgICAqIEByZXR1cm5zIHtGbG9hdH1cbiAgICAqL1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogUG9zdGVyaXplIEZpbHRlci4gQWRqdXN0cyB0aGUgY2hhbm5lbHMgc28gdGhhdCB0aGVyZSBhcmUgbm8gbW9yZVxuICAgICAqICB0aGFuIG4gZGlmZmVyZW50IHZhbHVlcyBmb3IgdGhhdCBjaGFubmVsLiBUaGlzIGlzIGFsc28gYXBwbGllZFxuICAgICAqICB0byB0aGUgYWxwaGEgY2hhbm5lbC5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbmFtZSBQb3N0ZXJpemVcbiAgICAgKiBAYXV0aG9yIGlwcG82MTVcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuUG9zdGVyaXplXSk7XG4gICAgICogbm9kZS5sZXZlbHMoMC44KTsgLy8gYmV0d2VlbiAwIGFuZCAxXG4gICAgICovXG5cbiAgICBLb252YS5GaWx0ZXJzLlBvc3Rlcml6ZSA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHtcbiAgICAgICAgLy8gbGV2ZWwgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDI1NVxuICAgICAgICB2YXIgbGV2ZWxzID0gTWF0aC5yb3VuZCh0aGlzLmxldmVscygpICogMjU0KSArIDEsXG4gICAgICAgICAgICBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICBsZW4gPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgICAgIHNjYWxlID0gKDI1NSAvIGxldmVscyksXG4gICAgICAgICAgICBpO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICAgICAgZGF0YVtpXSA9IE1hdGguZmxvb3IoZGF0YVtpXSAvIHNjYWxlKSAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdsZXZlbHMnLCAwLjUsIG51bGwsIEtvbnZhLkZhY3RvcnkuYWZ0ZXJTZXRGaWx0ZXIpO1xuXG4gICAgLyoqXG4gICAgKiBnZXQvc2V0IGxldmVscy4gIE11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAgVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuUG9zdGVyaXplfSBmaWx0ZXIuXG4gICAgKiBAbmFtZSBsZXZlbHNcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtOdW1iZXJ9IGxldmVsIGJldHdlZW4gMCBhbmQgMVxuICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAqL1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAvKipcclxuICAgICAqIE5vaXNlIEZpbHRlci4gUmFuZG9tbHkgYWRkcyBvciBzdWJzdHJhY3RzIHRvIHRoZSBjb2xvciBjaGFubmVsc1xyXG4gICAgICogQGZ1bmN0aW9uXHJcbiAgICAgKiBAbmFtZSBOb2lzZVxyXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBpbWFnZURhdGFcclxuICAgICAqIEBhdXRob3IgaXBwbzYxNVxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIG5vZGUuY2FjaGUoKTtcclxuICAgICAqIG5vZGUuZmlsdGVycyhbS29udmEuRmlsdGVycy5Ob2lzZV0pO1xyXG4gICAgICogbm9kZS5ub2lzZSgwLjgpO1xyXG4gICAgICovXHJcbiAgICBLb252YS5GaWx0ZXJzLk5vaXNlID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xyXG4gICAgICAgIHZhciBhbW91bnQgPSB0aGlzLm5vaXNlKCkgKiAyNTUsXHJcbiAgICAgICAgICAgIGRhdGEgPSBpbWFnZURhdGEuZGF0YSxcclxuICAgICAgICAgICAgblBpeGVscyA9IGRhdGEubGVuZ3RoLFxyXG4gICAgICAgICAgICBoYWxmID0gYW1vdW50IC8gMixcclxuICAgICAgICAgICAgaTtcclxuXHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5QaXhlbHM7IGkgKz0gNCkge1xyXG4gICAgICAgICAgICBkYXRhW2kgKyAwXSArPSBoYWxmIC0gMiAqIGhhbGYgKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgICAgICBkYXRhW2kgKyAxXSArPSBoYWxmIC0gMiAqIGhhbGYgKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgICAgICBkYXRhW2kgKyAyXSArPSBoYWxmIC0gMiAqIGhhbGYgKiBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ25vaXNlJywgMC4yLCBudWxsLCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcclxuXHJcbiAgICAvKipcclxuICAgICogZ2V0L3NldCBub2lzZSBhbW91bnQuICBNdXN0IGJlIGEgdmFsdWUgYmV0d2VlbiAwIGFuZCAxLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5Ob2lzZX0gZmlsdGVyLlxyXG4gICAgKiBAbmFtZSBub2lzZVxyXG4gICAgKiBAbWV0aG9kXHJcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxyXG4gICAgKiBAcGFyYW0ge051bWJlcn0gbm9pc2VcclxuICAgICogQHJldHVybnMge051bWJlcn1cclxuICAgICovXHJcbn0pKCk7XHJcblxuLyplc2xpbnQtZGlzYWJsZSBtYXgtZGVwdGggKi9cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIC8qKlxyXG4gICAgICogUGl4ZWxhdGUgRmlsdGVyLiBBdmVyYWdlcyBncm91cHMgb2YgcGl4ZWxzIGFuZCByZWRyYXdzXHJcbiAgICAgKiAgdGhlbSBhcyBsYXJnZXIgcGl4ZWxzXHJcbiAgICAgKiBAZnVuY3Rpb25cclxuICAgICAqIEBuYW1lIFBpeGVsYXRlXHJcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGltYWdlRGF0YVxyXG4gICAgICogQGF1dGhvciBpcHBvNjE1XHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogbm9kZS5jYWNoZSgpO1xyXG4gICAgICogbm9kZS5maWx0ZXJzKFtLb252YS5GaWx0ZXJzLlBpeGVsYXRlXSk7XHJcbiAgICAgKiBub2RlLnBpeGVsU2l6ZSgxMCk7XHJcbiAgICAgKi9cclxuXHJcbiAgICBLb252YS5GaWx0ZXJzLlBpeGVsYXRlID0gZnVuY3Rpb24gKGltYWdlRGF0YSkge1xyXG5cclxuICAgICAgICB2YXIgcGl4ZWxTaXplID0gTWF0aC5jZWlsKHRoaXMucGl4ZWxTaXplKCkpLFxyXG4gICAgICAgICAgICB3aWR0aCA9IGltYWdlRGF0YS53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0ID0gaW1hZ2VEYXRhLmhlaWdodCxcclxuICAgICAgICAgICAgeCwgeSwgaSxcclxuICAgICAgICAgICAgLy9waXhlbHNQZXJCaW4gPSBwaXhlbFNpemUgKiBwaXhlbFNpemUsXHJcbiAgICAgICAgICAgIHJlZCwgZ3JlZW4sIGJsdWUsIGFscGhhLFxyXG4gICAgICAgICAgICBuQmluc1ggPSBNYXRoLmNlaWwod2lkdGggLyBwaXhlbFNpemUpLFxyXG4gICAgICAgICAgICBuQmluc1kgPSBNYXRoLmNlaWwoaGVpZ2h0IC8gcGl4ZWxTaXplKSxcclxuICAgICAgICAgICAgeEJpblN0YXJ0LCB4QmluRW5kLCB5QmluU3RhcnQsIHlCaW5FbmQsXHJcbiAgICAgICAgICAgIHhCaW4sIHlCaW4sIHBpeGVsc0luQmluO1xyXG4gICAgICAgIGltYWdlRGF0YSA9IGltYWdlRGF0YS5kYXRhO1xyXG5cclxuICAgICAgICBpZiAocGl4ZWxTaXplIDw9IDApIHtcclxuICAgICAgICAgICAgS29udmEuVXRpbC5lcnJvcigncGl4ZWxTaXplIHZhbHVlIGNhbiBub3QgYmUgPD0gMCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHhCaW4gPSAwOyB4QmluIDwgbkJpbnNYOyB4QmluICs9IDEpIHtcclxuICAgICAgICAgICAgZm9yICh5QmluID0gMDsgeUJpbiA8IG5CaW5zWTsgeUJpbiArPSAxKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY29sb3IgYWNjdW1sYXRvcnMgdG8gMFxyXG4gICAgICAgICAgICAgICAgcmVkID0gMDtcclxuICAgICAgICAgICAgICAgIGdyZWVuID0gMDtcclxuICAgICAgICAgICAgICAgIGJsdWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgYWxwaGEgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIERldGVybWluZSB3aGljaCBwaXhlbHMgYXJlIGluY2x1ZGVkIGluIHRoaXMgYmluXHJcbiAgICAgICAgICAgICAgICB4QmluU3RhcnQgPSB4QmluICogcGl4ZWxTaXplO1xyXG4gICAgICAgICAgICAgICAgeEJpbkVuZCA9IHhCaW5TdGFydCArIHBpeGVsU2l6ZTtcclxuICAgICAgICAgICAgICAgIHlCaW5TdGFydCA9IHlCaW4gKiBwaXhlbFNpemU7XHJcbiAgICAgICAgICAgICAgICB5QmluRW5kID0geUJpblN0YXJ0ICsgcGl4ZWxTaXplO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFkZCBhbGwgb2YgdGhlIHBpeGVscyB0byB0aGlzIGJpbiFcclxuICAgICAgICAgICAgICAgIHBpeGVsc0luQmluID0gMDtcclxuICAgICAgICAgICAgICAgIGZvciAoeCA9IHhCaW5TdGFydDsgeCA8IHhCaW5FbmQ7IHggKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCB4ID49IHdpZHRoICl7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh5ID0geUJpblN0YXJ0OyB5IDwgeUJpbkVuZDsgeSArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB5ID49IGhlaWdodCApeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gKHdpZHRoICogeSArIHgpICogNDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVkICs9IGltYWdlRGF0YVtpICsgMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyZWVuICs9IGltYWdlRGF0YVtpICsgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsdWUgKz0gaW1hZ2VEYXRhW2kgKyAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEgKz0gaW1hZ2VEYXRhW2kgKyAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxzSW5CaW4gKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBjaGFubmVscyBhcmUgYmV0d2VlbiAwLTI1NVxyXG4gICAgICAgICAgICAgICAgcmVkID0gcmVkIC8gcGl4ZWxzSW5CaW47XHJcbiAgICAgICAgICAgICAgICBncmVlbiA9IGdyZWVuIC8gcGl4ZWxzSW5CaW47XHJcbiAgICAgICAgICAgICAgICBibHVlID0gYmx1ZSAvIHBpeGVsc0luQmluO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIERyYXcgdGhpcyBiaW5cclxuICAgICAgICAgICAgICAgIGZvciAoeCA9IHhCaW5TdGFydDsgeCA8IHhCaW5FbmQ7IHggKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCB4ID49IHdpZHRoICl7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh5ID0geUJpblN0YXJ0OyB5IDwgeUJpbkVuZDsgeSArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB5ID49IGhlaWdodCApeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gKHdpZHRoICogeSArIHgpICogNDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2kgKyAwXSA9IHJlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2kgKyAxXSA9IGdyZWVuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZURhdGFbaSArIDJdID0gYmx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2kgKyAzXSA9IGFscGhhO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9O1xyXG5cclxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLk5vZGUsICdwaXhlbFNpemUnLCA4LCBudWxsLCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcclxuXHJcbiAgICAvKipcclxuICAgICogZ2V0L3NldCBwaXhlbCBzaXplLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5QaXhlbGF0ZX0gZmlsdGVyLlxyXG4gICAgKiBAbmFtZSBwaXhlbFNpemVcclxuICAgICogQG1ldGhvZFxyXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcclxuICAgICogQHBhcmFtIHtJbnRlZ2VyfSBwaXhlbFNpemVcclxuICAgICogQHJldHVybnMge0ludGVnZXJ9XHJcbiAgICAqL1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICAvKipcclxuICAgICAqIFRocmVzaG9sZCBGaWx0ZXIuIFB1c2hlcyBhbnkgdmFsdWUgYWJvdmUgdGhlIG1pZCBwb2ludCB0b1xyXG4gICAgICogIHRoZSBtYXggYW5kIGFueSB2YWx1ZSBiZWxvdyB0aGUgbWlkIHBvaW50IHRvIHRoZSBtaW4uXHJcbiAgICAgKiAgVGhpcyBhZmZlY3RzIHRoZSBhbHBoYSBjaGFubmVsLlxyXG4gICAgICogQGZ1bmN0aW9uXHJcbiAgICAgKiBAbmFtZSBUaHJlc2hvbGRcclxuICAgICAqIEBtZW1iZXJvZiBLb252YS5GaWx0ZXJzXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gaW1hZ2VEYXRhXHJcbiAgICAgKiBAYXV0aG9yIGlwcG82MTVcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBub2RlLmNhY2hlKCk7XHJcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuVGhyZXNob2xkXSk7XHJcbiAgICAgKiBub2RlLnRocmVzaG9sZCgwLjEpO1xyXG4gICAgICovXHJcblxyXG4gICAgS29udmEuRmlsdGVycy5UaHJlc2hvbGQgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XHJcbiAgICAgICAgdmFyIGxldmVsID0gdGhpcy50aHJlc2hvbGQoKSAqIDI1NSxcclxuICAgICAgICAgICAgZGF0YSA9IGltYWdlRGF0YS5kYXRhLFxyXG4gICAgICAgICAgICBsZW4gPSBkYXRhLmxlbmd0aCxcclxuICAgICAgICAgICAgaTtcclxuXHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgIGRhdGFbaV0gPSBkYXRhW2ldIDwgbGV2ZWwgPyAwIDogMjU1O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ3RocmVzaG9sZCcsIDAuNSwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIGdldC9zZXQgdGhyZXNob2xkLiAgTXVzdCBiZSBhIHZhbHVlIGJldHdlZW4gMCBhbmQgMS4gVXNlIHdpdGgge0BsaW5rIEtvbnZhLkZpbHRlcnMuVGhyZXNob2xkfSBvciB7QGxpbmsgS29udmEuRmlsdGVycy5NYXNrfSBmaWx0ZXIuXHJcbiAgICAqIEBuYW1lIHRocmVzaG9sZFxyXG4gICAgKiBAbWV0aG9kXHJcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxyXG4gICAgKiBAcGFyYW0ge051bWJlcn0gdGhyZXNob2xkXHJcbiAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcbiAgICAqL1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogU2VwaWEgRmlsdGVyXG4gICAgICogQmFzZWQgb246IFBpeGFzdGljIExpYiAtIFNlcGlhIGZpbHRlciAtIHYwLjEuMFxuICAgICAqIENvcHlyaWdodCAoYykgMjAwOCBKYWNvYiBTZWlkZWxpbiwganNlaWRlbGluQG5paGlsb2dpYy5kaywgaHR0cDovL2Jsb2cubmloaWxvZ2ljLmRrL1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBuYW1lIFNlcGlhXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gaW1hZ2VEYXRhXG4gICAgICogQGF1dGhvciBKYWNvYiBTZWlkZWxpbiA8anNlaWRlbGluQG5paGlsb2dpYy5kaz5cbiAgICAgKiBAbGljZW5zZSBNUEwgdjEuMSBbaHR0cDovL3d3dy5waXhhc3RpYy5jb20vbGliL2xpY2Vuc2UudHh0XVxuICAgICAqIEBleGFtcGxlXG4gICAgICogbm9kZS5jYWNoZSgpO1xuICAgICAqIG5vZGUuZmlsdGVycyhbS29udmEuRmlsdGVycy5TZXBpYV0pO1xuICAgICAqL1xuICAgIEtvbnZhLkZpbHRlcnMuU2VwaWEgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgIHZhciBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICB3ID0gaW1hZ2VEYXRhLndpZHRoLFxuICAgICAgICAgICAgeSA9IGltYWdlRGF0YS5oZWlnaHQsXG4gICAgICAgICAgICB3NCA9IHcgKiA0LFxuICAgICAgICAgICAgb2Zmc2V0WSwgeCwgb2Zmc2V0LCBvciwgb2csIG9iLCByLCBnLCBiO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIG9mZnNldFkgPSAoeSAtIDEpICogdzQ7XG4gICAgICAgICAgICB4ID0gdztcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXRZICsgKHggLSAxKSAqIDQ7XG5cbiAgICAgICAgICAgICAgICBvciA9IGRhdGFbb2Zmc2V0XTtcbiAgICAgICAgICAgICAgICBvZyA9IGRhdGFbb2Zmc2V0ICsgMV07XG4gICAgICAgICAgICAgICAgb2IgPSBkYXRhW29mZnNldCArIDJdO1xuXG4gICAgICAgICAgICAgICAgciA9IG9yICogMC4zOTMgKyBvZyAqIDAuNzY5ICsgb2IgKiAwLjE4OTtcbiAgICAgICAgICAgICAgICBnID0gb3IgKiAwLjM0OSArIG9nICogMC42ODYgKyBvYiAqIDAuMTY4O1xuICAgICAgICAgICAgICAgIGIgPSBvciAqIDAuMjcyICsgb2cgKiAwLjUzNCArIG9iICogMC4xMzE7XG5cbiAgICAgICAgICAgICAgICBkYXRhW29mZnNldF0gPSByID4gMjU1ID8gMjU1IDogcjtcbiAgICAgICAgICAgICAgICBkYXRhW29mZnNldCArIDFdID0gZyA+IDI1NSA/IDI1NSA6IGc7XG4gICAgICAgICAgICAgICAgZGF0YVtvZmZzZXQgKyAyXSA9IGIgPiAyNTUgPyAyNTUgOiBiO1xuICAgICAgICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgM10gPSBkYXRhW29mZnNldCArIDNdO1xuICAgICAgICAgICAgfSB3aGlsZSAoLS14KTtcbiAgICAgICAgfSB3aGlsZSAoLS15KTtcbiAgICB9O1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogU29sYXJpemUgRmlsdGVyXG4gICAgICogUGl4YXN0aWMgTGliIC0gU29sYXJpemUgZmlsdGVyIC0gdjAuMS4wXG4gICAgICogQ29weXJpZ2h0IChjKSAyMDA4IEphY29iIFNlaWRlbGluLCBqc2VpZGVsaW5AbmloaWxvZ2ljLmRrLCBodHRwOi8vYmxvZy5uaWhpbG9naWMuZGsvXG4gICAgICogTGljZW5zZTogW2h0dHA6Ly93d3cucGl4YXN0aWMuY29tL2xpYi9saWNlbnNlLnR4dF1cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbmFtZSBTb2xhcml6ZVxuICAgICAqIEBtZW1iZXJvZiBLb252YS5GaWx0ZXJzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGltYWdlRGF0YVxuICAgICAqIEBleGFtcGxlXG4gICAgICogbm9kZS5jYWNoZSgpO1xuICAgICAqIG5vZGUuZmlsdGVycyhbS29udmEuRmlsdGVycy5Tb2xhcml6ZV0pO1xuICAgICAqL1xuICAgIEtvbnZhLkZpbHRlcnMuU29sYXJpemUgPSBmdW5jdGlvbiAoaW1hZ2VEYXRhKSB7XG4gICAgICAgIHZhciBkYXRhID0gaW1hZ2VEYXRhLmRhdGEsXG4gICAgICAgICAgICB3ID0gaW1hZ2VEYXRhLndpZHRoLFxuICAgICAgICAgICAgaCA9IGltYWdlRGF0YS5oZWlnaHQsXG4gICAgICAgICAgICB3NCA9IHcgKiA0LFxuICAgICAgICAgICAgeSA9IGg7XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIG9mZnNldFkgPSAoeSAtIDEpICogdzQ7XG4gICAgICAgICAgICB2YXIgeCA9IHc7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IG9mZnNldFkgKyAoeCAtIDEpICogNDtcbiAgICAgICAgICAgICAgICB2YXIgciA9IGRhdGFbb2Zmc2V0XTtcbiAgICAgICAgICAgICAgICB2YXIgZyA9IGRhdGFbb2Zmc2V0ICsgMV07XG4gICAgICAgICAgICAgICAgdmFyIGIgPSBkYXRhW29mZnNldCArIDJdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHIgPiAxMjcpIHtcbiAgICAgICAgICAgICAgICAgICAgciA9IDI1NSAtIHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnID4gMTI3KSB7XG4gICAgICAgICAgICAgICAgICAgIGcgPSAyNTUgLSBnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYiA+IDEyNykge1xuICAgICAgICAgICAgICAgICAgICBiID0gMjU1IC0gYjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkYXRhW29mZnNldF0gPSByO1xuICAgICAgICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgMV0gPSBnO1xuICAgICAgICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgMl0gPSBiO1xuICAgICAgICAgICAgfSB3aGlsZSAoLS14KTtcbiAgICAgICAgfSB3aGlsZSAoLS15KTtcbiAgICB9O1xufSkoKTtcblxuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qXG4gICAqIFRvUG9sYXIgRmlsdGVyLiBDb252ZXJ0cyBpbWFnZSBkYXRhIHRvIHBvbGFyIGNvb3JkaW5hdGVzLiBQZXJmb3Jtc1xuICAgKiAgdypoKjQgcGl4ZWwgcmVhZHMgYW5kIHcqaCBwaXhlbCB3cml0ZXMuIFRoZSByIGF4aXMgaXMgcGxhY2VkIGFsb25nXG4gICAqICB3aGF0IHdvdWxkIGJlIHRoZSB5IGF4aXMgYW5kIHRoZSB0aGV0YSBheGlzIGFsb25nIHRoZSB4IGF4aXMuXG4gICAqIEBmdW5jdGlvblxuICAgKiBAYXV0aG9yIGlwcG82MTVcbiAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcbiAgICogQHBhcmFtIHtJbWFnZURhdGF9IHNyYywgdGhlIHNvdXJjZSBpbWFnZSBkYXRhICh3aGF0IHdpbGwgYmUgdHJhbnNmb3JtZWQpXG4gICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBkc3QsIHRoZSBkZXN0aW5hdGlvbiBpbWFnZSBkYXRhICh3aGVyZSBpdCB3aWxsIGJlIHNhdmVkKVxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0LnBvbGFyQ2VudGVyWF0gaG9yaXpvbnRhbCBsb2NhdGlvbiBmb3IgdGhlIGNlbnRlciBvZiB0aGUgY2lyY2xlLFxuICAgKiAgZGVmYXVsdCBpcyBpbiB0aGUgbWlkZGxlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0LnBvbGFyQ2VudGVyWV0gdmVydGljYWwgbG9jYXRpb24gZm9yIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmNsZSxcbiAgICogIGRlZmF1bHQgaXMgaW4gdGhlIG1pZGRsZVxuICAgKi9cblxuICAgIHZhciBUb1BvbGFyID0gZnVuY3Rpb24oc3JjLCBkc3QsIG9wdCl7XG5cbiAgICAgICAgdmFyIHNyY1BpeGVscyA9IHNyYy5kYXRhLFxuICAgICAgICAgICAgZHN0UGl4ZWxzID0gZHN0LmRhdGEsXG4gICAgICAgICAgICB4U2l6ZSA9IHNyYy53aWR0aCxcbiAgICAgICAgICAgIHlTaXplID0gc3JjLmhlaWdodCxcbiAgICAgICAgICAgIHhNaWQgPSBvcHQucG9sYXJDZW50ZXJYIHx8IHhTaXplIC8gMixcbiAgICAgICAgICAgIHlNaWQgPSBvcHQucG9sYXJDZW50ZXJZIHx8IHlTaXplIC8gMixcbiAgICAgICAgICAgIGksIHgsIHksIHIgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwO1xuXG4gICAgICAgIC8vIEZpbmQgdGhlIGxhcmdlc3QgcmFkaXVzXG4gICAgICAgIHZhciByYWQsIHJNYXggPSBNYXRoLnNxcnQoIHhNaWQgKiB4TWlkICsgeU1pZCAqIHlNaWQgKTtcbiAgICAgICAgeCA9IHhTaXplIC0geE1pZDtcbiAgICAgICAgeSA9IHlTaXplIC0geU1pZDtcbiAgICAgICAgcmFkID0gTWF0aC5zcXJ0KCB4ICogeCArIHkgKiB5ICk7XG4gICAgICAgIHJNYXggPSAocmFkID4gck1heCkgPyByYWQgOiByTWF4O1xuXG4gICAgICAgIC8vIFdlJ2xsIGJlIHVpc25nIHkgYXMgdGhlIHJhZGl1cywgYW5kIHggYXMgdGhlIGFuZ2xlICh0aGV0YT10KVxuICAgICAgICB2YXIgclNpemUgPSB5U2l6ZSxcbiAgICAgICAgICAgIHRTaXplID0geFNpemUsXG4gICAgICAgICAgICByYWRpdXMsIHRoZXRhO1xuXG4gICAgICAgIC8vIFdlIHdhbnQgdG8gY292ZXIgYWxsIGFuZ2xlcyAoMC0zNjApIGFuZCB3ZSBuZWVkIHRvIGNvbnZlcnQgdG9cbiAgICAgICAgLy8gcmFkaWFucyAoKlBJLzE4MClcbiAgICAgICAgdmFyIGNvbnZlcnNpb24gPSAzNjAgLyB0U2l6ZSAqIE1hdGguUEkgLyAxODAsIHNpbiwgY29zO1xuXG4gICAgICAgIC8vIHZhciB4MSwgeDIsIHgxaSwgeDJpLCB5MSwgeTIsIHkxaSwgeTJpLCBzY2FsZTtcblxuICAgICAgICBmb3IoIHRoZXRhID0gMDsgdGhldGEgPCB0U2l6ZTsgdGhldGEgKz0gMSApe1xuICAgICAgICAgICAgc2luID0gTWF0aC5zaW4odGhldGEgKiBjb252ZXJzaW9uKTtcbiAgICAgICAgICAgIGNvcyA9IE1hdGguY29zKHRoZXRhICogY29udmVyc2lvbik7XG4gICAgICAgICAgICBmb3IoIHJhZGl1cyA9IDA7IHJhZGl1cyA8IHJTaXplOyByYWRpdXMgKz0gMSApe1xuICAgICAgICAgICAgICAgIHggPSBNYXRoLmZsb29yKHhNaWQgKyByTWF4ICogcmFkaXVzIC8gclNpemUgKiBjb3MpO1xuICAgICAgICAgICAgICAgIHkgPSBNYXRoLmZsb29yKHlNaWQgKyByTWF4ICogcmFkaXVzIC8gclNpemUgKiBzaW4pO1xuICAgICAgICAgICAgICAgIGkgPSAoeSAqIHhTaXplICsgeCkgKiA0O1xuICAgICAgICAgICAgICAgIHIgPSBzcmNQaXhlbHNbaSArIDBdO1xuICAgICAgICAgICAgICAgIGcgPSBzcmNQaXhlbHNbaSArIDFdO1xuICAgICAgICAgICAgICAgIGIgPSBzcmNQaXhlbHNbaSArIDJdO1xuICAgICAgICAgICAgICAgIGEgPSBzcmNQaXhlbHNbaSArIDNdO1xuXG4gICAgICAgICAgICAgICAgLy8gU3RvcmUgaXRcbiAgICAgICAgICAgICAgICAvL2kgPSAodGhldGEgKiB4U2l6ZSAgKyAgcmFkaXVzKSAqIDQ7XG4gICAgICAgICAgICAgICAgaSA9ICh0aGV0YSArIHJhZGl1cyAqIHhTaXplKSAqIDQ7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAwXSA9IHI7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAxXSA9IGc7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAyXSA9IGI7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAzXSA9IGE7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKlxuICAgICAqIEZyb21Qb2xhciBGaWx0ZXIuIENvbnZlcnRzIGltYWdlIGRhdGEgZnJvbSBwb2xhciBjb29yZGluYXRlcyBiYWNrIHRvIHJlY3Rhbmd1bGFyLlxuICAgICAqICBQZXJmb3JtcyB3KmgqNCBwaXhlbCByZWFkcyBhbmQgdypoIHBpeGVsIHdyaXRlcy5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAYXV0aG9yIGlwcG82MTVcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRmlsdGVyc1xuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBzcmMsIHRoZSBzb3VyY2UgaW1hZ2UgZGF0YSAod2hhdCB3aWxsIGJlIHRyYW5zZm9ybWVkKVxuICAgICAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBkc3QsIHRoZSBkZXN0aW5hdGlvbiBpbWFnZSBkYXRhICh3aGVyZSBpdCB3aWxsIGJlIHNhdmVkKVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW29wdC5wb2xhckNlbnRlclhdIGhvcml6b250YWwgbG9jYXRpb24gZm9yIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmNsZSxcbiAgICAgKiAgZGVmYXVsdCBpcyBpbiB0aGUgbWlkZGxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvcHQucG9sYXJDZW50ZXJZXSB2ZXJ0aWNhbCBsb2NhdGlvbiBmb3IgdGhlIGNlbnRlciBvZiB0aGUgY2lyY2xlLFxuICAgICAqICBkZWZhdWx0IGlzIGluIHRoZSBtaWRkbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW29wdC5wb2xhclJvdGF0aW9uXSBhbW91bnQgdG8gcm90YXRlIHRoZSBpbWFnZSBjb3VudGVyY2xvY2t3aXMsXG4gICAgICogIDAgaXMgbm8gcm90YXRpb24sIDM2MCBkZWdyZWVzIGlzIGEgZnVsbCByb3RhdGlvblxuICAgICAqL1xuXG4gICAgdmFyIEZyb21Qb2xhciA9IGZ1bmN0aW9uKHNyYywgZHN0LCBvcHQpe1xuXG4gICAgICAgIHZhciBzcmNQaXhlbHMgPSBzcmMuZGF0YSxcbiAgICAgICAgICAgIGRzdFBpeGVscyA9IGRzdC5kYXRhLFxuICAgICAgICAgICAgeFNpemUgPSBzcmMud2lkdGgsXG4gICAgICAgICAgICB5U2l6ZSA9IHNyYy5oZWlnaHQsXG4gICAgICAgICAgICB4TWlkID0gb3B0LnBvbGFyQ2VudGVyWCB8fCB4U2l6ZSAvIDIsXG4gICAgICAgICAgICB5TWlkID0gb3B0LnBvbGFyQ2VudGVyWSB8fCB5U2l6ZSAvIDIsXG4gICAgICAgICAgICBpLCB4LCB5LCBkeCwgZHksIHIgPSAwLCBnID0gMCwgYiA9IDAsIGEgPSAwO1xuXG5cbiAgICAgICAgLy8gRmluZCB0aGUgbGFyZ2VzdCByYWRpdXNcbiAgICAgICAgdmFyIHJhZCwgck1heCA9IE1hdGguc3FydCggeE1pZCAqIHhNaWQgKyB5TWlkICogeU1pZCApO1xuICAgICAgICB4ID0geFNpemUgLSB4TWlkO1xuICAgICAgICB5ID0geVNpemUgLSB5TWlkO1xuICAgICAgICByYWQgPSBNYXRoLnNxcnQoIHggKiB4ICsgeSAqIHkgKTtcbiAgICAgICAgck1heCA9IChyYWQgPiByTWF4KSA/IHJhZCA6IHJNYXg7XG5cbiAgICAgICAgLy8gV2UnbGwgYmUgdWlzbmcgeCBhcyB0aGUgcmFkaXVzLCBhbmQgeSBhcyB0aGUgYW5nbGUgKHRoZXRhPXQpXG4gICAgICAgIHZhciByU2l6ZSA9IHlTaXplLFxuICAgICAgICB0U2l6ZSA9IHhTaXplLFxuICAgICAgICByYWRpdXMsIHRoZXRhLFxuICAgICAgICBwaGFzZVNoaWZ0ID0gb3B0LnBvbGFyUm90YXRpb24gfHwgMDtcblxuICAgICAgICAvLyBXZSBuZWVkIHRvIGNvbnZlcnQgdG8gZGVncmVlcyBhbmQgd2UgbmVlZCB0byBtYWtlIHN1cmVcbiAgICAgICAgLy8gaXQncyBiZXR3ZWVuICgwLTM2MClcbiAgICAgICAgLy8gdmFyIGNvbnZlcnNpb24gPSB0U2l6ZS8zNjAqMTgwL01hdGguUEk7XG4gICAgICAgIC8vdmFyIGNvbnZlcnNpb24gPSB0U2l6ZS8zNjAqMTgwL01hdGguUEk7XG5cbiAgICAgICAgdmFyIHgxLCB5MTtcblxuICAgICAgICBmb3IoIHggPSAwOyB4IDwgeFNpemU7IHggKz0gMSApe1xuICAgICAgICAgICAgZm9yKCB5ID0gMDsgeSA8IHlTaXplOyB5ICs9IDEgKXtcbiAgICAgICAgICAgICAgICBkeCA9IHggLSB4TWlkO1xuICAgICAgICAgICAgICAgIGR5ID0geSAtIHlNaWQ7XG4gICAgICAgICAgICAgICAgcmFkaXVzID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KSAqIHJTaXplIC8gck1heDtcbiAgICAgICAgICAgICAgICB0aGV0YSA9IChNYXRoLmF0YW4yKGR5LCBkeCkgKiAxODAgLyBNYXRoLlBJICsgMzYwICsgcGhhc2VTaGlmdCkgJSAzNjA7XG4gICAgICAgICAgICAgICAgdGhldGEgPSB0aGV0YSAqIHRTaXplIC8gMzYwO1xuICAgICAgICAgICAgICAgIHgxID0gTWF0aC5mbG9vcih0aGV0YSk7XG4gICAgICAgICAgICAgICAgeTEgPSBNYXRoLmZsb29yKHJhZGl1cyk7XG4gICAgICAgICAgICAgICAgaSA9ICh5MSAqIHhTaXplICsgeDEpICogNDtcbiAgICAgICAgICAgICAgICByID0gc3JjUGl4ZWxzW2kgKyAwXTtcbiAgICAgICAgICAgICAgICBnID0gc3JjUGl4ZWxzW2kgKyAxXTtcbiAgICAgICAgICAgICAgICBiID0gc3JjUGl4ZWxzW2kgKyAyXTtcbiAgICAgICAgICAgICAgICBhID0gc3JjUGl4ZWxzW2kgKyAzXTtcblxuICAgICAgICAgICAgICAgIC8vIFN0b3JlIGl0XG4gICAgICAgICAgICAgICAgaSA9ICh5ICogeFNpemUgKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAwXSA9IHI7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAxXSA9IGc7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAyXSA9IGI7XG4gICAgICAgICAgICAgICAgZHN0UGl4ZWxzW2kgKyAzXSA9IGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICAvL0tvbnZhLkZpbHRlcnMuVG9Qb2xhciA9IEtvbnZhLlV0aWwuX0ZpbHRlcldyYXBEb3VibGVCdWZmZXIoVG9Qb2xhcik7XG4gICAgLy9Lb252YS5GaWx0ZXJzLkZyb21Qb2xhciA9IEtvbnZhLlV0aWwuX0ZpbHRlcldyYXBEb3VibGVCdWZmZXIoRnJvbVBvbGFyKTtcblxuICAgIC8vIGNyZWF0ZSBhIHRlbXBvcmFyeSBjYW52YXMgZm9yIHdvcmtpbmcgLSBzaGFyZWQgYmV0d2VlbiBtdWx0aXBsZSBjYWxsc1xuICAgIHZhciB0ZW1wQ2FudmFzID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG5cbiAgICAvKlxuICAgICAqIEthbGVpZG9zY29wZSBGaWx0ZXIuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQG5hbWUgS2FsZWlkb3Njb3BlXG4gICAgICogQGF1dGhvciBpcHBvNjE1XG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkZpbHRlcnNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG5vZGUuY2FjaGUoKTtcbiAgICAgKiBub2RlLmZpbHRlcnMoW0tvbnZhLkZpbHRlcnMuS2FsZWlkb3Njb3BlXSk7XG4gICAgICogbm9kZS5rYWxlaWRvc2NvcGVQb3dlcigzKTtcbiAgICAgKiBub2RlLmthbGVpZG9zY29wZUFuZ2xlKDQ1KTtcbiAgICAgKi9cbiAgICBLb252YS5GaWx0ZXJzLkthbGVpZG9zY29wZSA9IGZ1bmN0aW9uKGltYWdlRGF0YSl7XG4gICAgICAgIHZhciB4U2l6ZSA9IGltYWdlRGF0YS53aWR0aCxcbiAgICAgICAgICAgIHlTaXplID0gaW1hZ2VEYXRhLmhlaWdodDtcblxuICAgICAgICB2YXIgeCwgeSwgeG9mZiwgaSwgciwgZywgYiwgYSwgc3JjUG9zLCBkc3RQb3M7XG4gICAgICAgIHZhciBwb3dlciA9IE1hdGgucm91bmQoIHRoaXMua2FsZWlkb3Njb3BlUG93ZXIoKSApO1xuICAgICAgICB2YXIgYW5nbGUgPSBNYXRoLnJvdW5kKCB0aGlzLmthbGVpZG9zY29wZUFuZ2xlKCkgKTtcbiAgICAgICAgdmFyIG9mZnNldCA9IE1hdGguZmxvb3IoeFNpemUgKiAoYW5nbGUgJSAzNjApIC8gMzYwKTtcblxuICAgICAgICBpZiggcG93ZXIgPCAxICl7cmV0dXJuOyB9XG5cbiAgICAgICAgLy8gV29yayB3aXRoIG91ciBzaGFyZWQgYnVmZmVyIGNhbnZhc1xuICAgICAgICB0ZW1wQ2FudmFzLndpZHRoID0geFNpemU7XG4gICAgICAgIHRlbXBDYW52YXMuaGVpZ2h0ID0geVNpemU7XG4gICAgICAgIHZhciBzY3JhdGNoRGF0YSA9IHRlbXBDYW52YXMuZ2V0Q29udGV4dCgnMmQnKS5nZXRJbWFnZURhdGEoMCwgMCwgeFNpemUsIHlTaXplKTtcblxuICAgICAgICAvLyBDb252ZXJ0IHRoaGUgb3JpZ2luYWwgdG8gcG9sYXIgY29vcmRpbmF0ZXNcbiAgICAgICAgVG9Qb2xhciggaW1hZ2VEYXRhLCBzY3JhdGNoRGF0YSwge1xuICAgICAgICAgICAgcG9sYXJDZW50ZXJYOiB4U2l6ZSAvIDIsXG4gICAgICAgICAgICBwb2xhckNlbnRlclk6IHlTaXplIC8gMlxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEZXRlcm1pbmUgaG93IGJpZyBlYWNoIHNlY3Rpb24gd2lsbCBiZSwgaWYgaXQncyB0b28gc21hbGxcbiAgICAgICAgLy8gbWFrZSBpdCBiaWdnZXJcbiAgICAgICAgdmFyIG1pblNlY3Rpb25TaXplID0geFNpemUgLyBNYXRoLnBvdygyLCBwb3dlcik7XG4gICAgICAgIHdoaWxlKCBtaW5TZWN0aW9uU2l6ZSA8PSA4KXtcbiAgICAgICAgICAgIG1pblNlY3Rpb25TaXplID0gbWluU2VjdGlvblNpemUgKiAyO1xuICAgICAgICAgICAgcG93ZXIgLT0gMTtcbiAgICAgICAgfVxuICAgICAgICBtaW5TZWN0aW9uU2l6ZSA9IE1hdGguY2VpbChtaW5TZWN0aW9uU2l6ZSk7XG4gICAgICAgIHZhciBzZWN0aW9uU2l6ZSA9IG1pblNlY3Rpb25TaXplO1xuXG4gICAgICAgIC8vIENvcHkgdGhlIG9mZnNldCByZWdpb24gdG8gMFxuICAgICAgICAvLyBEZXBlbmRpbmcgb24gdGhlIHNpemUgb2YgZmlsdGVyIGFuZCBsb2NhdGlvbiBvZiB0aGUgb2Zmc2V0IHdlIG1heSBuZWVkXG4gICAgICAgIC8vIHRvIGNvcHkgdGhlIHNlY3Rpb24gYmFja3dhcmRzIHRvIHByZXZlbnQgaXQgZnJvbSByZXdyaXRpbmcgaXRzZWxmXG4gICAgICAgIHZhciB4U3RhcnQgPSAwLFxuICAgICAgICAgIHhFbmQgPSBzZWN0aW9uU2l6ZSxcbiAgICAgICAgICB4RGVsdGEgPSAxO1xuICAgICAgICBpZiggb2Zmc2V0ICsgbWluU2VjdGlvblNpemUgPiB4U2l6ZSApe1xuICAgICAgICAgICAgeFN0YXJ0ID0gc2VjdGlvblNpemU7XG4gICAgICAgICAgICB4RW5kID0gMDtcbiAgICAgICAgICAgIHhEZWx0YSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIGZvciggeSA9IDA7IHkgPCB5U2l6ZTsgeSArPSAxICl7XG4gICAgICAgICAgICBmb3IoIHggPSB4U3RhcnQ7IHggIT09IHhFbmQ7IHggKz0geERlbHRhICl7XG4gICAgICAgICAgICAgICAgeG9mZiA9IE1hdGgucm91bmQoeCArIG9mZnNldCkgJSB4U2l6ZTtcbiAgICAgICAgICAgICAgICBzcmNQb3MgPSAoeFNpemUgKiB5ICsgeG9mZikgKiA0O1xuICAgICAgICAgICAgICAgIHIgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDBdO1xuICAgICAgICAgICAgICAgIGcgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDFdO1xuICAgICAgICAgICAgICAgIGIgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDJdO1xuICAgICAgICAgICAgICAgIGEgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDNdO1xuICAgICAgICAgICAgICAgIGRzdFBvcyA9ICh4U2l6ZSAqIHkgKyB4KSAqIDQ7XG4gICAgICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAwXSA9IHI7XG4gICAgICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAxXSA9IGc7XG4gICAgICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAyXSA9IGI7XG4gICAgICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAzXSA9IGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQZXJmb3JtIHRoZSBhY3R1YWwgZWZmZWN0XG4gICAgICAgIGZvciggeSA9IDA7IHkgPCB5U2l6ZTsgeSArPSAxICl7XG4gICAgICAgICAgICBzZWN0aW9uU2l6ZSA9IE1hdGguZmxvb3IoIG1pblNlY3Rpb25TaXplICk7XG4gICAgICAgICAgICBmb3IoIGkgPSAwOyBpIDwgcG93ZXI7IGkgKz0gMSApe1xuICAgICAgICAgICAgICAgIGZvciggeCA9IDA7IHggPCBzZWN0aW9uU2l6ZSArIDE7IHggKz0gMSApe1xuICAgICAgICAgICAgICAgICAgICBzcmNQb3MgPSAoeFNpemUgKiB5ICsgeCkgKiA0O1xuICAgICAgICAgICAgICAgICAgICByID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAwXTtcbiAgICAgICAgICAgICAgICAgICAgZyA9IHNjcmF0Y2hEYXRhLmRhdGFbc3JjUG9zICsgMV07XG4gICAgICAgICAgICAgICAgICAgIGIgPSBzY3JhdGNoRGF0YS5kYXRhW3NyY1BvcyArIDJdO1xuICAgICAgICAgICAgICAgICAgICBhID0gc2NyYXRjaERhdGEuZGF0YVtzcmNQb3MgKyAzXTtcbiAgICAgICAgICAgICAgICAgICAgZHN0UG9zID0gKHhTaXplICogeSArIHNlY3Rpb25TaXplICogMiAtIHggLSAxKSAqIDQ7XG4gICAgICAgICAgICAgICAgICAgIHNjcmF0Y2hEYXRhLmRhdGFbZHN0UG9zICsgMF0gPSByO1xuICAgICAgICAgICAgICAgICAgICBzY3JhdGNoRGF0YS5kYXRhW2RzdFBvcyArIDFdID0gZztcbiAgICAgICAgICAgICAgICAgICAgc2NyYXRjaERhdGEuZGF0YVtkc3RQb3MgKyAyXSA9IGI7XG4gICAgICAgICAgICAgICAgICAgIHNjcmF0Y2hEYXRhLmRhdGFbZHN0UG9zICsgM10gPSBhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWN0aW9uU2l6ZSAqPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udmVydCBiYWNrIGZyb20gcG9sYXIgY29vcmRpbmF0ZXNcbiAgICAgICAgRnJvbVBvbGFyKHNjcmF0Y2hEYXRhLCBpbWFnZURhdGEsIHtwb2xhclJvdGF0aW9uOiAwfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICogZ2V0L3NldCBrYWxlaWRvc2NvcGUgcG93ZXIuIFVzZSB3aXRoIHtAbGluayBLb252YS5GaWx0ZXJzLkthbGVpZG9zY29wZX0gZmlsdGVyLlxuICAgICogQG5hbWUga2FsZWlkb3Njb3BlUG93ZXJcbiAgICAqIEBtZXRob2RcbiAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICogQHBhcmFtIHtJbnRlZ2VyfSBwb3dlciBvZiBrYWxlaWRvc2NvcGVcbiAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICovXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTm9kZSwgJ2thbGVpZG9zY29wZVBvd2VyJywgMiwgbnVsbCwgS29udmEuRmFjdG9yeS5hZnRlclNldEZpbHRlcik7XG5cbiAgICAvKipcbiAgICAqIGdldC9zZXQga2FsZWlkb3Njb3BlIGFuZ2xlLiBVc2Ugd2l0aCB7QGxpbmsgS29udmEuRmlsdGVycy5LYWxlaWRvc2NvcGV9IGZpbHRlci5cbiAgICAqIEBuYW1lIGthbGVpZG9zY29wZUFuZ2xlXG4gICAgKiBAbWV0aG9kXG4gICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7SW50ZWdlcn0gZGVncmVlc1xuICAgICogQHJldHVybnMge0ludGVnZXJ9XG4gICAgKi9cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAna2FsZWlkb3Njb3BlQW5nbGUnLCAwLCBudWxsLCBLb252YS5GYWN0b3J5LmFmdGVyU2V0RmlsdGVyKTtcblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBDb250YWluZXIgY29uc3RydWN0b3IuJm5ic3A7IENvbnRhaW5lcnMgYXJlIHVzZWQgdG8gY29udGFpbiBub2RlcyBvciBvdGhlciBjb250YWluZXJzXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLk5vZGVcbiAgICAgKiBAYWJzdHJhY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmNsaXBdIHNldCBjbGlwXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY2xpcFhdIHNldCBjbGlwIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwWV0gc2V0IGNsaXAgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBXaWR0aF0gc2V0IGNsaXAgd2lkdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwSGVpZ2h0XSBzZXQgY2xpcCBoZWlnaHRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmNsaXBGdW5jXSBzZXQgY2xpcCBmdW5jXG5cbiAgICAgKi9cbiAgICBLb252YS5Db250YWluZXIgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuVXRpbC5hZGRNZXRob2RzKEtvbnZhLkNvbnRhaW5lciwge1xuICAgICAgICBfX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG5ldyBLb252YS5Db2xsZWN0aW9uKCk7XG4gICAgICAgICAgICBLb252YS5Ob2RlLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgYSB7QGxpbmsgS29udmEuQ29sbGVjdGlvbn0gb2YgZGlyZWN0IGRlc2NlbmRhbnQgbm9kZXNcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZmlsdGVyRnVuY10gZmlsdGVyIGZ1bmN0aW9uXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Db2xsZWN0aW9ufVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiAvLyBnZXQgYWxsIGNoaWxkcmVuXG4gICAgICAgICAqIHZhciBjaGlsZHJlbiA9IGxheWVyLmdldENoaWxkcmVuKCk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIGdldCBvbmx5IGNpcmNsZXNcbiAgICAgICAgICogdmFyIGNpcmNsZXMgPSBsYXllci5nZXRDaGlsZHJlbihmdW5jdGlvbihub2RlKXtcbiAgICAgICAgICogICAgcmV0dXJuIG5vZGUuZ2V0Q2xhc3NOYW1lKCkgPT09ICdDaXJjbGUnO1xuICAgICAgICAgKiB9KTtcbiAgICAgICAgICovXG4gICAgICAgIGdldENoaWxkcmVuOiBmdW5jdGlvbihmaWx0ZXJGdW5jKSB7XG4gICAgICAgICAgICBpZiAoIWZpbHRlckZ1bmMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBuZXcgS29udmEuQ29sbGVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGNoaWxkKXtcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyRnVuYyhjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGNoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGV0ZXJtaW5lIGlmIG5vZGUgaGFzIGNoaWxkcmVuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBoYXNDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZHJlbigpLmxlbmd0aCA+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZW1vdmUgYWxsIGNoaWxkcmVuXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIHJlbW92ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZHJlbiA9IEtvbnZhLkNvbGxlY3Rpb24udG9Db2xsZWN0aW9uKHRoaXMuY2hpbGRyZW4pO1xuICAgICAgICAgICAgdmFyIGNoaWxkO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgcGFyZW50IHRvIHByZXZlbnQgbWFueSBfc2V0Q2hpbGRyZW5JbmRpY2VzIGNhbGxzXG4gICAgICAgICAgICAgICAgZGVsZXRlIGNoaWxkLnBhcmVudDtcbiAgICAgICAgICAgICAgICBjaGlsZC5pbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgY2hpbGQucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZHJlbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gbmV3IEtvbnZhLkNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGVzdHJveSBhbGwgY2hpbGRyZW5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZGVzdHJveUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gS29udmEuQ29sbGVjdGlvbi50b0NvbGxlY3Rpb24odGhpcy5jaGlsZHJlbik7XG4gICAgICAgICAgICB2YXIgY2hpbGQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgICAgICAgICAvLyByZXNldCBwYXJlbnQgdG8gcHJldmVudCBtYW55IF9zZXRDaGlsZHJlbkluZGljZXMgY2FsbHNcbiAgICAgICAgICAgICAgICBkZWxldGUgY2hpbGQucGFyZW50O1xuICAgICAgICAgICAgICAgIGNoaWxkLmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBjaGlsZC5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZHJlbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gbmV3IEtvbnZhLkNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIG5vZGUgb3Igbm9kZXMgdG8gY29udGFpbmVyLlxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250YWluZXIucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7Li4uS29udmEuTm9kZX0gY2hpbGRcbiAgICAgICAgICogQHJldHVybnMge0NvbnRhaW5lcn1cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogbGF5ZXIuYWRkKHNoYXBlMSwgc2hhcGUyLCBzaGFwZTMpO1xuICAgICAgICAgKi9cbiAgICAgICAgYWRkOiBmdW5jdGlvbihjaGlsZCkge1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGQoYXJndW1lbnRzW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hpbGQuZ2V0UGFyZW50KCkpIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5tb3ZlVG8odGhpcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGVBZGQoY2hpbGQpO1xuICAgICAgICAgICAgY2hpbGQuaW5kZXggPSBjaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQgPSB0aGlzO1xuICAgICAgICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgICAgICAgICB0aGlzLl9maXJlKCdhZGQnLCB7XG4gICAgICAgICAgICAgICAgY2hpbGQ6IGNoaWxkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gaWYgbm9kZSB1bmRlciBkcmFnIHdlIG5lZWQgdG8gdXBkYXRlIGRyYWcgYW5pbWF0aW9uXG4gICAgICAgICAgICBpZiAoS29udmEuREQgJiYgY2hpbGQuaXNEcmFnZ2luZygpKSB7XG4gICAgICAgICAgICAgICAgS29udmEuREQuYW5pbS5zZXRMYXllcnMoY2hpbGQuZ2V0TGF5ZXIoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNoYWluYWJsZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gZGVzdHJveSBjaGlsZHJlblxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveUNoaWxkcmVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0aGVuIGRlc3Ryb3kgc2VsZlxuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gYSB7QGxpbmsgS29udmEuQ29sbGVjdGlvbn0gb2Ygbm9kZXMgdGhhdCBtYXRjaCB0aGUgc2VsZWN0b3IuICBVc2UgJyMnIGZvciBpZCBzZWxlY3Rpb25zXG4gICAgICAgICAqIGFuZCAnLicgZm9yIG5hbWUgc2VsZWN0aW9ucy4gIFlvdSBjYW4gYWxzbyBzZWxlY3QgYnkgdHlwZSBvciBjbGFzcyBuYW1lLiBQYXNzIG11bHRpcGxlIHNlbGVjdG9yc1xuICAgICAgICAgKiBzZXBhcmF0ZWQgYnkgYSBzcGFjZS5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VsZWN0b3JcbiAgICAgICAgICogQHJldHVybnMge0NvbGxlY3Rpb259XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIC8vIHNlbGVjdCBub2RlIHdpdGggaWQgZm9vXG4gICAgICAgICAqIHZhciBub2RlID0gc3RhZ2UuZmluZCgnI2ZvbycpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBzZWxlY3Qgbm9kZXMgd2l0aCBuYW1lIGJhciBpbnNpZGUgbGF5ZXJcbiAgICAgICAgICogdmFyIG5vZGVzID0gbGF5ZXIuZmluZCgnLmJhcicpO1xuICAgICAgICAgKlxuICAgICAgICAgKiAvLyBzZWxlY3QgYWxsIGdyb3VwcyBpbnNpZGUgbGF5ZXJcbiAgICAgICAgICogdmFyIG5vZGVzID0gbGF5ZXIuZmluZCgnR3JvdXAnKTtcbiAgICAgICAgICpcbiAgICAgICAgICogLy8gc2VsZWN0IGFsbCByZWN0YW5nbGVzIGluc2lkZSBsYXllclxuICAgICAgICAgKiB2YXIgbm9kZXMgPSBsYXllci5maW5kKCdSZWN0Jyk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIHNlbGVjdCBub2RlIHdpdGggYW4gaWQgb2YgZm9vIG9yIGEgbmFtZSBvZiBiYXIgaW5zaWRlIGxheWVyXG4gICAgICAgICAqIHZhciBub2RlcyA9IGxheWVyLmZpbmQoJyNmb28sIC5iYXInKTtcbiAgICAgICAgICovXG4gICAgICAgIGZpbmQ6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICB2YXIgcmV0QXJyID0gW10sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JBcnIgPSBzZWxlY3Rvci5yZXBsYWNlKC8gL2csICcnKS5zcGxpdCgnLCcpLFxuICAgICAgICAgICAgICAgIGxlbiA9IHNlbGVjdG9yQXJyLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBuLCBpLCBzZWwsIGFyciwgbm9kZSwgY2hpbGRyZW4sIGNsZW47XG5cbiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIHNlbCA9IHNlbGVjdG9yQXJyW25dO1xuICAgICAgICAgICAgICAgIGlmICghS29udmEuVXRpbC5pc1ZhbGlkU2VsZWN0b3Ioc2VsKSkge1xuICAgICAgICAgICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ1NlbGVjdG9yIFwiJyArIHNlbCArICdcIiBpcyBpbnZhbGlkLiBBbGxvd2VkIHNlbGVjdG9ycyBleGFtcGxlcyBhcmUgXCIjZm9vXCIsIFwiLmJhclwiIG9yIFwiR3JvdXBcIi4nKTtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdJZiB5b3UgaGF2ZSBhIGN1c3RvbSBzaGFwZSB3aXRoIHN1Y2ggY2xhc3NOYW1lLCBwbGVhc2UgY2hhbmdlIGl0IHRvIHN0YXJ0IHdpdGggdXBwZXIgbGV0dGVyIGxpa2UgXCJUcmlhbmdsZVwiLicpO1xuICAgICAgICAgICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ0tvbnZhIGlzIGF3ZXNvbWUsIHJpZ2h0PycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpZCBzZWxlY3RvclxuICAgICAgICAgICAgICAgIGlmKHNlbC5jaGFyQXQoMCkgPT09ICcjJykge1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gdGhpcy5fZ2V0Tm9kZUJ5SWQoc2VsLnNsaWNlKDEpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0QXJyLnB1c2gobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gbmFtZSBzZWxlY3RvclxuICAgICAgICAgICAgICAgIGVsc2UgaWYoc2VsLmNoYXJBdCgwKSA9PT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyciA9IHRoaXMuX2dldE5vZGVzQnlOYW1lKHNlbC5zbGljZSgxKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldEFyciA9IHJldEFyci5jb25jYXQoYXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gdW5yZWNvZ25pemVkIHNlbGVjdG9yLCBwYXNzIHRvIGNoaWxkcmVuXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gdGhpcy5nZXRDaGlsZHJlbigpO1xuICAgICAgICAgICAgICAgICAgICBjbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBjbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldEFyciA9IHJldEFyci5jb25jYXQoY2hpbGRyZW5baV0uX2dldChzZWwpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIEtvbnZhLkNvbGxlY3Rpb24udG9Db2xsZWN0aW9uKHJldEFycik7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gYSBmaXJzdCBub2RlIGZyb20gYGZpbmRgIG1ldGhvZFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250YWluZXIucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvclxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuTm9kZX1cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogLy8gc2VsZWN0IG5vZGUgd2l0aCBpZCBmb29cbiAgICAgICAgICogdmFyIG5vZGUgPSBzdGFnZS5maW5kT25lKCcjZm9vJyk7XG4gICAgICAgICAqXG4gICAgICAgICAqIC8vIHNlbGVjdCBub2RlIHdpdGggbmFtZSBiYXIgaW5zaWRlIGxheWVyXG4gICAgICAgICAqIHZhciBub2RlcyA9IGxheWVyLmZpbmRPbmUoJy5iYXInKTtcbiAgICAgICAgICovXG4gICAgICAgIGZpbmRPbmU6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kKHNlbGVjdG9yKVswXTtcbiAgICAgICAgfSxcbiAgICAgICAgX2dldE5vZGVCeUlkOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gS29udmEuaWRzW2tleV07XG5cbiAgICAgICAgICAgIGlmKG5vZGUgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmlzQW5jZXN0b3JPZihub2RlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXROb2Rlc0J5TmFtZTogZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICB2YXIgYXJyID0gS29udmEubmFtZXNba2V5XSB8fCBbXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXREZXNjZW5kYW50cyhhcnIpO1xuICAgICAgICB9LFxuICAgICAgICBfZ2V0OiBmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAgICAgICAgdmFyIHJldEFyciA9IEtvbnZhLk5vZGUucHJvdG90eXBlLl9nZXQuY2FsbCh0aGlzLCBzZWxlY3Rvcik7XG4gICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKCk7XG4gICAgICAgICAgICB2YXIgbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yKHZhciBuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgcmV0QXJyID0gcmV0QXJyLmNvbmNhdChjaGlsZHJlbltuXS5fZ2V0KHNlbGVjdG9yKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0QXJyO1xuICAgICAgICB9LFxuICAgICAgICAvLyBleHRlbmRlcnNcbiAgICAgICAgdG9PYmplY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG9iaiA9IEtvbnZhLk5vZGUucHJvdG90eXBlLnRvT2JqZWN0LmNhbGwodGhpcyk7XG5cbiAgICAgICAgICAgIG9iai5jaGlsZHJlbiA9IFtdO1xuXG4gICAgICAgICAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmdldENoaWxkcmVuKCk7XG4gICAgICAgICAgICB2YXIgbGVuID0gY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yKHZhciBuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5bbl07XG4gICAgICAgICAgICAgICAgb2JqLmNoaWxkcmVuLnB1c2goY2hpbGQudG9PYmplY3QoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXREZXNjZW5kYW50czogZnVuY3Rpb24oYXJyKSB7XG4gICAgICAgICAgICB2YXIgcmV0QXJyID0gW107XG4gICAgICAgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aDtcbiAgICAgICAgICAgIGZvcih2YXIgbiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gYXJyW25dO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuaXNBbmNlc3Rvck9mKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldEFyci5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJldEFycjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZSBpZiBub2RlIGlzIGFuIGFuY2VzdG9yXG4gICAgICAgICAqIG9mIGRlc2NlbmRhbnRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge0tvbnZhLk5vZGV9IG5vZGVcbiAgICAgICAgICovXG4gICAgICAgIGlzQW5jZXN0b3JPZjogZnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IG5vZGUuZ2V0UGFyZW50KCk7XG4gICAgICAgICAgICB3aGlsZShwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBpZihwYXJlbnQuX2lkID09PSB0aGlzLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LmdldFBhcmVudCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb25lOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgbWV0aG9kXG4gICAgICAgICAgICB2YXIgbm9kZSA9IEtvbnZhLk5vZGUucHJvdG90eXBlLmNsb25lLmNhbGwodGhpcywgb2JqKTtcblxuICAgICAgICAgICAgdGhpcy5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24obm8pIHtcbiAgICAgICAgICAgICAgICBub2RlLmFkZChuby5jbG9uZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgYWxsIHNoYXBlcyB0aGF0IGludGVyc2VjdCBhIHBvaW50LiAgTm90ZTogYmVjYXVzZSB0aGlzIG1ldGhvZCBtdXN0IGNsZWFyIGEgdGVtcG9yYXJ5XG4gICAgICAgICAqIGNhbnZhcyBhbmQgcmVkcmF3IGV2ZXJ5IHNoYXBlIGluc2lkZSB0aGUgY29udGFpbmVyLCBpdCBzaG91bGQgb25seSBiZSB1c2VkIGZvciBzcGVjaWFsIHNpdGF0aW9uc1xuICAgICAgICAgKiBiZWNhdXNlIGl0IHBlcmZvcm1zIHZlcnkgcG9vcmx5LiAgUGxlYXNlIHVzZSB0aGUge0BsaW5rIEtvbnZhLlN0YWdlI2dldEludGVyc2VjdGlvbn0gbWV0aG9kIGlmIGF0IGFsbCBwb3NzaWJsZVxuICAgICAgICAgKiBiZWNhdXNlIGl0IHBlcmZvcm1zIG11Y2ggYmV0dGVyXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBvc1xuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9zLnhcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy55XG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX0gYXJyYXkgb2Ygc2hhcGVzXG4gICAgICAgICAqL1xuICAgICAgICBnZXRBbGxJbnRlcnNlY3Rpb25zOiBmdW5jdGlvbihwb3MpIHtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy5maW5kKCdTaGFwZScpLmVhY2goZnVuY3Rpb24oc2hhcGUpIHtcbiAgICAgICAgICAgICAgICBpZihzaGFwZS5pc1Zpc2libGUoKSAmJiBzaGFwZS5pbnRlcnNlY3RzKHBvcykpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goc2hhcGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICB9LFxuICAgICAgICBfc2V0Q2hpbGRyZW5JbmRpY2VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uZWFjaChmdW5jdGlvbihjaGlsZCwgbikge1xuICAgICAgICAgICAgICAgIGNoaWxkLmluZGV4ID0gbjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBkcmF3U2NlbmU6IGZ1bmN0aW9uKGNhbiwgdG9wLCBjYWNoaW5nKSB7XG4gICAgICAgICAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldExheWVyKCksXG4gICAgICAgICAgICAgICAgY2FudmFzID0gY2FuIHx8IChsYXllciAmJiBsYXllci5nZXRDYW52YXMoKSksXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcyAmJiBjYW52YXMuZ2V0Q29udGV4dCgpLFxuICAgICAgICAgICAgICAgIGNhY2hlZENhbnZhcyA9IHRoaXMuX2NhY2hlLmNhbnZhcyxcbiAgICAgICAgICAgICAgICBjYWNoZWRTY2VuZUNhbnZhcyA9IGNhY2hlZENhbnZhcyAmJiBjYWNoZWRDYW52YXMuc2NlbmU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjYWNoaW5nICYmIGNhY2hlZFNjZW5lQ2FudmFzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICBsYXllci5fYXBwbHlUcmFuc2Zvcm0odGhpcywgY29udGV4dCwgdG9wKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJhd0NhY2hlZFNjZW5lQ2FudmFzKGNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdDaGlsZHJlbihjYW52YXMsICdkcmF3U2NlbmUnLCB0b3AsIGZhbHNlLCBjYWNoaW5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgZHJhd0hpdDogZnVuY3Rpb24oY2FuLCB0b3AsIGNhY2hpbmcpIHtcbiAgICAgICAgICAgIHZhciBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSxcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW4gfHwgKGxheWVyICYmIGxheWVyLmhpdENhbnZhcyksXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcyAmJiBjYW52YXMuZ2V0Q29udGV4dCgpLFxuICAgICAgICAgICAgICAgIGNhY2hlZENhbnZhcyA9IHRoaXMuX2NhY2hlLmNhbnZhcyxcbiAgICAgICAgICAgICAgICBjYWNoZWRIaXRDYW52YXMgPSBjYWNoZWRDYW52YXMgJiYgY2FjaGVkQ2FudmFzLmhpdDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkRHJhd0hpdChjYW52YXMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxheWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyLmNsZWFySGl0Q2FjaGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjYWNoaW5nICYmIGNhY2hlZEhpdENhbnZhcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuX2FwcGx5VHJhbnNmb3JtKHRoaXMsIGNvbnRleHQsIHRvcCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdDYWNoZWRIaXRDYW52YXMoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJhd0NoaWxkcmVuKGNhbnZhcywgJ2RyYXdIaXQnLCB0b3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBfZHJhd0NoaWxkcmVuOiBmdW5jdGlvbihjYW52YXMsIGRyYXdNZXRob2QsIHRvcCwgY2FjaGluZywgc2tpcEJ1ZmZlcikge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gdGhpcy5nZXRMYXllcigpLFxuICAgICAgICAgICAgICAgIGNvbnRleHQgPSBjYW52YXMgJiYgY2FudmFzLmdldENvbnRleHQoKSxcbiAgICAgICAgICAgICAgICBjbGlwV2lkdGggPSB0aGlzLmdldENsaXBXaWR0aCgpLFxuICAgICAgICAgICAgICAgIGNsaXBIZWlnaHQgPSB0aGlzLmdldENsaXBIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBjbGlwRnVuYyA9IHRoaXMuZ2V0Q2xpcEZ1bmMoKSxcbiAgICAgICAgICAgICAgICBoYXNDbGlwID0gY2xpcFdpZHRoICYmIGNsaXBIZWlnaHQgfHwgY2xpcEZ1bmMsXG4gICAgICAgICAgICAgICAgY2xpcFgsIGNsaXBZO1xuXG4gICAgICAgICAgICBpZiAoaGFzQ2xpcCAmJiBsYXllcikge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGxheWVyLl9hcHBseVRyYW5zZm9ybSh0aGlzLCBjb250ZXh0KTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIGlmIChjbGlwRnVuYykge1xuICAgICAgICAgICAgICAgICAgY2xpcEZ1bmMuY2FsbCh0aGlzLCBjb250ZXh0LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY2xpcFggPSB0aGlzLmdldENsaXBYKCk7XG4gICAgICAgICAgICAgICAgICBjbGlwWSA9IHRoaXMuZ2V0Q2xpcFkoKTtcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdChjbGlwWCwgY2xpcFksIGNsaXBXaWR0aCwgY2xpcEhlaWdodCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xpcCgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzZXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5lYWNoKGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgY2hpbGRbZHJhd01ldGhvZF0oY2FudmFzLCB0b3AsIGNhY2hpbmcsIHNraXBCdWZmZXIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChoYXNDbGlwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNob3VsZERyYXdIaXQ6IGZ1bmN0aW9uKGNhbnZhcykge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gdGhpcy5nZXRMYXllcigpO1xuICAgICAgICAgICAgdmFyIGRkID0gS29udmEuREQ7XG4gICAgICAgICAgICB2YXIgbGF5ZXJVbmRlckRyYWcgPSBkZCAmJiBLb252YS5pc0RyYWdnaW5nKCkgJiYgKEtvbnZhLkRELmFuaW0uZ2V0TGF5ZXJzKCkuaW5kZXhPZihsYXllcikgIT09IC0xKTtcbiAgICAgICAgICAgIHJldHVybiAoY2FudmFzICYmIGNhbnZhcy5pc0NhY2hlKSB8fCAobGF5ZXIgJiYgbGF5ZXIuaGl0R3JhcGhFbmFibGVkKCkpXG4gICAgICAgICAgICAgICAgJiYgdGhpcy5pc1Zpc2libGUoKSAmJiAhbGF5ZXJVbmRlckRyYWc7XG4gICAgICAgIH0sXG4gICAgICAgIGdldENsaWVudFJlY3Q6IGZ1bmN0aW9uKHNraXBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHZhciBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZO1xuICAgICAgICAgICAgdmFyIHNlbGZSZWN0ID0ge1xuICAgICAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICAgICAgeTogMCxcbiAgICAgICAgICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmVhY2goZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGNoaWxkLmdldENsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgICAgIC8vIHNraXAgaW52aXNpYmxlIGNoaWxkcmVuIChsaWtlIGVtcHR5IGdyb3VwcylcbiAgICAgICAgICAgICAgICAvLyBvciBkb24ndCBza2lwLi4uIGhtbW0uLi5cbiAgICAgICAgICAgICAgICAvLyBpZiAocmVjdC53aWR0aCA9PT0gMCAmJiByZWN0LmhlaWdodCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgaWYgKG1pblggPT09IHVuZGVmaW5lZCkgeyAvLyBpbml0aWFsIHZhbHVlIGZvciBmaXJzdCBjaGlsZFxuICAgICAgICAgICAgICAgICAgICBtaW5YID0gcmVjdC54O1xuICAgICAgICAgICAgICAgICAgICBtaW5ZID0gcmVjdC55O1xuICAgICAgICAgICAgICAgICAgICBtYXhYID0gcmVjdC54ICsgcmVjdC53aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgbWF4WSA9IHJlY3QueSArIHJlY3QuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCByZWN0LngpO1xuICAgICAgICAgICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgcmVjdC55KTtcbiAgICAgICAgICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHJlY3QueCArIHJlY3Qud2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgcmVjdC55ICsgcmVjdC5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHNlbGZSZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICB4OiBtaW5YLFxuICAgICAgICAgICAgICAgICAgICB5OiBtaW5ZLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogbWF4WCAtIG1pblgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogbWF4WSAtIG1pbllcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXNraXBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNmb3JtZWRSZWN0KHNlbGZSZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzZWxmUmVjdDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuQ29udGFpbmVyLCBLb252YS5Ob2RlKTtcbiAgICAvLyBkZXByZWNhdGVkIG1ldGhvZHNcbiAgICBLb252YS5Db250YWluZXIucHJvdG90eXBlLmdldCA9IEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGUuZmluZDtcblxuICAgIC8vIGFkZCBnZXR0ZXJzIHNldHRlcnNcbiAgICBLb252YS5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoS29udmEuQ29udGFpbmVyLCAnY2xpcCcsIFsneCcsICd5JywgJ3dpZHRoJywgJ2hlaWdodCddKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNsaXBcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG5hbWUgY2xpcFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250YWluZXIucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNsaXBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY2xpcC54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNsaXAueVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjbGlwLndpZHRoXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNsaXAuaGVpZ2h0XG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBjbGlwXG4gICAgICogdmFyIGNsaXAgPSBjb250YWluZXIuY2xpcCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGNsaXBcbiAgICAgKiBjb250YWluZXIuc2V0Q2xpcCh7XG4gICAgICogICB4OiAyMCxcbiAgICAgKiAgIHk6IDIwLFxuICAgICAqICAgd2lkdGg6IDIwLFxuICAgICAqICAgaGVpZ2h0OiAyMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuQ29udGFpbmVyLCAnY2xpcFgnKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNsaXAgeFxuICAgICAqIEBuYW1lIGNsaXBYXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Db250YWluZXIucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNsaXAgeFxuICAgICAqIHZhciBjbGlwWCA9IGNvbnRhaW5lci5jbGlwWCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGNsaXAgeFxuICAgICAqIGNvbnRhaW5lci5jbGlwWCgxMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Db250YWluZXIsICdjbGlwWScpO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY2xpcCB5XG4gICAgICogQG5hbWUgY2xpcFlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgY2xpcCB5XG4gICAgICogdmFyIGNsaXBZID0gY29udGFpbmVyLmNsaXBZKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgY2xpcCB5XG4gICAgICogY29udGFpbmVyLmNsaXBZKDEwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLkNvbnRhaW5lciwgJ2NsaXBXaWR0aCcpO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY2xpcCB3aWR0aFxuICAgICAqIEBuYW1lIGNsaXBXaWR0aFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgY2xpcCB3aWR0aFxuICAgICAqIHZhciBjbGlwV2lkdGggPSBjb250YWluZXIuY2xpcFdpZHRoKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgY2xpcCB3aWR0aFxuICAgICAqIGNvbnRhaW5lci5jbGlwV2lkdGgoMTAwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLkNvbnRhaW5lciwgJ2NsaXBIZWlnaHQnKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNsaXAgaGVpZ2h0XG4gICAgICogQG5hbWUgY2xpcEhlaWdodFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBoZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNsaXAgaGVpZ2h0XG4gICAgICogdmFyIGNsaXBIZWlnaHQgPSBjb250YWluZXIuY2xpcEhlaWdodCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGNsaXAgaGVpZ2h0XG4gICAgICogY29udGFpbmVyLmNsaXBIZWlnaHQoMTAwKTtcbiAgICAgKi9cblxuICAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Db250YWluZXIsICdjbGlwRnVuYycpO1xuICAgICAvKipcbiAgICAgICogZ2V0L3NldCBjbGlwIGZ1bmN0aW9uXG4gICAgICAqIEBuYW1lIGNsaXBGdW5jXG4gICAgICAqIEBtZXRob2RcbiAgICAgICogQG1lbWJlcm9mIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGVcbiAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY3Rpb25cbiAgICAgICogQHJldHVybnMge0Z1bmN0aW9ufVxuICAgICAgKiBAZXhhbXBsZVxuICAgICAgKiAvLyBnZXQgY2xpcCBmdW5jdGlvblxuICAgICAgKiB2YXIgY2xpcEZ1bmN0aW9uID0gY29udGFpbmVyLmNsaXBGdW5jKCk7XG4gICAgICAqXG4gICAgICAqIC8vIHNldCBjbGlwIGhlaWdodFxuICAgICAgKiBjb250YWluZXIuY2xpcEZ1bmMoZnVuY3Rpb24oY3R4KSB7XG4gICAgICAqICAgY3R4LnJlY3QoMCwgMCwgMTAwLCAxMDApO1xuICAgICAgKiB9KTtcbiAgICAgICovXG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuQ29udGFpbmVyKTtcbn0pKCk7XG5cbihmdW5jdGlvbihLb252YSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgSEFTX1NIQURPVyA9ICdoYXNTaGFkb3cnO1xuICAgIHZhciBTSEFET1dfUkdCQSA9ICdzaGFkb3dSR0JBJztcblxuICAgIGZ1bmN0aW9uIF9maWxsRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfc3Ryb2tlRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9maWxsRnVuY0hpdChjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfc3Ryb2tlRnVuY0hpdChjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2NsZWFySGFzU2hhZG93Q2FjaGUoKSB7XG4gICAgICAgIHRoaXMuX2NsZWFyQ2FjaGUoSEFTX1NIQURPVyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2NsZWFyR2V0U2hhZG93UkdCQUNhY2hlKCkge1xuICAgICAgICB0aGlzLl9jbGVhckNhY2hlKFNIQURPV19SR0JBKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaGFwZSBjb25zdHJ1Y3Rvci4gIFNoYXBlcyBhcmUgcHJpbWl0aXZlIG9iamVjdHMgc3VjaCBhcyByZWN0YW5nbGVzLFxuICAgICAqICBjaXJjbGVzLCB0ZXh0LCBsaW5lcywgZXRjLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBhdWdtZW50cyBLb252YS5Ob2RlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgY3VzdG9tU2hhcGUgPSBuZXcgS29udmEuU2hhcGUoe1xuICAgICAgICAgKiAgIHg6IDUsXG4gICAgICAgICAqICAgeTogMTAsXG4gICAgICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICAgICAqICAgLy8gYSBLb252YS5DYW52YXMgcmVuZGVyZXIgaXMgcGFzc2VkIGludG8gdGhlIGRyYXdGdW5jIGZ1bmN0aW9uXG4gICAgICAgICAqICAgZHJhd0Z1bmM6IGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgICAgICAgICogICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAqICAgICBjb250ZXh0Lm1vdmVUbygyMDAsIDUwKTtcbiAgICAgICAgICogICAgIGNvbnRleHQubGluZVRvKDQyMCwgODApO1xuICAgICAgICAgKiAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKDMwMCwgMTAwLCAyNjAsIDE3MCk7XG4gICAgICAgICAqICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgKiAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgICAqICAgfVxuICAgICAgICAgKn0pO1xuICAgICAqL1xuICAgIEtvbnZhLlNoYXBlID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlV0aWwuYWRkTWV0aG9kcyhLb252YS5TaGFwZSwge1xuICAgICAgICBfX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5ub2RlVHlwZSA9ICdTaGFwZSc7XG4gICAgICAgICAgICB0aGlzLl9maWxsRnVuYyA9IF9maWxsRnVuYztcbiAgICAgICAgICAgIHRoaXMuX3N0cm9rZUZ1bmMgPSBfc3Ryb2tlRnVuYztcbiAgICAgICAgICAgIHRoaXMuX2ZpbGxGdW5jSGl0ID0gX2ZpbGxGdW5jSGl0O1xuICAgICAgICAgICAgdGhpcy5fc3Ryb2tlRnVuY0hpdCA9IF9zdHJva2VGdW5jSGl0O1xuXG4gICAgICAgICAgICAvLyBzZXQgY29sb3JLZXlcbiAgICAgICAgICAgIHZhciBzaGFwZXMgPSBLb252YS5zaGFwZXM7XG4gICAgICAgICAgICB2YXIga2V5O1xuXG4gICAgICAgICAgICB3aGlsZSh0cnVlKSB7XG4gICAgICAgICAgICAgICAga2V5ID0gS29udmEuVXRpbC5nZXRSYW5kb21Db2xvcigpO1xuICAgICAgICAgICAgICAgIGlmKGtleSAmJiAhKCBrZXkgaW4gc2hhcGVzKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY29sb3JLZXkgPSBrZXk7XG4gICAgICAgICAgICBzaGFwZXNba2V5XSA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgY29uc3RydWN0b3JcbiAgICAgICAgICAgIEtvbnZhLk5vZGUuY2FsbCh0aGlzLCBjb25maWcpO1xuXG4gICAgICAgICAgICB0aGlzLm9uKCdzaGFkb3dDb2xvckNoYW5nZS5rb252YSBzaGFkb3dCbHVyQ2hhbmdlLmtvbnZhIHNoYWRvd09mZnNldENoYW5nZS5rb252YSBzaGFkb3dPcGFjaXR5Q2hhbmdlLmtvbnZhIHNoYWRvd0VuYWJsZWRDaGFuZ2Uua29udmEnLCBfY2xlYXJIYXNTaGFkb3dDYWNoZSk7XG5cbiAgICAgICAgICAgIHRoaXMub24oJ3NoYWRvd0NvbG9yQ2hhbmdlLmtvbnZhIHNoYWRvd09wYWNpdHlDaGFuZ2Uua29udmEgc2hhZG93RW5hYmxlZENoYW5nZS5rb252YScsIF9jbGVhckdldFNoYWRvd1JHQkFDYWNoZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhc0NoaWxkcmVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0Q2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGNhbnZhcyBjb250ZXh0IHRpZWQgdG8gdGhlIGxheWVyXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7S29udmEuQ29udGV4dH1cbiAgICAgICAgICovXG4gICAgICAgIGdldENvbnRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGF5ZXIoKS5nZXRDb250ZXh0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgY2FudmFzIHJlbmRlcmVyIHRpZWQgdG8gdGhlIGxheWVyLiAgTm90ZSB0aGF0IHRoaXMgcmV0dXJucyBhIGNhbnZhcyByZW5kZXJlciwgbm90IGEgY2FudmFzIGVsZW1lbnRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5DYW52YXN9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRDYW52YXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGF5ZXIoKS5nZXRDYW52YXMoKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybnMgd2hldGhlciBvciBub3QgYSBzaGFkb3cgd2lsbCBiZSByZW5kZXJlZFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBoYXNTaGFkb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhY2hlKEhBU19TSEFET1csIHRoaXMuX2hhc1NoYWRvdyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9oYXNTaGFkb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2hhZG93RW5hYmxlZCgpICYmICh0aGlzLmdldFNoYWRvd09wYWNpdHkoKSAhPT0gMCAmJiAhISh0aGlzLmdldFNoYWRvd0NvbG9yKCkgfHwgdGhpcy5nZXRTaGFkb3dCbHVyKCkgfHwgdGhpcy5nZXRTaGFkb3dPZmZzZXRYKCkgfHwgdGhpcy5nZXRTaGFkb3dPZmZzZXRZKCkpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0U2hhZG93UkdCQTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FjaGUoU0hBRE9XX1JHQkEsIHRoaXMuX2dldFNoYWRvd1JHQkEpO1xuICAgICAgICB9LFxuICAgICAgICBfZ2V0U2hhZG93UkdCQTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5oYXNTaGFkb3coKSkge1xuICAgICAgICAgICAgICAgIHZhciByZ2JhID0gS29udmEuVXRpbC5jb2xvclRvUkdCQSh0aGlzLnNoYWRvd0NvbG9yKCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiAncmdiYSgnICsgcmdiYS5yICsgJywnICsgcmdiYS5nICsgJywnICsgcmdiYS5iICsgJywnICsgKHJnYmEuYSAqICh0aGlzLmdldFNoYWRvd09wYWNpdHkoKSB8fCAxKSkgKyAnKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBzaGFwZSB3aWxsIGJlIGZpbGxlZFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBoYXNGaWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhISh0aGlzLmdldEZpbGwoKSB8fCB0aGlzLmdldEZpbGxQYXR0ZXJuSW1hZ2UoKSB8fCB0aGlzLmdldEZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHMoKSB8fCB0aGlzLmdldEZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHMoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBzaGFwZSB3aWxsIGJlIHN0cm9rZWRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgaGFzU3Ryb2tlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAhISh0aGlzLnN0cm9rZSgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZXMgaWYgcG9pbnQgaXMgaW4gdGhlIHNoYXBlLCByZWdhcmRsZXNzIGlmIG90aGVyIHNoYXBlcyBhcmUgb24gdG9wIG9mIGl0LiAgTm90ZTogYmVjYXVzZVxuICAgICAgICAgKiAgdGhpcyBtZXRob2QgY2xlYXJzIGEgdGVtcG9yYXJ5IGNhbnZhcyBhbmQgdGhlbiByZWRyYXdzIHRoZSBzaGFwZSwgaXQgcGVyZm9ybXMgdmVyeSBwb29ybHkgaWYgZXhlY3V0ZWQgbWFueSB0aW1lc1xuICAgICAgICAgKiAgY29uc2VjdXRpdmVseS4gIFBsZWFzZSB1c2UgdGhlIHtAbGluayBLb252YS5TdGFnZSNnZXRJbnRlcnNlY3Rpb259IG1ldGhvZCBpZiBhdCBhbGwgcG9zc2libGVcbiAgICAgICAgICogIGJlY2F1c2UgaXQgcGVyZm9ybXMgbXVjaCBiZXR0ZXJcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwb2ludFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9pbnQueFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9pbnQueVxuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGludGVyc2VjdHM6IGZ1bmN0aW9uKHBvaW50KSB7XG4gICAgICAgICAgICB2YXIgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCksXG4gICAgICAgICAgICAgICAgYnVmZmVySGl0Q2FudmFzID0gc3RhZ2UuYnVmZmVySGl0Q2FudmFzLFxuICAgICAgICAgICAgICAgIHA7XG5cbiAgICAgICAgICAgIGJ1ZmZlckhpdENhbnZhcy5nZXRDb250ZXh0KCkuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd1NjZW5lKGJ1ZmZlckhpdENhbnZhcyk7XG4gICAgICAgICAgICBwID0gYnVmZmVySGl0Q2FudmFzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKE1hdGgucm91bmQocG9pbnQueCksIE1hdGgucm91bmQocG9pbnQueSksIDEsIDEpLmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gcFszXSA+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGV4dGVuZHMgTm9kZS5wcm90b3R5cGUuZGVzdHJveVxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIGRlbGV0ZSBLb252YS5zaGFwZXNbdGhpcy5jb2xvcktleV07XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgX3VzZUJ1ZmZlckNhbnZhczogZnVuY3Rpb24oY2FjaGluZykge1xuICAgICAgICAgICAgcmV0dXJuICFjYWNoaW5nICYmICh0aGlzLnBlcmZlY3REcmF3RW5hYmxlZCgpICYmICh0aGlzLmdldEFic29sdXRlT3BhY2l0eSgpICE9PSAxKSAmJiB0aGlzLmhhc0ZpbGwoKSAmJiB0aGlzLmhhc1N0cm9rZSgpICYmIHRoaXMuZ2V0U3RhZ2UoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAodGhpcy5wZXJmZWN0RHJhd0VuYWJsZWQoKSAmJiB0aGlzLmhhc1NoYWRvdygpICYmICh0aGlzLmdldEFic29sdXRlT3BhY2l0eSgpICE9PSAxKSAmJiB0aGlzLmhhc0ZpbGwoKSAmJiB0aGlzLmhhc1N0cm9rZSgpICYmIHRoaXMuZ2V0U3RhZ2UoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gc2VsZiByZWN0YW5nbGUgKHgsIHksIHdpZHRoLCBoZWlnaHQpIG9mIHNoYXBlLlxuICAgICAgICAgKiBUaGlzIG1ldGhvZCBhcmUgbm90IHRha2VuIGludG8gYWNjb3VudCB0cmFuc2Zvcm1hdGlvbiBhbmQgc3R5bGVzLlxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH0gcmVjdCB3aXRoIHt4LCB5LCB3aWR0aCwgaGVpZ2h0fSBwcm9wZXJ0aWVzXG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqXG4gICAgICAgICAqIHJlY3QuZ2V0U2VsZlJlY3QoKTsgIC8vIHJldHVybiB7eDowLCB5OjAsIHdpZHRoOnJlY3Qud2lkdGgoKSwgaGVpZ2h0OnJlY3QuaGVpZ2h0KCl9XG4gICAgICAgICAqIGNpcmNsZS5nZXRTZWxmUmVjdCgpOyAgLy8gcmV0dXJuIHt4OiAtIGNpcmNsZS53aWR0aCgpIC8gMiwgeTogLSBjaXJjbGUuaGVpZ2h0KCkgLyAyLCB3aWR0aDpjaXJjbGUud2lkdGgoKSwgaGVpZ2h0OmNpcmNsZS5oZWlnaHQoKX1cbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIGdldFNlbGZSZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gdGhpcy5nZXRTaXplKCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IHRoaXMuX2NlbnRyb2lkID8gTWF0aC5yb3VuZCgtc2l6ZS53aWR0aCAvIDIpIDogMCxcbiAgICAgICAgICAgICAgICB5OiB0aGlzLl9jZW50cm9pZCA/IE1hdGgucm91bmQoLXNpemUuaGVpZ2h0IC8gMikgOiAwLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBzaXplLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogc2l6ZS5oZWlnaHRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGdldENsaWVudFJlY3Q6IGZ1bmN0aW9uKHNraXBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIHZhciBmaWxsUmVjdCA9IHRoaXMuZ2V0U2VsZlJlY3QoKTtcblxuICAgICAgICAgICAgdmFyIHN0cm9rZVdpZHRoID0gKHRoaXMuaGFzU3Ryb2tlKCkgJiYgdGhpcy5zdHJva2VXaWR0aCgpKSB8fCAwO1xuICAgICAgICAgICAgdmFyIGZpbGxBbmRTdHJva2VXaWR0aCA9IGZpbGxSZWN0LndpZHRoICsgc3Ryb2tlV2lkdGg7XG4gICAgICAgICAgICB2YXIgZmlsbEFuZFN0cm9rZUhlaWdodCA9IGZpbGxSZWN0LmhlaWdodCArIHN0cm9rZVdpZHRoO1xuXG4gICAgICAgICAgICB2YXIgc2hhZG93T2Zmc2V0WCA9IHRoaXMuc2hhZG93T2Zmc2V0WCgpO1xuICAgICAgICAgICAgdmFyIHNoYWRvd09mZnNldFkgPSB0aGlzLnNoYWRvd09mZnNldFkoKTtcblxuICAgICAgICAgICAgdmFyIHByZVdpZHRoID0gZmlsbEFuZFN0cm9rZVdpZHRoICsgTWF0aC5hYnMoc2hhZG93T2Zmc2V0WCk7XG4gICAgICAgICAgICB2YXIgcHJlSGVpZ2h0ID0gZmlsbEFuZFN0cm9rZUhlaWdodCArIE1hdGguYWJzKHNoYWRvd09mZnNldFkpO1xuXG4gICAgICAgICAgICB2YXIgYmx1clJhZGl1cyA9ICh0aGlzLmhhc1NoYWRvdygpICYmIHRoaXMuc2hhZG93Qmx1cigpIHx8IDApO1xuXG4gICAgICAgICAgICB2YXIgd2lkdGggPSBwcmVXaWR0aCArIGJsdXJSYWRpdXMgKiAyO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHByZUhlaWdodCArIGJsdXJSYWRpdXMgKiAyO1xuXG4gICAgICAgICAgICAvLyBpZiBzdHJva2UsIGZvciBleGFtcGxlID0gM1xuICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBzZXQgeCB0byAxLjUsIGJ1dCBhZnRlciBNYXRoLnJvdW5kIGl0IHdpbGwgYmUgMlxuICAgICAgICAgICAgLy8gYXMgd2UgaGF2ZSBhZGRpdGlvbmFsIG9mZnNldCB3ZSBuZWVkIHRvIGluY3JlYXNlIHdpZHRoIGFuZCBoZWlnaHQgYnkgMSBwaXhlbFxuICAgICAgICAgICAgdmFyIHJvdW5kaW5nT2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIGlmIChNYXRoLnJvdW5kKHN0cm9rZVdpZHRoIC8gMikgIT09IHN0cm9rZVdpZHRoIC8gMikge1xuICAgICAgICAgICAgICAgIHJvdW5kaW5nT2Zmc2V0ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWN0ID0ge1xuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCArIHJvdW5kaW5nT2Zmc2V0LFxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0ICsgcm91bmRpbmdPZmZzZXQsXG4gICAgICAgICAgICAgICAgeDogLU1hdGgucm91bmQoc3Ryb2tlV2lkdGggLyAyICsgYmx1clJhZGl1cykgKyBNYXRoLm1pbihzaGFkb3dPZmZzZXRYLCAwKSArIGZpbGxSZWN0LngsXG4gICAgICAgICAgICAgICAgeTogLU1hdGgucm91bmQoc3Ryb2tlV2lkdGggLyAyICsgYmx1clJhZGl1cykgKyBNYXRoLm1pbihzaGFkb3dPZmZzZXRZLCAwKSArIGZpbGxSZWN0LnlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIXNraXBUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNmb3JtZWRSZWN0KHJlY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlY3Q7XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXdTY2VuZTogZnVuY3Rpb24oY2FuLCB0b3AsIGNhY2hpbmcsIHNraXBCdWZmZXIpIHtcbiAgICAgICAgICAgIHZhciBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSxcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW4gfHwgbGF5ZXIuZ2V0Q2FudmFzKCksXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCksXG4gICAgICAgICAgICAgICAgY2FjaGVkQ2FudmFzID0gdGhpcy5fY2FjaGUuY2FudmFzLFxuICAgICAgICAgICAgICAgIGRyYXdGdW5jID0gdGhpcy5zY2VuZUZ1bmMoKSxcbiAgICAgICAgICAgICAgICBoYXNTaGFkb3cgPSB0aGlzLmhhc1NoYWRvdygpLFxuICAgICAgICAgICAgICAgIGhhc1N0cm9rZSA9IHRoaXMuaGFzU3Ryb2tlKCksXG4gICAgICAgICAgICAgICAgc3RhZ2UsIGJ1ZmZlckNhbnZhcywgYnVmZmVyQ29udGV4dDtcblxuICAgICAgICAgICAgaWYoIXRoaXMuaXNWaXNpYmxlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjYWNoZWRDYW52YXMpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICBsYXllci5fYXBwbHlUcmFuc2Zvcm0odGhpcywgY29udGV4dCwgdG9wKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kcmF3Q2FjaGVkU2NlbmVDYW52YXMoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRyYXdGdW5jKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIC8vIGlmIGJ1ZmZlciBjYW52YXMgaXMgbmVlZGVkXG4gICAgICAgICAgICBpZiAodGhpcy5fdXNlQnVmZmVyQ2FudmFzKGNhY2hpbmcpICYmICFza2lwQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgICAgICAgICAgYnVmZmVyQ2FudmFzID0gc3RhZ2UuYnVmZmVyQ2FudmFzO1xuICAgICAgICAgICAgICAgIGJ1ZmZlckNvbnRleHQgPSBidWZmZXJDYW52YXMuZ2V0Q29udGV4dCgpO1xuICAgICAgICAgICAgICAgIGJ1ZmZlckNvbnRleHQuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICBidWZmZXJDb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICBidWZmZXJDb250ZXh0Ll9hcHBseUxpbmVKb2luKHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIGxheWVyIG1pZ2h0IGJlIHVuZGVmaW5lZCBpZiB3ZSBhcmUgdXNpbmcgY2FjaGUgYmVmb3JlIGFkZGluZyB0byBsYXllclxuICAgICAgICAgICAgICAgIGlmICghY2FjaGluZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLl9hcHBseVRyYW5zZm9ybSh0aGlzLCBidWZmZXJDb250ZXh0LCB0b3ApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zZm9ybShtWzBdLCBtWzFdLCBtWzJdLCBtWzNdLCBtWzRdLCBtWzVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgYnVmZmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgYnVmZmVyQ29udGV4dC5yZXN0b3JlKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmF0aW8gPSBidWZmZXJDYW52YXMucGl4ZWxSYXRpbztcbiAgICAgICAgICAgICAgICBpZiAoaGFzU2hhZG93ICYmICFjYW52YXMuaGl0Q2FudmFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuX2FwcGx5U2hhZG93KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlPcGFjaXR5KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoYnVmZmVyQ2FudmFzLl9jYW52YXMsIDAsIDAsIGJ1ZmZlckNhbnZhcy53aWR0aCAvIHJhdGlvLCBidWZmZXJDYW52YXMuaGVpZ2h0IC8gcmF0aW8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlPcGFjaXR5KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShidWZmZXJDYW52YXMuX2NhbnZhcywgMCwgMCwgYnVmZmVyQ2FudmFzLndpZHRoIC8gcmF0aW8sIGJ1ZmZlckNhbnZhcy5oZWlnaHQgLyByYXRpbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgYnVmZmVyIGNhbnZhcyBpcyBub3QgbmVlZGVkXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0Ll9hcHBseUxpbmVKb2luKHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIGxheWVyIG1pZ2h0IGJlIHVuZGVmaW5lZCBpZiB3ZSBhcmUgdXNpbmcgY2FjaGUgYmVmb3JlIGFkZGluZyB0byBsYXllclxuICAgICAgICAgICAgICAgIGlmICghY2FjaGluZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyLl9hcHBseVRyYW5zZm9ybSh0aGlzLCBjb250ZXh0LCB0b3ApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zZm9ybShvWzBdLCBvWzFdLCBvWzJdLCBvWzNdLCBvWzRdLCBvWzVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChoYXNTaGFkb3cgJiYgaGFzU3Ryb2tlICYmICFjYW52YXMuaGl0Q2FudmFzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBhcHBseSBzaGFkb3dcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjYWNoaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Ll9hcHBseU9wYWNpdHkodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlTaGFkb3codGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBzaGFwZSBoYXMgc3Ryb2tlIHdlIG5lZWQgdG8gcmVkcmF3IHNoYXBlXG4gICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSB3ZSB3aWxsIHNlZSBhIHNoYWRvdyB1bmRlciBzdHJva2UgKGFuZCBvdmVyIGZpbGwpXG4gICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBJIHRoaW5rIHRoaXMgaXMgdW5leHBlY3RlZCBiZWhhdmlvclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNGaWxsKCkgJiYgdGhpcy5nZXRTaGFkb3dGb3JTdHJva2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhc1NoYWRvdyAmJiAhY2FudmFzLmhpdENhbnZhcykge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjYWNoaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Ll9hcHBseU9wYWNpdHkodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlTaGFkb3codGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2FjaGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYXBwbHlPcGFjaXR5KHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgZHJhd0hpdDogZnVuY3Rpb24oY2FuLCB0b3AsIGNhY2hpbmcpIHtcbiAgICAgICAgICAgIHZhciBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSxcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW4gfHwgbGF5ZXIuaGl0Q2FudmFzLFxuICAgICAgICAgICAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgpLFxuICAgICAgICAgICAgICAgIGRyYXdGdW5jID0gdGhpcy5oaXRGdW5jKCkgfHwgdGhpcy5zY2VuZUZ1bmMoKSxcbiAgICAgICAgICAgICAgICBjYWNoZWRDYW52YXMgPSB0aGlzLl9jYWNoZS5jYW52YXMsXG4gICAgICAgICAgICAgICAgY2FjaGVkSGl0Q2FudmFzID0gY2FjaGVkQ2FudmFzICYmIGNhY2hlZENhbnZhcy5oaXQ7XG5cbiAgICAgICAgICAgIGlmKCF0aGlzLnNob3VsZERyYXdIaXQoY2FudmFzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxheWVyKSB7XG4gICAgICAgICAgICAgICAgbGF5ZXIuY2xlYXJIaXRDYWNoZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhY2hlZEhpdENhbnZhcykge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGxheWVyLl9hcHBseVRyYW5zZm9ybSh0aGlzLCBjb250ZXh0LCB0b3ApO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RyYXdDYWNoZWRIaXRDYW52YXMoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRyYXdGdW5jKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIGNvbnRleHQuX2FwcGx5TGluZUpvaW4odGhpcyk7XG4gICAgICAgICAgICBpZiAoIWNhY2hpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIuX2FwcGx5VHJhbnNmb3JtKHRoaXMsIGNvbnRleHQsIHRvcCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSB0aGlzLmdldEFic29sdXRlVHJhbnNmb3JtKHRvcCkuZ2V0TWF0cml4KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKG9bMF0sIG9bMV0sIG9bMl0sIG9bM10sIG9bNF0sIG9bNV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRyYXdGdW5jLmNhbGwodGhpcywgY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBkcmF3IGhpdCBncmFwaCB1c2luZyB0aGUgY2FjaGVkIHNjZW5lIGNhbnZhc1xuICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICAgICogQHBhcmFtIHtJbnRlZ2VyfSBhbHBoYVRocmVzaG9sZCBhbHBoYSBjaGFubmVsIHRocmVzaG9sZCB0aGF0IGRldGVybWluZXMgd2hldGhlciBvciBub3RcbiAgICAgICAgKiAgYSBwaXhlbCBzaG91bGQgYmUgZHJhd24gb250byB0aGUgaGl0IGdyYXBoLiAgTXVzdCBiZSBhIHZhbHVlIGJldHdlZW4gMCBhbmQgMjU1LlxuICAgICAgICAqICBUaGUgZGVmYXVsdCBpcyAwXG4gICAgICAgICogQHJldHVybnMge0tvbnZhLlNoYXBlfVxuICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICogc2hhcGUuY2FjaGUoKTtcbiAgICAgICAgKiBzaGFwZS5kcmF3SGl0RnJvbUNhY2hlKCk7XG4gICAgICAgICovXG4gICAgICAgIGRyYXdIaXRGcm9tQ2FjaGU6IGZ1bmN0aW9uKGFscGhhVGhyZXNob2xkKSB7XG4gICAgICAgICAgICB2YXIgdGhyZXNob2xkID0gYWxwaGFUaHJlc2hvbGQgfHwgMCxcbiAgICAgICAgICAgICAgICBjYWNoZWRDYW52YXMgPSB0aGlzLl9jYWNoZS5jYW52YXMsXG4gICAgICAgICAgICAgICAgc2NlbmVDYW52YXMgPSB0aGlzLl9nZXRDYWNoZWRTY2VuZUNhbnZhcygpLFxuICAgICAgICAgICAgICAgIGhpdENhbnZhcyA9IGNhY2hlZENhbnZhcy5oaXQsXG4gICAgICAgICAgICAgICAgaGl0Q29udGV4dCA9IGhpdENhbnZhcy5nZXRDb250ZXh0KCksXG4gICAgICAgICAgICAgICAgaGl0V2lkdGggPSBoaXRDYW52YXMuZ2V0V2lkdGgoKSxcbiAgICAgICAgICAgICAgICBoaXRIZWlnaHQgPSBoaXRDYW52YXMuZ2V0SGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgaGl0SW1hZ2VEYXRhLCBoaXREYXRhLCBsZW4sIHJnYkNvbG9yS2V5LCBpLCBhbHBoYTtcblxuICAgICAgICAgICAgaGl0Q29udGV4dC5jbGVhcigpO1xuICAgICAgICAgICAgaGl0Q29udGV4dC5kcmF3SW1hZ2Uoc2NlbmVDYW52YXMuX2NhbnZhcywgMCwgMCwgaGl0V2lkdGgsIGhpdEhlaWdodCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaGl0SW1hZ2VEYXRhID0gaGl0Q29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgaGl0V2lkdGgsIGhpdEhlaWdodCk7XG4gICAgICAgICAgICAgICAgaGl0RGF0YSA9IGhpdEltYWdlRGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgIGxlbiA9IGhpdERhdGEubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHJnYkNvbG9yS2V5ID0gS29udmEuVXRpbC5faGV4VG9SZ2IodGhpcy5jb2xvcktleSk7XG5cbiAgICAgICAgICAgICAgICAvLyByZXBsYWNlIG5vbiB0cmFuc3BhcmVudCBwaXhlbHMgd2l0aCBjb2xvciBrZXlcbiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IGhpdERhdGFbaSArIDNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWxwaGEgPiB0aHJlc2hvbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpdERhdGFbaV0gPSByZ2JDb2xvcktleS5yO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0RGF0YVtpICsgMV0gPSByZ2JDb2xvcktleS5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0RGF0YVtpICsgMl0gPSByZ2JDb2xvcktleS5iO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0RGF0YVtpICsgM10gPSAyNTU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXREYXRhW2kgKyAzXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaGl0Q29udGV4dC5wdXRJbWFnZURhdGEoaGl0SW1hZ2VEYXRhLCAwLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgICBLb252YS5VdGlsLmVycm9yKCdVbmFibGUgdG8gZHJhdyBoaXQgZ3JhcGggZnJvbSBjYWNoZWQgc2NlbmUgY2FudmFzLiAnICsgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5TaGFwZSwgS29udmEuTm9kZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBhbmQgc2V0dGVyc1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc3Ryb2tlJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHN0cm9rZSBjb2xvclxuICAgICAqIEBuYW1lIHN0cm9rZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbG9yXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzdHJva2UgY29sb3JcbiAgICAgKiB2YXIgc3Ryb2tlID0gc2hhcGUuc3Ryb2tlKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc3Ryb2tlIGNvbG9yIHdpdGggY29sb3Igc3RyaW5nXG4gICAgICogc2hhcGUuc3Ryb2tlKCdncmVlbicpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHN0cm9rZSBjb2xvciB3aXRoIGhleFxuICAgICAqIHNoYXBlLnN0cm9rZSgnIzAwZmYwMCcpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHN0cm9rZSBjb2xvciB3aXRoIHJnYlxuICAgICAqIHNoYXBlLnN0cm9rZSgncmdiKDAsMjU1LDApJyk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc3Ryb2tlIGNvbG9yIHdpdGggcmdiYSBhbmQgbWFrZSBpdCA1MCUgb3BhcXVlXG4gICAgICogc2hhcGUuc3Ryb2tlKCdyZ2JhKDAsMjU1LDAsMC41Jyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzdHJva2VSZWQnLCAwLCBLb252YS5WYWxpZGF0b3JzLlJHQkNvbXBvbmVudCk7XG4gICAgS29udmEuRmFjdG9yeS5hZGREZXByZWNhdGVkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc3Ryb2tlR3JlZW4nLCAwLCBLb252YS5WYWxpZGF0b3JzLlJHQkNvbXBvbmVudCk7XG4gICAgS29udmEuRmFjdG9yeS5hZGREZXByZWNhdGVkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc3Ryb2tlQmx1ZScsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50KTtcbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzdHJva2VBbHBoYScsIDEsIEtvbnZhLlZhbGlkYXRvcnMuYWxwaGFDb21wb25lbnQpO1xuXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3N0cm9rZVdpZHRoJywgMik7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHN0cm9rZSB3aWR0aFxuICAgICAqIEBuYW1lIHN0cm9rZVdpZHRoXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3Ryb2tlV2lkdGhcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHN0cm9rZSB3aWR0aFxuICAgICAqIHZhciBzdHJva2VXaWR0aCA9IHNoYXBlLnN0cm9rZVdpZHRoKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc3Ryb2tlIHdpZHRoXG4gICAgICogc2hhcGUuc3Ryb2tlV2lkdGgoKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc3Ryb2tlSGl0RW5hYmxlZCcsIHRydWUpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBzdHJva2VIaXRFbmFibGVkIHByb3BlcnR5LiBVc2VmdWwgZm9yIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbi5cbiAgICAgKiBZb3UgbWF5IHNldCBgc2hhcGUuc3Ryb2tlSGl0RW5hYmxlZChmYWxzZSlgLiBJbiB0aGlzIGNhc2Ugc3Ryb2tlIHdpbGwgYmUgbm8gZHJhdyBvbiBoaXQgY2FudmFzLCBzbyBoaXQgYXJlYVxuICAgICAqIG9mIHNoYXBlIHdpbGwgYmUgZGVjcmVhc2VkIChieSBsaW5lV2lkdGggLyAyKS4gUmVtZW1iZXIgdGhhdCBub24gY2xvc2VkIGxpbmUgd2l0aCBgc3Ryb2tlSGl0RW5hYmxlZCA9IGZhbHNlYFxuICAgICAqIHdpbGwgYmUgbm90IGRyYXduIG9uIGhpdCBjYW52YXMsIHRoYXQgaXMgbWVhbiBsaW5lIHdpbGwgbm8gdHJpZ2dlciBwb2ludGVyIGV2ZW50cyAobGlrZSBtb3VzZW92ZXIpXG4gICAgICogRGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQG5hbWUgc3Ryb2tlSGl0RW5hYmxlZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBzdHJva2VIaXRFbmFibGVkXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc3Ryb2tlSGl0RW5hYmxlZFxuICAgICAqIHZhciBzdHJva2VIaXRFbmFibGVkID0gc2hhcGUuc3Ryb2tlSGl0RW5hYmxlZCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHN0cm9rZUhpdEVuYWJsZWRcbiAgICAgKiBzaGFwZS5zdHJva2VIaXRFbmFibGVkKCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3BlcmZlY3REcmF3RW5hYmxlZCcsIHRydWUpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBwZXJmZWN0RHJhd0VuYWJsZWQuIElmIGEgc2hhcGUgaGFzIGZpbGwsIHN0cm9rZSBhbmQgb3BhY2l0eSB5b3UgbWF5IHNldCBgcGVyZmVjdERyYXdFbmFibGVkYCB0byBpbXByb3ZlIHBlcmZvcm1hbmNlLlxuICAgICAqIFNlZSBodHRwOi8va29udmFqcy5naXRodWIuaW8vZG9jcy9wZXJmb3JtYW5jZS9EaXNhYmxlX1BlcmZlY3RfRHJhdy5odG1sIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgICAqIERlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBuYW1lIHBlcmZlY3REcmF3RW5hYmxlZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBwZXJmZWN0RHJhd0VuYWJsZWRcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBwZXJmZWN0RHJhd0VuYWJsZWRcbiAgICAgKiB2YXIgcGVyZmVjdERyYXdFbmFibGVkID0gc2hhcGUucGVyZmVjdERyYXdFbmFibGVkKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgcGVyZmVjdERyYXdFbmFibGVkXG4gICAgICogc2hhcGUucGVyZmVjdERyYXdFbmFibGVkKCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd0ZvclN0cm9rZUVuYWJsZWQnLCB0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZC4gVXNlZnVsIGZvciBwZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24uXG4gICAgICogWW91IG1heSBzZXQgYHNoYXBlLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWQoZmFsc2UpYC4gSW4gdGhpcyBjYXNlIHN0cm9rZSB3aWxsIGJlIG5vIGRyYXcgc2hhZG93IGZvciBzdHJva2UuXG4gICAgICogUmVtZW1iZXIgaWYgeW91IHNldCBgc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZCA9IGZhbHNlYCBmb3Igbm9uIGNsb3NlZCBsaW5lIC0gdGhhdCBsaW5lIHdpdGggaGF2ZSBubyBzaGFkb3chLlxuICAgICAqIERlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBuYW1lIHNoYWRvd0ZvclN0cm9rZUVuYWJsZWRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZFxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHNoYWRvd0ZvclN0cm9rZUVuYWJsZWRcbiAgICAgKiB2YXIgc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZCA9IHNoYXBlLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzaGFkb3dGb3JTdHJva2VFbmFibGVkXG4gICAgICogc2hhcGUuc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZCgpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdsaW5lSm9pbicpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBsaW5lIGpvaW4uICBDYW4gYmUgbWl0ZXIsIHJvdW5kLCBvciBiZXZlbC4gIFRoZVxuICAgICAqICBkZWZhdWx0IGlzIG1pdGVyXG4gICAgICogQG5hbWUgbGluZUpvaW5cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBsaW5lSm9pblxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgbGluZSBqb2luXG4gICAgICogdmFyIGxpbmVKb2luID0gc2hhcGUubGluZUpvaW4oKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBsaW5lIGpvaW5cbiAgICAgKiBzaGFwZS5saW5lSm9pbigncm91bmQnKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnbGluZUNhcCcpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBsaW5lIGNhcC4gIENhbiBiZSBidXR0LCByb3VuZCwgb3Igc3F1YXJlXG4gICAgICogQG5hbWUgbGluZUNhcFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGxpbmVDYXBcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGxpbmUgY2FwXG4gICAgICogdmFyIGxpbmVDYXAgPSBzaGFwZS5saW5lQ2FwKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgbGluZSBjYXBcbiAgICAgKiBzaGFwZS5saW5lQ2FwKCdyb3VuZCcpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzY2VuZUZ1bmMnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2NlbmUgZHJhdyBmdW5jdGlvblxuICAgICAqIEBuYW1lIHNjZW5lRnVuY1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZHJhd0Z1bmMgZHJhd2luZyBmdW5jdGlvblxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzY2VuZSBkcmF3IGZ1bmN0aW9uXG4gICAgICogdmFyIHNjZW5lRnVuYyA9IHNoYXBlLnNjZW5lRnVuYygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNjZW5lIGRyYXcgZnVuY3Rpb25cbiAgICAgKiBzaGFwZS5zY2VuZUZ1bmMoZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAqICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgKiAgIGNvbnRleHQucmVjdCgwLCAwLCB0aGlzLndpZHRoKCksIHRoaXMuaGVpZ2h0KCkpO1xuICAgICAqICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgKiAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdoaXRGdW5jJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGhpdCBkcmF3IGZ1bmN0aW9uXG4gICAgICogQG5hbWUgaGl0RnVuY1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZHJhd0Z1bmMgZHJhd2luZyBmdW5jdGlvblxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBoaXQgZHJhdyBmdW5jdGlvblxuICAgICAqIHZhciBoaXRGdW5jID0gc2hhcGUuaGl0RnVuYygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGhpdCBkcmF3IGZ1bmN0aW9uXG4gICAgICogc2hhcGUuaGl0RnVuYyhmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICogICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAqICAgY29udGV4dC5yZWN0KDAsIDAsIHRoaXMud2lkdGgoKSwgdGhpcy5oZWlnaHQoKSk7XG4gICAgICogICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAqICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICogfSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2Rhc2gnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZGFzaCBhcnJheSBmb3Igc3Ryb2tlLlxuICAgICAqIEBuYW1lIGRhc2hcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGRhc2hcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgLy8gYXBwbHkgZGFzaGVkIHN0cm9rZSB0aGF0IGlzIDEwcHggbG9uZyBhbmQgNSBwaXhlbHMgYXBhcnRcbiAgICAgKiAgbGluZS5kYXNoKFsxMCwgNV0pO1xuICAgICAqICAvLyBhcHBseSBkYXNoZWQgc3Ryb2tlIHRoYXQgaXMgbWFkZSB1cCBvZiBhbHRlcm5hdGluZyBkYXNoZWRcbiAgICAgKiAgLy8gbGluZXMgdGhhdCBhcmUgMTBweCBsb25nIGFuZCAyMHB4IGFwYXJ0LCBhbmQgZG90cyB0aGF0IGhhdmVcbiAgICAgKiAgLy8gYSByYWRpdXMgb2YgNXB4IGFuZCBhcmUgMjBweCBhcGFydFxuICAgICAqICBsaW5lLmRhc2goWzEwLCAyMCwgMC4wMDEsIDIwXSk7XG4gICAgICovXG5cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc2hhZG93Q29sb3InKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2hhZG93IGNvbG9yXG4gICAgICogQG5hbWUgc2hhZG93Q29sb3JcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb2xvclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc2hhZG93IGNvbG9yXG4gICAgICogdmFyIHNoYWRvdyA9IHNoYXBlLnNoYWRvd0NvbG9yKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc2hhZG93IGNvbG9yIHdpdGggY29sb3Igc3RyaW5nXG4gICAgICogc2hhcGUuc2hhZG93Q29sb3IoJ2dyZWVuJyk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc2hhZG93IGNvbG9yIHdpdGggaGV4XG4gICAgICogc2hhcGUuc2hhZG93Q29sb3IoJyMwMGZmMDAnKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzaGFkb3cgY29sb3Igd2l0aCByZ2JcbiAgICAgKiBzaGFwZS5zaGFkb3dDb2xvcigncmdiKDAsMjU1LDApJyk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc2hhZG93IGNvbG9yIHdpdGggcmdiYSBhbmQgbWFrZSBpdCA1MCUgb3BhcXVlXG4gICAgICogc2hhcGUuc2hhZG93Q29sb3IoJ3JnYmEoMCwyNTUsMCwwLjUnKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkRGVwcmVjYXRlZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd1JlZCcsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50KTtcbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzaGFkb3dHcmVlbicsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50KTtcbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzaGFkb3dCbHVlJywgMCwgS29udmEuVmFsaWRhdG9ycy5SR0JDb21wb25lbnQpO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkRGVwcmVjYXRlZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd0FscGhhJywgMSwgS29udmEuVmFsaWRhdG9ycy5hbHBoYUNvbXBvbmVudCk7XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd0JsdXInKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2hhZG93IGJsdXJcbiAgICAgKiBAbmFtZSBzaGFkb3dCbHVyXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYmx1clxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc2hhZG93IGJsdXJcbiAgICAgKiB2YXIgc2hhZG93Qmx1ciA9IHNoYXBlLnNoYWRvd0JsdXIoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzaGFkb3cgYmx1clxuICAgICAqIHNoYXBlLnNoYWRvd0JsdXIoMTApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzaGFkb3dPcGFjaXR5Jyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHNoYWRvdyBvcGFjaXR5LiAgbXVzdCBiZSBhIHZhbHVlIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBuYW1lIHNoYWRvd09wYWNpdHlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvcGFjaXR5XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzaGFkb3cgb3BhY2l0eVxuICAgICAqIHZhciBzaGFkb3dPcGFjaXR5ID0gc2hhcGUuc2hhZG93T3BhY2l0eSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNoYWRvdyBvcGFjaXR5XG4gICAgICogc2hhcGUuc2hhZG93T3BhY2l0eSgwLjUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc2hhZG93T2Zmc2V0JywgWyd4JywgJ3knXSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHNoYWRvdyBvZmZzZXRcbiAgICAgKiBAbmFtZSBzaGFkb3dPZmZzZXRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvZmZzZXRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0LnhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0LnlcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHNoYWRvdyBvZmZzZXRcbiAgICAgKiB2YXIgc2hhZG93T2Zmc2V0ID0gc2hhcGUuc2hhZG93T2Zmc2V0KCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgc2hhZG93IG9mZnNldFxuICAgICAqIHNoYXBlLnNoYWRvd09mZnNldCh7XG4gICAgICogICB4OiAyMFxuICAgICAqICAgeTogMTBcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc2hhZG93T2Zmc2V0WCcsIDApO1xuXG4gICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2hhZG93IG9mZnNldCB4XG4gICAgICogQG5hbWUgc2hhZG93T2Zmc2V0WFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHNoYWRvdyBvZmZzZXQgeFxuICAgICAqIHZhciBzaGFkb3dPZmZzZXRYID0gc2hhcGUuc2hhZG93T2Zmc2V0WCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHNoYWRvdyBvZmZzZXQgeFxuICAgICAqIHNoYXBlLnNoYWRvd09mZnNldFgoNSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd09mZnNldFknLCAwKTtcblxuICAgICAvKipcbiAgICAgKiBnZXQvc2V0IHNoYWRvdyBvZmZzZXQgeVxuICAgICAqIEBuYW1lIHNoYWRvd09mZnNldFlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzaGFkb3cgb2Zmc2V0IHlcbiAgICAgKiB2YXIgc2hhZG93T2Zmc2V0WSA9IHNoYXBlLnNoYWRvd09mZnNldFkoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBzaGFkb3cgb2Zmc2V0IHlcbiAgICAgKiBzaGFwZS5zaGFkb3dPZmZzZXRZKDUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUGF0dGVybkltYWdlJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBuYW1lIGZpbGxQYXR0ZXJuSW1hZ2VcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IGltYWdlIG9iamVjdFxuICAgICAqIEByZXR1cm5zIHtJbWFnZX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiB2YXIgZmlsbFBhdHRlcm5JbWFnZSA9IHNoYXBlLmZpbGxQYXR0ZXJuSW1hZ2UoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiB2YXIgaW1hZ2VPYmogPSBuZXcgSW1hZ2UoKTtcbiAgICAgKiBpbWFnZU9iai5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgKiAgIHNoYXBlLmZpbGxQYXR0ZXJuSW1hZ2UoaW1hZ2VPYmopO1xuICAgICAqIH07XG4gICAgICogaW1hZ2VPYmouc3JjID0gJ3BhdGgvdG8vaW1hZ2UvanBnJztcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbCcpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIGNvbG9yXG4gICAgICogQG5hbWUgZmlsbFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbG9yXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIGNvbG9yXG4gICAgICogdmFyIGZpbGwgPSBzaGFwZS5maWxsKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBjb2xvciB3aXRoIGNvbG9yIHN0cmluZ1xuICAgICAqIHNoYXBlLmZpbGwoJ2dyZWVuJyk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBjb2xvciB3aXRoIGhleFxuICAgICAqIHNoYXBlLmZpbGwoJyMwMGZmMDAnKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIGNvbG9yIHdpdGggcmdiXG4gICAgICogc2hhcGUuZmlsbCgncmdiKDAsMjU1LDApJyk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBjb2xvciB3aXRoIHJnYmEgYW5kIG1ha2UgaXQgNTAlIG9wYXF1ZVxuICAgICAqIHNoYXBlLmZpbGwoJ3JnYmEoMCwyNTUsMCwwLjUnKTtcbiAgICAgKlxuICAgICAqIC8vIHNoYXBlIHdpdGhvdXQgZmlsbFxuICAgICAqIHNoYXBlLmZpbGwobnVsbCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUmVkJywgMCwgS29udmEuVmFsaWRhdG9ycy5SR0JDb21wb25lbnQpO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkRGVwcmVjYXRlZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxHcmVlbicsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50KTtcbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsQmx1ZScsIDAsIEtvbnZhLlZhbGlkYXRvcnMuUkdCQ29tcG9uZW50KTtcbiAgICBLb252YS5GYWN0b3J5LmFkZERlcHJlY2F0ZWRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsQWxwaGEnLCAxLCBLb252YS5WYWxpZGF0b3JzLmFscGhhQ29tcG9uZW50KTtcblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFBhdHRlcm5YJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiB4XG4gICAgICogQG5hbWUgZmlsbFBhdHRlcm5YXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBwYXR0ZXJuIHhcbiAgICAgKiB2YXIgZmlsbFBhdHRlcm5YID0gc2hhcGUuZmlsbFBhdHRlcm5YKCk7XG4gICAgICogLy8gc2V0IGZpbGwgcGF0dGVybiB4XG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5YKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFBhdHRlcm5ZJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiB5XG4gICAgICogQG5hbWUgZmlsbFBhdHRlcm5ZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBwYXR0ZXJuIHlcbiAgICAgKiB2YXIgZmlsbFBhdHRlcm5ZID0gc2hhcGUuZmlsbFBhdHRlcm5ZKCk7XG4gICAgICogLy8gc2V0IGZpbGwgcGF0dGVybiB5XG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5ZKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wcycpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIGxpbmVhciBncmFkaWVudCBjb2xvciBzdG9wc1xuICAgICAqIEBuYW1lIGZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvbG9yU3RvcHNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IGNvbG9yU3RvcHNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIGxpbmVhciBncmFkaWVudCBjb2xvciBzdG9wc1xuICAgICAqIHZhciBjb2xvclN0b3BzID0gc2hhcGUuZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wcygpO1xuICAgICAqXG4gICAgICogLy8gY3JlYXRlIGEgbGluZWFyIGdyYWRpZW50IHRoYXQgc3RhcnRzIHdpdGggcmVkLCBjaGFuZ2VzIHRvIGJsdWVcbiAgICAgKiAvLyBoYWxmd2F5IHRocm91Z2gsIGFuZCB0aGVuIGNoYW5nZXMgdG8gZ3JlZW5cbiAgICAgKiBzaGFwZS5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzKDAsICdyZWQnLCAwLjUsICdibHVlJywgMSwgJ2dyZWVuJyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IHN0YXJ0IHJhZGl1c1xuICAgICAqIEBuYW1lIGZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcmFkaXVzXG4gICAgICogdmFyIHN0YXJ0UmFkaXVzID0gc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcmFkaXVzXG4gICAgICogc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXMoMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1cycsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHJhZGlhbCBncmFkaWVudCBlbmQgcmFkaXVzXG4gICAgICogQG5hbWUgZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCByYWRpYWwgZ3JhZGllbnQgZW5kIHJhZGl1c1xuICAgICAqIHZhciBlbmRSYWRpdXMgPSBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCByYWRpYWwgZ3JhZGllbnQgZW5kIHJhZGl1c1xuICAgICAqIHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1cygxMDApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IGNvbG9yIHN0b3BzXG4gICAgICogQG5hbWUgZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbG9yU3RvcHNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgY29sb3Igc3RvcHNcbiAgICAgKiB2YXIgY29sb3JTdG9wcyA9IHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHMoKTtcbiAgICAgKlxuICAgICAqIC8vIGNyZWF0ZSBhIHJhZGlhbCBncmFkaWVudCB0aGF0IHN0YXJ0cyB3aXRoIHJlZCwgY2hhbmdlcyB0byBibHVlXG4gICAgICogLy8gaGFsZndheSB0aHJvdWdoLCBhbmQgdGhlbiBjaGFuZ2VzIHRvIGdyZWVuXG4gICAgICogc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wcygwLCAncmVkJywgMC41LCAnYmx1ZScsIDEsICdncmVlbicpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUGF0dGVyblJlcGVhdCcsICdyZXBlYXQnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZmlsbCBwYXR0ZXJuIHJlcGVhdC4gIENhbiBiZSAncmVwZWF0JywgJ3JlcGVhdC14JywgJ3JlcGVhdC15Jywgb3IgJ25vLXJlcGVhdCcuICBUaGUgZGVmYXVsdCBpcyAncmVwZWF0J1xuICAgICAqIEBuYW1lIGZpbGxQYXR0ZXJuUmVwZWF0XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwZWF0XG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIHBhdHRlcm4gcmVwZWF0XG4gICAgICogdmFyIHJlcGVhdCA9IHNoYXBlLmZpbGxQYXR0ZXJuUmVwZWF0KCk7XG4gICAgICpcbiAgICAgKiAvLyByZXBlYXQgcGF0dGVybiBpbiB4IGRpcmVjdGlvbiBvbmx5XG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5SZXBlYXQoJ3JlcGVhdC14Jyk7XG4gICAgICpcbiAgICAgKiAvLyBkbyBub3QgcmVwZWF0IHRoZSBwYXR0ZXJuXG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5SZXBlYXQoJ25vIHJlcGVhdCcpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsRW5hYmxlZCcsIHRydWUpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIGVuYWJsZWQgZmxhZ1xuICAgICAqIEBuYW1lIGZpbGxFbmFibGVkXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVuYWJsZWRcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIGVuYWJsZWQgZmxhZ1xuICAgICAqIHZhciBmaWxsRW5hYmxlZCA9IHNoYXBlLmZpbGxFbmFibGVkKCk7XG4gICAgICpcbiAgICAgKiAvLyBkaXNhYmxlIGZpbGxcbiAgICAgKiBzaGFwZS5maWxsRW5hYmxlZChmYWxzZSk7XG4gICAgICpcbiAgICAgKiAvLyBlbmFibGUgZmlsbFxuICAgICAqIHNoYXBlLmZpbGxFbmFibGVkKHRydWUpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdzdHJva2VFbmFibGVkJywgdHJ1ZSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHN0cm9rZSBlbmFibGVkIGZsYWdcbiAgICAgKiBAbmFtZSBzdHJva2VFbmFibGVkXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVuYWJsZWRcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBzdHJva2UgZW5hYmxlZCBmbGFnXG4gICAgICogdmFyIHN0cm9rZUVuYWJsZWQgPSBzaGFwZS5zdHJva2VFbmFibGVkKCk7XG4gICAgICpcbiAgICAgKiAvLyBkaXNhYmxlIHN0cm9rZVxuICAgICAqIHNoYXBlLnN0cm9rZUVuYWJsZWQoZmFsc2UpO1xuICAgICAqXG4gICAgICogLy8gZW5hYmxlIHN0cm9rZVxuICAgICAqIHNoYXBlLnN0cm9rZUVuYWJsZWQodHJ1ZSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ3NoYWRvd0VuYWJsZWQnLCB0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgc2hhZG93IGVuYWJsZWQgZmxhZ1xuICAgICAqIEBuYW1lIHNoYWRvd0VuYWJsZWRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gZW5hYmxlZFxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHNoYWRvdyBlbmFibGVkIGZsYWdcbiAgICAgKiB2YXIgc2hhZG93RW5hYmxlZCA9IHNoYXBlLnNoYWRvd0VuYWJsZWQoKTtcbiAgICAgKlxuICAgICAqIC8vIGRpc2FibGUgc2hhZG93XG4gICAgICogc2hhcGUuc2hhZG93RW5hYmxlZChmYWxzZSk7XG4gICAgICpcbiAgICAgKiAvLyBlbmFibGUgc2hhZG93XG4gICAgICogc2hhcGUuc2hhZG93RW5hYmxlZCh0cnVlKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZGFzaEVuYWJsZWQnLCB0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZGFzaCBlbmFibGVkIGZsYWdcbiAgICAgKiBAbmFtZSBkYXNoRW5hYmxlZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBlbmFibGVkXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZGFzaCBlbmFibGVkIGZsYWdcbiAgICAgKiB2YXIgZGFzaEVuYWJsZWQgPSBzaGFwZS5kYXNoRW5hYmxlZCgpO1xuICAgICAqXG4gICAgICogLy8gZGlzYWJsZSBkYXNoXG4gICAgICogc2hhcGUuZGFzaEVuYWJsZWQoZmFsc2UpO1xuICAgICAqXG4gICAgICogLy8gZW5hYmxlIGRhc2hcbiAgICAgKiBzaGFwZS5kYXNoRW5hYmxlZCh0cnVlKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnc3Ryb2tlU2NhbGVFbmFibGVkJywgdHJ1ZSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHN0cm9rZVNjYWxlIGVuYWJsZWQgZmxhZ1xuICAgICAqIEBuYW1lIHN0cm9rZVNjYWxlRW5hYmxlZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBlbmFibGVkXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgc3Ryb2tlIHNjYWxlIGVuYWJsZWQgZmxhZ1xuICAgICAqIHZhciBzdHJva2VTY2FsZUVuYWJsZWQgPSBzaGFwZS5zdHJva2VTY2FsZUVuYWJsZWQoKTtcbiAgICAgKlxuICAgICAqIC8vIGRpc2FibGUgc3Ryb2tlIHNjYWxlXG4gICAgICogc2hhcGUuc3Ryb2tlU2NhbGVFbmFibGVkKGZhbHNlKTtcbiAgICAgKlxuICAgICAqIC8vIGVuYWJsZSBzdHJva2Ugc2NhbGVcbiAgICAgKiBzaGFwZS5zdHJva2VTY2FsZUVuYWJsZWQodHJ1ZSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxQcmlvcml0eScsICdjb2xvcicpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHByaW9yaXR5LiAgY2FuIGJlIGNvbG9yLCBwYXR0ZXJuLCBsaW5lYXItZ3JhZGllbnQsIG9yIHJhZGlhbC1ncmFkaWVudC4gIFRoZSBkZWZhdWx0IGlzIGNvbG9yLlxuICAgICAqICAgVGhpcyBpcyBoYW5keSBpZiB5b3Ugd2FudCB0byB0b2dnbGUgYmV0d2VlbiBkaWZmZXJlbnQgZmlsbCB0eXBlcy5cbiAgICAgKiBAbmFtZSBmaWxsUHJpb3JpdHlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcmlvcml0eVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBwcmlvcml0eVxuICAgICAqIHZhciBmaWxsUHJpb3JpdHkgPSBzaGFwZS5maWxsUHJpb3JpdHkoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHByaW9yaXR5XG4gICAgICogc2hhcGUuZmlsbFByaW9yaXR5KCdsaW5lYXItZ3JhZGllbnQnKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxQYXR0ZXJuT2Zmc2V0JywgWyd4JywgJ3knXSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiBvZmZzZXRcbiAgICAgKiBAbmFtZSBmaWxsUGF0dGVybk9mZnNldFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9mZnNldFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvZmZzZXQueFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvZmZzZXQueVxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBwYXR0ZXJuIG9mZnNldFxuICAgICAqIHZhciBwYXR0ZXJuT2Zmc2V0ID0gc2hhcGUuZmlsbFBhdHRlcm5PZmZzZXQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHBhdHRlcm4gb2Zmc2V0XG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5PZmZzZXQoe1xuICAgICAqICAgeDogMjBcbiAgICAgKiAgIHk6IDEwXG4gICAgICogfSk7XG4gICAgICovXG5cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFBhdHRlcm5PZmZzZXRYJywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHBhdHRlcm4gb2Zmc2V0IHhcbiAgICAgKiBAbmFtZSBmaWxsUGF0dGVybk9mZnNldFhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIHBhdHRlcm4gb2Zmc2V0IHhcbiAgICAgKiB2YXIgcGF0dGVybk9mZnNldFggPSBzaGFwZS5maWxsUGF0dGVybk9mZnNldFgoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHBhdHRlcm4gb2Zmc2V0IHhcbiAgICAgKiBzaGFwZS5maWxsUGF0dGVybk9mZnNldFgoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUGF0dGVybk9mZnNldFknLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiBvZmZzZXQgeVxuICAgICAqIEBuYW1lIGZpbGxQYXR0ZXJuT2Zmc2V0WVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcGF0dGVybiBvZmZzZXQgeVxuICAgICAqIHZhciBwYXR0ZXJuT2Zmc2V0WSA9IHNoYXBlLmZpbGxQYXR0ZXJuT2Zmc2V0WSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcGF0dGVybiBvZmZzZXQgeVxuICAgICAqIHNoYXBlLmZpbGxQYXR0ZXJuT2Zmc2V0WSgxMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUGF0dGVyblNjYWxlJywgWyd4JywgJ3knXSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiBzY2FsZVxuICAgICAqIEBuYW1lIGZpbGxQYXR0ZXJuU2NhbGVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY2FsZS54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNjYWxlLnlcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcGF0dGVybiBzY2FsZVxuICAgICAqIHZhciBwYXR0ZXJuU2NhbGUgPSBzaGFwZS5maWxsUGF0dGVyblNjYWxlKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBwYXR0ZXJuIHNjYWxlXG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5TY2FsZSh7XG4gICAgICogICB4OiAyXG4gICAgICogICB5OiAyXG4gICAgICogfSk7XG4gICAgICovXG5cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFBhdHRlcm5TY2FsZVgnLCAxKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcGF0dGVybiBzY2FsZSB4XG4gICAgICogQG5hbWUgZmlsbFBhdHRlcm5TY2FsZVhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIHBhdHRlcm4gc2NhbGUgeFxuICAgICAqIHZhciBwYXR0ZXJuU2NhbGVYID0gc2hhcGUuZmlsbFBhdHRlcm5TY2FsZVgoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHBhdHRlcm4gc2NhbGUgeFxuICAgICAqIHNoYXBlLmZpbGxQYXR0ZXJuU2NhbGVYKDIpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUGF0dGVyblNjYWxlWScsIDEpO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZmlsbCBwYXR0ZXJuIHNjYWxlIHlcbiAgICAgKiBAbmFtZSBmaWxsUGF0dGVyblNjYWxlWVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcGF0dGVybiBzY2FsZSB5XG4gICAgICogdmFyIHBhdHRlcm5TY2FsZVkgPSBzaGFwZS5maWxsUGF0dGVyblNjYWxlWSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcGF0dGVybiBzY2FsZSB5XG4gICAgICogc2hhcGUuZmlsbFBhdHRlcm5TY2FsZVkoMik7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50JywgWyd4JywgJ3knXSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgbGluZWFyIGdyYWRpZW50IHN0YXJ0IHBvaW50XG4gICAgICogQG5hbWUgZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN0YXJ0UG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnRQb2ludC54XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0UG9pbnQueVxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgc3RhcnQgcG9pbnRcbiAgICAgKiB2YXIgc3RhcnRQb2ludCA9IHNoYXBlLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIGxpbmVhciBncmFkaWVudCBzdGFydCBwb2ludFxuICAgICAqIHNoYXBlLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnQoe1xuICAgICAqICAgeDogMjBcbiAgICAgKiAgIHk6IDEwXG4gICAgICogfSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYJywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIGxpbmVhciBncmFkaWVudCBzdGFydCBwb2ludCB4XG4gICAgICogQG5hbWUgZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIGxpbmVhciBncmFkaWVudCBzdGFydCBwb2ludCB4XG4gICAgICogdmFyIHN0YXJ0UG9pbnRYID0gc2hhcGUuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFgoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIGxpbmVhciBncmFkaWVudCBzdGFydCBwb2ludCB4XG4gICAgICogc2hhcGUuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFgoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WScsIDApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeVxuICAgICAqIEBuYW1lIGZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeVxuICAgICAqIHZhciBzdGFydFBvaW50WSA9IHNoYXBlLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeVxuICAgICAqIHNoYXBlLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkQ29tcG9uZW50c0dldHRlclNldHRlcihLb252YS5TaGFwZSwgJ2ZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50JywgWyd4JywgJ3knXSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgbGluZWFyIGdyYWRpZW50IGVuZCBwb2ludFxuICAgICAqIEBuYW1lIGZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZW5kUG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZW5kUG9pbnQueFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlbmRQb2ludC55XG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIGxpbmVhciBncmFkaWVudCBlbmQgcG9pbnRcbiAgICAgKiB2YXIgZW5kUG9pbnQgPSBzaGFwZS5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgbGluZWFyIGdyYWRpZW50IGVuZCBwb2ludFxuICAgICAqIHNoYXBlLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50KHtcbiAgICAgKiAgIHg6IDIwXG4gICAgICogICB5OiAxMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFgnLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgbGluZWFyIGdyYWRpZW50IGVuZCBwb2ludCB4XG4gICAgICogQG5hbWUgZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgZW5kIHBvaW50IHhcbiAgICAgKiB2YXIgZW5kUG9pbnRYID0gc2hhcGUuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgZW5kIHBvaW50IHhcbiAgICAgKiBzaGFwZS5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFgoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFknLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgbGluZWFyIGdyYWRpZW50IGVuZCBwb2ludCB5XG4gICAgICogQG5hbWUgZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgZW5kIHBvaW50IHlcbiAgICAgKiB2YXIgZW5kUG9pbnRZID0gc2hhcGUuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCBsaW5lYXIgZ3JhZGllbnQgZW5kIHBvaW50IHlcbiAgICAgKiBzaGFwZS5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFkoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludCcsIFsneCcsICd5J10pO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHJhZGlhbCBncmFkaWVudCBzdGFydCBwb2ludFxuICAgICAqIEBuYW1lIGZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdGFydFBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0UG9pbnQueFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydFBvaW50LnlcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IHN0YXJ0IHBvaW50XG4gICAgICogdmFyIHN0YXJ0UG9pbnQgPSBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50KCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcG9pbnRcbiAgICAgKiBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50KHtcbiAgICAgKiAgIHg6IDIwXG4gICAgICogICB5OiAxMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WCcsIDApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeFxuICAgICAqIEBuYW1lIGZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TaGFwZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeFxuICAgICAqIHZhciBzdGFydFBvaW50WCA9IHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgc3RhcnQgcG9pbnQgeFxuICAgICAqIHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFknLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IHN0YXJ0IHBvaW50IHlcbiAgICAgKiBAbmFtZSBmaWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IHN0YXJ0IHBvaW50IHlcbiAgICAgKiB2YXIgc3RhcnRQb2ludFkgPSBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IHN0YXJ0IHBvaW50IHlcbiAgICAgKiBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WSgyMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZENvbXBvbmVudHNHZXR0ZXJTZXR0ZXIoS29udmEuU2hhcGUsICdmaWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludCcsIFsneCcsICd5J10pO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHJhZGlhbCBncmFkaWVudCBlbmQgcG9pbnRcbiAgICAgKiBAbmFtZSBmaWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGVuZFBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGVuZFBvaW50LnhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZW5kUG9pbnQueVxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZmlsbCByYWRpYWwgZ3JhZGllbnQgZW5kIHBvaW50XG4gICAgICogdmFyIGVuZFBvaW50ID0gc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmaWxsIHJhZGlhbCBncmFkaWVudCBlbmQgcG9pbnRcbiAgICAgKiBzaGFwZS5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludCh7XG4gICAgICogICB4OiAyMFxuICAgICAqICAgeTogMTBcbiAgICAgKiB9KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYJywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHJhZGlhbCBncmFkaWVudCBlbmQgcG9pbnQgeFxuICAgICAqIEBuYW1lIGZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHhcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IGVuZCBwb2ludCB4XG4gICAgICogdmFyIGVuZFBvaW50WCA9IHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IGVuZCBwb2ludCB4XG4gICAgICogc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZJywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHJhZGlhbCBncmFkaWVudCBlbmQgcG9pbnQgeVxuICAgICAqIEBuYW1lIGZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU2hhcGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHlcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IGVuZCBwb2ludCB5XG4gICAgICogdmFyIGVuZFBvaW50WSA9IHNoYXBlLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcmFkaWFsIGdyYWRpZW50IGVuZCBwb2ludCB5XG4gICAgICogc2hhcGUuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNoYXBlLCAnZmlsbFBhdHRlcm5Sb3RhdGlvbicsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmaWxsIHBhdHRlcm4gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBuYW1lIGZpbGxQYXR0ZXJuUm90YXRpb25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNoYXBlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByb3RhdGlvblxuICAgICAqIEByZXR1cm5zIHtLb252YS5TaGFwZX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmaWxsIHBhdHRlcm4gcm90YXRpb25cbiAgICAgKiB2YXIgcGF0dGVyblJvdGF0aW9uID0gc2hhcGUuZmlsbFBhdHRlcm5Sb3RhdGlvbigpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZpbGwgcGF0dGVybiByb3RhdGlvblxuICAgICAqIHNoYXBlLmZpbGxQYXR0ZXJuUm90YXRpb24oMjApO1xuICAgICAqL1xuXG5cbiAgICBLb252YS5GYWN0b3J5LmJhY2tDb21wYXQoS29udmEuU2hhcGUsIHtcbiAgICAgICAgZGFzaEFycmF5OiAnZGFzaCcsXG4gICAgICAgIGdldERhc2hBcnJheTogJ2dldERhc2gnLFxuICAgICAgICBzZXREYXNoQXJyYXk6ICdnZXREYXNoJyxcblxuICAgICAgICBkcmF3RnVuYzogJ3NjZW5lRnVuYycsXG4gICAgICAgIGdldERyYXdGdW5jOiAnZ2V0U2NlbmVGdW5jJyxcbiAgICAgICAgc2V0RHJhd0Z1bmM6ICdzZXRTY2VuZUZ1bmMnLFxuXG4gICAgICAgIGRyYXdIaXRGdW5jOiAnaGl0RnVuYycsXG4gICAgICAgIGdldERyYXdIaXRGdW5jOiAnZ2V0SGl0RnVuYycsXG4gICAgICAgIHNldERyYXdIaXRGdW5jOiAnc2V0SGl0RnVuYydcbiAgICB9KTtcblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5TaGFwZSk7XG59KShLb252YSk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLy8gQ09OU1RBTlRTXG4gICAgdmFyIFNUQUdFID0gJ1N0YWdlJyxcbiAgICAgICAgU1RSSU5HID0gJ3N0cmluZycsXG4gICAgICAgIFBYID0gJ3B4JyxcblxuICAgICAgICBNT1VTRU9VVCA9ICdtb3VzZW91dCcsXG4gICAgICAgIE1PVVNFTEVBVkUgPSAnbW91c2VsZWF2ZScsXG4gICAgICAgIE1PVVNFT1ZFUiA9ICdtb3VzZW92ZXInLFxuICAgICAgICBNT1VTRUVOVEVSID0gJ21vdXNlZW50ZXInLFxuICAgICAgICBNT1VTRU1PVkUgPSAnbW91c2Vtb3ZlJyxcbiAgICAgICAgTU9VU0VET1dOID0gJ21vdXNlZG93bicsXG4gICAgICAgIE1PVVNFVVAgPSAnbW91c2V1cCcsXG4gICAgICAgIENMSUNLID0gJ2NsaWNrJyxcbiAgICAgICAgREJMX0NMSUNLID0gJ2RibGNsaWNrJyxcbiAgICAgICAgVE9VQ0hTVEFSVCA9ICd0b3VjaHN0YXJ0JyxcbiAgICAgICAgVE9VQ0hFTkQgPSAndG91Y2hlbmQnLFxuICAgICAgICBUQVAgPSAndGFwJyxcbiAgICAgICAgREJMX1RBUCA9ICdkYmx0YXAnLFxuICAgICAgICBUT1VDSE1PVkUgPSAndG91Y2htb3ZlJyxcbiAgICAgICAgRE9NTU9VU0VTQ1JPTEwgPSAnRE9NTW91c2VTY3JvbGwnLFxuICAgICAgICBNT1VTRVdIRUVMID0gJ21vdXNld2hlZWwnLFxuICAgICAgICBXSEVFTCA9ICd3aGVlbCcsXG5cbiAgICAgICAgQ09OVEVOVF9NT1VTRU9VVCA9ICdjb250ZW50TW91c2VvdXQnLFxuICAgICAgICBDT05URU5UX01PVVNFT1ZFUiA9ICdjb250ZW50TW91c2VvdmVyJyxcbiAgICAgICAgQ09OVEVOVF9NT1VTRU1PVkUgPSAnY29udGVudE1vdXNlbW92ZScsXG4gICAgICAgIENPTlRFTlRfTU9VU0VET1dOID0gJ2NvbnRlbnRNb3VzZWRvd24nLFxuICAgICAgICBDT05URU5UX01PVVNFVVAgPSAnY29udGVudE1vdXNldXAnLFxuICAgICAgICBDT05URU5UX0NMSUNLID0gJ2NvbnRlbnRDbGljaycsXG4gICAgICAgIENPTlRFTlRfREJMX0NMSUNLID0gJ2NvbnRlbnREYmxjbGljaycsXG4gICAgICAgIENPTlRFTlRfVE9VQ0hTVEFSVCA9ICdjb250ZW50VG91Y2hzdGFydCcsXG4gICAgICAgIENPTlRFTlRfVE9VQ0hFTkQgPSAnY29udGVudFRvdWNoZW5kJyxcbiAgICAgICAgQ09OVEVOVF9EQkxfVEFQID0gJ2NvbnRlbnREYmx0YXAnLFxuICAgICAgICBDT05URU5UX1RBUCA9ICdjb250ZW50VGFwJyxcbiAgICAgICAgQ09OVEVOVF9UT1VDSE1PVkUgPSAnY29udGVudFRvdWNobW92ZScsXG4gICAgICAgIENPTlRFTlRfV0hFRUwgPSAnY29udGVudFdoZWVsJyxcblxuICAgICAgICBESVYgPSAnZGl2JyxcbiAgICAgICAgUkVMQVRJVkUgPSAncmVsYXRpdmUnLFxuICAgICAgICBLT05WQV9DT05URU5UID0gJ2tvbnZhanMtY29udGVudCcsXG4gICAgICAgIFNQQUNFID0gJyAnLFxuICAgICAgICBVTkRFUlNDT1JFID0gJ18nLFxuICAgICAgICBDT05UQUlORVIgPSAnY29udGFpbmVyJyxcbiAgICAgICAgRU1QVFlfU1RSSU5HID0gJycsXG4gICAgICAgIEVWRU5UUyA9IFtNT1VTRURPV04sIE1PVVNFTU9WRSwgTU9VU0VVUCwgTU9VU0VPVVQsIFRPVUNIU1RBUlQsIFRPVUNITU9WRSwgVE9VQ0hFTkQsIE1PVVNFT1ZFUiwgRE9NTU9VU0VTQ1JPTEwsIE1PVVNFV0hFRUwsIFdIRUVMXSxcblxuICAgICAgICAvLyBjYWNoZWQgdmFyaWFibGVzXG4gICAgICAgIGV2ZW50c0xlbmd0aCA9IEVWRU5UUy5sZW5ndGg7XG5cbiAgICBmdW5jdGlvbiBhZGRFdmVudChjdHgsIGV2ZW50TmFtZSkge1xuICAgICAgICBjdHguY29udGVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICBjdHhbVU5ERVJTQ09SRSArIGV2ZW50TmFtZV0oZXZ0KTtcbiAgICAgICAgfSwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YWdlIGNvbnN0cnVjdG9yLiAgQSBzdGFnZSBpcyB1c2VkIHRvIGNvbnRhaW4gbXVsdGlwbGUgbGF5ZXJzXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLkNvbnRhaW5lclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xFbGVtZW50fSBjb25maWcuY29udGFpbmVyIENvbnRhaW5lciBzZWxlY3RvciBvciBET00gZWxlbWVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgc3RhZ2UgPSBuZXcgS29udmEuU3RhZ2Uoe1xuICAgICAgICAgKiAgIHdpZHRoOiA1MDAsXG4gICAgICAgICAqICAgaGVpZ2h0OiA4MDAsXG4gICAgICAgICAqICAgY29udGFpbmVyOiAnY29udGFpbmVySWQnIC8vIG9yIFwiI2NvbnRhaW5lcklkXCIgb3IgXCIuY29udGFpbmVyQ2xhc3NcIlxuICAgICAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5TdGFnZSA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuVXRpbC5hZGRNZXRob2RzKEtvbnZhLlN0YWdlLCB7XG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5ub2RlVHlwZSA9IFNUQUdFO1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuQ29udGFpbmVyLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuX2lkID0gS29udmEuaWRDb3VudGVyKys7XG4gICAgICAgICAgICB0aGlzLl9idWlsZERPTSgpO1xuICAgICAgICAgICAgdGhpcy5fYmluZENvbnRlbnRFdmVudHMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZU5lc3RlZFRyYW5zZm9ybXMgPSBmYWxzZTtcbiAgICAgICAgICAgIEtvbnZhLnN0YWdlcy5wdXNoKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBfdmFsaWRhdGVBZGQ6IGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQuZ2V0VHlwZSgpICE9PSAnTGF5ZXInKSB7XG4gICAgICAgICAgICAgICAgS29udmEuVXRpbC50aHJvdygnWW91IG1heSBvbmx5IGFkZCBsYXllcnMgdG8gdGhlIHN0YWdlLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IGNvbnRhaW5lciBkb20gZWxlbWVudCB3aGljaCBjb250YWlucyB0aGUgc3RhZ2Ugd3JhcHBlciBkaXYgZWxlbWVudFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtEb21FbGVtZW50fSBjb250YWluZXIgY2FuIHBhc3MgaW4gYSBkb20gZWxlbWVudCBvciBpZCBzdHJpbmdcbiAgICAgICAgICovXG4gICAgICAgIHNldENvbnRhaW5lcjogZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250YWluZXIgPT09IFNUUklORykge1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuY2hhckF0KDApID09PSAnLicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IGNvbnRhaW5lci5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gS29udmEuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc05hbWUpWzBdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5jaGFyQXQoMCkgIT09ICcjJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBjb250YWluZXI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGNvbnRhaW5lci5zbGljZSgxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSBLb252YS5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93ICdDYW4gbm90IGZpbmQgY29udGFpbmVyIGluIGRvY3VtZW50IHdpdGggaWQgJyArIGlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3NldEF0dHIoQ09OVEFJTkVSLCBjb250YWluZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNob3VsZERyYXdIaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuZHJhdy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBkcmF3IGxheWVyIHNjZW5lIGdyYXBoc1xuICAgICAgICAgKiBAbmFtZSBkcmF3XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAgICAgKi9cblxuICAgICAgICAvKipcbiAgICAgICAgICogZHJhdyBsYXllciBoaXQgZ3JhcGhzXG4gICAgICAgICAqIEBuYW1lIGRyYXdIaXRcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU3RhZ2UucHJvdG90eXBlXG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgaGVpZ2h0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaGVpZ2h0XG4gICAgICAgICAqL1xuICAgICAgICBzZXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0SGVpZ2h0LmNhbGwodGhpcywgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZURPTSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgd2lkdGhcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU3RhZ2UucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSB3aWR0aFxuICAgICAgICAgKi9cbiAgICAgICAgc2V0V2lkdGg6IGZ1bmN0aW9uKHdpZHRoKSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRXaWR0aC5jYWxsKHRoaXMsIHdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZURPTSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjbGVhciBhbGwgbGF5ZXJzXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGxheWVycyA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgbGVuID0gbGF5ZXJzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBuO1xuXG4gICAgICAgICAgICBmb3IobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIGxheWVyc1tuXS5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb25lOiBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIGlmICghb2JqKSB7XG4gICAgICAgICAgICAgICAgb2JqID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmouY29udGFpbmVyID0gS29udmEuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChESVYpO1xuICAgICAgICAgICAgcmV0dXJuIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGUuY2xvbmUuY2FsbCh0aGlzLCBvYmopO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGVzdHJveSBzdGFnZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQ7XG4gICAgICAgICAgICBLb252YS5Db250YWluZXIucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgaWYoY29udGVudCAmJiBLb252YS5VdGlsLl9pc0luRG9jdW1lbnQoY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldENvbnRhaW5lcigpLnJlbW92ZUNoaWxkKGNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gS29udmEuc3RhZ2VzLmluZGV4T2YodGhpcyk7XG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgIEtvbnZhLnN0YWdlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgcG9pbnRlciBwb3NpdGlvbiB3aGljaCBjYW4gYmUgYSB0b3VjaCBwb3NpdGlvbiBvciBtb3VzZSBwb3NpdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIGdldFBvaW50ZXJQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wb2ludGVyUG9zO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTdGFnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCBzdGFnZSBjb250ZW50IGRpdiBlbGVtZW50IHdoaWNoIGhhcyB0aGVcbiAgICAgICAgICogIHRoZSBjbGFzcyBuYW1lIFwia29udmFqcy1jb250ZW50XCJcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU3RhZ2UucHJvdG90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBnZXRDb250ZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGVzIGEgY29tcG9zaXRlIGRhdGEgVVJMXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuY2FsbGJhY2tdIGZ1bmN0aW9uIGV4ZWN1dGVkIHdoZW4gdGhlIGNvbXBvc2l0ZSBoYXMgY29tcGxldGVkLiBEZXByZWNhdGVkIGFzIG1ldGhvZCBpcyBzeW5jIG5vdy5cbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubWltZVR5cGVdIGNhbiBiZSBcImltYWdlL3BuZ1wiIG9yIFwiaW1hZ2UvanBlZ1wiLlxuICAgICAgICAgKiAgXCJpbWFnZS9wbmdcIiBpcyB0aGUgZGVmYXVsdFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XSB4IHBvc2l0aW9uIG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldIHkgcG9zaXRpb24gb2YgY2FudmFzIHNlY3Rpb25cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdIHdpZHRoIG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF0gaGVpZ2h0IG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnF1YWxpdHldIGpwZWcgcXVhbGl0eS4gIElmIHVzaW5nIGFuIFwiaW1hZ2UvanBlZ1wiIG1pbWVUeXBlLFxuICAgICAgICAgKiAgeW91IGNhbiBzcGVjaWZ5IHRoZSBxdWFsaXR5IGZyb20gMCB0byAxLCB3aGVyZSAwIGlzIHZlcnkgcG9vciBxdWFsaXR5IGFuZCAxXG4gICAgICAgICAqICBpcyB2ZXJ5IGhpZ2ggcXVhbGl0eVxuICAgICAgICAgKi9cbiAgICAgICAgdG9EYXRhVVJMOiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcblxuICAgICAgICAgICAgdmFyIG1pbWVUeXBlID0gY29uZmlnLm1pbWVUeXBlIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgcXVhbGl0eSA9IGNvbmZpZy5xdWFsaXR5IHx8IG51bGwsXG4gICAgICAgICAgICAgICAgeCA9IGNvbmZpZy54IHx8IDAsXG4gICAgICAgICAgICAgICAgeSA9IGNvbmZpZy55IHx8IDAsXG4gICAgICAgICAgICAgICAgY2FudmFzID0gbmV3IEtvbnZhLlNjZW5lQ2FudmFzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGNvbmZpZy53aWR0aCB8fCB0aGlzLmdldFdpZHRoKCksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogY29uZmlnLmhlaWdodCB8fCB0aGlzLmdldEhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBwaXhlbFJhdGlvOiBjb25maWcucGl4ZWxSYXRpb1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIF9jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoKS5fY29udGV4dCxcbiAgICAgICAgICAgICAgICBsYXllcnMgPSB0aGlzLmNoaWxkcmVuO1xuXG4gICAgICAgICAgICBpZih4IHx8IHkpIHtcbiAgICAgICAgICAgICAgICBfY29udGV4dC50cmFuc2xhdGUoLTEgKiB4LCAtMSAqIHkpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGxheWVycy5lYWNoKGZ1bmN0aW9uKGxheWVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gbGF5ZXIuZ2V0Q2FudmFzKCkuZ2V0V2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gbGF5ZXIuZ2V0Q2FudmFzKCkuZ2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHJhdGlvID0gbGF5ZXIuZ2V0Q2FudmFzKCkuZ2V0UGl4ZWxSYXRpbygpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0LmRyYXdJbWFnZShsYXllci5nZXRDYW52YXMoKS5fY2FudmFzLCAwLCAwLCB3aWR0aCAvIHJhdGlvLCBoZWlnaHQgLyByYXRpbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBzcmMgPSBjYW52YXMudG9EYXRhVVJMKG1pbWVUeXBlLCBxdWFsaXR5KTtcblxuICAgICAgICAgICAgaWYgKGNvbmZpZy5jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5jYWxsYmFjayhzcmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3JjO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogY29udmVydHMgc3RhZ2UgaW50byBhbiBpbWFnZS5cbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuU3RhZ2UucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29uZmlnLmNhbGxiYWNrIGZ1bmN0aW9uIGV4ZWN1dGVkIHdoZW4gdGhlIGNvbXBvc2l0ZSBoYXMgY29tcGxldGVkXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm1pbWVUeXBlXSBjYW4gYmUgXCJpbWFnZS9wbmdcIiBvciBcImltYWdlL2pwZWdcIi5cbiAgICAgICAgICogIFwiaW1hZ2UvcG5nXCIgaXMgdGhlIGRlZmF1bHRcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF0geCBwb3NpdGlvbiBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XSB5IHBvc2l0aW9uIG9mIGNhbnZhcyBzZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXSB3aWR0aCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdIGhlaWdodCBvZiBjYW52YXMgc2VjdGlvblxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5xdWFsaXR5XSBqcGVnIHF1YWxpdHkuICBJZiB1c2luZyBhbiBcImltYWdlL2pwZWdcIiBtaW1lVHlwZSxcbiAgICAgICAgICogIHlvdSBjYW4gc3BlY2lmeSB0aGUgcXVhbGl0eSBmcm9tIDAgdG8gMSwgd2hlcmUgMCBpcyB2ZXJ5IHBvb3IgcXVhbGl0eSBhbmQgMVxuICAgICAgICAgKiAgaXMgdmVyeSBoaWdoIHF1YWxpdHlcbiAgICAgICAgICovXG4gICAgICAgIHRvSW1hZ2U6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdmFyIGNiID0gY29uZmlnLmNhbGxiYWNrO1xuXG4gICAgICAgICAgICBjb25maWcuY2FsbGJhY2sgPSBmdW5jdGlvbihkYXRhVXJsKSB7XG4gICAgICAgICAgICAgICAgS29udmEuVXRpbC5fZ2V0SW1hZ2UoZGF0YVVybCwgZnVuY3Rpb24oaW1nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKGltZyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy50b0RhdGFVUkwoY29uZmlnKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB2aXNpYmxlIGludGVyc2VjdGlvbiBzaGFwZS4gVGhpcyBpcyB0aGUgcHJlZmVycmVkXG4gICAgICAgICAqICBtZXRob2QgZm9yIGRldGVybWluaW5nIGlmIGEgcG9pbnQgaW50ZXJzZWN0cyBhIHNoYXBlIG9yIG5vdFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBvc1xuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9zLnhcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy55XG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc2VsZWN0b3JdXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiB2YXIgc2hhcGUgPSBzdGFnZS5nZXRJbnRlcnNlY3Rpb24oe3g6IDUwLCB5OiA1MH0pO1xuICAgICAgICAgKiAvLyBvciBpZiB5b3UgaW50ZXJlc3RlZCBpbiBzaGFwZSBwYXJlbnQ6XG4gICAgICAgICAqIHZhciBncm91cCA9IHN0YWdlLmdldEludGVyc2VjdGlvbih7eDogNTAsIHk6IDUwfSwgJ0dyb3VwJyk7XG4gICAgICAgICAqL1xuICAgICAgICBnZXRJbnRlcnNlY3Rpb246IGZ1bmN0aW9uKHBvcywgc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHZhciBsYXllcnMgPSB0aGlzLmdldENoaWxkcmVuKCksXG4gICAgICAgICAgICAgICAgbGVuID0gbGF5ZXJzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBlbmQgPSBsZW4gLSAxLFxuICAgICAgICAgICAgICAgIG4sIHNoYXBlO1xuXG4gICAgICAgICAgICBmb3IobiA9IGVuZDsgbiA+PSAwOyBuLS0pIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IGxheWVyc1tuXS5nZXRJbnRlcnNlY3Rpb24ocG9zLCBzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBfcmVzaXplRE9NOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKHRoaXMuY29udGVudCkge1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKSxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXJzID0gdGhpcy5nZXRDaGlsZHJlbigpLFxuICAgICAgICAgICAgICAgICAgICBsZW4gPSBsYXllcnMubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBuLCBsYXllcjtcblxuICAgICAgICAgICAgICAgIC8vIHNldCBjb250ZW50IGRpbWVuc2lvbnNcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQuc3R5bGUud2lkdGggPSB3aWR0aCArIFBYO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBQWDtcblxuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyQ2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5idWZmZXJIaXRDYW52YXMuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgICAgICAgICAgIC8vIHNldCBsYXllciBkaW1lbnNpb25zXG4gICAgICAgICAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSBsYXllcnNbbl07XG4gICAgICAgICAgICAgICAgICAgIGxheWVyLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyLmRyYXcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBhZGQgbGF5ZXIgb3IgbGF5ZXJzIHRvIHN0YWdlXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0gey4uLktvbnZhLkxheWVyfSBsYXllclxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBzdGFnZS5hZGQobGF5ZXIxLCBsYXllcjIsIGxheWVyMyk7XG4gICAgICAgICAqL1xuICAgICAgICBhZGQ6IGZ1bmN0aW9uKGxheWVyKSB7XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZChhcmd1bWVudHNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGUuYWRkLmNhbGwodGhpcywgbGF5ZXIpO1xuICAgICAgICAgICAgbGF5ZXIuX3NldENhbnZhc1NpemUodGhpcy53aWR0aCgpLCB0aGlzLmhlaWdodCgpKTtcblxuICAgICAgICAgICAgLy8gZHJhdyBsYXllciBhbmQgYXBwZW5kIGNhbnZhcyB0byBjb250YWluZXJcbiAgICAgICAgICAgIGxheWVyLmRyYXcoKTtcbiAgICAgICAgICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZChsYXllci5jYW52YXMuX2NhbnZhcyk7XG5cbiAgICAgICAgICAgIC8vIGNoYWluYWJsZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBhcmVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0TGF5ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm5zIGEge0BsaW5rIEtvbnZhLkNvbGxlY3Rpb259IG9mIGxheWVyc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGdldExheWVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZHJlbigpO1xuICAgICAgICB9LFxuICAgICAgICBfYmluZENvbnRlbnRFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBldmVudHNMZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgICAgIGFkZEV2ZW50KHRoaXMsIEVWRU5UU1tuXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9tb3VzZW92ZXI6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgaWYgKCFLb252YS5VQS5tb2JpbGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRQb2ludGVyUG9zaXRpb24oZXZ0KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFTlRfTU9VU0VPVkVSLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX21vdXNlb3V0OiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIGlmICghS29udmEuVUEubW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0UG9pbnRlclBvc2l0aW9uKGV2dCk7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldFNoYXBlID0gdGhpcy50YXJnZXRTaGFwZTtcblxuICAgICAgICAgICAgICAgIGlmKHRhcmdldFNoYXBlICYmICFLb252YS5pc0RyYWdnaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U2hhcGUuX2ZpcmVBbmRCdWJibGUoTU9VU0VPVVQsIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRUxFQVZFLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRTaGFwZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucG9pbnRlclBvcyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmUoQ09OVEVOVF9NT1VTRU9VVCwge2V2dDogZXZ0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9tb3VzZW1vdmU6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgbW9iaWxlIElFIHRvIGZvcmNlIHRvdWNoIGV2ZW50IHdoZW4gdW5oYW5kbGVkIHBvaW50ZXIgZXZlbnQgZWxldmF0ZXMgaW50byBhIG1vdXNlIGV2ZW50XG4gICAgICAgICAgICBpZiAoS29udmEuVUEuaWVNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdG91Y2htb3ZlKGV2dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB3b3JrYXJvdW5kIGZha2UgbW91c2Vtb3ZlIGV2ZW50IGluIGNocm9tZSBicm93c2VyIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0xNjE0NjRcbiAgICAgICAgICAgIGlmICgodHlwZW9mIGV2dC5tb3ZlbWVudFggIT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBldnQubW92ZW1lbnRZICE9PSAndW5kZWZpbmVkJykgJiYgZXZ0Lm1vdmVtZW50WSA9PT0gMCAmJiBldnQubW92ZW1lbnRYID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoS29udmEuVUEubW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zZXRQb2ludGVyUG9zaXRpb24oZXZ0KTtcbiAgICAgICAgICAgIHZhciBzaGFwZTtcblxuICAgICAgICAgICAgaWYgKCFLb252YS5pc0RyYWdnaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IHRoaXMuZ2V0SW50ZXJzZWN0aW9uKHRoaXMuZ2V0UG9pbnRlclBvc2l0aW9uKCkpO1xuICAgICAgICAgICAgICAgIGlmKHNoYXBlICYmIHNoYXBlLmlzTGlzdGVuaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoIUtvbnZhLmlzRHJhZ2dpbmcoKSAmJiAoIXRoaXMudGFyZ2V0U2hhcGUgfHwgdGhpcy50YXJnZXRTaGFwZS5faWQgIT09IHNoYXBlLl9pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMudGFyZ2V0U2hhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFNoYXBlLl9maXJlQW5kQnViYmxlKE1PVVNFT1VULCB7ZXZ0OiBldnR9LCBzaGFwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRTaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRUxFQVZFLCB7ZXZ0OiBldnR9LCBzaGFwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRU9WRVIsIHtldnQ6IGV2dH0sIHRoaXMudGFyZ2V0U2hhcGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoTU9VU0VFTlRFUiwge2V2dDogZXZ0fSwgdGhpcy50YXJnZXRTaGFwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFNoYXBlID0gc2hhcGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRU1PVkUsIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogaWYgbm8gc2hhcGUgd2FzIGRldGVjdGVkLCBjbGVhciB0YXJnZXQgc2hhcGUgYW5kIHRyeVxuICAgICAgICAgICAgICAgICAqIHRvIHJ1biBtb3VzZW91dCBmcm9tIHByZXZpb3VzIHRhcmdldCBzaGFwZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnRhcmdldFNoYXBlICYmICFLb252YS5pc0RyYWdnaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0U2hhcGUuX2ZpcmVBbmRCdWJibGUoTU9VU0VPVVQsIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRTaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRUxFQVZFLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0U2hhcGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBjb250ZW50IGV2ZW50XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZShDT05URU5UX01PVVNFTU9WRSwge2V2dDogZXZ0fSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFsd2F5cyBjYWxsIHByZXZlbnREZWZhdWx0IGZvciBkZXNrdG9wIGV2ZW50cyBiZWNhdXNlIHNvbWUgYnJvd3NlcnNcbiAgICAgICAgICAgIC8vIHRyeSB0byBkcmFnIGFuZCBkcm9wIHRoZSBjYW52YXMgZWxlbWVudFxuICAgICAgICAgICAgaWYgKGV2dC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfbW91c2Vkb3duOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIC8vIHdvcmthcm91bmQgZm9yIG1vYmlsZSBJRSB0byBmb3JjZSB0b3VjaCBldmVudCB3aGVuIHVuaGFuZGxlZCBwb2ludGVyIGV2ZW50IGVsZXZhdGVzIGludG8gYSBtb3VzZSBldmVudFxuICAgICAgICAgICAgaWYgKEtvbnZhLlVBLmllTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RvdWNoc3RhcnQoZXZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghS29udmEuVUEubW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0UG9pbnRlclBvc2l0aW9uKGV2dCk7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXBlID0gdGhpcy5nZXRJbnRlcnNlY3Rpb24odGhpcy5nZXRQb2ludGVyUG9zaXRpb24oKSk7XG5cbiAgICAgICAgICAgICAgICBLb252YS5saXN0ZW5DbGlja1RhcCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2hhcGUgJiYgc2hhcGUuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrU3RhcnRTaGFwZSA9IHNoYXBlO1xuICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRURPV04sIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGNvbnRlbnQgZXZlbnRcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFTlRfTU9VU0VET1dOLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWx3YXlzIGNhbGwgcHJldmVudERlZmF1bHQgZm9yIGRlc2t0b3AgZXZlbnRzIGJlY2F1c2Ugc29tZSBicm93c2Vyc1xuICAgICAgICAgICAgLy8gdHJ5IHRvIGRyYWcgYW5kIGRyb3AgdGhlIGNhbnZhcyBlbGVtZW50XG4gICAgICAgICAgICBpZiAoZXZ0LnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9tb3VzZXVwOiBmdW5jdGlvbihldnQpIHtcblxuICAgICAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgbW9iaWxlIElFIHRvIGZvcmNlIHRvdWNoIGV2ZW50IHdoZW4gdW5oYW5kbGVkIHBvaW50ZXIgZXZlbnQgZWxldmF0ZXMgaW50byBhIG1vdXNlIGV2ZW50XG4gICAgICAgICAgICBpZiAoS29udmEuVUEuaWVNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdG91Y2hlbmQoZXZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghS29udmEuVUEubW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0UG9pbnRlclBvc2l0aW9uKGV2dCk7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXBlID0gdGhpcy5nZXRJbnRlcnNlY3Rpb24odGhpcy5nZXRQb2ludGVyUG9zaXRpb24oKSksXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrU3RhcnRTaGFwZSA9IHRoaXMuY2xpY2tTdGFydFNoYXBlLFxuICAgICAgICAgICAgICAgICAgICBmaXJlRGJsQ2xpY2sgPSBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZGQgPSBLb252YS5ERDtcblxuICAgICAgICAgICAgICAgIGlmKEtvbnZhLmluRGJsQ2xpY2tXaW5kb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyZURibENsaWNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuaW5EYmxDbGlja1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBkb24ndCBzZXQgaW5EYmxDbGlja1dpbmRvdyBhZnRlciBkcmFnZ2luZ1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFkZCB8fCAhZGQuanVzdERyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgS29udmEuaW5EYmxDbGlja1dpbmRvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZCkge1xuICAgICAgICAgICAgICAgICAgICBkZC5qdXN0RHJhZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIEtvbnZhLmluRGJsQ2xpY2tXaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LCBLb252YS5kYmxDbGlja1dpbmRvdyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2hhcGUgJiYgc2hhcGUuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShNT1VTRVVQLCB7ZXZ0OiBldnR9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBkZXRlY3QgaWYgY2xpY2sgb3IgZG91YmxlIGNsaWNrIG9jY3VycmVkXG4gICAgICAgICAgICAgICAgICAgIGlmKEtvbnZhLmxpc3RlbkNsaWNrVGFwICYmIGNsaWNrU3RhcnRTaGFwZSAmJiBjbGlja1N0YXJ0U2hhcGUuX2lkID09PSBzaGFwZS5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKENMSUNLLCB7ZXZ0OiBldnR9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZmlyZURibENsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoREJMX0NMSUNLLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBjb250ZW50IGV2ZW50c1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmUoQ09OVEVOVF9NT1VTRVVQLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICBpZiAoS29udmEubGlzdGVuQ2xpY2tUYXApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlyZShDT05URU5UX0NMSUNLLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYoZmlyZURibENsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFTlRfREJMX0NMSUNLLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIEtvbnZhLmxpc3RlbkNsaWNrVGFwID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFsd2F5cyBjYWxsIHByZXZlbnREZWZhdWx0IGZvciBkZXNrdG9wIGV2ZW50cyBiZWNhdXNlIHNvbWUgYnJvd3NlcnNcbiAgICAgICAgICAgIC8vIHRyeSB0byBkcmFnIGFuZCBkcm9wIHRoZSBjYW52YXMgZWxlbWVudFxuICAgICAgICAgICAgaWYgKGV2dC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfdG91Y2hzdGFydDogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRQb2ludGVyUG9zaXRpb24oZXZ0KTtcbiAgICAgICAgICAgIHZhciBzaGFwZSA9IHRoaXMuZ2V0SW50ZXJzZWN0aW9uKHRoaXMuZ2V0UG9pbnRlclBvc2l0aW9uKCkpO1xuXG4gICAgICAgICAgICBLb252YS5saXN0ZW5DbGlja1RhcCA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChzaGFwZSAmJiBzaGFwZS5pc0xpc3RlbmluZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50YXBTdGFydFNoYXBlID0gc2hhcGU7XG4gICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoVE9VQ0hTVEFSVCwge2V2dDogZXZ0fSk7XG5cbiAgICAgICAgICAgICAgICAvLyBvbmx5IGNhbGwgcHJldmVudERlZmF1bHQgaWYgdGhlIHNoYXBlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlLmlzTGlzdGVuaW5nKCkgJiYgc2hhcGUucHJldmVudERlZmF1bHQoKSAmJiBldnQucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY29udGVudCBldmVudFxuICAgICAgICAgICAgdGhpcy5fZmlyZShDT05URU5UX1RPVUNIU1RBUlQsIHtldnQ6IGV2dH0pO1xuICAgICAgICB9LFxuICAgICAgICBfdG91Y2hlbmQ6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgdGhpcy5fc2V0UG9pbnRlclBvc2l0aW9uKGV2dCk7XG4gICAgICAgICAgICB2YXIgc2hhcGUgPSB0aGlzLmdldEludGVyc2VjdGlvbih0aGlzLmdldFBvaW50ZXJQb3NpdGlvbigpKSxcbiAgICAgICAgICAgICAgICBmaXJlRGJsQ2xpY2sgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYoS29udmEuaW5EYmxDbGlja1dpbmRvdykge1xuICAgICAgICAgICAgICAgIGZpcmVEYmxDbGljayA9IHRydWU7XG4gICAgICAgICAgICAgICAgS29udmEuaW5EYmxDbGlja1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgS29udmEuaW5EYmxDbGlja1dpbmRvdyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgS29udmEuaW5EYmxDbGlja1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgS29udmEuZGJsQ2xpY2tXaW5kb3cpO1xuXG4gICAgICAgICAgICBpZiAoc2hhcGUgJiYgc2hhcGUuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKFRPVUNIRU5ELCB7ZXZ0OiBldnR9KTtcblxuICAgICAgICAgICAgICAgIC8vIGRldGVjdCBpZiB0YXAgb3IgZG91YmxlIHRhcCBvY2N1cnJlZFxuICAgICAgICAgICAgICAgIGlmKEtvbnZhLmxpc3RlbkNsaWNrVGFwICYmIHRoaXMudGFwU3RhcnRTaGFwZSAmJiBzaGFwZS5faWQgPT09IHRoaXMudGFwU3RhcnRTaGFwZS5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoVEFQLCB7ZXZ0OiBldnR9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZihmaXJlRGJsQ2xpY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXBlLl9maXJlQW5kQnViYmxlKERCTF9UQVAsIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIG9ubHkgY2FsbCBwcmV2ZW50RGVmYXVsdCBpZiB0aGUgc2hhcGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGUuaXNMaXN0ZW5pbmcoKSAmJiBzaGFwZS5wcmV2ZW50RGVmYXVsdCgpICYmIGV2dC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjb250ZW50IGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5fZmlyZShDT05URU5UX1RPVUNIRU5ELCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgIGlmIChLb252YS5saXN0ZW5DbGlja1RhcCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmUoQ09OVEVOVF9UQVAsIHtldnQ6IGV2dH0pO1xuICAgICAgICAgICAgICAgIGlmKGZpcmVEYmxDbGljaykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFTlRfREJMX1RBUCwge2V2dDogZXZ0fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBLb252YS5saXN0ZW5DbGlja1RhcCA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBfdG91Y2htb3ZlOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFBvaW50ZXJQb3NpdGlvbihldnQpO1xuICAgICAgICAgICAgdmFyIGRkID0gS29udmEuREQsXG4gICAgICAgICAgICAgICAgc2hhcGU7XG4gICAgICAgICAgICBpZiAoIUtvbnZhLmlzRHJhZ2dpbmcoKSkge1xuICAgICAgICAgICAgICAgIHNoYXBlID0gdGhpcy5nZXRJbnRlcnNlY3Rpb24odGhpcy5nZXRQb2ludGVyUG9zaXRpb24oKSk7XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlICYmIHNoYXBlLmlzTGlzdGVuaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hhcGUuX2ZpcmVBbmRCdWJibGUoVE9VQ0hNT1ZFLCB7ZXZ0OiBldnR9KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBjYWxsIHByZXZlbnREZWZhdWx0IGlmIHRoZSBzaGFwZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcGUuaXNMaXN0ZW5pbmcoKSAmJiBzaGFwZS5wcmV2ZW50RGVmYXVsdCgpICYmIGV2dC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZShDT05URU5UX1RPVUNITU9WRSwge2V2dDogZXZ0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihkZCkge1xuICAgICAgICAgICAgICAgIGlmIChLb252YS5pc0RyYWdnaW5nKCkgJiYgS29udmEuREQubm9kZS5wcmV2ZW50RGVmYXVsdCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX0RPTU1vdXNlU2Nyb2xsOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNld2hlZWwoZXZ0KTtcbiAgICAgICAgfSxcbiAgICAgICAgX21vdXNld2hlZWw6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgdGhpcy5fc2V0UG9pbnRlclBvc2l0aW9uKGV2dCk7XG4gICAgICAgICAgICB2YXIgc2hhcGUgPSB0aGlzLmdldEludGVyc2VjdGlvbih0aGlzLmdldFBvaW50ZXJQb3NpdGlvbigpKTtcblxuICAgICAgICAgICAgaWYgKHNoYXBlICYmIHNoYXBlLmlzTGlzdGVuaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBzaGFwZS5fZmlyZUFuZEJ1YmJsZShXSEVFTCwge2V2dDogZXZ0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9maXJlKENPTlRFTlRfV0hFRUwsIHtldnQ6IGV2dH0pO1xuICAgICAgICB9LFxuICAgICAgICBfd2hlZWw6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgdGhpcy5fbW91c2V3aGVlbChldnQpO1xuICAgICAgICB9LFxuICAgICAgICBfc2V0UG9pbnRlclBvc2l0aW9uOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50UG9zaXRpb24gPSB0aGlzLl9nZXRDb250ZW50UG9zaXRpb24oKSxcbiAgICAgICAgICAgICAgICB4ID0gbnVsbCxcbiAgICAgICAgICAgICAgICB5ID0gbnVsbDtcbiAgICAgICAgICAgIGV2dCA9IGV2dCA/IGV2dCA6IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgLy8gdG91Y2ggZXZlbnRzXG4gICAgICAgICAgICBpZihldnQudG91Y2hlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gY3VycmVudGx5LCBvbmx5IGhhbmRsZSBvbmUgZmluZ2VyXG4gICAgICAgICAgICAgICAgaWYgKGV2dC50b3VjaGVzLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdG91Y2ggPSBldnQudG91Y2hlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBpbmZvcm1hdGlvbiBmb3IgZmluZ2VyICMxXG4gICAgICAgICAgICAgICAgICAgIHggPSB0b3VjaC5jbGllbnRYIC0gY29udGVudFBvc2l0aW9uLmxlZnQ7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB0b3VjaC5jbGllbnRZIC0gY29udGVudFBvc2l0aW9uLnRvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtb3VzZSBldmVudHNcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHggPSBldnQuY2xpZW50WCAtIGNvbnRlbnRQb3NpdGlvbi5sZWZ0O1xuICAgICAgICAgICAgICAgIHkgPSBldnQuY2xpZW50WSAtIGNvbnRlbnRQb3NpdGlvbi50b3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCAhPT0gbnVsbCAmJiB5ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludGVyUG9zID0ge1xuICAgICAgICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICAgICAgICB5OiB5XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldENvbnRlbnRQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcmVjdCA9IHRoaXMuY29udGVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgPyB0aGlzLmNvbnRlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7IHRvcDogMCwgbGVmdDogMCB9O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0b3A6IHJlY3QudG9wLFxuICAgICAgICAgICAgICAgIGxlZnQ6IHJlY3QubGVmdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgX2J1aWxkRE9NOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLmdldENvbnRhaW5lcigpO1xuICAgICAgICAgICAgaWYgKCFjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoS29udmEuVXRpbC5pc0Jyb3dzZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyAnU3RhZ2UgaGFzIG5vIGNvbnRhaW5lci4gQSBjb250YWluZXIgaXMgcmVxdWlyZWQuJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IGNyZWF0ZSBlbGVtZW50IGZvciBqc2RvbSBpbiBub2RlanMgZW52XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IEtvbnZhLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoRElWKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjbGVhciBjb250ZW50IGluc2lkZSBjb250YWluZXJcbiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBFTVBUWV9TVFJJTkc7XG5cbiAgICAgICAgICAgIC8vIGNvbnRlbnRcbiAgICAgICAgICAgIHRoaXMuY29udGVudCA9IEtvbnZhLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoRElWKTtcbiAgICAgICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5wb3NpdGlvbiA9IFJFTEFUSVZFO1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LmNsYXNzTmFtZSA9IEtPTlZBX0NPTlRFTlQ7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3ByZXNlbnRhdGlvbicpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG5cbiAgICAgICAgICAgIC8vIHRoZSBidWZmZXIgY2FudmFzIHBpeGVsIHJhdGlvIG11c3QgYmUgMSBiZWNhdXNlIGl0IGlzIHVzZWQgYXMgYW5cbiAgICAgICAgICAgIC8vIGludGVybWVkaWF0ZSBjYW52YXMgYmVmb3JlIGNvcHlpbmcgdGhlIHJlc3VsdCBvbnRvIGEgc2NlbmUgY2FudmFzLlxuICAgICAgICAgICAgLy8gbm90IHNldHRpbmcgaXQgdG8gMSB3aWxsIHJlc3VsdCBpbiBhbiBvdmVyIGNvbXBlbnNhdGlvblxuICAgICAgICAgICAgdGhpcy5idWZmZXJDYW52YXMgPSBuZXcgS29udmEuU2NlbmVDYW52YXMoKTtcbiAgICAgICAgICAgIHRoaXMuYnVmZmVySGl0Q2FudmFzID0gbmV3IEtvbnZhLkhpdENhbnZhcyh7cGl4ZWxSYXRpbzogMX0pO1xuXG4gICAgICAgICAgICB0aGlzLl9yZXNpemVET00oKTtcbiAgICAgICAgfSxcbiAgICAgICAgX29uQ29udGVudDogZnVuY3Rpb24odHlwZXNTdHIsIGhhbmRsZXIpIHtcbiAgICAgICAgICAgIHZhciB0eXBlcyA9IHR5cGVzU3RyLnNwbGl0KFNQQUNFKSxcbiAgICAgICAgICAgICAgICBsZW4gPSB0eXBlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgbiwgYmFzZUV2ZW50O1xuXG4gICAgICAgICAgICBmb3IobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIGJhc2VFdmVudCA9IHR5cGVzW25dO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudC5hZGRFdmVudExpc3RlbmVyKGJhc2VFdmVudCwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBjdXJyZW50bHkgY2FjaGUgZnVuY3Rpb24gaXMgbm93IHdvcmtpbmcgZm9yIHN0YWdlLCBiZWNhdXNlIHN0YWdlIGhhcyBubyBpdHMgb3duIGNhbnZhcyBlbGVtZW50XG4gICAgICAgIC8vIFRPRE86IG1heSBiZSBpdCBpcyBiZXR0ZXIgdG8gY2FjaGUgYWxsIGNoaWxkcmVuIGxheWVycz9cbiAgICAgICAgY2FjaGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgS29udmEuVXRpbC53YXJuKCdDYWNoZSBmdW5jdGlvbiBpcyBub3QgYWxsb3dlZCBmb3Igc3RhZ2UuIFlvdSBtYXkgdXNlIGNhY2hlIG9ubHkgZm9yIGxheWVycywgZ3JvdXBzIGFuZCBzaGFwZXMuJyk7XG4gICAgICAgIH0sXG4gICAgICAgIGNsZWFyQ2FjaGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuU3RhZ2UsIEtvbnZhLkNvbnRhaW5lcik7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBhbmQgc2V0dGVyc1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyKEtvbnZhLlN0YWdlLCAnY29udGFpbmVyJyk7XG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLlN0YWdlLCAnY29udGFpbmVyJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQgY29udGFpbmVyIERPTSBlbGVtZW50XG4gICAgICogQG5hbWUgY29udGFpbmVyXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFnZS5wcm90b3R5cGVcbiAgICAgKiBAcmV0dXJucyB7RG9tRWxlbWVudH0gY29udGFpbmVyXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgY29udGFpbmVyXG4gICAgICogdmFyIGNvbnRhaW5lciA9IHN0YWdlLmNvbnRhaW5lcigpO1xuICAgICAqIC8vIHNldCBjb250YWluZXJcbiAgICAgKiB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICogYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAqIHN0YWdlLmNvbnRhaW5lcihjb250YWluZXIpO1xuICAgICAqL1xuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIEJhc2VMYXllciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAYXVnbWVudHMgS29udmEuQ29udGFpbmVyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5jbGVhckJlZm9yZURyYXddIHNldCB0aGlzIHByb3BlcnR5IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50XG4gICAgICogdG8gY2xlYXIgdGhlIGNhbnZhcyBiZWZvcmUgZWFjaCBsYXllciBkcmF3LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuY2xpcF0gc2V0IGNsaXBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwWF0gc2V0IGNsaXAgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBZXSBzZXQgY2xpcCB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY2xpcFdpZHRoXSBzZXQgY2xpcCB3aWR0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBIZWlnaHRdIHNldCBjbGlwIGhlaWdodFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuY2xpcEZ1bmNdIHNldCBjbGlwIGZ1bmNcblxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGxheWVyID0gbmV3IEtvbnZhLkxheWVyKCk7XG4gICAgICovXG4gICAgS29udmEuQmFzZUxheWVyID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5VdGlsLmFkZE1ldGhvZHMoS29udmEuQmFzZUxheWVyLCB7XG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5ub2RlVHlwZSA9ICdMYXllcic7XG4gICAgICAgICAgICBLb252YS5Db250YWluZXIuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVQTkdTdHJlYW06IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FudmFzLl9jYW52YXMuY3JlYXRlUE5HU3RyZWFtKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgbGF5ZXIgY2FudmFzXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkJhc2VMYXllci5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGdldENhbnZhczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW52YXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgbGF5ZXIgaGl0IGNhbnZhc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5CYXNlTGF5ZXIucHJvdG90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBnZXRIaXRDYW52YXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGl0Q2FudmFzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGxheWVyIGNhbnZhcyBjb250ZXh0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkJhc2VMYXllci5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGdldENvbnRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FudmFzKCkuZ2V0Q29udGV4dCgpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogY2xlYXIgc2NlbmUgYW5kIGhpdCBjYW52YXMgY29udGV4dHMgdGllZCB0byB0aGUgbGF5ZXJcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQmFzZUxheWVyLnByb3RvdHlwZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gW2JvdW5kc11cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMueF1cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMueV1cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtib3VuZHMud2lkdGhdXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbYm91bmRzLmhlaWdodF1cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogbGF5ZXIuY2xlYXIoKTtcbiAgICAgICAgICogbGF5ZXIuY2xlYXIoe1xuICAgICAgICAgKiAgIHggOiAwLFxuICAgICAgICAgKiAgIHkgOiAwLFxuICAgICAgICAgKiAgIHdpZHRoIDogMTAwLFxuICAgICAgICAgKiAgIGhlaWdodCA6IDEwMFxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICovXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbihib3VuZHMpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0Q29udGV4dCgpLmNsZWFyKGJvdW5kcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgY2xlYXJIaXRDYWNoZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9oaXRJbWFnZURhdGEgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGV4dGVuZCBOb2RlLnByb3RvdHlwZS5zZXRaSW5kZXhcbiAgICAgICAgc2V0WkluZGV4OiBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0WkluZGV4LmNhbGwodGhpcywgaW5kZXgpO1xuICAgICAgICAgICAgdmFyIHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpO1xuICAgICAgICAgICAgaWYoc3RhZ2UpIHtcbiAgICAgICAgICAgICAgICBzdGFnZS5jb250ZW50LnJlbW92ZUNoaWxkKHRoaXMuZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG5cbiAgICAgICAgICAgICAgICBpZihpbmRleCA8IHN0YWdlLmdldENoaWxkcmVuKCkubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFnZS5jb250ZW50Lmluc2VydEJlZm9yZSh0aGlzLmdldENhbnZhcygpLl9jYW52YXMsIHN0YWdlLmdldENoaWxkcmVuKClbaW5kZXggKyAxXS5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQuYXBwZW5kQ2hpbGQodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLy8gZXh0ZW5kIE5vZGUucHJvdG90eXBlLm1vdmVUb1RvcFxuICAgICAgICBtb3ZlVG9Ub3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUubW92ZVRvVG9wLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgICAgICBpZihzdGFnZSkge1xuICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICBzdGFnZS5jb250ZW50LmFwcGVuZENoaWxkKHRoaXMuZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLy8gZXh0ZW5kIE5vZGUucHJvdG90eXBlLm1vdmVVcFxuICAgICAgICBtb3ZlVXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vdmVkID0gS29udmEuTm9kZS5wcm90b3R5cGUubW92ZVVwLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAoIW1vdmVkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzdGFnZSA9IHRoaXMuZ2V0U3RhZ2UoKTtcbiAgICAgICAgICAgIGlmKCFzdGFnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhZ2UuY29udGVudC5yZW1vdmVDaGlsZCh0aGlzLmdldENhbnZhcygpLl9jYW52YXMpO1xuXG4gICAgICAgICAgICBpZih0aGlzLmluZGV4IDwgc3RhZ2UuZ2V0Q2hpbGRyZW4oKS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5pbnNlcnRCZWZvcmUodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzLCBzdGFnZS5nZXRDaGlsZHJlbigpW3RoaXMuaW5kZXggKyAxXS5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLmdldENhbnZhcygpLl9jYW52YXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGV4dGVuZCBOb2RlLnByb3RvdHlwZS5tb3ZlRG93blxuICAgICAgICBtb3ZlRG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZihLb252YS5Ob2RlLnByb3RvdHlwZS5tb3ZlRG93bi5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpO1xuICAgICAgICAgICAgICAgIGlmKHN0YWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbiA9IHN0YWdlLmdldENoaWxkcmVuKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5pbnNlcnRCZWZvcmUodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzLCBjaGlsZHJlblt0aGlzLmluZGV4ICsgMV0uZ2V0Q2FudmFzKCkuX2NhbnZhcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGV4dGVuZCBOb2RlLnByb3RvdHlwZS5tb3ZlVG9Cb3R0b21cbiAgICAgICAgbW92ZVRvQm90dG9tOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKEtvbnZhLk5vZGUucHJvdG90eXBlLm1vdmVUb0JvdHRvbS5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpO1xuICAgICAgICAgICAgICAgIGlmKHN0YWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbiA9IHN0YWdlLmdldENoaWxkcmVuKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YWdlLmNvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhZ2UuY29udGVudC5pbnNlcnRCZWZvcmUodGhpcy5nZXRDYW52YXMoKS5fY2FudmFzLCBjaGlsZHJlblsxXS5nZXRDYW52YXMoKS5fY2FudmFzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0TGF5ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgX2NhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzKCkuX2NhbnZhcztcblxuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyk7XG5cbiAgICAgICAgICAgIGlmKF9jYW52YXMgJiYgX2NhbnZhcy5wYXJlbnROb2RlICYmIEtvbnZhLlV0aWwuX2lzSW5Eb2N1bWVudChfY2FudmFzKSkge1xuICAgICAgICAgICAgICAgIF9jYW52YXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChfY2FudmFzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBnZXRTdGFnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldFNpemU6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldC9zZXQgd2lkdGggb2YgbGF5ZXIuZ2V0dGVyIHJldHVybiB3aWR0aCBvZiBzdGFnZS4gc2V0dGVyIGRvaW5nIG5vdGhpbmcuXG4gICAgICAgICAqIGlmIHlvdSB3YW50IGNoYW5nZSB3aWR0aCB1c2UgYHN0YWdlLndpZHRoKHZhbHVlKTtgXG4gICAgICAgICAqIEBuYW1lIHdpZHRoXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkJhc2VMYXllci5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICogdmFyIHdpZHRoID0gbGF5ZXIud2lkdGgoKTtcbiAgICAgICAgICovXG4gICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ0NhbiBub3QgY2hhbmdlIHdpZHRoIG9mIGxheWVyLiBVc2UgXCJzdGFnZS53aWR0aCh2YWx1ZSlcIiBmdW5jdGlvbiBpbnN0ZWFkLicpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0L3NldCBoZWlnaHQgb2YgbGF5ZXIuZ2V0dGVyIHJldHVybiBoZWlnaHQgb2Ygc3RhZ2UuIHNldHRlciBkb2luZyBub3RoaW5nLlxuICAgICAgICAgKiBpZiB5b3Ugd2FudCBjaGFuZ2UgaGVpZ2h0IHVzZSBgc3RhZ2UuaGVpZ2h0KHZhbHVlKTtgXG4gICAgICAgICAqIEBuYW1lIGhlaWdodFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5CYXNlTGF5ZXIucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAqIHZhciBoZWlnaHQgPSBsYXllci5oZWlnaHQoKTtcbiAgICAgICAgICovXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBLb252YS5VdGlsLndhcm4oJ0NhbiBub3QgY2hhbmdlIGhlaWdodCBvZiBsYXllci4gVXNlIFwic3RhZ2UuaGVpZ2h0KHZhbHVlKVwiIGZ1bmN0aW9uIGluc3RlYWQuJyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRoZSBhcHBseSB0cmFuc2Zvcm0gbWV0aG9kIGlzIGhhbmRsZWQgYnkgdGhlIExheWVyIGFuZCBGYXN0TGF5ZXIgY2xhc3NcbiAgICAgICAgLy8gYmVjYXVzZSBpdCBpcyB1cCB0byB0aGUgbGF5ZXIgdG8gZGVjaWRlIGlmIGFuIGFic29sdXRlIG9yIHJlbGF0aXZlIHRyYW5zZm9ybVxuICAgICAgICAvLyBzaG91bGQgYmUgdXNlZFxuICAgICAgICBfYXBwbHlUcmFuc2Zvcm06IGZ1bmN0aW9uKHNoYXBlLCBjb250ZXh0LCB0b3ApIHtcbiAgICAgICAgICAgIHZhciBtID0gc2hhcGUuZ2V0QWJzb2x1dGVUcmFuc2Zvcm0odG9wKS5nZXRNYXRyaXgoKTtcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKG1bMF0sIG1bMV0sIG1bMl0sIG1bM10sIG1bNF0sIG1bNV0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuQmFzZUxheWVyLCBLb252YS5Db250YWluZXIpO1xuXG4gICAgLy8gYWRkIGdldHRlcnMgYW5kIHNldHRlcnNcbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5CYXNlTGF5ZXIsICdjbGVhckJlZm9yZURyYXcnLCB0cnVlKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNsZWFyQmVmb3JlRHJhdyBmbGFnIHdoaWNoIGRldGVybWluZXMgaWYgdGhlIGxheWVyIGlzIGNsZWFyZWQgb3Igbm90XG4gICAgICogIGJlZm9yZSBkcmF3aW5nXG4gICAgICogQG5hbWUgY2xlYXJCZWZvcmVEcmF3XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5CYXNlTGF5ZXIucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBjbGVhckJlZm9yZURyYXdcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBjbGVhckJlZm9yZURyYXcgZmxhZ1xuICAgICAqIHZhciBjbGVhckJlZm9yZURyYXcgPSBsYXllci5jbGVhckJlZm9yZURyYXcoKTtcbiAgICAgKlxuICAgICAqIC8vIGRpc2FibGUgY2xlYXIgYmVmb3JlIGRyYXdcbiAgICAgKiBsYXllci5jbGVhckJlZm9yZURyYXcoZmFsc2UpO1xuICAgICAqXG4gICAgICogLy8gZW5hYmxlIGNsZWFyIGJlZm9yZSBkcmF3XG4gICAgICogbGF5ZXIuY2xlYXJCZWZvcmVEcmF3KHRydWUpO1xuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLkJhc2VMYXllcik7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIGNvbnN0YW50c1xuICAgIHZhciBIQVNIID0gJyMnLFxuICAgICAgICBCRUZPUkVfRFJBVyA9ICdiZWZvcmVEcmF3JyxcbiAgICAgICAgRFJBVyA9ICdkcmF3JyxcblxuICAgICAgICAvKlxuICAgICAgICAgKiAyIC0gMyAtIDRcbiAgICAgICAgICogfCAgICAgICB8XG4gICAgICAgICAqIDEgLSAwICAgNVxuICAgICAgICAgKiAgICAgICAgIHxcbiAgICAgICAgICogOCAtIDcgLSA2XG4gICAgICAgICAqL1xuICAgICAgICBJTlRFUlNFQ1RJT05fT0ZGU0VUUyA9IFtcbiAgICAgICAgICAgIHt4OiAwLCB5OiAwfSwgIC8vIDBcbiAgICAgICAgICAgIHt4OiAtMSwgeTogMH0sIC8vIDFcbiAgICAgICAgICAgIHt4OiAtMSwgeTogLTF9LCAvLyAyXG4gICAgICAgICAgICB7eDogMCwgeTogLTF9LCAvLyAzXG4gICAgICAgICAgICB7eDogMSwgeTogLTF9LCAvLyA0XG4gICAgICAgICAgICB7eDogMSwgeTogMH0sIC8vIDVcbiAgICAgICAgICAgIHt4OiAxLCB5OiAxfSwgLy8gNlxuICAgICAgICAgICAge3g6IDAsIHk6IDF9LCAvLyA3XG4gICAgICAgICAgICB7eDogLTEsIHk6IDF9ICAvLyA4XG4gICAgICAgIF0sXG4gICAgICAgIElOVEVSU0VDVElPTl9PRkZTRVRTX0xFTiA9IElOVEVSU0VDVElPTl9PRkZTRVRTLmxlbmd0aDtcblxuICAgIC8qKlxuICAgICAqIExheWVyIGNvbnN0cnVjdG9yLiAgTGF5ZXJzIGFyZSB0aWVkIHRvIHRoZWlyIG93biBjYW52YXMgZWxlbWVudCBhbmQgYXJlIHVzZWRcbiAgICAgKiB0byBjb250YWluIGdyb3VwcyBvciBzaGFwZXMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLkJhc2VMYXllclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuY2xlYXJCZWZvcmVEcmF3XSBzZXQgdGhpcyBwcm9wZXJ0eSB0byBmYWxzZSBpZiB5b3UgZG9uJ3Qgd2FudFxuICAgICAqIHRvIGNsZWFyIHRoZSBjYW52YXMgYmVmb3JlIGVhY2ggbGF5ZXIgZHJhdy4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmNsaXBdIHNldCBjbGlwXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY2xpcFhdIHNldCBjbGlwIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwWV0gc2V0IGNsaXAgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBXaWR0aF0gc2V0IGNsaXAgd2lkdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwSGVpZ2h0XSBzZXQgY2xpcCBoZWlnaHRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmNsaXBGdW5jXSBzZXQgY2xpcCBmdW5jXG5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBsYXllciA9IG5ldyBLb252YS5MYXllcigpO1xuICAgICAqL1xuICAgIEtvbnZhLkxheWVyID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuVXRpbC5hZGRNZXRob2RzKEtvbnZhLkxheWVyLCB7XG4gICAgICAgIF9fX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZVR5cGUgPSAnTGF5ZXInO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBuZXcgS29udmEuU2NlbmVDYW52YXMoKTtcbiAgICAgICAgICAgIHRoaXMuaGl0Q2FudmFzID0gbmV3IEtvbnZhLkhpdENhbnZhcyh7XG4gICAgICAgICAgICAgICAgcGl4ZWxSYXRpbzogMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjYWxsIHN1cGVyIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICBLb252YS5CYXNlTGF5ZXIuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICB9LFxuICAgICAgICBfc2V0Q2FudmFzU2l6ZTogZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuICAgICAgICAgICAgdGhpcy5jYW52YXMuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuaGl0Q2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH0sXG4gICAgICAgIF92YWxpZGF0ZUFkZDogZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICAgIHZhciB0eXBlID0gY2hpbGQuZ2V0VHlwZSgpO1xuICAgICAgICAgICAgaWYgKHR5cGUgIT09ICdHcm91cCcgJiYgdHlwZSAhPT0gJ1NoYXBlJykge1xuICAgICAgICAgICAgICAgIEtvbnZhLlV0aWwudGhyb3coJ1lvdSBtYXkgb25seSBhZGQgZ3JvdXBzIGFuZCBzaGFwZXMgdG8gYSBsYXllci4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB2aXNpYmxlIGludGVyc2VjdGlvbiBzaGFwZS4gVGhpcyBpcyB0aGUgcHJlZmVycmVkXG4gICAgICAgICAqIG1ldGhvZCBmb3IgZGV0ZXJtaW5pbmcgaWYgYSBwb2ludCBpbnRlcnNlY3RzIGEgc2hhcGUgb3Igbm90XG4gICAgICAgICAqIGFsc28geW91IG1heSBwYXNzIG9wdGlvbmFsIHNlbGVjdG9yIHBhcmFtZXRyIHRvIHJldHVybiBhbmNlc3RvciBvZiBpbnRlcnNlY3RlZCBzaGFwZVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5MYXllci5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBvc1xuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9zLnhcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcy55XG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc2VsZWN0b3JdXG4gICAgICAgICAqIEByZXR1cm5zIHtLb252YS5Ob2RlfVxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiB2YXIgc2hhcGUgPSBsYXllci5nZXRJbnRlcnNlY3Rpb24oe3g6IDUwLCB5OiA1MH0pO1xuICAgICAgICAgKiAvLyBvciBpZiB5b3UgaW50ZXJlc3RlZCBpbiBzaGFwZSBwYXJlbnQ6XG4gICAgICAgICAqIHZhciBncm91cCA9IGxheWVyLmdldEludGVyc2VjdGlvbih7eDogNTAsIHk6IDUwfSwgJ0dyb3VwJyk7XG4gICAgICAgICAqL1xuICAgICAgICBnZXRJbnRlcnNlY3Rpb246IGZ1bmN0aW9uKHBvcywgc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHZhciBvYmosIGksIGludGVyc2VjdGlvbk9mZnNldCwgc2hhcGU7XG5cbiAgICAgICAgICAgIGlmKCF0aGlzLmhpdEdyYXBoRW5hYmxlZCgpIHx8ICF0aGlzLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpbiBzb21lIGNhc2VzIGFudGlhbGlhc2VkIGFyZWEgbWF5IGJlIGJpZ2dlciB0aGFuIDFweFxuICAgICAgICAgICAgLy8gaXQgaXMgcG9zc2libGUgaWYgd2Ugd2lsbCBjYWNoZSBub2RlLCB0aGVuIHNjYWxlIGl0IGEgbG90XG4gICAgICAgICAgICAvLyBUT0RPOiBjaGVjayB7IDA7IDAgfSBwb2ludCBiZWZvcmUgbG9vcCwgYW5kIHJlbW92ZSBpdCBmcm9tIElOVEVSU0VDVElPTl9PRkZTRVRTLlxuICAgICAgICAgICAgdmFyIHNwaXJhbFNlYXJjaERpc3RhbmNlID0gMTtcbiAgICAgICAgICAgIHZhciBjb250aW51ZVNlYXJjaCA9IGZhbHNlO1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgSU5URVJTRUNUSU9OX09GRlNFVFNfTEVOOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0aW9uT2Zmc2V0ID0gSU5URVJTRUNUSU9OX09GRlNFVFNbaV07XG4gICAgICAgICAgICAgICAgICAgIG9iaiA9IHRoaXMuX2dldEludGVyc2VjdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiBwb3MueCArIGludGVyc2VjdGlvbk9mZnNldC54ICogc3BpcmFsU2VhcmNoRGlzdGFuY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBwb3MueSArIGludGVyc2VjdGlvbk9mZnNldC55ICogc3BpcmFsU2VhcmNoRGlzdGFuY2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlID0gb2JqLnNoYXBlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hhcGUgJiYgc2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaGFwZS5maW5kQW5jZXN0b3Ioc2VsZWN0b3IsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhcGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gd2Ugc2hvdWxkIGNvbnRpbnVlIHNlYXJjaCBpZiB3ZSBmb3VuZCBhbnRpYWxpYXNlZCBwaXhlbFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IG1lYW5zIG91ciBub2RlIHNvbWV3aGVyZSB2ZXJ5IGNsb3NlXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlU2VhcmNoID0gISFvYmouYW50aWFsaWFzZWQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIHN0b3Agc2VhcmNoIGlmIGZvdW5kIGVtcHR5IHBpeGVsXG4gICAgICAgICAgICAgICAgICAgIGlmICghb2JqLmFudGlhbGlhc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBpZiBubyBzaGFwZSwgYW5kIG5vIGFudGlhbGlhc2VkIHBpeGVsLCB3ZSBzaG91bGQgZW5kIHNlYXJjaGluZ1xuICAgICAgICAgICAgICAgIGlmIChjb250aW51ZVNlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICBzcGlyYWxTZWFyY2hEaXN0YW5jZSArPSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldEltYWdlRGF0YTogZnVuY3Rpb24oeCwgeSkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5oaXRDYW52YXMud2lkdGggfHwgMSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhpdENhbnZhcy5oZWlnaHQgfHwgMSxcbiAgICAgICAgICAgICAgICBpbmRleCA9IChNYXRoLnJvdW5kKHkpICogd2lkdGggKSArIE1hdGgucm91bmQoeCk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5faGl0SW1hZ2VEYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGl0SW1hZ2VEYXRhID0gdGhpcy5oaXRDYW52YXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgdGhpcy5faGl0SW1hZ2VEYXRhLmRhdGFbNCAqIGluZGV4ICsgMF0sIC8vIFJlZFxuICAgICAgICAgICAgICAgIHRoaXMuX2hpdEltYWdlRGF0YS5kYXRhWzQgKiBpbmRleCArIDFdLCAvLyBHcmVlblxuICAgICAgICAgICAgICAgIHRoaXMuX2hpdEltYWdlRGF0YS5kYXRhWzQgKiBpbmRleCArIDJdLCAvLyBCbHVlXG4gICAgICAgICAgICAgICAgdGhpcy5faGl0SW1hZ2VEYXRhLmRhdGFbNCAqIGluZGV4ICsgM10gLy8gQWxwaGFcbiAgICAgICAgICAgIF07XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRJbnRlcnNlY3Rpb246IGZ1bmN0aW9uKHBvcykge1xuICAgICAgICAgICAgdmFyIHJhdGlvID0gdGhpcy5oaXRDYW52YXMucGl4ZWxSYXRpbztcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5oaXRDYW52YXMuY29udGV4dC5nZXRJbWFnZURhdGEoTWF0aC5yb3VuZChwb3MueCAqIHJhdGlvKSwgTWF0aC5yb3VuZChwb3MueSAqIHJhdGlvKSwgMSwgMSkuZGF0YSxcbiAgICAgICAgICAgICAgICBwMyA9IHBbM10sXG4gICAgICAgICAgICAgICAgY29sb3JLZXksIHNoYXBlO1xuICAgICAgICAgICAgLy8gZnVsbHkgb3BhcXVlIHBpeGVsXG4gICAgICAgICAgICBpZihwMyA9PT0gMjU1KSB7XG4gICAgICAgICAgICAgICAgY29sb3JLZXkgPSBLb252YS5VdGlsLl9yZ2JUb0hleChwWzBdLCBwWzFdLCBwWzJdKTtcbiAgICAgICAgICAgICAgICBzaGFwZSA9IEtvbnZhLnNoYXBlc1tIQVNIICsgY29sb3JLZXldO1xuICAgICAgICAgICAgICAgIGlmIChzaGFwZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcGU6IHNoYXBlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGFudGlhbGlhc2VkOiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGFudGlhbGlhc2VkIHBpeGVsXG4gICAgICAgICAgICBlbHNlIGlmKHAzID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGFudGlhbGlhc2VkOiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGVtcHR5IHBpeGVsXG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXdTY2VuZTogZnVuY3Rpb24oY2FuLCB0b3ApIHtcbiAgICAgICAgICAgIHZhciBsYXllciA9IHRoaXMuZ2V0TGF5ZXIoKSxcbiAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW4gfHwgKGxheWVyICYmIGxheWVyLmdldENhbnZhcygpKTtcblxuICAgICAgICAgICAgdGhpcy5fZmlyZShCRUZPUkVfRFJBVywge1xuICAgICAgICAgICAgICAgIG5vZGU6IHRoaXNcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZih0aGlzLmdldENsZWFyQmVmb3JlRHJhdygpKSB7XG4gICAgICAgICAgICAgICAgY2FudmFzLmdldENvbnRleHQoKS5jbGVhcigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBLb252YS5Db250YWluZXIucHJvdG90eXBlLmRyYXdTY2VuZS5jYWxsKHRoaXMsIGNhbnZhcywgdG9wKTtcblxuICAgICAgICAgICAgdGhpcy5fZmlyZShEUkFXLCB7XG4gICAgICAgICAgICAgICAgbm9kZTogdGhpc1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBkcmF3SGl0OiBmdW5jdGlvbihjYW4sIHRvcCkge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gdGhpcy5nZXRMYXllcigpLFxuICAgICAgICAgICAgICAgIGNhbnZhcyA9IGNhbiB8fCAobGF5ZXIgJiYgbGF5ZXIuaGl0Q2FudmFzKTtcblxuICAgICAgICAgICAgaWYobGF5ZXIgJiYgbGF5ZXIuZ2V0Q2xlYXJCZWZvcmVEcmF3KCkpIHtcbiAgICAgICAgICAgICAgICBsYXllci5nZXRIaXRDYW52YXMoKS5nZXRDb250ZXh0KCkuY2xlYXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgS29udmEuQ29udGFpbmVyLnByb3RvdHlwZS5kcmF3SGl0LmNhbGwodGhpcywgY2FudmFzLCB0b3ApO1xuICAgICAgICAgICAgdGhpcy5pbWFnZURhdGEgPSBudWxsOyAvLyBDbGVhciBpbWFnZURhdGEgY2FjaGVcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBjbGVhcjogZnVuY3Rpb24oYm91bmRzKSB7XG4gICAgICAgICAgICBLb252YS5CYXNlTGF5ZXIucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcywgYm91bmRzKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0SGl0Q2FudmFzKCkuZ2V0Q29udGV4dCgpLmNsZWFyKGJvdW5kcyk7XG4gICAgICAgICAgICB0aGlzLmltYWdlRGF0YSA9IG51bGw7IC8vIENsZWFyIGdldEltYWdlRGF0YSBjYWNoZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGV4dGVuZCBOb2RlLnByb3RvdHlwZS5zZXRWaXNpYmxlXG4gICAgICAgIHNldFZpc2libGU6IGZ1bmN0aW9uKHZpc2libGUpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldFZpc2libGUuY2FsbCh0aGlzLCB2aXNpYmxlKTtcbiAgICAgICAgICAgIGlmKHZpc2libGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldENhbnZhcygpLl9jYW52YXMuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgdGhpcy5oaXRDYW52YXMuX2NhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2FudmFzKCkuX2NhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIHRoaXMuaGl0Q2FudmFzLl9jYW52YXMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZW5hYmxlIGhpdCBncmFwaFxuICAgICAgICAgKiBAbmFtZSBlbmFibGVIaXRHcmFwaFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5MYXllci5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0xheWVyfVxuICAgICAgICAgKi9cbiAgICAgICAgZW5hYmxlSGl0R3JhcGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5zZXRIaXRHcmFwaEVuYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRpc2FibGUgaGl0IGdyYXBoXG4gICAgICAgICAqIEBuYW1lIGRpc2FibGVIaXRHcmFwaFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5MYXllci5wcm90b3R5cGVcbiAgICAgICAgICogQHJldHVybnMge0xheWVyfVxuICAgICAgICAgKi9cbiAgICAgICAgZGlzYWJsZUhpdEdyYXBoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0SGl0R3JhcGhFbmFibGVkKGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBzZXRTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICBLb252YS5CYXNlTGF5ZXIucHJvdG90eXBlLnNldFNpemUuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuaGl0Q2FudmFzLnNldFNpemUod2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLkxheWVyLCBLb252YS5CYXNlTGF5ZXIpO1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTGF5ZXIsICdoaXRHcmFwaEVuYWJsZWQnLCB0cnVlKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGhpdEdyYXBoRW5hYmxlZCBmbGFnLiAgRGlzYWJsaW5nIHRoZSBoaXQgZ3JhcGggd2lsbCBncmVhdGx5IGluY3JlYXNlXG4gICAgICogIGRyYXcgcGVyZm9ybWFuY2UgYmVjYXVzZSB0aGUgaGl0IGdyYXBoIHdpbGwgbm90IGJlIHJlZHJhd24gZWFjaCB0aW1lIHRoZSBsYXllciBpc1xuICAgICAqICBkcmF3bi4gIFRoaXMsIGhvd2V2ZXIsIGFsc28gZGlzYWJsZXMgbW91c2UvdG91Y2ggZXZlbnQgZGV0ZWN0aW9uXG4gICAgICogQG5hbWUgaGl0R3JhcGhFbmFibGVkXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5MYXllci5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVuYWJsZWRcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBoaXRHcmFwaEVuYWJsZWQgZmxhZ1xuICAgICAqIHZhciBoaXRHcmFwaEVuYWJsZWQgPSBsYXllci5oaXRHcmFwaEVuYWJsZWQoKTtcbiAgICAgKlxuICAgICAqIC8vIGRpc2FibGUgaGl0IGdyYXBoXG4gICAgICogbGF5ZXIuaGl0R3JhcGhFbmFibGVkKGZhbHNlKTtcbiAgICAgKlxuICAgICAqIC8vIGVuYWJsZSBoaXQgZ3JhcGhcbiAgICAgKiBsYXllci5oaXRHcmFwaEVuYWJsZWQodHJ1ZSk7XG4gICAgICovXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLkxheWVyKTtcbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogRmFzdExheWVyIGNvbnN0cnVjdG9yLiBMYXllcnMgYXJlIHRpZWQgdG8gdGhlaXIgb3duIGNhbnZhcyBlbGVtZW50IGFuZCBhcmUgdXNlZFxuICAgICAqIHRvIGNvbnRhaW4gc2hhcGVzIG9ubHkuICBJZiB5b3UgZG9uJ3QgbmVlZCBub2RlIG5lc3RpbmcsIG1vdXNlIGFuZCB0b3VjaCBpbnRlcmFjdGlvbnMsXG4gICAgICogb3IgZXZlbnQgcHViL3N1YiwgeW91IHNob3VsZCB1c2UgRmFzdExheWVyIGluc3RlYWQgb2YgTGF5ZXIgdG8gY3JlYXRlIHlvdXIgbGF5ZXJzLlxuICAgICAqIEl0IHJlbmRlcnMgYWJvdXQgMnggZmFzdGVyIHRoYW4gbm9ybWFsIGxheWVycy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAYXVnbWVudHMgS29udmEuQmFzZUxheWVyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5jbGVhckJlZm9yZURyYXddIHNldCB0aGlzIHByb3BlcnR5IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50XG4gICAgICogdG8gY2xlYXIgdGhlIGNhbnZhcyBiZWZvcmUgZWFjaCBsYXllciBkcmF3LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZS5cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmNsaXBdIHNldCBjbGlwXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY2xpcFhdIHNldCBjbGlwIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwWV0gc2V0IGNsaXAgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBXaWR0aF0gc2V0IGNsaXAgd2lkdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwSGVpZ2h0XSBzZXQgY2xpcCBoZWlnaHRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmNsaXBGdW5jXSBzZXQgY2xpcCBmdW5jXG5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBsYXllciA9IG5ldyBLb252YS5GYXN0TGF5ZXIoKTtcbiAgICAgKi9cbiAgICBLb252YS5GYXN0TGF5ZXIgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5VdGlsLmFkZE1ldGhvZHMoS29udmEuRmFzdExheWVyLCB7XG4gICAgICAgIF9fX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZVR5cGUgPSAnTGF5ZXInO1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBuZXcgS29udmEuU2NlbmVDYW52YXMoKTtcbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgY29uc3RydWN0b3JcbiAgICAgICAgICAgIEtvbnZhLkJhc2VMYXllci5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgICAgIH0sXG4gICAgICAgIF92YWxpZGF0ZUFkZDogZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgICAgIHZhciB0eXBlID0gY2hpbGQuZ2V0VHlwZSgpO1xuICAgICAgICAgICAgaWYgKHR5cGUgIT09ICdTaGFwZScpIHtcbiAgICAgICAgICAgICAgICBLb252YS5VdGlsLnRocm93KCdZb3UgbWF5IG9ubHkgYWRkIHNoYXBlcyB0byBhIGZhc3QgbGF5ZXIuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9zZXRDYW52YXNTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zZXRTaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICB9LFxuICAgICAgICBoaXRHcmFwaEVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBnZXRJbnRlcnNlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXdTY2VuZTogZnVuY3Rpb24oY2FuKSB7XG4gICAgICAgICAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldExheWVyKCksXG4gICAgICAgICAgICAgICAgY2FudmFzID0gY2FuIHx8IChsYXllciAmJiBsYXllci5nZXRDYW52YXMoKSk7XG5cbiAgICAgICAgICAgIGlmKHRoaXMuZ2V0Q2xlYXJCZWZvcmVEcmF3KCkpIHtcbiAgICAgICAgICAgICAgICBjYW52YXMuZ2V0Q29udGV4dCgpLmNsZWFyKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEtvbnZhLkNvbnRhaW5lci5wcm90b3R5cGUuZHJhd1NjZW5lLmNhbGwodGhpcywgY2FudmFzKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5kcmF3U2NlbmUoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvLyBleHRlbmQgTm9kZS5wcm90b3R5cGUuc2V0VmlzaWJsZVxuICAgICAgICBzZXRWaXNpYmxlOiBmdW5jdGlvbih2aXNpYmxlKSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRWaXNpYmxlLmNhbGwodGhpcywgdmlzaWJsZSk7XG4gICAgICAgICAgICBpZih2aXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDYW52YXMoKS5fY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDYW52YXMoKS5fY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLkZhc3RMYXllciwgS29udmEuQmFzZUxheWVyKTtcblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5GYXN0TGF5ZXIpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBHcm91cCBjb25zdHJ1Y3Rvci4gIEdyb3VwcyBhcmUgdXNlZCB0byBjb250YWluIHNoYXBlcyBvciBvdGhlciBncm91cHMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLkNvbnRhaW5lclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuY2xpcF0gc2V0IGNsaXBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5jbGlwWF0gc2V0IGNsaXAgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBZXSBzZXQgY2xpcCB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY2xpcFdpZHRoXSBzZXQgY2xpcCB3aWR0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmNsaXBIZWlnaHRdIHNldCBjbGlwIGhlaWdodFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuY2xpcEZ1bmNdIHNldCBjbGlwIGZ1bmNcblxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGdyb3VwID0gbmV3IEtvbnZhLkdyb3VwKCk7XG4gICAgICovXG4gICAgS29udmEuR3JvdXAgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlV0aWwuYWRkTWV0aG9kcyhLb252YS5Hcm91cCwge1xuICAgICAgICBfX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZVR5cGUgPSAnR3JvdXAnO1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuQ29udGFpbmVyLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3ZhbGlkYXRlQWRkOiBmdW5jdGlvbihjaGlsZCkge1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBjaGlsZC5nZXRUeXBlKCk7XG4gICAgICAgICAgICBpZiAodHlwZSAhPT0gJ0dyb3VwJyAmJiB0eXBlICE9PSAnU2hhcGUnKSB7XG4gICAgICAgICAgICAgICAgS29udmEuVXRpbC50aHJvdygnWW91IG1heSBvbmx5IGFkZCBncm91cHMgYW5kIHNoYXBlcyB0byBncm91cHMuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5Hcm91cCwgS29udmEuQ29udGFpbmVyKTtcblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5Hcm91cCk7XG59KSgpO1xuXG4oZnVuY3Rpb24oS29udmEpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgbm93ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoS29udmEuZ2xvYmFsLnBlcmZvcm1hbmNlICYmIEtvbnZhLmdsb2JhbC5wZXJmb3JtYW5jZS5ub3cpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS29udmEuZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgfTtcbiAgICB9KSgpO1xuXG4gICAgZnVuY3Rpb24gRlJBRihjYWxsYmFjaykge1xuICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gNjApO1xuICAgIH1cblxuICAgIHZhciBSQUYgPSAoZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIEtvbnZhLmdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAgICAgICAgICAgIHx8IEtvbnZhLmdsb2JhbC53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAgICAgICAgICAgIHx8IEtvbnZhLmdsb2JhbC5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAgICAgICAgICAgIHx8IEtvbnZhLmdsb2JhbC5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lXG4gICAgICAgICAgICB8fCBLb252YS5nbG9iYWwubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAgICAgICAgICAgIHx8IEZSQUY7XG4gICAgfSkoKTtcblxuXG5cbiAgICBmdW5jdGlvbiByZXF1ZXN0QW5pbUZyYW1lKCkge1xuICAgICAgICByZXR1cm4gUkFGLmFwcGx5KEtvbnZhLmdsb2JhbCwgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbmltYXRpb24gY29uc3RydWN0b3IuICBBIHN0YWdlIGlzIHVzZWQgdG8gY29udGFpbiBtdWx0aXBsZSBsYXllcnMgYW5kIGhhbmRsZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgZnVuY3Rpb24gZXhlY3V0ZWQgb24gZWFjaCBhbmltYXRpb24gZnJhbWUuICBUaGUgZnVuY3Rpb24gaXMgcGFzc2VkIGEgZnJhbWUgb2JqZWN0LCB3aGljaCBjb250YWluc1xuICAgICAqICB0aW1lRGlmZiwgbGFzdFRpbWUsIHRpbWUsIGFuZCBmcmFtZVJhdGUgcHJvcGVydGllcy4gIFRoZSB0aW1lRGlmZiBwcm9wZXJ0eSBpcyB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0aGF0IGhhdmUgcGFzc2VkXG4gICAgICogIHNpbmNlIHRoZSBsYXN0IGFuaW1hdGlvbiBmcmFtZS4gIFRoZSBsYXN0VGltZSBwcm9wZXJ0eSBpcyB0aW1lIGluIG1pbGxpc2Vjb25kcyB0aGF0IGVsYXBzZWQgZnJvbSB0aGUgbW9tZW50IHRoZSBhbmltYXRpb24gc3RhcnRlZFxuICAgICAqICB0byB0aGUgbGFzdCBhbmltYXRpb24gZnJhbWUuICBUaGUgdGltZSBwcm9wZXJ0eSBpcyB0aGUgdGltZSBpbiBtaWxsaXNlY29uZHMgdGhhdCBlbGxhcHNlZCBmcm9tIHRoZSBtb21lbnQgdGhlIGFuaW1hdGlvbiBzdGFydGVkXG4gICAgICogIHRvIHRoZSBjdXJyZW50IGFuaW1hdGlvbiBmcmFtZS4gIFRoZSBmcmFtZVJhdGUgcHJvcGVydHkgaXMgdGhlIGN1cnJlbnQgZnJhbWUgcmF0ZSBpbiBmcmFtZXMgLyBzZWNvbmQuIFJldHVybiBmYWxzZSBmcm9tIGZ1bmN0aW9uLFxuICAgICAqICBpZiB5b3UgZG9uJ3QgbmVlZCB0byByZWRyYXcgbGF5ZXIvbGF5ZXJzIG9uIHNvbWUgZnJhbWVzLlxuICAgICAqIEBwYXJhbSB7S29udmEuTGF5ZXJ8QXJyYXl9IFtsYXllcnNdIGxheWVyKHMpIHRvIGJlIHJlZHJhd24gb24gZWFjaCBhbmltYXRpb24gZnJhbWUuIENhbiBiZSBhIGxheWVyLCBhbiBhcnJheSBvZiBsYXllcnMsIG9yIG51bGwuXG4gICAgICogIE5vdCBzcGVjaWZ5aW5nIGEgbm9kZSB3aWxsIHJlc3VsdCBpbiBubyByZWRyYXcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBtb3ZlIGEgbm9kZSB0byB0aGUgcmlnaHQgYXQgNTAgcGl4ZWxzIC8gc2Vjb25kXG4gICAgICogdmFyIHZlbG9jaXR5ID0gNTA7XG4gICAgICpcbiAgICAgKiB2YXIgYW5pbSA9IG5ldyBLb252YS5BbmltYXRpb24oZnVuY3Rpb24oZnJhbWUpIHtcbiAgICAgKiAgIHZhciBkaXN0ID0gdmVsb2NpdHkgKiAoZnJhbWUudGltZURpZmYgLyAxMDAwKTtcbiAgICAgKiAgIG5vZGUubW92ZShkaXN0LCAwKTtcbiAgICAgKiB9LCBsYXllcik7XG4gICAgICpcbiAgICAgKiBhbmltLnN0YXJ0KCk7XG4gICAgICovXG4gICAgS29udmEuQW5pbWF0aW9uID0gZnVuY3Rpb24oZnVuYywgbGF5ZXJzKSB7XG4gICAgICAgIHZhciBBbmltID0gS29udmEuQW5pbWF0aW9uO1xuICAgICAgICB0aGlzLmZ1bmMgPSBmdW5jO1xuICAgICAgICB0aGlzLnNldExheWVycyhsYXllcnMpO1xuICAgICAgICB0aGlzLmlkID0gQW5pbS5hbmltSWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMuZnJhbWUgPSB7XG4gICAgICAgICAgICB0aW1lOiAwLFxuICAgICAgICAgICAgdGltZURpZmY6IDAsXG4gICAgICAgICAgICBsYXN0VGltZTogbm93KClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qXG4gICAgICogQW5pbWF0aW9uIG1ldGhvZHNcbiAgICAgKi9cbiAgICBLb252YS5BbmltYXRpb24ucHJvdG90eXBlID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IGxheWVycyB0byBiZSByZWRyYXduIG9uIGVhY2ggYW5pbWF0aW9uIGZyYW1lXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkFuaW1hdGlvbi5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtLb252YS5MYXllcnxBcnJheX0gW2xheWVyc10gbGF5ZXIocykgdG8gYmUgcmVkcmF3bi4mbmJzcDsgQ2FuIGJlIGEgbGF5ZXIsIGFuIGFycmF5IG9mIGxheWVycywgb3IgbnVsbC4gIE5vdCBzcGVjaWZ5aW5nIGEgbm9kZSB3aWxsIHJlc3VsdCBpbiBubyByZWRyYXcuXG4gICAgICAgICAqIEByZXR1cm4ge0tvbnZhLkFuaW1hdGlvbn0gdGhpc1xuICAgICAgICAgKi9cbiAgICAgICAgc2V0TGF5ZXJzOiBmdW5jdGlvbihsYXllcnMpIHtcbiAgICAgICAgICAgIHZhciBsYXlzID0gW107XG4gICAgICAgICAgICAvLyBpZiBwYXNzaW5nIGluIG5vIGxheWVyc1xuICAgICAgICAgICAgaWYgKCFsYXllcnMpIHtcbiAgICAgICAgICAgICAgICBsYXlzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBwYXNzaW5nIGluIGFuIGFycmF5IG9mIExheWVyc1xuICAgICAgICAgICAgLy8gTk9URTogbGF5ZXJzIGNvdWxkIGJlIGFuIGFycmF5IG9yIEtvbnZhLkNvbGxlY3Rpb24uICBmb3Igc2ltcGxpY2l0eSwgSSdtIGp1c3QgaW5zcGVjdGluZ1xuICAgICAgICAgICAgLy8gdGhlIGxlbmd0aCBwcm9wZXJ0eSB0byBjaGVjayBmb3IgYm90aCBjYXNlc1xuICAgICAgICAgICAgZWxzZSBpZiAobGF5ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBsYXlzID0gbGF5ZXJzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgcGFzc2luZyBpbiBhIExheWVyXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsYXlzID0gW2xheWVyc107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubGF5ZXJzID0gbGF5cztcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IGxheWVyc1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5BbmltYXRpb24ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm4ge0FycmF5fSBBcnJheSBvZiBLb252YS5MYXllclxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0TGF5ZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxheWVycztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGFkZCBsYXllci4gIFJldHVybnMgdHJ1ZSBpZiB0aGUgbGF5ZXIgd2FzIGFkZGVkLCBhbmQgZmFsc2UgaWYgaXQgd2FzIG5vdFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5BbmltYXRpb24ucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7S29udmEuTGF5ZXJ9IGxheWVyIHRvIGFkZFxuICAgICAgICAgKiBAcmV0dXJuIHtCb29sfSB0cnVlIGlmIGxheWVyIGlzIGFkZGVkIHRvIGFuaW1hdGlvbiwgb3RoZXJ3aXNlIGZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICBhZGRMYXllcjogZnVuY3Rpb24obGF5ZXIpIHtcbiAgICAgICAgICAgIHZhciBsYXllcnMgPSB0aGlzLmxheWVycyxcbiAgICAgICAgICAgICAgICBsZW4gPSBsYXllcnMubGVuZ3RoLCBuO1xuXG4gICAgICAgICAgICAvLyBkb24ndCBhZGQgdGhlIGxheWVyIGlmIGl0IGFscmVhZHkgZXhpc3RzXG4gICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobGF5ZXJzW25dLl9pZCA9PT0gbGF5ZXIuX2lkKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5sYXllcnMucHVzaChsYXllcik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGRldGVybWluZSBpZiBhbmltYXRpb24gaXMgcnVubmluZyBvciBub3QuICByZXR1cm5zIHRydWUgb3IgZmFsc2VcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQW5pbWF0aW9uLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJuIHtCb29sfSBpcyBhbmltYXRpb24gcnVubmluZz9cbiAgICAgICAgICovXG4gICAgICAgIGlzUnVubmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYSA9IEtvbnZhLkFuaW1hdGlvbixcbiAgICAgICAgICAgICAgICBhbmltYXRpb25zID0gYS5hbmltYXRpb25zLFxuICAgICAgICAgICAgICAgIGxlbiA9IGFuaW1hdGlvbnMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIG47XG5cbiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25zW25dLmlkID09PSB0aGlzLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0YXJ0IGFuaW1hdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5BbmltYXRpb24ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm4ge0tvbnZhLkFuaW1hdGlvbn0gdGhpc1xuICAgICAgICAgKi9cbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIEFuaW0gPSBLb252YS5BbmltYXRpb247XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIHRoaXMuZnJhbWUudGltZURpZmYgPSAwO1xuICAgICAgICAgICAgdGhpcy5mcmFtZS5sYXN0VGltZSA9IG5vdygpO1xuICAgICAgICAgICAgQW5pbS5fYWRkQW5pbWF0aW9uKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzdG9wIGFuaW1hdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5BbmltYXRpb24ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm4ge0tvbnZhLkFuaW1hdGlvbn0gdGhpc1xuICAgICAgICAgKi9cbiAgICAgICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBLb252YS5BbmltYXRpb24uX3JlbW92ZUFuaW1hdGlvbih0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBfdXBkYXRlRnJhbWVPYmplY3Q6IGZ1bmN0aW9uKHRpbWUpIHtcbiAgICAgICAgICAgIHRoaXMuZnJhbWUudGltZURpZmYgPSB0aW1lIC0gdGhpcy5mcmFtZS5sYXN0VGltZTtcbiAgICAgICAgICAgIHRoaXMuZnJhbWUubGFzdFRpbWUgPSB0aW1lO1xuICAgICAgICAgICAgdGhpcy5mcmFtZS50aW1lICs9IHRoaXMuZnJhbWUudGltZURpZmY7XG4gICAgICAgICAgICB0aGlzLmZyYW1lLmZyYW1lUmF0ZSA9IDEwMDAgLyB0aGlzLmZyYW1lLnRpbWVEaWZmO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5BbmltYXRpb24uYW5pbWF0aW9ucyA9IFtdO1xuICAgIEtvbnZhLkFuaW1hdGlvbi5hbmltSWRDb3VudGVyID0gMDtcbiAgICBLb252YS5BbmltYXRpb24uYW5pbVJ1bm5pbmcgPSBmYWxzZTtcblxuICAgIEtvbnZhLkFuaW1hdGlvbi5fYWRkQW5pbWF0aW9uID0gZnVuY3Rpb24oYW5pbSkge1xuICAgICAgICB0aGlzLmFuaW1hdGlvbnMucHVzaChhbmltKTtcbiAgICAgICAgdGhpcy5faGFuZGxlQW5pbWF0aW9uKCk7XG4gICAgfTtcbiAgICBLb252YS5BbmltYXRpb24uX3JlbW92ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uKGFuaW0pIHtcbiAgICAgICAgdmFyIGlkID0gYW5pbS5pZCxcbiAgICAgICAgICAgIGFuaW1hdGlvbnMgPSB0aGlzLmFuaW1hdGlvbnMsXG4gICAgICAgICAgICBsZW4gPSBhbmltYXRpb25zLmxlbmd0aCxcbiAgICAgICAgICAgIG47XG5cbiAgICAgICAgZm9yKG4gPSAwOyBuIDwgbGVuOyBuKyspIHtcbiAgICAgICAgICAgIGlmKGFuaW1hdGlvbnNbbl0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zLnNwbGljZShuLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBLb252YS5BbmltYXRpb24uX3J1bkZyYW1lcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbGF5ZXJIYXNoID0ge30sXG4gICAgICAgICAgICBhbmltYXRpb25zID0gdGhpcy5hbmltYXRpb25zLFxuICAgICAgICAgICAgYW5pbSwgbGF5ZXJzLCBmdW5jLCBuLCBpLCBsYXllcnNMZW4sIGxheWVyLCBrZXksIG5lZWRSZWRyYXc7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGxvb3AgdGhyb3VnaCBhbGwgYW5pbWF0aW9ucyBhbmQgZXhlY3V0ZSBhbmltYXRpb25cbiAgICAgICAgICogIGZ1bmN0aW9uLiAgaWYgdGhlIGFuaW1hdGlvbiBvYmplY3QgaGFzIHNwZWNpZmllZCBub2RlLFxuICAgICAgICAgKiAgd2UgY2FuIGFkZCB0aGUgbm9kZSB0byB0aGUgbm9kZXMgaGFzaCB0byBlbGltaW5hdGVcbiAgICAgICAgICogIGRyYXdpbmcgdGhlIHNhbWUgbm9kZSBtdWx0aXBsZSB0aW1lcy4gIFRoZSBub2RlIHByb3BlcnR5XG4gICAgICAgICAqICBjYW4gYmUgdGhlIHN0YWdlIGl0c2VsZiBvciBhIGxheWVyXG4gICAgICAgICAqL1xuICAgICAgICAvKlxuICAgICAgICAgKiBXQVJOSU5HOiBkb24ndCBjYWNoZSBhbmltYXRpb25zLmxlbmd0aCBiZWNhdXNlIGl0IGNvdWxkIGNoYW5nZSB3aGlsZVxuICAgICAgICAgKiB0aGUgZm9yIGxvb3AgaXMgcnVubmluZywgY2F1c2luZyBhIEpTIGVycm9yXG4gICAgICAgICAqL1xuXG4gICAgICAgIGZvcihuID0gMDsgbiA8IGFuaW1hdGlvbnMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIGFuaW0gPSBhbmltYXRpb25zW25dO1xuICAgICAgICAgICAgbGF5ZXJzID0gYW5pbS5sYXllcnM7XG4gICAgICAgICAgICBmdW5jID0gYW5pbS5mdW5jO1xuXG5cbiAgICAgICAgICAgIGFuaW0uX3VwZGF0ZUZyYW1lT2JqZWN0KG5vdygpKTtcbiAgICAgICAgICAgIGxheWVyc0xlbiA9IGxheWVycy5sZW5ndGg7XG5cbiAgICAgICAgICAgIC8vIGlmIGFuaW1hdGlvbiBvYmplY3QgaGFzIGEgZnVuY3Rpb24sIGV4ZWN1dGUgaXRcbiAgICAgICAgICAgIGlmIChmdW5jKSB7XG4gICAgICAgICAgICAgICAgLy8gYWxsb3cgYW5pbSBieXBhc3NpbmcgZHJhd2luZ1xuICAgICAgICAgICAgICAgIG5lZWRSZWRyYXcgPSAoZnVuYy5jYWxsKGFuaW0sIGFuaW0uZnJhbWUpICE9PSBmYWxzZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5lZWRSZWRyYXcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFuZWVkUmVkcmF3KSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGF5ZXJzTGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsYXllciA9IGxheWVyc1tpXTtcblxuICAgICAgICAgICAgICAgIGlmIChsYXllci5faWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBsYXllckhhc2hbbGF5ZXIuX2lkXSA9IGxheWVyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoa2V5IGluIGxheWVySGFzaCkge1xuICAgICAgICAgICAgaWYgKCFsYXllckhhc2guaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGF5ZXJIYXNoW2tleV0uZHJhdygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5BbmltYXRpb24uX2FuaW1hdGlvbkxvb3AgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIEFuaW0gPSBLb252YS5BbmltYXRpb247XG4gICAgICAgIGlmKEFuaW0uYW5pbWF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIEFuaW0uX3J1bkZyYW1lcygpO1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZShBbmltLl9hbmltYXRpb25Mb29wKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEFuaW0uYW5pbVJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS29udmEuQW5pbWF0aW9uLl9oYW5kbGVBbmltYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYoIXRoaXMuYW5pbVJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbVJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZSh0aGlzLl9hbmltYXRpb25Mb29wKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBiYXRjaCBkcmF3LiB0aGlzIGZ1bmN0aW9uIHdpbGwgbm90IGRvIGltbWVkaWF0ZSBkcmF3XG4gICAgICogYnV0IGl0IHdpbGwgc2NoZWR1bGUgZHJhd2luZyB0byBuZXh0IHRpY2sgKHJlcXVlc3RBbmltRnJhbWUpXG4gICAgICogQG1ldGhvZFxuICAgICAqIEByZXR1cm4ge0tvbnZhLkxheWVyfSB0aGlzXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkJhc2UucHJvdG90eXBlXG4gICAgICovXG4gICAgS29udmEuQmFzZUxheWVyLnByb3RvdHlwZS5iYXRjaERyYXcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxuICAgICAgICAgICAgQW5pbSA9IEtvbnZhLkFuaW1hdGlvbjtcblxuICAgICAgICBpZiAoIXRoaXMuYmF0Y2hBbmltKSB7XG4gICAgICAgICAgICB0aGlzLmJhdGNoQW5pbSA9IG5ldyBBbmltKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIHN0b3AgYW5pbWF0aW9uIGFmdGVyIGZpcnN0IHRpY2tcbiAgICAgICAgICAgICAgICB0aGF0LmJhdGNoQW5pbS5zdG9wKCk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubGFzdEJhdGNoRHJhd1RpbWUgPSBub3coKTtcblxuICAgICAgICBpZiAoIXRoaXMuYmF0Y2hBbmltLmlzUnVubmluZygpKSB7XG4gICAgICAgICAgICB0aGlzLmJhdGNoQW5pbS5zdGFydCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBiYXRjaCBkcmF3XG4gICAgICogQG1ldGhvZFxuICAgICAqIEByZXR1cm4ge0tvbnZhLlN0YWdlfSB0aGlzXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YWdlLnByb3RvdHlwZVxuICAgICAqL1xuICAgIEtvbnZhLlN0YWdlLnByb3RvdHlwZS5iYXRjaERyYXcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5nZXRDaGlsZHJlbigpLmVhY2goZnVuY3Rpb24obGF5ZXIpIHtcbiAgICAgICAgICAgIGxheWVyLmJhdGNoRHJhdygpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbn0pKEtvbnZhKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgYmxhY2tsaXN0ID0ge1xuICAgICAgICBub2RlOiAxLFxuICAgICAgICBkdXJhdGlvbjogMSxcbiAgICAgICAgZWFzaW5nOiAxLFxuICAgICAgICBvbkZpbmlzaDogMSxcbiAgICAgICAgeW95bzogMVxuICAgIH0sXG5cbiAgICBQQVVTRUQgPSAxLFxuICAgIFBMQVlJTkcgPSAyLFxuICAgIFJFVkVSU0lORyA9IDMsXG5cbiAgICBpZENvdW50ZXIgPSAwLFxuICAgIGNvbG9yQXR0cnMgPSBbJ2ZpbGwnLCAnc3Ryb2tlJywgJ3NoYWRvd0NvbG9yJ107XG5cbiAgICB2YXIgVHdlZW4gPSBmdW5jdGlvbihwcm9wLCBwcm9wRnVuYywgZnVuYywgYmVnaW4sIGZpbmlzaCwgZHVyYXRpb24sIHlveW8pIHtcbiAgICAgICAgdGhpcy5wcm9wID0gcHJvcDtcbiAgICAgICAgdGhpcy5wcm9wRnVuYyA9IHByb3BGdW5jO1xuICAgICAgICB0aGlzLmJlZ2luID0gYmVnaW47XG4gICAgICAgIHRoaXMuX3BvcyA9IGJlZ2luO1xuICAgICAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIHRoaXMuX2NoYW5nZSA9IDA7XG4gICAgICAgIHRoaXMucHJldlBvcyA9IDA7XG4gICAgICAgIHRoaXMueW95byA9IHlveW87XG4gICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICB0aGlzLl9wb3NpdGlvbiA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IDA7XG4gICAgICAgIHRoaXMuX2ZpbmlzaCA9IDA7XG4gICAgICAgIHRoaXMuZnVuYyA9IGZ1bmM7XG4gICAgICAgIHRoaXMuX2NoYW5nZSA9IGZpbmlzaCAtIHRoaXMuYmVnaW47XG4gICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICB9O1xuICAgIC8qXG4gICAgICogVHdlZW4gbWV0aG9kc1xuICAgICAqL1xuICAgIFR3ZWVuLnByb3RvdHlwZSA9IHtcbiAgICAgICAgZmlyZTogZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXNbc3RyXTtcbiAgICAgICAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXRUaW1lOiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBpZih0ID4gdGhpcy5kdXJhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmKHRoaXMueW95bykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aW1lID0gdGhpcy5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodCA8IDApIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnlveW8pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWUgPSB0O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldFRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldFBvc2l0aW9uOiBmdW5jdGlvbihwKSB7XG4gICAgICAgICAgICB0aGlzLnByZXZQb3MgPSB0aGlzLl9wb3M7XG4gICAgICAgICAgICB0aGlzLnByb3BGdW5jKHApO1xuICAgICAgICAgICAgdGhpcy5fcG9zID0gcDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0UG9zaXRpb246IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGlmKHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHQgPSB0aGlzLl90aW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnVuYyh0LCB0aGlzLmJlZ2luLCB0aGlzLl9jaGFuZ2UsIHRoaXMuZHVyYXRpb24pO1xuICAgICAgICB9LFxuICAgICAgICBwbGF5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBQTEFZSU5HO1xuICAgICAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gdGhpcy5nZXRUaW1lcigpIC0gdGhpcy5fdGltZTtcbiAgICAgICAgICAgIHRoaXMub25FbnRlckZyYW1lKCk7XG4gICAgICAgICAgICB0aGlzLmZpcmUoJ29uUGxheScpO1xuICAgICAgICB9LFxuICAgICAgICByZXZlcnNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBSRVZFUlNJTkc7XG4gICAgICAgICAgICB0aGlzLl90aW1lID0gdGhpcy5kdXJhdGlvbiAtIHRoaXMuX3RpbWU7XG4gICAgICAgICAgICB0aGlzLl9zdGFydFRpbWUgPSB0aGlzLmdldFRpbWVyKCkgLSB0aGlzLl90aW1lO1xuICAgICAgICAgICAgdGhpcy5vbkVudGVyRnJhbWUoKTtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnb25SZXZlcnNlJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlZWs6IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSB0O1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnb25TZWVrJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgPSAwO1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnb25SZXNldCcpO1xuICAgICAgICB9LFxuICAgICAgICBmaW5pc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYXVzZSgpO1xuICAgICAgICAgICAgdGhpcy5fdGltZSA9IHRoaXMuZHVyYXRpb247XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5maXJlKCdvbkZpbmlzaCcpO1xuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvbih0aGlzLmdldFBvc2l0aW9uKHRoaXMuX3RpbWUpKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25FbnRlckZyYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5nZXRUaW1lcigpIC0gdGhpcy5fc3RhcnRUaW1lO1xuICAgICAgICAgICAgaWYodGhpcy5zdGF0ZSA9PT0gUExBWUlORykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZSh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdGUgPT09IFJFVkVSU0lORykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZSh0aGlzLmR1cmF0aW9uIC0gdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHBhdXNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBQQVVTRUQ7XG4gICAgICAgICAgICB0aGlzLmZpcmUoJ29uUGF1c2UnKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0VGltZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFR3ZWVuIGNvbnN0cnVjdG9yLiAgVHdlZW5zIGVuYWJsZSB5b3UgdG8gYW5pbWF0ZSBhIG5vZGUgYmV0d2VlbiB0aGUgY3VycmVudCBzdGF0ZSBhbmQgYSBuZXcgc3RhdGUuXG4gICAgICogIFlvdSBjYW4gcGxheSwgcGF1c2UsIHJldmVyc2UsIHNlZWssIHJlc2V0LCBhbmQgZmluaXNoIHR3ZWVucy4gIEJ5IGRlZmF1bHQsIHR3ZWVucyBhcmUgYW5pbWF0ZWQgdXNpbmdcbiAgICAgKiAgYSBsaW5lYXIgZWFzaW5nLiAgRm9yIG1vcmUgdHdlZW5pbmcgb3B0aW9ucywgY2hlY2sgb3V0IHtAbGluayBLb252YS5FYXNpbmdzfVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gaW5zdGFudGlhdGUgbmV3IHR3ZWVuIHdoaWNoIGZ1bGx5IHJvdGF0ZXMgYSBub2RlIGluIDEgc2Vjb25kXG4gICAgICogdmFyIHR3ZWVuID0gbmV3IEtvbnZhLlR3ZWVuKHtcbiAgICAgKiAgIG5vZGU6IG5vZGUsXG4gICAgICogICByb3RhdGlvbkRlZzogMzYwLFxuICAgICAqICAgZHVyYXRpb246IDEsXG4gICAgICogICBlYXNpbmc6IEtvbnZhLkVhc2luZ3MuRWFzZUluT3V0XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiAvLyBwbGF5IHR3ZWVuXG4gICAgICogdHdlZW4ucGxheSgpO1xuICAgICAqXG4gICAgICogLy8gcGF1c2UgdHdlZW5cbiAgICAgKiB0d2Vlbi5wYXVzZSgpO1xuICAgICAqL1xuICAgIEtvbnZhLlR3ZWVuID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgICAgICAgIG5vZGUgPSBjb25maWcubm9kZSxcbiAgICAgICAgICAgIG5vZGVJZCA9IG5vZGUuX2lkLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBlYXNpbmcgPSBjb25maWcuZWFzaW5nIHx8IEtvbnZhLkVhc2luZ3MuTGluZWFyLFxuICAgICAgICAgICAgeW95byA9ICEhY29uZmlnLnlveW8sXG4gICAgICAgICAgICBrZXk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcuZHVyYXRpb24gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBkdXJhdGlvbiA9IDE7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLmR1cmF0aW9uID09PSAwKSB7ICAvLyB6ZXJvIGlzIGJhZCB2YWx1ZSBmb3IgZHVyYXRpb25cbiAgICAgICAgICAgIGR1cmF0aW9uID0gMC4wMDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkdXJhdGlvbiA9IGNvbmZpZy5kdXJhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuICAgICAgICB0aGlzLl9pZCA9IGlkQ291bnRlcisrO1xuXG4gICAgICAgIHZhciBsYXllcnMgPSBub2RlLmdldExheWVyKCkgfHwgKChub2RlIGluc3RhbmNlb2YgS29udmEuU3RhZ2UpID8gbm9kZS5nZXRMYXllcnMoKSA6IG51bGwpO1xuICAgICAgICBpZiAoIWxheWVycykge1xuICAgICAgICAgICAgS29udmEuVXRpbC5lcnJvcihcbiAgICAgICAgICAgICAgICAnVHdlZW4gY29uc3RydWN0b3IgaGF2ZSBgbm9kZWAgdGhhdCBpcyBub3QgaW4gYSBsYXllci4gUGxlYXNlIGFkZCBub2RlIGludG8gbGF5ZXIgZmlyc3QuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuaW0gPSBuZXcgS29udmEuQW5pbWF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhhdC50d2Vlbi5vbkVudGVyRnJhbWUoKTtcbiAgICAgICAgfSwgbGF5ZXJzKTtcblxuICAgICAgICB0aGlzLnR3ZWVuID0gbmV3IFR3ZWVuKGtleSwgZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgdGhhdC5fdHdlZW5GdW5jKGkpO1xuICAgICAgICB9LCBlYXNpbmcsIDAsIDEsIGR1cmF0aW9uICogMTAwMCwgeW95byk7XG5cbiAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgLy8gaW5pdCBhdHRycyBtYXBcbiAgICAgICAgaWYgKCFLb252YS5Ud2Vlbi5hdHRyc1tub2RlSWRdKSB7XG4gICAgICAgICAgICBLb252YS5Ud2Vlbi5hdHRyc1tub2RlSWRdID0ge307XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFLb252YS5Ud2Vlbi5hdHRyc1tub2RlSWRdW3RoaXMuX2lkXSkge1xuICAgICAgICAgICAgS29udmEuVHdlZW4uYXR0cnNbbm9kZUlkXVt0aGlzLl9pZF0gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpbml0IHR3ZWVucyBtYXBcbiAgICAgICAgaWYgKCFLb252YS5Ud2Vlbi50d2VlbnNbbm9kZUlkXSkge1xuICAgICAgICAgICAgS29udmEuVHdlZW4udHdlZW5zW25vZGVJZF0gPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoa2V5IGluIGNvbmZpZykge1xuICAgICAgICAgICAgaWYgKGJsYWNrbGlzdFtrZXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRBdHRyKGtleSwgY29uZmlnW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIC8vIGNhbGxiYWNrc1xuICAgICAgICB0aGlzLm9uRmluaXNoID0gY29uZmlnLm9uRmluaXNoO1xuICAgICAgICB0aGlzLm9uUmVzZXQgPSBjb25maWcub25SZXNldDtcbiAgICB9O1xuXG4gICAgLy8gc3RhcnQvZGlmZiBvYmplY3QgPSBhdHRycy5ub2RlSWQudHdlZW5JZC5hdHRyXG4gICAgS29udmEuVHdlZW4uYXR0cnMgPSB7fTtcbiAgICAvLyB0d2VlbklkID0gdHdlZW5zLm5vZGVJZC5hdHRyXG4gICAgS29udmEuVHdlZW4udHdlZW5zID0ge307XG5cbiAgICBLb252YS5Ud2Vlbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIF9hZGRBdHRyOiBmdW5jdGlvbihrZXksIGVuZCkge1xuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGUsXG4gICAgICAgICAgICAgICAgbm9kZUlkID0gbm9kZS5faWQsXG4gICAgICAgICAgICAgICAgc3RhcnQsIGRpZmYsIHR3ZWVuSWQsIG4sIGxlbiwgdHJ1ZUVuZCwgdHJ1ZVN0YXJ0O1xuXG4gICAgICAgICAgICAvLyByZW1vdmUgY29uZmxpY3QgZnJvbSB0d2VlbiBtYXAgaWYgaXQgZXhpc3RzXG4gICAgICAgICAgICB0d2VlbklkID0gS29udmEuVHdlZW4udHdlZW5zW25vZGVJZF1ba2V5XTtcblxuICAgICAgICAgICAgaWYgKHR3ZWVuSWQpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgS29udmEuVHdlZW4uYXR0cnNbbm9kZUlkXVt0d2VlbklkXVtrZXldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgdG8gdHdlZW4gbWFwXG4gICAgICAgICAgICBzdGFydCA9IG5vZGUuZ2V0QXR0cihrZXkpO1xuXG4gICAgICAgICAgICBpZiAoS29udmEuVXRpbC5faXNBcnJheShlbmQpKSB7XG4gICAgICAgICAgICAgICAgZGlmZiA9IFtdO1xuICAgICAgICAgICAgICAgIGxlbiA9IE1hdGgubWF4KGVuZC5sZW5ndGgsIHN0YXJ0Lmxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAncG9pbnRzJyAmJiBlbmQubGVuZ3RoICE9PSBzdGFydC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYmVmb3JlIHR3ZWVuaW5nIHBvaW50cyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHN0YXJ0Lmxlbmd0aCA9PT0gZW5kLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAvLyBLb252YS5VdGlsLl9wcmVwYXJlQXJyYXlGb3JUd2VlbiB0aGlua2luZyB0aGF0IGVuZC5sZW5ndGggPiBzdGFydC5sZW5ndGhcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZW5kLmxlbmd0aCA+IHN0YXJ0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gaW4gdGhpcyBjYXNlIHdlIHdpbGwgaW5jcmVhc2UgbnVtYmVyIG9mIHN0YXJ0aW5nIHBvaW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVN0YXJ0ID0gc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IEtvbnZhLlV0aWwuX3ByZXBhcmVBcnJheUZvclR3ZWVuKHN0YXJ0LCBlbmQsIG5vZGUuY2xvc2VkKCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gdGhpcyBjYXNlIHdlIHdpbGwgaW5jcmVhc2UgbnVtYmVyIG9mIGVkaW5nIHBvaW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZUVuZCA9IGVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IEtvbnZhLlV0aWwuX3ByZXBhcmVBcnJheUZvclR3ZWVuKGVuZCwgc3RhcnQsIG5vZGUuY2xvc2VkKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGxlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpZmYucHVzaCgoZW5kW25dKSAtIChzdGFydFtuXSkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xvckF0dHJzLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBzdGFydCA9IEtvbnZhLlV0aWwuY29sb3JUb1JHQkEoc3RhcnQpO1xuICAgICAgICAgICAgICAgIHZhciBlbmRSR0JBID0gS29udmEuVXRpbC5jb2xvclRvUkdCQShlbmQpO1xuICAgICAgICAgICAgICAgIGRpZmYgPSB7XG4gICAgICAgICAgICAgICAgICAgIHI6IGVuZFJHQkEuciAtIHN0YXJ0LnIsXG4gICAgICAgICAgICAgICAgICAgIGc6IGVuZFJHQkEuZyAtIHN0YXJ0LmcsXG4gICAgICAgICAgICAgICAgICAgIGI6IGVuZFJHQkEuYiAtIHN0YXJ0LmIsXG4gICAgICAgICAgICAgICAgICAgIGE6IGVuZFJHQkEuYSAtIHN0YXJ0LmFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaWZmID0gZW5kIC0gc3RhcnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEtvbnZhLlR3ZWVuLmF0dHJzW25vZGVJZF1bdGhpcy5faWRdW2tleV0gPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICAgIGRpZmY6IGRpZmYsXG4gICAgICAgICAgICAgICAgZW5kOiBlbmQsXG4gICAgICAgICAgICAgICAgdHJ1ZUVuZDogdHJ1ZUVuZCxcbiAgICAgICAgICAgICAgICB0cnVlU3RhcnQ6IHRydWVTdGFydFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEtvbnZhLlR3ZWVuLnR3ZWVuc1tub2RlSWRdW2tleV0gPSB0aGlzLl9pZDtcbiAgICAgICAgfSxcbiAgICAgICAgX3R3ZWVuRnVuYzogZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGUsXG4gICAgICAgICAgICAgICAgYXR0cnMgPSBLb252YS5Ud2Vlbi5hdHRyc1tub2RlLl9pZF1bdGhpcy5faWRdLFxuICAgICAgICAgICAgICAgIGtleSwgYXR0ciwgc3RhcnQsIGRpZmYsIG5ld1ZhbCwgbiwgbGVuLCBlbmQ7XG5cbiAgICAgICAgICAgIGZvciAoa2V5IGluIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgYXR0ciA9IGF0dHJzW2tleV07XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBhdHRyLnN0YXJ0O1xuICAgICAgICAgICAgICAgIGRpZmYgPSBhdHRyLmRpZmY7XG4gICAgICAgICAgICAgICAgZW5kID0gYXR0ci5lbmQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoS29udmEuVXRpbC5faXNBcnJheShzdGFydCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsID0gW107XG4gICAgICAgICAgICAgICAgICAgIGxlbiA9IE1hdGgubWF4KHN0YXJ0Lmxlbmd0aCwgZW5kLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBsZW47IG4rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsLnB1c2goKHN0YXJ0W25dIHx8IDApICsgKGRpZmZbbl0gKiBpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbG9yQXR0cnMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWwgPSAncmdiYSgnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKHN0YXJ0LnIgKyBkaWZmLnIgKiBpKSArICcsJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChzdGFydC5nICsgZGlmZi5nICogaSkgKyAnLCcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoc3RhcnQuYiArIGRpZmYuYiAqIGkpICsgJywnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RhcnQuYSArIGRpZmYuYSAqIGkpICsgJyknO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbCA9IHN0YXJ0ICsgKGRpZmYgKiBpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBub2RlLnNldEF0dHIoa2V5LCBuZXdWYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfYWRkTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgLy8gc3RhcnQgbGlzdGVuZXJzXG4gICAgICAgICAgICB0aGlzLnR3ZWVuLm9uUGxheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuYW5pbS5zdGFydCgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudHdlZW4ub25SZXZlcnNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5hbmltLnN0YXJ0KCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzdG9wIGxpc3RlbmVyc1xuICAgICAgICAgICAgdGhpcy50d2Vlbi5vblBhdXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5hbmltLnN0b3AoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnR3ZWVuLm9uRmluaXNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGF0Lm5vZGU7XG5cbiAgICAgICAgICAgICAgICAvLyBhZnRlciB0d2VlbmluZyAgcG9pbnRzIG9mIGxpbmUgd2UgbmVlZCB0byBzZXQgb3JpZ2luYWwgZW5kXG4gICAgICAgICAgICAgICAgdmFyIGF0dHJzID0gS29udmEuVHdlZW4uYXR0cnNbbm9kZS5faWRdW3RoYXQuX2lkXTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cnMucG9pbnRzICYmIGF0dHJzLnBvaW50cy50cnVlRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucG9pbnRzKGF0dHJzLnBvaW50cy50cnVlRW5kKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhhdC5vbkZpbmlzaCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Lm9uRmluaXNoLmNhbGwodGhhdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudHdlZW4ub25SZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gdGhhdC5ub2RlO1xuICAgICAgICAgICAgICAgIC8vIGFmdGVyIHR3ZWVuaW5nICBwb2ludHMgb2YgbGluZSB3ZSBuZWVkIHRvIHNldCBvcmlnaW5hbCBzdGFydFxuICAgICAgICAgICAgICAgIHZhciBhdHRycyA9IEtvbnZhLlR3ZWVuLmF0dHJzW25vZGUuX2lkXVt0aGF0Ll9pZF07XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzLnBvaW50cyAmJiBhdHRycy5wb2ludHMudHJ1ZVN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucG9pbnRzKGF0dHJzLnBvaW50cy50cnVlU3RhcnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGF0Lm9uUmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5vblJlc2V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHBsYXlcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHdlZW4ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtUd2Vlbn1cbiAgICAgICAgICovXG4gICAgICAgIHBsYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50d2Vlbi5wbGF5KCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldmVyc2VcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHdlZW4ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtUd2Vlbn1cbiAgICAgICAgICovXG4gICAgICAgIHJldmVyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50d2Vlbi5yZXZlcnNlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlc2V0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlR3ZWVuLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7VHdlZW59XG4gICAgICAgICAqL1xuICAgICAgICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnR3ZWVuLnJlc2V0KCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNlZWtcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHdlZW4ucHJvdG90eXBlXG4gICAgICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gdCB0aW1lIGluIHNlY29uZHMgYmV0d2VlbiAwIGFuZCB0aGUgZHVyYXRpb25cbiAgICAgICAgICogQHJldHVybnMge1R3ZWVufVxuICAgICAgICAgKi9cbiAgICAgICAgc2VlazogZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdGhpcy50d2Vlbi5zZWVrKHQgKiAxMDAwKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogcGF1c2VcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVHdlZW4ucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtUd2Vlbn1cbiAgICAgICAgICovXG4gICAgICAgIHBhdXNlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMudHdlZW4ucGF1c2UoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZmluaXNoXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlR3ZWVuLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7VHdlZW59XG4gICAgICAgICAqL1xuICAgICAgICBmaW5pc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50d2Vlbi5maW5pc2goKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGVzdHJveVxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5Ud2Vlbi5wcm90b3R5cGVcbiAgICAgICAgICovXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vZGVJZCA9IHRoaXMubm9kZS5faWQsXG4gICAgICAgICAgICAgICAgdGhpc0lkID0gdGhpcy5faWQsXG4gICAgICAgICAgICAgICAgYXR0cnMgPSBLb252YS5Ud2Vlbi50d2VlbnNbbm9kZUlkXSxcbiAgICAgICAgICAgICAgICBrZXk7XG5cbiAgICAgICAgICAgIHRoaXMucGF1c2UoKTtcblxuICAgICAgICAgICAgZm9yIChrZXkgaW4gYXR0cnMpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgS29udmEuVHdlZW4udHdlZW5zW25vZGVJZF1ba2V5XTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVsZXRlIEtvbnZhLlR3ZWVuLmF0dHJzW25vZGVJZF1bdGhpc0lkXTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUd2VlbiBub2RlIHByb3BlcnRpZXMuIFNob3J0ZXIgdXNhZ2Ugb2Yge0BsaW5rIEtvbnZhLlR3ZWVufSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIEtvbnZhLk5vZGUjdG9cbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbcGFyYW1zXSB0d2VlbiBwYXJhbXNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogY2lyY2xlLnRvKHtcbiAgICAgKiAgeCA6IDUwLFxuICAgICAqICBkdXJhdGlvbiA6IDAuNVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnRvID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgIHZhciBvbkZpbmlzaCA9IHBhcmFtcy5vbkZpbmlzaDtcbiAgICAgICAgcGFyYW1zLm5vZGUgPSB0aGlzO1xuICAgICAgICBwYXJhbXMub25GaW5pc2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICAgICAgaWYgKG9uRmluaXNoKSB7XG4gICAgICAgICAgICAgICAgb25GaW5pc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHR3ZWVuID0gbmV3IEtvbnZhLlR3ZWVuKHBhcmFtcyk7XG4gICAgICAgIHR3ZWVuLnBsYXkoKTtcbiAgICB9O1xuXG4gICAgLypcbiAgICAqIFRoZXNlIGVhc2VzIHdlcmUgcG9ydGVkIGZyb20gYW4gQWRvYmUgRmxhc2ggdHdlZW5pbmcgbGlicmFyeSB0byBKYXZhU2NyaXB0XG4gICAgKiBieSBYYXJpY1xuICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAbmFtZXNwYWNlIEVhc2luZ3NcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKi9cbiAgICBLb252YS5FYXNpbmdzID0ge1xuICAgICAgICAvKipcbiAgICAgICAgKiBiYWNrIGVhc2UgaW5cbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnQmFja0Vhc2VJbic6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIHZhciBzID0gMS43MDE1ODtcbiAgICAgICAgICAgIHJldHVybiBjICogKHQgLz0gZCkgKiB0ICogKChzICsgMSkgKiB0IC0gcykgKyBiO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBiYWNrIGVhc2Ugb3V0XG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ0JhY2tFYXNlT3V0JzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgICAgICAgICAgdmFyIHMgPSAxLjcwMTU4O1xuICAgICAgICAgICAgcmV0dXJuIGMgKiAoKCB0ID0gdCAvIGQgLSAxKSAqIHQgKiAoKHMgKyAxKSAqIHQgKyBzKSArIDEpICsgYjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogYmFjayBlYXNlIGluIG91dFxuICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5FYXNpbmdzXG4gICAgICAgICovXG4gICAgICAgICdCYWNrRWFzZUluT3V0JzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgICAgICAgICAgdmFyIHMgPSAxLjcwMTU4O1xuICAgICAgICAgICAgaWYoKHQgLz0gZCAvIDIpIDwgMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjIC8gMiAqICh0ICogdCAqICgoKHMgKj0gKDEuNTI1KSkgKyAxKSAqIHQgLSBzKSkgKyBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGMgLyAyICogKCh0IC09IDIpICogdCAqICgoKHMgKj0gKDEuNTI1KSkgKyAxKSAqIHQgKyBzKSArIDIpICsgYjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogZWxhc3RpYyBlYXNlIGluXG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ0VsYXN0aWNFYXNlSW4nOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBhLCBwKSB7XG4gICAgICAgICAgICAvLyBhZGRlZCBzID0gMFxuICAgICAgICAgICAgdmFyIHMgPSAwO1xuICAgICAgICAgICAgaWYodCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoKHQgLz0gZCkgPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYiArIGM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighcCkge1xuICAgICAgICAgICAgICAgIHAgPSBkICogMC4zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7XG4gICAgICAgICAgICAgICAgYSA9IGM7XG4gICAgICAgICAgICAgICAgcyA9IHAgLyA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcyA9IHAgLyAoMiAqIE1hdGguUEkpICogTWF0aC5hc2luKGMgLyBhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAtKGEgKiBNYXRoLnBvdygyLCAxMCAqICh0IC09IDEpKSAqIE1hdGguc2luKCh0ICogZCAtIHMpICogKDIgKiBNYXRoLlBJKSAvIHApKSArIGI7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAqIGVsYXN0aWMgZWFzZSBvdXRcbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnRWxhc3RpY0Vhc2VPdXQnOiBmdW5jdGlvbih0LCBiLCBjLCBkLCBhLCBwKSB7XG4gICAgICAgICAgICAvLyBhZGRlZCBzID0gMFxuICAgICAgICAgICAgdmFyIHMgPSAwO1xuICAgICAgICAgICAgaWYodCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoKHQgLz0gZCkgPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYiArIGM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighcCkge1xuICAgICAgICAgICAgICAgIHAgPSBkICogMC4zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIWEgfHwgYSA8IE1hdGguYWJzKGMpKSB7XG4gICAgICAgICAgICAgICAgYSA9IGM7XG4gICAgICAgICAgICAgICAgcyA9IHAgLyA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcyA9IHAgLyAoMiAqIE1hdGguUEkpICogTWF0aC5hc2luKGMgLyBhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAoYSAqIE1hdGgucG93KDIsIC0xMCAqIHQpICogTWF0aC5zaW4oKHQgKiBkIC0gcykgKiAoMiAqIE1hdGguUEkpIC8gcCkgKyBjICsgYik7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAqIGVsYXN0aWMgZWFzZSBpbiBvdXRcbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnRWxhc3RpY0Vhc2VJbk91dCc6IGZ1bmN0aW9uKHQsIGIsIGMsIGQsIGEsIHApIHtcbiAgICAgICAgICAgIC8vIGFkZGVkIHMgPSAwXG4gICAgICAgICAgICB2YXIgcyA9IDA7XG4gICAgICAgICAgICBpZih0ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZigodCAvPSBkIC8gMikgPT09IDIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYiArIGM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighcCkge1xuICAgICAgICAgICAgICAgIHAgPSBkICogKDAuMyAqIDEuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighYSB8fCBhIDwgTWF0aC5hYnMoYykpIHtcbiAgICAgICAgICAgICAgICBhID0gYztcbiAgICAgICAgICAgICAgICBzID0gcCAvIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzID0gcCAvICgyICogTWF0aC5QSSkgKiBNYXRoLmFzaW4oYyAvIGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYodCA8IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTAuNSAqIChhICogTWF0aC5wb3coMiwgMTAgKiAodCAtPSAxKSkgKiBNYXRoLnNpbigodCAqIGQgLSBzKSAqICgyICogTWF0aC5QSSkgLyBwKSkgKyBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGEgKiBNYXRoLnBvdygyLCAtMTAgKiAodCAtPSAxKSkgKiBNYXRoLnNpbigodCAqIGQgLSBzKSAqICgyICogTWF0aC5QSSkgLyBwKSAqIDAuNSArIGMgKyBiO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBib3VuY2UgZWFzZSBvdXRcbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnQm91bmNlRWFzZU91dCc6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIGlmKCh0IC89IGQpIDwgKDEgLyAyLjc1KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjICogKDcuNTYyNSAqIHQgKiB0KSArIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHQgPCAoMiAvIDIuNzUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGMgKiAoNy41NjI1ICogKHQgLT0gKDEuNSAvIDIuNzUpKSAqIHQgKyAwLjc1KSArIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHQgPCAoMi41IC8gMi43NSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYyAqICg3LjU2MjUgKiAodCAtPSAoMi4yNSAvIDIuNzUpKSAqIHQgKyAwLjkzNzUpICsgYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBjICogKDcuNTYyNSAqICh0IC09ICgyLjYyNSAvIDIuNzUpKSAqIHQgKyAwLjk4NDM3NSkgKyBiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBib3VuY2UgZWFzZSBpblxuICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5FYXNpbmdzXG4gICAgICAgICovXG4gICAgICAgICdCb3VuY2VFYXNlSW4nOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICAgICAgICByZXR1cm4gYyAtIEtvbnZhLkVhc2luZ3MuQm91bmNlRWFzZU91dChkIC0gdCwgMCwgYywgZCkgKyBiO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBib3VuY2UgZWFzZSBpbiBvdXRcbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnQm91bmNlRWFzZUluT3V0JzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgICAgICAgICAgaWYodCA8IGQgLyAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtvbnZhLkVhc2luZ3MuQm91bmNlRWFzZUluKHQgKiAyLCAwLCBjLCBkKSAqIDAuNSArIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS29udmEuRWFzaW5ncy5Cb3VuY2VFYXNlT3V0KHQgKiAyIC0gZCwgMCwgYywgZCkgKiAwLjUgKyBjICogMC41ICsgYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogZWFzZSBpblxuICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5FYXNpbmdzXG4gICAgICAgICovXG4gICAgICAgICdFYXNlSW4nOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICAgICAgICByZXR1cm4gYyAqICh0IC89IGQpICogdCArIGI7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAqIGVhc2Ugb3V0XG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ0Vhc2VPdXQnOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICAgICAgICByZXR1cm4gLWMgKiAodCAvPSBkKSAqICh0IC0gMikgKyBiO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBlYXNlIGluIG91dFxuICAgICAgICAqIEBmdW5jdGlvblxuICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5FYXNpbmdzXG4gICAgICAgICovXG4gICAgICAgICdFYXNlSW5PdXQnOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICAgICAgICBpZigodCAvPSBkIC8gMikgPCAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGMgLyAyICogdCAqIHQgKyBiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIC1jIC8gMiAqICgoLS10KSAqICh0IC0gMikgLSAxKSArIGI7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAqIHN0cm9uZyBlYXNlIGluXG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ1N0cm9uZ0Vhc2VJbic6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIHJldHVybiBjICogKHQgLz0gZCkgKiB0ICogdCAqIHQgKiB0ICsgYjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogc3Ryb25nIGVhc2Ugb3V0XG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ1N0cm9uZ0Vhc2VPdXQnOiBmdW5jdGlvbih0LCBiLCBjLCBkKSB7XG4gICAgICAgICAgICByZXR1cm4gYyAqICgoIHQgPSB0IC8gZCAtIDEpICogdCAqIHQgKiB0ICogdCArIDEpICsgYjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICogc3Ryb25nIGVhc2UgaW4gb3V0XG4gICAgICAgICogQGZ1bmN0aW9uXG4gICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkVhc2luZ3NcbiAgICAgICAgKi9cbiAgICAgICAgJ1N0cm9uZ0Vhc2VJbk91dCc6IGZ1bmN0aW9uKHQsIGIsIGMsIGQpIHtcbiAgICAgICAgICAgIGlmKCh0IC89IGQgLyAyKSA8IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYyAvIDIgKiB0ICogdCAqIHQgKiB0ICogdCArIGI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYyAvIDIgKiAoKHQgLT0gMikgKiB0ICogdCAqIHQgKiB0ICsgMikgKyBiO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgKiBsaW5lYXJcbiAgICAgICAgKiBAZnVuY3Rpb25cbiAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuRWFzaW5nc1xuICAgICAgICAqL1xuICAgICAgICAnTGluZWFyJzogZnVuY3Rpb24odCwgYiwgYywgZCkge1xuICAgICAgICAgICAgcmV0dXJuIGMgKiB0IC8gZCArIGI7XG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBLb252YS5ERCA9IHtcbiAgICAgICAgLy8gcHJvcGVydGllc1xuICAgICAgICBhbmltOiBuZXcgS29udmEuQW5pbWF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmRpcnR5O1xuICAgICAgICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgIH0pLFxuICAgICAgICBpc0RyYWdnaW5nOiBmYWxzZSxcbiAgICAgICAganVzdERyYWdnZWQ6IGZhbHNlLFxuICAgICAgICBvZmZzZXQ6IHtcbiAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICB5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIG5vZGU6IG51bGwsXG5cbiAgICAgICAgLy8gbWV0aG9kc1xuICAgICAgICBfZHJhZzogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICB2YXIgZGQgPSBLb252YS5ERCxcbiAgICAgICAgICAgICAgICBub2RlID0gZGQubm9kZTtcblxuICAgICAgICAgICAgaWYobm9kZSkge1xuICAgICAgICAgICAgICAgaWYoIWRkLmlzRHJhZ2dpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IG5vZGUuZ2V0U3RhZ2UoKS5nZXRQb2ludGVyUG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRyYWdEaXN0YW5jZSA9IG5vZGUuZHJhZ0Rpc3RhbmNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IE1hdGgubWF4KFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMocG9zLnggLSBkZC5zdGFydFBvaW50ZXJQb3MueCksXG4gICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhwb3MueSAtIGRkLnN0YXJ0UG9pbnRlclBvcy55KVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPCBkcmFnRGlzdGFuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgbm9kZS5nZXRTdGFnZSgpLl9zZXRQb2ludGVyUG9zaXRpb24oZXZ0KTtcbiAgICAgICAgICAgICAgICBub2RlLl9zZXREcmFnUG9zaXRpb24oZXZ0KTtcbiAgICAgICAgICAgICAgICBpZighZGQuaXNEcmFnZ2luZykge1xuICAgICAgICAgICAgICAgICAgICBkZC5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5maXJlKCdkcmFnc3RhcnQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZHJhZ3N0YXJ0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dDogZXZ0XG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGUgb25kcmFnbW92ZSBpZiBkZWZpbmVkXG4gICAgICAgICAgICAgICAgbm9kZS5maXJlKCdkcmFnbW92ZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RyYWdtb3ZlJyxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBub2RlLFxuICAgICAgICAgICAgICAgICAgICBldnQ6IGV2dFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfZW5kRHJhZ0JlZm9yZTogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICB2YXIgZGQgPSBLb252YS5ERCxcbiAgICAgICAgICAgICAgICBub2RlID0gZGQubm9kZSxcbiAgICAgICAgICAgICAgICBsYXllcjtcblxuICAgICAgICAgICAgaWYobm9kZSkge1xuICAgICAgICAgICAgICAgIGxheWVyID0gbm9kZS5nZXRMYXllcigpO1xuICAgICAgICAgICAgICAgIGRkLmFuaW0uc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gb25seSBmaXJlIGRyYWdlbmQgZXZlbnQgaWYgdGhlIGRyYWcgYW5kIGRyb3BcbiAgICAgICAgICAgICAgICAvLyBvcGVyYXRpb24gYWN0dWFsbHkgc3RhcnRlZC5cbiAgICAgICAgICAgICAgICBpZihkZC5pc0RyYWdnaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGRkLmlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZGQuanVzdERyYWdnZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBLb252YS5saXN0ZW5DbGlja1RhcCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2dC5kcmFnRW5kTm9kZSA9IG5vZGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkZWxldGUgZGQubm9kZTtcblxuICAgICAgICAgICAgICAgIGlmIChub2RlLmdldExheWVyKCkgfHwgbGF5ZXIpIHtcbiAgICAgICAgICAgICAgICAgIChsYXllciB8fCBub2RlKS5kcmF3KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9lbmREcmFnQWZ0ZXI6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgZXZ0ID0gZXZ0IHx8IHt9O1xuICAgICAgICAgICAgdmFyIGRyYWdFbmROb2RlID0gZXZ0LmRyYWdFbmROb2RlO1xuXG4gICAgICAgICAgICBpZiAoZXZ0ICYmIGRyYWdFbmROb2RlKSB7XG4gICAgICAgICAgICAgICAgZHJhZ0VuZE5vZGUuZmlyZSgnZHJhZ2VuZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RyYWdlbmQnLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGRyYWdFbmROb2RlLFxuICAgICAgICAgICAgICAgICAgICBldnQ6IGV2dFxuICAgICAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIE5vZGUgZXh0ZW5kZXJzXG5cbiAgICAvKipcbiAgICAgKiBpbml0aWF0ZSBkcmFnIGFuZCBkcm9wXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqL1xuICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnN0YXJ0RHJhZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGQgPSBLb252YS5ERCxcbiAgICAgICAgICAgIHN0YWdlID0gdGhpcy5nZXRTdGFnZSgpLFxuICAgICAgICAgICAgbGF5ZXIgPSB0aGlzLmdldExheWVyKCksXG4gICAgICAgICAgICBwb3MgPSBzdGFnZS5nZXRQb2ludGVyUG9zaXRpb24oKSxcbiAgICAgICAgICAgIGFwID0gdGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCk7XG5cbiAgICAgICAgaWYocG9zKSB7XG4gICAgICAgICAgICBpZiAoZGQubm9kZSkge1xuICAgICAgICAgICAgICAgIGRkLm5vZGUuc3RvcERyYWcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGQubm9kZSA9IHRoaXM7XG4gICAgICAgICAgICBkZC5zdGFydFBvaW50ZXJQb3MgPSBwb3M7XG4gICAgICAgICAgICBkZC5vZmZzZXQueCA9IHBvcy54IC0gYXAueDtcbiAgICAgICAgICAgIGRkLm9mZnNldC55ID0gcG9zLnkgLSBhcC55O1xuICAgICAgICAgICAgZGQuYW5pbS5zZXRMYXllcnMobGF5ZXIgfHwgdGhpcy5nZXRMYXllcnMoKSk7XG4gICAgICAgICAgICBkZC5hbmltLnN0YXJ0KCk7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldERyYWdQb3NpdGlvbigpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLl9zZXREcmFnUG9zaXRpb24gPSBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgdmFyIGRkID0gS29udmEuREQsXG4gICAgICAgICAgICBwb3MgPSB0aGlzLmdldFN0YWdlKCkuZ2V0UG9pbnRlclBvc2l0aW9uKCksXG4gICAgICAgICAgICBkYmYgPSB0aGlzLmdldERyYWdCb3VuZEZ1bmMoKTtcbiAgICAgICAgaWYgKCFwb3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3Tm9kZVBvcyA9IHtcbiAgICAgICAgICAgIHg6IHBvcy54IC0gZGQub2Zmc2V0LngsXG4gICAgICAgICAgICB5OiBwb3MueSAtIGRkLm9mZnNldC55XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYoZGJmICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5ld05vZGVQb3MgPSBkYmYuY2FsbCh0aGlzLCBuZXdOb2RlUG9zLCBldnQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0QWJzb2x1dGVQb3NpdGlvbihuZXdOb2RlUG9zKTtcblxuICAgICAgICBpZiAoIXRoaXMuX2xhc3RQb3MgfHwgdGhpcy5fbGFzdFBvcy54ICE9PSBuZXdOb2RlUG9zLnggfHxcbiAgICAgICAgICAgIHRoaXMuX2xhc3RQb3MueSAhPT0gbmV3Tm9kZVBvcy55KSB7XG4gICAgICAgICAgICBkZC5hbmltLmRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2xhc3RQb3MgPSBuZXdOb2RlUG9zO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBzdG9wIGRyYWcgYW5kIGRyb3BcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICovXG4gICAgS29udmEuTm9kZS5wcm90b3R5cGUuc3RvcERyYWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRkID0gS29udmEuREQsXG4gICAgICAgICAgICBldnQgPSB7fTtcbiAgICAgICAgZGQuX2VuZERyYWdCZWZvcmUoZXZ0KTtcbiAgICAgICAgZGQuX2VuZERyYWdBZnRlcihldnQpO1xuICAgIH07XG5cbiAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXREcmFnZ2FibGUgPSBmdW5jdGlvbihkcmFnZ2FibGUpIHtcbiAgICAgICAgdGhpcy5fc2V0QXR0cignZHJhZ2dhYmxlJywgZHJhZ2dhYmxlKTtcbiAgICAgICAgdGhpcy5fZHJhZ0NoYW5nZSgpO1xuICAgIH07XG5cbiAgICB2YXIgb3JpZ0Rlc3Ryb3kgPSBLb252YS5Ob2RlLnByb3RvdHlwZS5kZXN0cm95O1xuXG4gICAgS29udmEuTm9kZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGQgPSBLb252YS5ERDtcblxuICAgICAgICAvLyBzdG9wIEREXG4gICAgICAgIGlmKGRkLm5vZGUgJiYgZGQubm9kZS5faWQgPT09IHRoaXMuX2lkKSB7XG5cbiAgICAgICAgICAgIHRoaXMuc3RvcERyYWcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9yaWdEZXN0cm95LmNhbGwodGhpcyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGRldGVybWluZSBpZiBub2RlIGlzIGN1cnJlbnRseSBpbiBkcmFnIGFuZCBkcm9wIG1vZGVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLk5vZGUucHJvdG90eXBlXG4gICAgICovXG4gICAgS29udmEuTm9kZS5wcm90b3R5cGUuaXNEcmFnZ2luZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGQgPSBLb252YS5ERDtcbiAgICAgICAgcmV0dXJuICEhKGRkLm5vZGUgJiYgZGQubm9kZS5faWQgPT09IHRoaXMuX2lkICYmIGRkLmlzRHJhZ2dpbmcpO1xuICAgIH07XG5cbiAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5fbGlzdGVuRHJhZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5fZHJhZ0NsZWFudXAoKTtcblxuICAgICAgICBpZiAodGhpcy5nZXRDbGFzc05hbWUoKSA9PT0gJ1N0YWdlJykge1xuICAgICAgICAgICAgdGhpcy5vbignY29udGVudE1vdXNlZG93bi5rb252YSBjb250ZW50VG91Y2hzdGFydC5rb252YScsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgICAgIGlmKCFLb252YS5ERC5ub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc3RhcnREcmFnKGV2dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9uKCdtb3VzZWRvd24ua29udmEgdG91Y2hzdGFydC5rb252YScsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSByaWdodCBhbmQgbWlkZGxlIGJ1dHRvbnNcbiAgICAgICAgICAgICAgICBpZiAoZXZ0LmV2dC5idXR0b24gPT09IDEgfHwgZXZ0LmV2dC5idXR0b24gPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZighS29udmEuREQubm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnN0YXJ0RHJhZyhldnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbGlzdGVuaW5nIGlzIHJlcXVpcmVkIGZvciBkcmFnIGFuZCBkcm9wXG4gICAgICAgIC8qXG4gICAgICAgIHRoaXMuX2xpc3RlbmluZ0VuYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jbGVhclNlbGZBbmRBbmNlc3RvckNhY2hlKCdsaXN0ZW5pbmdFbmFibGVkJyk7XG4gICAgICAgICovXG4gICAgfTtcblxuICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLl9kcmFnQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHRoaXMuYXR0cnMuZHJhZ2dhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5EcmFnKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgICAgICB0aGlzLl9kcmFnQ2xlYW51cCgpO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogZm9yY2UgZHJhZyBhbmQgZHJvcCB0byBlbmRcbiAgICAgICAgICAgICAqIGlmIHRoaXMgbm9kZSBpcyBjdXJyZW50bHkgaW5cbiAgICAgICAgICAgICAqIGRyYWcgYW5kIGRyb3AgbW9kZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgc3RhZ2UgPSB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgICAgICB2YXIgZGQgPSBLb252YS5ERDtcbiAgICAgICAgICAgIGlmKHN0YWdlICYmIGRkLm5vZGUgJiYgZGQubm9kZS5faWQgPT09IHRoaXMuX2lkKSB7XG4gICAgICAgICAgICAgICAgZGQubm9kZS5zdG9wRHJhZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLl9kcmFnQ2xlYW51cCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5nZXRDbGFzc05hbWUoKSA9PT0gJ1N0YWdlJykge1xuICAgICAgICAgICAgdGhpcy5vZmYoJ2NvbnRlbnRNb3VzZWRvd24ua29udmEnKTtcbiAgICAgICAgICAgIHRoaXMub2ZmKCdjb250ZW50VG91Y2hzdGFydC5rb252YScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vZmYoJ21vdXNlZG93bi5rb252YScpO1xuICAgICAgICAgICAgdGhpcy5vZmYoJ3RvdWNoc3RhcnQua29udmEnKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZHJhZ0JvdW5kRnVuYycpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBkcmFnIGJvdW5kIGZ1bmN0aW9uLiAgVGhpcyBpcyB1c2VkIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0XG4gICAgICogIGRyYWcgYW5kIGRyb3AgcG9zaXRpb25cbiAgICAgKiBAbmFtZSBkcmFnQm91bmRGdW5jXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5Ob2RlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGRyYWdCb3VuZEZ1bmNcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZHJhZyBib3VuZCBmdW5jdGlvblxuICAgICAqIHZhciBkcmFnQm91bmRGdW5jID0gbm9kZS5kcmFnQm91bmRGdW5jKCk7XG4gICAgICpcbiAgICAgKiAvLyBjcmVhdGUgdmVydGljYWwgZHJhZyBhbmQgZHJvcFxuICAgICAqIG5vZGUuZHJhZ0JvdW5kRnVuYyhmdW5jdGlvbihwb3Mpe1xuICAgICAqICAgcmV0dXJuIHtcbiAgICAgKiAgICAgeDogdGhpcy5nZXRBYnNvbHV0ZVBvc2l0aW9uKCkueCxcbiAgICAgKiAgICAgeTogcG9zLnlcbiAgICAgKiAgIH07XG4gICAgICogfSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlcihLb252YS5Ob2RlLCAnZHJhZ2dhYmxlJywgZmFsc2UpO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihLb252YS5Ob2RlLCAnZHJhZ2dhYmxlJyk7XG5cbiAgICAgLyoqXG4gICAgICogZ2V0L3NldCBkcmFnZ2FibGUgZmxhZ1xuICAgICAqIEBuYW1lIGRyYWdnYWJsZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTm9kZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGRyYWdnYWJsZVxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGRyYWdnYWJsZSBmbGFnXG4gICAgICogdmFyIGRyYWdnYWJsZSA9IG5vZGUuZHJhZ2dhYmxlKCk7XG4gICAgICpcbiAgICAgKiAvLyBlbmFibGUgZHJhZyBhbmQgZHJvcFxuICAgICAqIG5vZGUuZHJhZ2dhYmxlKHRydWUpO1xuICAgICAqXG4gICAgICogLy8gZGlzYWJsZSBkcmFnIGFuZCBkcm9wXG4gICAgICogbm9kZS5kcmFnZ2FibGUoZmFsc2UpO1xuICAgICAqL1xuXG4gICAgdmFyIGh0bWwgPSBLb252YS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgaHRtbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgS29udmEuREQuX2VuZERyYWdCZWZvcmUsIHRydWUpO1xuICAgIGh0bWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBLb252YS5ERC5fZW5kRHJhZ0JlZm9yZSwgdHJ1ZSk7XG5cbiAgICBodG1sLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIEtvbnZhLkRELl9kcmFnKTtcbiAgICBodG1sLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIEtvbnZhLkRELl9kcmFnKTtcblxuICAgIGh0bWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIEtvbnZhLkRELl9lbmREcmFnQWZ0ZXIsIGZhbHNlKTtcbiAgICBodG1sLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgS29udmEuREQuX2VuZERyYWdBZnRlciwgZmFsc2UpO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIFJlY3QgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY29ybmVyUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgcmVjdCA9IG5ldyBLb252YS5SZWN0KHtcbiAgICAgKiAgIHdpZHRoOiAxMDAsXG4gICAgICogICBoZWlnaHQ6IDUwLFxuICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICogICBzdHJva2U6ICdibGFjaycsXG4gICAgICogICBzdHJva2VXaWR0aDogNVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLlJlY3QgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlJlY3QucHJvdG90eXBlID0ge1xuICAgICAgICBfX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIEtvbnZhLlNoYXBlLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJ1JlY3QnO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGNvcm5lclJhZGl1cyA9IHRoaXMuZ2V0Q29ybmVyUmFkaXVzKCksXG4gICAgICAgICAgICAgICAgd2lkdGggPSB0aGlzLmdldFdpZHRoKCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKTtcblxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcblxuICAgICAgICAgICAgaWYoIWNvcm5lclJhZGl1cykge1xuICAgICAgICAgICAgICAgIC8vIHNpbXBsZSByZWN0IC0gZG9uJ3QgYm90aGVyIGRvaW5nIGFsbCB0aGF0IGNvbXBsaWNhdGVkIG1hdGhzIHN0dWZmLlxuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYXJjVG8gd291bGQgYmUgbmljZXIsIGJ1dCBicm93c2VyIHN1cHBvcnQgaXMgcGF0Y2h5IChPcGVyYSlcbiAgICAgICAgICAgICAgICBjb3JuZXJSYWRpdXMgPSBNYXRoLm1pbihjb3JuZXJSYWRpdXMsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8oY29ybmVyUmFkaXVzLCAwKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCAtIGNvcm5lclJhZGl1cywgMCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5hcmMod2lkdGggLSBjb3JuZXJSYWRpdXMsIGNvcm5lclJhZGl1cywgY29ybmVyUmFkaXVzLCBNYXRoLlBJICogMyAvIDIsIDAsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCwgaGVpZ2h0IC0gY29ybmVyUmFkaXVzKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFyYyh3aWR0aCAtIGNvcm5lclJhZGl1cywgaGVpZ2h0IC0gY29ybmVyUmFkaXVzLCBjb3JuZXJSYWRpdXMsIDAsIE1hdGguUEkgLyAyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oY29ybmVyUmFkaXVzLCBoZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKGNvcm5lclJhZGl1cywgaGVpZ2h0IC0gY29ybmVyUmFkaXVzLCBjb3JuZXJSYWRpdXMsIE1hdGguUEkgLyAyLCBNYXRoLlBJLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oMCwgY29ybmVyUmFkaXVzKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFyYyhjb3JuZXJSYWRpdXMsIGNvcm5lclJhZGl1cywgY29ybmVyUmFkaXVzLCBNYXRoLlBJLCBNYXRoLlBJICogMyAvIDIsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5SZWN0LCBLb252YS5TaGFwZSk7XG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5SZWN0LCAnY29ybmVyUmFkaXVzJywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBjb3JuZXIgcmFkaXVzXG4gICAgICogQG5hbWUgY29ybmVyUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5SZWN0LnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3JuZXJSYWRpdXNcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNvcm5lciByYWRpdXNcbiAgICAgKiB2YXIgY29ybmVyUmFkaXVzID0gcmVjdC5jb3JuZXJSYWRpdXMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBjb3JuZXIgcmFkaXVzXG4gICAgICogcmVjdC5jb3JuZXJSYWRpdXMoMTApO1xuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLlJlY3QpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyB0aGUgMC4wMDAxIG9mZnNldCBmaXhlcyBhIGJ1ZyBpbiBDaHJvbWUgMjdcbiAgICB2YXIgUEl4MiA9IChNYXRoLlBJICogMikgLSAwLjAwMDEsXG4gICAgICAgIENJUkNMRSA9ICdDaXJjbGUnO1xuXG4gICAgLyoqXG4gICAgICogQ2lyY2xlIGNvbnN0cnVjdG9yXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLlNoYXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb25maWcucmFkaXVzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbF0gZmlsbCBjb2xvclxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IFtjb25maWcuZmlsbFBhdHRlcm5JbWFnZV0gZmlsbCBwYXR0ZXJuIGltYWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5YXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WV0gXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZV0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblJvdGF0aW9uXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQYXR0ZXJuUmVwZWF0XSBjYW4gYmUgXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIG9yIFwibm8tcmVwZWF0XCIuICBUaGUgZGVmYXVsdCBpcyBcIm5vLXJlcGVhdFwiXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5maWxsRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBmaWxsLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQcmlvcml0eV0gY2FuIGJlIGNvbG9yLCBsaW5lYXItZ3JhZGllbnQsIHJhZGlhbC1ncmFpZGVudCwgb3IgcGF0dGVybi4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGNvbG9yLiAgVGhlIGZpbGxQcmlvcml0eSBwcm9wZXJ0eSBtYWtlcyBpdCByZWFsbHkgZWFzeSB0byB0b2dnbGUgYmV0d2VlbiBkaWZmZXJlbnQgZmlsbCB0eXBlcy4gIEZvciBleGFtcGxlLCBpZiB5b3Ugd2FudCB0byB0b2dnbGUgYmV0d2VlbiBhIGZpbGwgY29sb3Igc3R5bGUgYW5kIGEgZmlsbCBwYXR0ZXJuIHN0eWxlLCBzaW1wbHkgc2V0IHRoZSBmaWxsIHByb3BlcnR5IGFuZCB0aGUgZmlsbFBhdHRlcm4gcHJvcGVydGllcywgYW5kIHRoZW4gdXNlIHNldEZpbGxQcmlvcml0eSgnY29sb3InKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggYSBjb2xvciBmaWxsLCBvciB1c2Ugc2V0RmlsbFByaW9yaXR5KCdwYXR0ZXJuJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIHRoZSBwYXR0ZXJuIGZpbGwgY29uZmlndXJhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnN0cm9rZV0gc3Ryb2tlIGNvbG9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc3Ryb2tlV2lkdGhdIHN0cm9rZSB3aWR0aFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VIaXRFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIGhpdCByZWdpb24uICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnBlcmZlY3REcmF3RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHVzaW5nIGJ1ZmZlciBjYW52YXMuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzaGFzb3cgZm9yIHN0cm9rZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlU2NhbGVFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIHNjYWxlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHN0cm9rZS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lSm9pbl0gY2FuIGJlIG1pdGVyLCByb3VuZCwgb3IgYmV2ZWwuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBtaXRlclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVDYXBdIGNhbiBiZSBidXR0LCByb3VuZCwgb3Igc3FhcmUuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBidXR0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc2hhZG93Q29sb3JdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93Qmx1cl1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zaGFkb3dPZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09wYWNpdHldIHNoYWRvdyBvcGFjaXR5LiAgQ2FuIGJlIGFueSByZWFsIG51bWJlclxuICAgICAqICBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzaGFkb3cuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5kYXNoXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kYXNoRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBkYXNoQXJyYXkuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGNyZWF0ZSBjaXJjbGVcbiAgICAgKiB2YXIgY2lyY2xlID0gbmV3IEtvbnZhLkNpcmNsZSh7XG4gICAgICogICByYWRpdXM6IDQwLFxuICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICogICBzdHJva2U6ICdibGFjaydcbiAgICAgKiAgIHN0cm9rZVdpZHRoOiA1XG4gICAgICogfSk7XG4gICAgICovXG4gICAgS29udmEuQ2lyY2xlID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5DaXJjbGUucHJvdG90eXBlID0ge1xuICAgICAgICBfY2VudHJvaWQ6IHRydWUsXG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBDSVJDTEU7XG4gICAgICAgICAgICB0aGlzLnNjZW5lRnVuYyh0aGlzLl9zY2VuZUZ1bmMpO1xuICAgICAgICB9LFxuICAgICAgICBfc2NlbmVGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5nZXRSYWRpdXMoKSwgMCwgUEl4MiwgZmFsc2UpO1xuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5nZXRXaWR0aCgpXG4gICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJhZGl1cygpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuZ2V0SGVpZ2h0KClcbiAgICAgICAgZ2V0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJhZGl1cygpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuc2V0V2lkdGgoKVxuICAgICAgICBzZXRXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldFdpZHRoLmNhbGwodGhpcywgd2lkdGgpO1xuICAgICAgICAgICAgaWYgKHRoaXMucmFkaXVzKCkgIT09IHdpZHRoIC8gMikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0UmFkaXVzKHdpZHRoIC8gMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLnNldEhlaWdodCgpXG4gICAgICAgIHNldEhlaWdodDogZnVuY3Rpb24oaGVpZ2h0KSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRIZWlnaHQuY2FsbCh0aGlzLCBoZWlnaHQpO1xuICAgICAgICAgICAgaWYgKHRoaXMucmFkaXVzKCkgIT09IGhlaWdodCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFJhZGl1cyhoZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuQ2lyY2xlLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuQ2lyY2xlLCAncmFkaXVzJywgMCk7XG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLkNpcmNsZSwgJ3JhZGl1cycpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCByYWRpdXNcbiAgICAgKiBAbmFtZSByYWRpdXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkNpcmNsZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCByYWRpdXNcbiAgICAgKiB2YXIgcmFkaXVzID0gY2lyY2xlLnJhZGl1cygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHJhZGl1c1xuICAgICAqIGNpcmNsZS5yYWRpdXMoMTApO1xuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLkNpcmNsZSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIHRoZSAwLjAwMDEgb2Zmc2V0IGZpeGVzIGEgYnVnIGluIENocm9tZSAyN1xuICAgIHZhciBQSXgyID0gKE1hdGguUEkgKiAyKSAtIDAuMDAwMSxcbiAgICAgICAgRUxMSVBTRSA9ICdFbGxpcHNlJztcblxuICAgIC8qKlxuICAgICAqIEVsbGlwc2UgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZy5yYWRpdXMgZGVmaW5lcyB4IGFuZCB5IHJhZGl1c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgZWxsaXBzZSA9IG5ldyBLb252YS5FbGxpcHNlKHtcbiAgICAgKiAgIHJhZGl1cyA6IHtcbiAgICAgKiAgICAgeCA6IDUwLFxuICAgICAqICAgICB5IDogNTBcbiAgICAgKiAgIH0sXG4gICAgICogICBmaWxsOiAncmVkJ1xuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLkVsbGlwc2UgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLkVsbGlwc2UucHJvdG90eXBlID0ge1xuICAgICAgICBfY2VudHJvaWQ6IHRydWUsXG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBFTExJUFNFO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHJ4ID0gdGhpcy5nZXRSYWRpdXNYKCksXG4gICAgICAgICAgICAgICAgcnkgPSB0aGlzLmdldFJhZGl1c1koKTtcblxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuICAgICAgICAgICAgaWYocnggIT09IHJ5KSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zY2FsZSgxLCByeSAvIHJ4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHJ4LCAwLCBQSXgyLCBmYWxzZSk7XG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuZ2V0V2lkdGgoKVxuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSYWRpdXNYKCkgKiAyO1xuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5nZXRIZWlnaHQoKVxuICAgICAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmFkaXVzWSgpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuc2V0V2lkdGgoKVxuICAgICAgICBzZXRXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldFdpZHRoLmNhbGwodGhpcywgd2lkdGgpO1xuICAgICAgICAgICAgdGhpcy5zZXRSYWRpdXMoe1xuICAgICAgICAgICAgICAgIHg6IHdpZHRoIC8gMlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLnNldEhlaWdodCgpXG4gICAgICAgIHNldEhlaWdodDogZnVuY3Rpb24oaGVpZ2h0KSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRIZWlnaHQuY2FsbCh0aGlzLCBoZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5zZXRSYWRpdXMoe1xuICAgICAgICAgICAgICAgIHk6IGhlaWdodCAvIDJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5FbGxpcHNlLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKEtvbnZhLkVsbGlwc2UsICdyYWRpdXMnLCBbJ3gnLCAneSddKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgcmFkaXVzXG4gICAgICogQG5hbWUgcmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5FbGxpcHNlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByYWRpdXNcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzLnhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzLnlcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHJhZGl1c1xuICAgICAqIHZhciByYWRpdXMgPSBlbGxpcHNlLnJhZGl1cygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHJhZGl1c1xuICAgICAqIGVsbGlwc2UucmFkaXVzKHtcbiAgICAgKiAgIHg6IDIwMCxcbiAgICAgKiAgIHk6IDEwMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuRWxsaXBzZSwgJ3JhZGl1c1gnLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHJhZGl1cyB4XG4gICAgICogQG5hbWUgcmFkaXVzWFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuRWxsaXBzZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geFxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgcmFkaXVzIHhcbiAgICAgKiB2YXIgcmFkaXVzWCA9IGVsbGlwc2UucmFkaXVzWCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHJhZGl1cyB4XG4gICAgICogZWxsaXBzZS5yYWRpdXNYKDIwMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5FbGxpcHNlLCAncmFkaXVzWScsIDApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgcmFkaXVzIHlcbiAgICAgKiBAbmFtZSByYWRpdXNZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5FbGxpcHNlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB5XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCByYWRpdXMgeVxuICAgICAqIHZhciByYWRpdXNZID0gZWxsaXBzZS5yYWRpdXNZKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgcmFkaXVzIHlcbiAgICAgKiBlbGxpcHNlLnJhZGl1c1koMjAwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5FbGxpcHNlKTtcblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyB0aGUgMC4wMDAxIG9mZnNldCBmaXhlcyBhIGJ1ZyBpbiBDaHJvbWUgMjdcbiAgICB2YXIgUEl4MiA9IChNYXRoLlBJICogMikgLSAwLjAwMDE7XG4gICAgLyoqXG4gICAgICogUmluZyBjb25zdHJ1Y3RvclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBhdWdtZW50cyBLb252YS5TaGFwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29uZmlnLmlubmVyUmFkaXVzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5vdXRlclJhZGl1c1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5jbG9ja3dpc2VdXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbF0gZmlsbCBjb2xvclxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IFtjb25maWcuZmlsbFBhdHRlcm5JbWFnZV0gZmlsbCBwYXR0ZXJuIGltYWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5YXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WV0gXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZV0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblJvdGF0aW9uXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQYXR0ZXJuUmVwZWF0XSBjYW4gYmUgXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIG9yIFwibm8tcmVwZWF0XCIuICBUaGUgZGVmYXVsdCBpcyBcIm5vLXJlcGVhdFwiXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5maWxsRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBmaWxsLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQcmlvcml0eV0gY2FuIGJlIGNvbG9yLCBsaW5lYXItZ3JhZGllbnQsIHJhZGlhbC1ncmFpZGVudCwgb3IgcGF0dGVybi4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGNvbG9yLiAgVGhlIGZpbGxQcmlvcml0eSBwcm9wZXJ0eSBtYWtlcyBpdCByZWFsbHkgZWFzeSB0byB0b2dnbGUgYmV0d2VlbiBkaWZmZXJlbnQgZmlsbCB0eXBlcy4gIEZvciBleGFtcGxlLCBpZiB5b3Ugd2FudCB0byB0b2dnbGUgYmV0d2VlbiBhIGZpbGwgY29sb3Igc3R5bGUgYW5kIGEgZmlsbCBwYXR0ZXJuIHN0eWxlLCBzaW1wbHkgc2V0IHRoZSBmaWxsIHByb3BlcnR5IGFuZCB0aGUgZmlsbFBhdHRlcm4gcHJvcGVydGllcywgYW5kIHRoZW4gdXNlIHNldEZpbGxQcmlvcml0eSgnY29sb3InKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggYSBjb2xvciBmaWxsLCBvciB1c2Ugc2V0RmlsbFByaW9yaXR5KCdwYXR0ZXJuJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIHRoZSBwYXR0ZXJuIGZpbGwgY29uZmlndXJhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnN0cm9rZV0gc3Ryb2tlIGNvbG9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc3Ryb2tlV2lkdGhdIHN0cm9rZSB3aWR0aFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VIaXRFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIGhpdCByZWdpb24uICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnBlcmZlY3REcmF3RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHVzaW5nIGJ1ZmZlciBjYW52YXMuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzaGFzb3cgZm9yIHN0cm9rZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlU2NhbGVFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIHNjYWxlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHN0cm9rZS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lSm9pbl0gY2FuIGJlIG1pdGVyLCByb3VuZCwgb3IgYmV2ZWwuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBtaXRlclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVDYXBdIGNhbiBiZSBidXR0LCByb3VuZCwgb3Igc3FhcmUuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBidXR0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc2hhZG93Q29sb3JdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93Qmx1cl1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zaGFkb3dPZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09wYWNpdHldIHNoYWRvdyBvcGFjaXR5LiAgQ2FuIGJlIGFueSByZWFsIG51bWJlclxuICAgICAqICBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzaGFkb3cuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5kYXNoXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kYXNoRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBkYXNoQXJyYXkuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciByaW5nID0gbmV3IEtvbnZhLlJpbmcoe1xuICAgICAqICAgaW5uZXJSYWRpdXM6IDQwLFxuICAgICAqICAgb3V0ZXJSYWRpdXM6IDgwLFxuICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICogICBzdHJva2U6ICdibGFjaycsXG4gICAgICogICBzdHJva2VXaWR0aDogNVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLlJpbmcgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlJpbmcucHJvdG90eXBlID0ge1xuICAgICAgICBfY2VudHJvaWQ6IHRydWUsXG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSAnUmluZyc7XG4gICAgICAgICAgICB0aGlzLnNjZW5lRnVuYyh0aGlzLl9zY2VuZUZ1bmMpO1xuICAgICAgICB9LFxuICAgICAgICBfc2NlbmVGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5nZXRJbm5lclJhZGl1cygpLCAwLCBQSXgyLCBmYWxzZSk7XG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyh0aGlzLmdldE91dGVyUmFkaXVzKCksIDApO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5nZXRPdXRlclJhZGl1cygpLCBQSXgyLCAwLCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuZ2V0V2lkdGgoKVxuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRPdXRlclJhZGl1cygpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuZ2V0SGVpZ2h0KClcbiAgICAgICAgZ2V0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE91dGVyUmFkaXVzKCkgKiAyO1xuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5zZXRXaWR0aCgpXG4gICAgICAgIHNldFdpZHRoOiBmdW5jdGlvbih3aWR0aCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0V2lkdGguY2FsbCh0aGlzLCB3aWR0aCk7XG4gICAgICAgICAgICBpZiAodGhpcy5vdXRlclJhZGl1cygpICE9PSB3aWR0aCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE91dGVyUmFkaXVzKHdpZHRoIC8gMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLnNldEhlaWdodCgpXG4gICAgICAgIHNldEhlaWdodDogZnVuY3Rpb24oaGVpZ2h0KSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRIZWlnaHQuY2FsbCh0aGlzLCBoZWlnaHQpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3V0ZXJSYWRpdXMoKSAhPT0gaGVpZ2h0IC8gMikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0T3V0ZXJSYWRpdXMoaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNldE91dGVyUmFkaXVzOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldEF0dHIoJ291dGVyUmFkaXVzJywgdmFsKTtcbiAgICAgICAgICAgIHRoaXMuc2V0V2lkdGgodmFsICogMik7XG4gICAgICAgICAgICB0aGlzLnNldEhlaWdodCh2YWwgKiAyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuUmluZywgS29udmEuU2hhcGUpO1xuXG4gICAgLy8gYWRkIGdldHRlcnMgc2V0dGVyc1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlJpbmcsICdpbm5lclJhZGl1cycsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBpbm5lclJhZGl1c1xuICAgICAqIEBuYW1lIGlubmVyUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5SaW5nLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbm5lclJhZGl1c1xuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgaW5uZXIgcmFkaXVzXG4gICAgICogdmFyIGlubmVyUmFkaXVzID0gcmluZy5pbm5lclJhZGl1cygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGlubmVyIHJhZGl1c1xuICAgICAqIHJpbmcuaW5uZXJSYWRpdXMoMjApO1xuICAgICAqL1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyKEtvbnZhLlJpbmcsICdvdXRlclJhZGl1cycsIDApO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkT3ZlcmxvYWRlZEdldHRlclNldHRlcihLb252YS5SaW5nLCAnb3V0ZXJSYWRpdXMnKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgb3V0ZXJSYWRpdXNcbiAgICAgKiBAbmFtZSBvdXRlclJhZGl1c1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuUmluZy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gb3V0ZXJSYWRpdXNcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IG91dGVyIHJhZGl1c1xuICAgICAqIHZhciBvdXRlclJhZGl1cyA9IHJpbmcub3V0ZXJSYWRpdXMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBvdXRlciByYWRpdXNcbiAgICAgKiByaW5nLm91dGVyUmFkaXVzKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5SaW5nKTtcbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogV2VkZ2UgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5hbmdsZSBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5yYWRpdXNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuY2xvY2t3aXNlXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBkcmF3IGEgd2VkZ2UgdGhhdCdzIHBvaW50aW5nIGRvd253YXJkc1xuICAgICAqIHZhciB3ZWRnZSA9IG5ldyBLb252YS5XZWRnZSh7XG4gICAgICogICByYWRpdXM6IDQwLFxuICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICogICBzdHJva2U6ICdibGFjaydcbiAgICAgKiAgIHN0cm9rZVdpZHRoOiA1LFxuICAgICAqICAgYW5nbGVEZWc6IDYwLFxuICAgICAqICAgcm90YXRpb25EZWc6IC0xMjBcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5XZWRnZSA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuV2VkZ2UucHJvdG90eXBlID0ge1xuICAgICAgICBfY2VudHJvaWQ6IHRydWUsXG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSAnV2VkZ2UnO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHRoaXMuZ2V0UmFkaXVzKCksIDAsIEtvbnZhLmdldEFuZ2xlKHRoaXMuZ2V0QW5nbGUoKSksIHRoaXMuZ2V0Q2xvY2t3aXNlKCkpO1xuICAgICAgICAgICAgY29udGV4dC5saW5lVG8oMCwgMCk7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldFdpZHRoKClcbiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmFkaXVzKCkgKiAyO1xuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5nZXRIZWlnaHQoKVxuICAgICAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmFkaXVzKCkgKiAyO1xuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5zZXRXaWR0aCgpXG4gICAgICAgIHNldFdpZHRoOiBmdW5jdGlvbih3aWR0aCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0V2lkdGguY2FsbCh0aGlzLCB3aWR0aCk7XG4gICAgICAgICAgICBpZiAodGhpcy5yYWRpdXMoKSAhPT0gd2lkdGggLyAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSYWRpdXMod2lkdGggLyAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuc2V0SGVpZ2h0KClcbiAgICAgICAgc2V0SGVpZ2h0OiBmdW5jdGlvbihoZWlnaHQpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldEhlaWdodC5jYWxsKHRoaXMsIGhlaWdodCk7XG4gICAgICAgICAgICBpZiAodGhpcy5yYWRpdXMoKSAhPT0gaGVpZ2h0IC8gMikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0UmFkaXVzKGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5XZWRnZSwgS29udmEuU2hhcGUpO1xuXG4gICAgLy8gYWRkIGdldHRlcnMgc2V0dGVyc1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLldlZGdlLCAncmFkaXVzJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHJhZGl1c1xuICAgICAqIEBuYW1lIHJhZGl1c1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuV2VkZ2UucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHJhZGl1c1xuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgcmFkaXVzXG4gICAgICogdmFyIHJhZGl1cyA9IHdlZGdlLnJhZGl1cygpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHJhZGl1c1xuICAgICAqIHdlZGdlLnJhZGl1cygxMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5XZWRnZSwgJ2FuZ2xlJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGFuZ2xlIGluIGRlZ3JlZXNcbiAgICAgKiBAbmFtZSBhbmdsZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuV2VkZ2UucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGFuZ2xlXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBhbmdsZVxuICAgICAqIHZhciBhbmdsZSA9IHdlZGdlLmFuZ2xlKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgYW5nbGVcbiAgICAgKiB3ZWRnZS5hbmdsZSgyMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5XZWRnZSwgJ2Nsb2Nrd2lzZScsIGZhbHNlKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY2xvY2t3aXNlIGZsYWdcbiAgICAgKiBAbmFtZSBjbG9ja3dpc2VcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLldlZGdlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjbG9ja3dpc2VcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNsb2Nrd2lzZSBmbGFnXG4gICAgICogdmFyIGNsb2Nrd2lzZSA9IHdlZGdlLmNsb2Nrd2lzZSgpO1xuICAgICAqXG4gICAgICogLy8gZHJhdyB3ZWRnZSBjb3VudGVyLWNsb2Nrd2lzZVxuICAgICAqIHdlZGdlLmNsb2Nrd2lzZShmYWxzZSk7XG4gICAgICpcbiAgICAgKiAvLyBkcmF3IHdlZGdlIGNsb2Nrd2lzZVxuICAgICAqIHdlZGdlLmNsb2Nrd2lzZSh0cnVlKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYmFja0NvbXBhdChLb252YS5XZWRnZSwge1xuICAgICAgICBhbmdsZURlZzogJ2FuZ2xlJyxcbiAgICAgICAgZ2V0QW5nbGVEZWc6ICdnZXRBbmdsZScsXG4gICAgICAgIHNldEFuZ2xlRGVnOiAnc2V0QW5nbGUnXG4gICAgfSk7XG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuV2VkZ2UpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBBcmMgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5hbmdsZSBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5pbm5lclJhZGl1c1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb25maWcub3V0ZXJSYWRpdXNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuY2xvY2t3aXNlXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBkcmF3IGEgQXJjIHRoYXQncyBwb2ludGluZyBkb3dud2FyZHNcbiAgICAgKiB2YXIgYXJjID0gbmV3IEtvbnZhLkFyYyh7XG4gICAgICogICBpbm5lclJhZGl1czogNDAsXG4gICAgICogICBvdXRlclJhZGl1czogODAsXG4gICAgICogICBmaWxsOiAncmVkJyxcbiAgICAgKiAgIHN0cm9rZTogJ2JsYWNrJ1xuICAgICAqICAgc3Ryb2tlV2lkdGg6IDUsXG4gICAgICogICBhbmdsZTogNjAsXG4gICAgICogICByb3RhdGlvbkRlZzogLTEyMFxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLkFyYyA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuQXJjLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX2NlbnRyb2lkOiB0cnVlLFxuICAgICAgICBfX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgY29uc3RydWN0b3JcbiAgICAgICAgICAgIEtvbnZhLlNoYXBlLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJ0FyYyc7XG4gICAgICAgICAgICB0aGlzLnNjZW5lRnVuYyh0aGlzLl9zY2VuZUZ1bmMpO1xuICAgICAgICB9LFxuICAgICAgICBfc2NlbmVGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgYW5nbGUgPSBLb252YS5nZXRBbmdsZSh0aGlzLmFuZ2xlKCkpLFxuICAgICAgICAgICAgICAgIGNsb2Nrd2lzZSA9IHRoaXMuY2xvY2t3aXNlKCk7XG5cbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmFyYygwLCAwLCB0aGlzLmdldE91dGVyUmFkaXVzKCksIDAsIGFuZ2xlLCBjbG9ja3dpc2UpO1xuICAgICAgICAgICAgY29udGV4dC5hcmMoMCwgMCwgdGhpcy5nZXRJbm5lclJhZGl1cygpLCBhbmdsZSwgMCwgIWNsb2Nrd2lzZSk7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldFdpZHRoKClcbiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3V0ZXJSYWRpdXMoKSAqIDI7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldEhlaWdodCgpXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRPdXRlclJhZGl1cygpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuc2V0V2lkdGgoKVxuICAgICAgICBzZXRXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldFdpZHRoLmNhbGwodGhpcywgd2lkdGgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0T3V0ZXJSYWRpdXMoKSAhPT0gd2lkdGggLyAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRPdXRlclJhZGl1cyh3aWR0aCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5zZXRIZWlnaHQoKVxuICAgICAgICBzZXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0SGVpZ2h0LmNhbGwodGhpcywgaGVpZ2h0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE91dGVyUmFkaXVzKCkgIT09IGhlaWdodCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE91dGVyUmFkaXVzKGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5BcmMsIEtvbnZhLlNoYXBlKTtcblxuICAgIC8vIGFkZCBnZXR0ZXJzIHNldHRlcnNcbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5BcmMsICdpbm5lclJhZGl1cycsIDApO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBpbm5lclJhZGl1c1xuICAgICAqIEBuYW1lIGlubmVyUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5BcmMucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlubmVyUmFkaXVzXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBpbm5lciByYWRpdXNcbiAgICAgKiB2YXIgaW5uZXJSYWRpdXMgPSBhcmMuaW5uZXJSYWRpdXMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBpbm5lciByYWRpdXNcbiAgICAgKiBhcmMuaW5uZXJSYWRpdXMoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuQXJjLCAnb3V0ZXJSYWRpdXMnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgb3V0ZXJSYWRpdXNcbiAgICAgKiBAbmFtZSBvdXRlclJhZGl1c1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuQXJjLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvdXRlclJhZGl1c1xuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgb3V0ZXIgcmFkaXVzXG4gICAgICogdmFyIG91dGVyUmFkaXVzID0gYXJjLm91dGVyUmFkaXVzKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgb3V0ZXIgcmFkaXVzXG4gICAgICogYXJjLm91dGVyUmFkaXVzKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLkFyYywgJ2FuZ2xlJywgMCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGFuZ2xlIGluIGRlZ3JlZXNcbiAgICAgKiBAbmFtZSBhbmdsZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuQXJjLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhbmdsZVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgYW5nbGVcbiAgICAgKiB2YXIgYW5nbGUgPSBhcmMuYW5nbGUoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBhbmdsZVxuICAgICAqIGFyYy5hbmdsZSgyMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5BcmMsICdjbG9ja3dpc2UnLCBmYWxzZSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNsb2Nrd2lzZSBmbGFnXG4gICAgICogQG5hbWUgY2xvY2t3aXNlXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5BcmMucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBjbG9ja3dpc2VcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBjbG9ja3dpc2UgZmxhZ1xuICAgICAqIHZhciBjbG9ja3dpc2UgPSBhcmMuY2xvY2t3aXNlKCk7XG4gICAgICpcbiAgICAgKiAvLyBkcmF3IGFyYyBjb3VudGVyLWNsb2Nrd2lzZVxuICAgICAqIGFyYy5jbG9ja3dpc2UoZmFsc2UpO1xuICAgICAqXG4gICAgICogLy8gZHJhdyBhcmMgY2xvY2t3aXNlXG4gICAgICogYXJjLmNsb2Nrd2lzZSh0cnVlKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5BcmMpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyBDT05TVEFOVFNcbiAgICB2YXIgSU1BR0UgPSAnSW1hZ2UnO1xuXG4gICAgLyoqXG4gICAgICogSW1hZ2UgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtJbWFnZX0gY29uZmlnLmltYWdlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuY3JvcF1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsXSBmaWxsIGNvbG9yXG4gICAgICogQHBhcmFtIHtJbWFnZX0gW2NvbmZpZy5maWxsUGF0dGVybkltYWdlXSBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5ZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRZXSBcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlXSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuUm90YXRpb25dXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFBhdHRlcm5SZXBlYXRdIGNhbiBiZSBcInJlcGVhdFwiLCBcInJlcGVhdC14XCIsIFwicmVwZWF0LXlcIiwgb3IgXCJuby1yZXBlYXRcIi4gIFRoZSBkZWZhdWx0IGlzIFwibm8tcmVwZWF0XCJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFldXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFldIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmZpbGxFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGZpbGwuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFByaW9yaXR5XSBjYW4gYmUgY29sb3IsIGxpbmVhci1ncmFkaWVudCwgcmFkaWFsLWdyYWlkZW50LCBvciBwYXR0ZXJuLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgY29sb3IuICBUaGUgZmlsbFByaW9yaXR5IHByb3BlcnR5IG1ha2VzIGl0IHJlYWxseSBlYXN5IHRvIHRvZ2dsZSBiZXR3ZWVuIGRpZmZlcmVudCBmaWxsIHR5cGVzLiAgRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIHRvZ2dsZSBiZXR3ZWVuIGEgZmlsbCBjb2xvciBzdHlsZSBhbmQgYSBmaWxsIHBhdHRlcm4gc3R5bGUsIHNpbXBseSBzZXQgdGhlIGZpbGwgcHJvcGVydHkgYW5kIHRoZSBmaWxsUGF0dGVybiBwcm9wZXJ0aWVzLCBhbmQgdGhlbiB1c2Ugc2V0RmlsbFByaW9yaXR5KCdjb2xvcicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCBhIGNvbG9yIGZpbGwsIG9yIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ3BhdHRlcm4nKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggdGhlIHBhdHRlcm4gZmlsbCBjb25maWd1cmF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc3Ryb2tlXSBzdHJva2UgY29sb3JcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zdHJva2VXaWR0aF0gc3Ryb2tlIHdpZHRoXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUhpdEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2UgaGl0IHJlZ2lvbi4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcucGVyZmVjdERyYXdFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdXNpbmcgYnVmZmVyIGNhbnZhcy4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHNoYXNvdyBmb3Igc3Ryb2tlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VTY2FsZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2Ugc2NhbGUuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc3Ryb2tlLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVKb2luXSBjYW4gYmUgbWl0ZXIsIHJvdW5kLCBvciBiZXZlbC4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIG1pdGVyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUNhcF0gY2FuIGJlIGJ1dHQsIHJvdW5kLCBvciBzcWFyZS4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIGJ1dHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zaGFkb3dDb2xvcl1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dCbHVyXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNoYWRvd09mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T3BhY2l0eV0gc2hhZG93IG9wYWNpdHkuICBDYW4gYmUgYW55IHJlYWwgbnVtYmVyXG4gICAgICogIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHNoYWRvdy4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmRhc2hdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRhc2hFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGRhc2hBcnJheS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGltYWdlT2JqID0gbmV3IEltYWdlKCk7XG4gICAgICogaW1hZ2VPYmoub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICogICB2YXIgaW1hZ2UgPSBuZXcgS29udmEuSW1hZ2Uoe1xuICAgICAqICAgICB4OiAyMDAsXG4gICAgICogICAgIHk6IDUwLFxuICAgICAqICAgICBpbWFnZTogaW1hZ2VPYmosXG4gICAgICogICAgIHdpZHRoOiAxMDAsXG4gICAgICogICAgIGhlaWdodDogMTAwXG4gICAgICogICB9KTtcbiAgICAgKiB9O1xuICAgICAqIGltYWdlT2JqLnNyYyA9ICcvcGF0aC90by9pbWFnZS5qcGcnXG4gICAgICovXG4gICAgS29udmEuSW1hZ2UgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLkltYWdlLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICAvLyBjYWxsIHN1cGVyIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICBLb252YS5TaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IElNQUdFO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgICAgIHRoaXMuaGl0RnVuYyh0aGlzLl9oaXRGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3VzZUJ1ZmZlckNhbnZhczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuaGFzU2hhZG93KCkgfHwgdGhpcy5nZXRBYnNvbHV0ZU9wYWNpdHkoKSAhPT0gMSkgJiYgdGhpcy5oYXNTdHJva2UoKSAmJiB0aGlzLmdldFN0YWdlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY2VuZUZ1bmM6IGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpLFxuICAgICAgICAgICAgICAgIGltYWdlID0gdGhpcy5nZXRJbWFnZSgpLFxuICAgICAgICAgICAgICAgIGNyb3BXaWR0aCwgY3JvcEhlaWdodCwgcGFyYW1zO1xuXG4gICAgICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICBjcm9wV2lkdGggPSB0aGlzLmdldENyb3BXaWR0aCgpO1xuICAgICAgICAgICAgICAgIGNyb3BIZWlnaHQgPSB0aGlzLmdldENyb3BIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoY3JvcFdpZHRoICYmIGNyb3BIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gW2ltYWdlLCB0aGlzLmdldENyb3BYKCksIHRoaXMuZ2V0Q3JvcFkoKSwgY3JvcFdpZHRoLCBjcm9wSGVpZ2h0LCAwLCAwLCB3aWR0aCwgaGVpZ2h0XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBbaW1hZ2UsIDAsIDAsIHdpZHRoLCBoZWlnaHRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzRmlsbCgpIHx8IHRoaXMuaGFzU3Ryb2tlKCkpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZS5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfaGl0RnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5nZXRXaWR0aCgpLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuZ2V0SGVpZ2h0KCk7XG5cbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuZ2V0SW1hZ2UoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJzLndpZHRoIHx8IChpbWFnZSA/IGltYWdlLndpZHRoIDogMCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmdldEltYWdlKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRycy5oZWlnaHQgfHwgKGltYWdlID8gaW1hZ2UuaGVpZ2h0IDogMCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLkltYWdlLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuSW1hZ2UsICdpbWFnZScpO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGltYWdlXG4gICAgICogQG5hbWUgc2V0SW1hZ2VcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkltYWdlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IGltYWdlXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBnZXQgaW1hZ2VcbiAgICAgKiBAbmFtZSBnZXRJbWFnZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuSW1hZ2UucHJvdG90eXBlXG4gICAgICogQHJldHVybnMge0ltYWdlfVxuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRDb21wb25lbnRzR2V0dGVyU2V0dGVyKEtvbnZhLkltYWdlLCAnY3JvcCcsIFsneCcsICd5JywgJ3dpZHRoJywgJ2hlaWdodCddKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNyb3BcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG5hbWUgY3JvcFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5JbWFnZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY3JvcFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjcm9wLnhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY3JvcC55XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNyb3Aud2lkdGhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY3JvcC5oZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNyb3BcbiAgICAgKiB2YXIgY3JvcCA9IGltYWdlLmNyb3AoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBjcm9wXG4gICAgICogaW1hZ2UuY3JvcCh7XG4gICAgICogICB4OiAyMCxcbiAgICAgKiAgIHk6IDIwLFxuICAgICAqICAgd2lkdGg6IDIwLFxuICAgICAqICAgaGVpZ2h0OiAyMFxuICAgICAqIH0pO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuSW1hZ2UsICdjcm9wWCcsIDApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY3JvcCB4XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBuYW1lIGNyb3BYXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkltYWdlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB4XG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBjcm9wIHhcbiAgICAgKiB2YXIgY3JvcFggPSBpbWFnZS5jcm9wWCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGNyb3AgeFxuICAgICAqIGltYWdlLmNyb3BYKDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLkltYWdlLCAnY3JvcFknLCAwKTtcbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGNyb3AgeVxuICAgICAqIEBuYW1lIGNyb3BZXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5JbWFnZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0geVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgY3JvcCB5XG4gICAgICogdmFyIGNyb3BZID0gaW1hZ2UuY3JvcFkoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBjcm9wIHlcbiAgICAgKiBpbWFnZS5jcm9wWSgyMCk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5JbWFnZSwgJ2Nyb3BXaWR0aCcsIDApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY3JvcCB3aWR0aFxuICAgICAqIEBuYW1lIGNyb3BXaWR0aFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuSW1hZ2UucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHdpZHRoXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBjcm9wIHdpZHRoXG4gICAgICogdmFyIGNyb3BXaWR0aCA9IGltYWdlLmNyb3BXaWR0aCgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGNyb3Agd2lkdGhcbiAgICAgKiBpbWFnZS5jcm9wV2lkdGgoMjApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuSW1hZ2UsICdjcm9wSGVpZ2h0JywgMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBjcm9wIGhlaWdodFxuICAgICAqIEBuYW1lIGNyb3BIZWlnaHRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkltYWdlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBoZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNyb3AgaGVpZ2h0XG4gICAgICogdmFyIGNyb3BIZWlnaHQgPSBpbWFnZS5jcm9wSGVpZ2h0KCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgY3JvcCBoZWlnaHRcbiAgICAgKiBpbWFnZS5jcm9wSGVpZ2h0KDIwKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5JbWFnZSk7XG5cbiAgICAvKipcbiAgICAgKiBsb2FkIGltYWdlIGZyb20gZ2l2ZW4gdXJsIGFuZCBjcmVhdGUgYEtvbnZhLkltYWdlYCBpbnN0YW5jZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuSW1hZ2VcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIGltYWdlIHNvdXJjZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIHdpdGggS29udmEuSW1hZ2UgaW5zdGFuY2UgYXMgZmlyc3QgYXJndW1lbnRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqICBLb252YS5JbWFnZS5mcm9tVVJMKGltYWdlVVJMLCBmdW5jdGlvbihpbWFnZSl7XG4gICAgICogICAgLy8gaW1hZ2UgaXMgS29udmEuSW1hZ2UgaW5zdGFuY2VcbiAgICAgKiAgICBsYXllci5hZGQoaW1hZ2UpO1xuICAgICAqICAgIGxheWVyLmRyYXcoKTtcbiAgICAgKiAgfSk7XG4gICAgICovXG4gICAgS29udmEuSW1hZ2UuZnJvbVVSTCA9IGZ1bmN0aW9uKHVybCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGltYWdlID0gbmV3IEtvbnZhLkltYWdlKHtcbiAgICAgICAgICAgIGltYWdlOiBpbWdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjYWxsYmFjayhpbWFnZSk7XG4gICAgICAgIH07XG4gICAgICAgIGltZy5zcmMgPSB1cmw7XG4gICAgfTtcbn0pKCk7XG5cbi8qZXNsaW50LWRpc2FibGUgbWF4LWRlcHRoICovXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIGNvbnN0YW50c1xuICAgIHZhciBBVVRPID0gJ2F1dG8nLFxuICAgICAgICAvL0NBTlZBUyA9ICdjYW52YXMnLFxuICAgICAgICBDRU5URVIgPSAnY2VudGVyJyxcbiAgICAgICAgQ0hBTkdFX0tPTlZBID0gJ0NoYW5nZS5rb252YScsXG4gICAgICAgIENPTlRFWFRfMkQgPSAnMmQnLFxuICAgICAgICBEQVNIID0gJy0nLFxuICAgICAgICBFTVBUWV9TVFJJTkcgPSAnJyxcbiAgICAgICAgTEVGVCA9ICdsZWZ0JyxcbiAgICAgICAgVEVYVCA9ICd0ZXh0JyxcbiAgICAgICAgVEVYVF9VUFBFUiA9ICdUZXh0JyxcbiAgICAgICAgTUlERExFID0gJ21pZGRsZScsXG4gICAgICAgIE5PUk1BTCA9ICdub3JtYWwnLFxuICAgICAgICBQWF9TUEFDRSA9ICdweCAnLFxuICAgICAgICBTUEFDRSA9ICcgJyxcbiAgICAgICAgUklHSFQgPSAncmlnaHQnLFxuICAgICAgICBXT1JEID0gJ3dvcmQnLFxuICAgICAgICBDSEFSID0gJ2NoYXInLFxuICAgICAgICBOT05FID0gJ25vbmUnLFxuICAgICAgICBBVFRSX0NIQU5HRV9MSVNUID0gWydmb250RmFtaWx5JywgJ2ZvbnRTaXplJywgJ2ZvbnRTdHlsZScsICdmb250VmFyaWFudCcsICdwYWRkaW5nJywgJ2FsaWduJywgJ2xpbmVIZWlnaHQnLCAndGV4dCcsICd3aWR0aCcsICdoZWlnaHQnLCAnd3JhcCddLFxuXG4gICAgICAgIC8vIGNhY2hlZCB2YXJpYWJsZXNcbiAgICAgICAgYXR0ckNoYW5nZUxpc3RMZW4gPSBBVFRSX0NIQU5HRV9MSVNULmxlbmd0aCxcbiAgICAgICAgZHVtbXlDb250ZXh0ID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCkuZ2V0Q29udGV4dChDT05URVhUXzJEKTtcblxuICAgIC8qKlxuICAgICAqIFRleHQgY29uc3RydWN0b3JcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAbWVtYmVyb2YgS29udmFcbiAgICAgKiBAYXVnbWVudHMgS29udmEuU2hhcGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZm9udEZhbWlseV0gZGVmYXVsdCBpcyBBcmlhbFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZvbnRTaXplXSBpbiBwaXhlbHMuICBEZWZhdWx0IGlzIDEyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZm9udFN0eWxlXSBjYW4gYmUgbm9ybWFsLCBib2xkLCBvciBpdGFsaWMuICBEZWZhdWx0IGlzIG5vcm1hbFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZvbnRWYXJpYW50XSBjYW4gYmUgbm9ybWFsIG9yIHNtYWxsLWNhcHMuICBEZWZhdWx0IGlzIG5vcm1hbFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb25maWcudGV4dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmFsaWduXSBjYW4gYmUgbGVmdCwgY2VudGVyLCBvciByaWdodFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnBhZGRpbmddXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcubGluZUhlaWdodF0gZGVmYXVsdCBpcyAxXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcud3JhcF0gY2FuIGJlIHdvcmQsIGNoYXIsIG9yIG5vbmUuIERlZmF1bHQgaXMgd29yZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgdGV4dCA9IG5ldyBLb252YS5UZXh0KHtcbiAgICAgKiAgIHg6IDEwLFxuICAgICAqICAgeTogMTUsXG4gICAgICogICB0ZXh0OiAnU2ltcGxlIFRleHQnLFxuICAgICAqICAgZm9udFNpemU6IDMwLFxuICAgICAqICAgZm9udEZhbWlseTogJ0NhbGlicmknLFxuICAgICAqICAgZmlsbDogJ2dyZWVuJ1xuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLlRleHQgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBfZmlsbEZ1bmMoY29udGV4dCkge1xuICAgICAgICBjb250ZXh0LmZpbGxUZXh0KHRoaXMucGFydGlhbFRleHQsIDAsIDApO1xuICAgIH1cbiAgICBmdW5jdGlvbiBfc3Ryb2tlRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuc3Ryb2tlVGV4dCh0aGlzLnBhcnRpYWxUZXh0LCAwLCAwKTtcbiAgICB9XG5cbiAgICBLb252YS5UZXh0LnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcgPSBjb25maWcgfHwge307XG5cbiAgICAgICAgICAgIC8vIHNldCBkZWZhdWx0IGNvbG9yIHRvIGJsYWNrXG4gICAgICAgICAgICBpZiAoIWNvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzICYmICFjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wcykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5maWxsID0gY29uZmlnLmZpbGwgfHwgJ2JsYWNrJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBpZiAoY29uZmlnLndpZHRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vICAgICBjb25maWcud2lkdGggPSBBVVRPO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gaWYgKGNvbmZpZy5oZWlnaHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gICAgIGNvbmZpZy5oZWlnaHQgPSBBVVRPO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAvLyBjYWxsIHN1cGVyIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICBLb252YS5TaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIHRoaXMuX2ZpbGxGdW5jID0gX2ZpbGxGdW5jO1xuICAgICAgICAgICAgdGhpcy5fc3Ryb2tlRnVuYyA9IF9zdHJva2VGdW5jO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBURVhUX1VQUEVSO1xuXG4gICAgICAgICAgICAvLyB1cGRhdGUgdGV4dCBkYXRhIGZvciBjZXJ0YWluIGF0dHIgY2hhbmdlc1xuICAgICAgICAgICAgZm9yKHZhciBuID0gMDsgbiA8IGF0dHJDaGFuZ2VMaXN0TGVuOyBuKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uKEFUVFJfQ0hBTkdFX0xJU1Rbbl0gKyBDSEFOR0VfS09OVkEsIHRoaXMuX3NldFRleHREYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc2V0VGV4dERhdGEoKTtcbiAgICAgICAgICAgIHRoaXMuc2NlbmVGdW5jKHRoaXMuX3NjZW5lRnVuYyk7XG4gICAgICAgICAgICB0aGlzLmhpdEZ1bmModGhpcy5faGl0RnVuYyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY2VuZUZ1bmM6IGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5nZXRQYWRkaW5nKCksXG4gICAgICAgICAgICAgICAgdGV4dEhlaWdodCA9IHRoaXMuZ2V0VGV4dEhlaWdodCgpLFxuICAgICAgICAgICAgICAgIGxpbmVIZWlnaHRQeCA9IHRoaXMuZ2V0TGluZUhlaWdodCgpICogdGV4dEhlaWdodCxcbiAgICAgICAgICAgICAgICB0ZXh0QXJyID0gdGhpcy50ZXh0QXJyLFxuICAgICAgICAgICAgICAgIHRleHRBcnJMZW4gPSB0ZXh0QXJyLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB0b3RhbFdpZHRoID0gdGhpcy5nZXRXaWR0aCgpLFxuICAgICAgICAgICAgICAgIG47XG5cbiAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cignZm9udCcsIHRoaXMuX2dldENvbnRleHRGb250KCkpO1xuXG4gICAgICAgICAgICBjb250ZXh0LnNldEF0dHIoJ3RleHRCYXNlbGluZScsIE1JRERMRSk7XG4gICAgICAgICAgICBjb250ZXh0LnNldEF0dHIoJ3RleHRBbGlnbicsIExFRlQpO1xuICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG4gICAgICAgICAgICBpZiAocCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKHAsIDApO1xuICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKDAsIHAgKyB0ZXh0SGVpZ2h0IC8gMik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKDAsIHRleHRIZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAvLyBkcmF3IHRleHQgbGluZXNcbiAgICAgICAgICAgIGZvcihuID0gMDsgbiA8IHRleHRBcnJMZW47IG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB0ZXh0QXJyW25dLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gb2JqLnRleHQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gb2JqLndpZHRoO1xuXG4gICAgICAgICAgICAgICAgLy8gaG9yaXpvbnRhbCBhbGlnbm1lbnRcbiAgICAgICAgICAgICAgICBjb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLmdldEFsaWduKCkgPT09IFJJR0hUKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKHRvdGFsV2lkdGggLSB3aWR0aCAtIHAgKiAyLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmdldEFsaWduKCkgPT09IENFTlRFUikge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZSgodG90YWxXaWR0aCAtIHdpZHRoIC0gcCAqIDIpIC8gMiwgMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJ0aWFsVGV4dCA9IHRleHQ7XG5cbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZSgwLCBsaW5lSGVpZ2h0UHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9oaXRGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKTtcblxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0VGV4dDogZnVuY3Rpb24odGV4dCkge1xuICAgICAgICAgICAgdmFyIHN0ciA9IEtvbnZhLlV0aWwuX2lzU3RyaW5nKHRleHQpID8gdGV4dCA6ICh0ZXh0IHx8ICcnKS50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5fc2V0QXR0cihURVhULCBzdHIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgd2lkdGggb2YgdGV4dCBhcmVhLCB3aGljaCBpbmNsdWRlcyBwYWRkaW5nXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaXNBdXRvID0gKHRoaXMuYXR0cnMud2lkdGggPT09IEFVVE8pIHx8ICh0aGlzLmF0dHJzLndpZHRoID09PSB1bmRlZmluZWQpO1xuICAgICAgICAgICAgcmV0dXJuIGlzQXV0byA/IHRoaXMuZ2V0VGV4dFdpZHRoKCkgKyB0aGlzLmdldFBhZGRpbmcoKSAqIDIgOiB0aGlzLmF0dHJzLndpZHRoO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IHRoZSBoZWlnaHQgb2YgdGhlIHRleHQgYXJlYSwgd2hpY2ggdGFrZXMgaW50byBhY2NvdW50IG11bHRpLWxpbmUgdGV4dCwgbGluZSBoZWlnaHRzLCBhbmQgcGFkZGluZ1xuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0LnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgaXNBdXRvID0gKHRoaXMuYXR0cnMuaGVpZ2h0ID09PSBBVVRPKSB8fCAodGhpcy5hdHRycy5oZWlnaHQgPT09IHVuZGVmaW5lZCk7XG4gICAgICAgICAgcmV0dXJuIGlzQXV0byA/ICh0aGlzLmdldFRleHRIZWlnaHQoKSAqIHRoaXMudGV4dEFyci5sZW5ndGggKiB0aGlzLmdldExpbmVIZWlnaHQoKSkgKyB0aGlzLmdldFBhZGRpbmcoKSAqIDIgOiB0aGlzLmF0dHJzLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB0ZXh0IHdpZHRoXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRUZXh0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dFdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IHRleHQgaGVpZ2h0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICAgICAqL1xuICAgICAgICBnZXRUZXh0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRUZXh0U2l6ZTogZnVuY3Rpb24odGV4dCkge1xuICAgICAgICAgICAgdmFyIF9jb250ZXh0ID0gZHVtbXlDb250ZXh0LFxuICAgICAgICAgICAgICAgIGZvbnRTaXplID0gdGhpcy5nZXRGb250U2l6ZSgpLFxuICAgICAgICAgICAgICAgIG1ldHJpY3M7XG5cbiAgICAgICAgICAgIF9jb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIF9jb250ZXh0LmZvbnQgPSB0aGlzLl9nZXRDb250ZXh0Rm9udCgpO1xuXG4gICAgICAgICAgICBtZXRyaWNzID0gX2NvbnRleHQubWVhc3VyZVRleHQodGV4dCk7XG4gICAgICAgICAgICBfY29udGV4dC5yZXN0b3JlKCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHdpZHRoOiBtZXRyaWNzLndpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogcGFyc2VJbnQoZm9udFNpemUsIDEwKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgX2dldENvbnRleHRGb250OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIElFIGRvbid0IHdhbnQgdG8gd29yayB3aXRoIHVzdWFsIGZvbnQgc3R5bGVcbiAgICAgICAgICAgIC8vIGJvbGQgd2FzIG5vdCB3b3JraW5nXG4gICAgICAgICAgICAvLyByZW1vdmluZyBmb250IHZhcmlhbnQgd2lsbCBzb2x2ZVxuICAgICAgICAgICAgLy8gZml4IGZvcjogaHR0cHM6Ly9naXRodWIuY29tL2tvbnZhanMva29udmEvaXNzdWVzLzk0XG4gICAgICAgICAgICBpZiAoS29udmEuVUEuaXNJRSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZvbnRTdHlsZSgpICsgU1BBQ0UgKyB0aGlzLmdldEZvbnRTaXplKCkgKyBQWF9TUEFDRSArIHRoaXMuZ2V0Rm9udEZhbWlseSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rm9udFN0eWxlKCkgKyBTUEFDRSArXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Rm9udFZhcmlhbnQoKSArIFNQQUNFICtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRGb250U2l6ZSgpICsgUFhfU1BBQ0UgK1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEZvbnRGYW1pbHkoKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2FkZFRleHRMaW5lOiBmdW5jdGlvbiAobGluZSwgd2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRBcnIucHVzaCh7dGV4dDogbGluZSwgd2lkdGg6IHdpZHRofSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXRUZXh0V2lkdGg6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gZHVtbXlDb250ZXh0Lm1lYXN1cmVUZXh0KHRleHQpLndpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBfc2V0VGV4dERhdGE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsaW5lcyA9IHRoaXMuZ2V0VGV4dCgpLnNwbGl0KCdcXG4nKSxcbiAgICAgICAgICAgICAgICBmb250U2l6ZSA9ICt0aGlzLmdldEZvbnRTaXplKCksXG4gICAgICAgICAgICAgICAgdGV4dFdpZHRoID0gMCxcbiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0UHggPSB0aGlzLmdldExpbmVIZWlnaHQoKSAqIGZvbnRTaXplLFxuICAgICAgICAgICAgICAgIHdpZHRoID0gdGhpcy5hdHRycy53aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmF0dHJzLmhlaWdodCxcbiAgICAgICAgICAgICAgICBmaXhlZFdpZHRoID0gd2lkdGggIT09IEFVVE8sXG4gICAgICAgICAgICAgICAgZml4ZWRIZWlnaHQgPSBoZWlnaHQgIT09IEFVVE8sXG4gICAgICAgICAgICAgICAgcGFkZGluZyA9IHRoaXMuZ2V0UGFkZGluZygpLFxuICAgICAgICAgICAgICAgIG1heFdpZHRoID0gd2lkdGggLSBwYWRkaW5nICogMixcbiAgICAgICAgICAgICAgICBtYXhIZWlnaHRQeCA9IGhlaWdodCAtIHBhZGRpbmcgKiAyLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRIZWlnaHRQeCA9IDAsXG4gICAgICAgICAgICAgICAgd3JhcCA9IHRoaXMuZ2V0V3JhcCgpLFxuICAgICAgICAgICAgICAgIHNob3VsZFdyYXAgPSB3cmFwICE9PSBOT05FLFxuICAgICAgICAgICAgICAgIHdyYXBBdFdvcmQgPSB3cmFwICE9PSBDSEFSICYmIHNob3VsZFdyYXA7XG5cbiAgICAgICAgICAgIHRoaXMudGV4dEFyciA9IFtdO1xuICAgICAgICAgICAgZHVtbXlDb250ZXh0LnNhdmUoKTtcbiAgICAgICAgICAgIGR1bW15Q29udGV4dC5mb250ID0gdGhpcy5fZ2V0Q29udGV4dEZvbnQoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXggPSBsaW5lcy5sZW5ndGg7IGkgPCBtYXg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gbGluZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aChsaW5lKTtcbiAgICAgICAgICAgICAgICBpZiAoZml4ZWRXaWR0aCAmJiBsaW5lV2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBpZiB3aWR0aCBpcyBmaXhlZCBhbmQgbGluZSBkb2VzIG5vdCBmaXQgZW50aXJlbHlcbiAgICAgICAgICAgICAgICAgICAgICogYnJlYWsgdGhlIGxpbmUgaW50byBtdWx0aXBsZSBmaXR0aW5nIGxpbmVzXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAobGluZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogdXNlIGJpbmFyeSBzZWFyY2ggdG8gZmluZCB0aGUgbG9uZ2VzdCBzdWJzdHJpbmcgdGhhdFxuICAgICAgICAgICAgICAgICAgICAgICAgICogdGhhdCB3b3VsZCBmaXQgaW4gdGhlIHNwZWNpZmllZCB3aWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGxpbmUubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gJycsIG1hdGNoV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWlkID0gKGxvdyArIGhpZ2gpID4+PiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzdHIgPSBsaW5lLnNsaWNlKDAsIG1pZCArIDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzdHJXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aChzdWJzdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJzdHJXaWR0aCA8PSBtYXhXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IHN1YnN0cjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hXaWR0aCA9IHN1YnN0cldpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2ggPSBtaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqICdsb3cnIGlzIG5vdyB0aGUgaW5kZXggb2YgdGhlIHN1YnN0cmluZyBlbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAqICdtYXRjaCcgaXMgdGhlIHN1YnN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICogJ21hdGNoV2lkdGgnIGlzIHRoZSBzdWJzdHJpbmcgd2lkdGggaW4gcHhcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBmaXR0aW5nIHN1YnN0cmluZyB3YXMgZm91bmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod3JhcEF0V29yZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cnkgdG8gZmluZCBhIHNwYWNlIG9yIGRhc2ggd2hlcmUgd3JhcHBpbmcgY291bGQgYmUgZG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd3JhcEluZGV4ID0gTWF0aC5tYXgobWF0Y2gubGFzdEluZGV4T2YoU1BBQ0UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoLmxhc3RJbmRleE9mKERBU0gpKSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3cmFwSW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZS1jdXQgdGhlIHN1YnN0cmluZyBmb3VuZCBhdCB0aGUgc3BhY2UvZGFzaCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG93ID0gd3JhcEluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBtYXRjaC5zbGljZSgwLCBsb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hXaWR0aCA9IHRoaXMuX2dldFRleHRXaWR0aChtYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkVGV4dExpbmUobWF0Y2gsIG1hdGNoV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRXaWR0aCA9IE1hdGgubWF4KHRleHRXaWR0aCwgbWF0Y2hXaWR0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlaWdodFB4ICs9IGxpbmVIZWlnaHRQeDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3VsZFdyYXAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZpeGVkSGVpZ2h0ICYmIGN1cnJlbnRIZWlnaHRQeCArIGxpbmVIZWlnaHRQeCA+IG1heEhlaWdodFB4KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBzdG9wIHdyYXBwaW5nIGlmIHdyYXBwaW5nIGlzIGRpc2FibGVkIG9yIGlmIGFkZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBvbmUgbW9yZSBsaW5lIHdvdWxkIG92ZXJmbG93IHRoZSBmaXhlZCBoZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5zbGljZShsb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHJlbWFpbmluZyB0ZXh0IHdvdWxkIGZpdCBvbiBvbmUgbGluZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGggPSB0aGlzLl9nZXRUZXh0V2lkdGgobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lV2lkdGggPD0gbWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0IGRvZXMsIGFkZCB0aGUgbGluZSBhbmQgYnJlYWsgb3V0IG9mIHRoZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRUZXh0TGluZShsaW5lLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlaWdodFB4ICs9IGxpbmVIZWlnaHRQeDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRXaWR0aCA9IE1hdGgubWF4KHRleHRXaWR0aCwgbGluZVdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBub3QgZXZlbiBvbmUgY2hhcmFjdGVyIGNvdWxkIGZpdCBpbiB0aGUgZWxlbWVudCwgYWJvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgd2lkdGggaXMgYXV0b21hdGljYWxseSBhZGp1c3RlZCB0byBtYXggbGluZSB3aWR0aFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRUZXh0TGluZShsaW5lLCBsaW5lV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50SGVpZ2h0UHggKz0gbGluZUhlaWdodFB4O1xuICAgICAgICAgICAgICAgICAgICB0ZXh0V2lkdGggPSBNYXRoLm1heCh0ZXh0V2lkdGgsIGxpbmVXaWR0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGlmIGVsZW1lbnQgaGVpZ2h0IGlzIGZpeGVkLCBhYm9ydCBpZiBhZGRpbmcgb25lIG1vcmUgbGluZSB3b3VsZCBvdmVyZmxvd1xuICAgICAgICAgICAgICAgIGlmIChmaXhlZEhlaWdodCAmJiBjdXJyZW50SGVpZ2h0UHggKyBsaW5lSGVpZ2h0UHggPiBtYXhIZWlnaHRQeCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkdW1teUNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICAgICAgdGhpcy50ZXh0SGVpZ2h0ID0gZm9udFNpemU7XG4gICAgICAgICAgICB0aGlzLnRleHRXaWR0aCA9IHRleHRXaWR0aDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuVGV4dCwgS29udmEuU2hhcGUpO1xuXG4gICAgLy8gYWRkIGdldHRlcnMgc2V0dGVyc1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRleHQsICdmb250RmFtaWx5JywgJ0FyaWFsJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGZvbnQgZmFtaWx5XG4gICAgICogQG5hbWUgZm9udEZhbWlseVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dC5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZm9udEZhbWlseVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZm9udCBmYW1pbHlcbiAgICAgKiB2YXIgZm9udEZhbWlseSA9IHRleHQuZm9udEZhbWlseSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZvbnQgZmFtaWx5XG4gICAgICogdGV4dC5mb250RmFtaWx5KCdBcmlhbCcpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dCwgJ2ZvbnRTaXplJywgMTIpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBmb250IHNpemUgaW4gcGl4ZWxzXG4gICAgICogQG5hbWUgZm9udFNpemVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGZvbnRTaXplXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmb250IHNpemVcbiAgICAgKiB2YXIgZm9udFNpemUgPSB0ZXh0LmZvbnRTaXplKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZm9udCBzaXplIHRvIDIycHhcbiAgICAgKiB0ZXh0LmZvbnRTaXplKDIyKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRleHQsICdmb250U3R5bGUnLCBOT1JNQUwpO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGZvbnQgc3R5bGUuICBDYW4gYmUgJ25vcm1hbCcsICdpdGFsaWMnLCBvciAnYm9sZCcuICAnbm9ybWFsJyBpcyB0aGUgZGVmYXVsdC5cbiAgICAgKiBAbmFtZSBmb250U3R5bGVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGZvbnRTdHlsZVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgZm9udCBzdHlsZVxuICAgICAqIHZhciBmb250U3R5bGUgPSB0ZXh0LmZvbnRTdHlsZSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGZvbnQgc3R5bGVcbiAgICAgKiB0ZXh0LmZvbnRTdHlsZSgnYm9sZCcpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dCwgJ2ZvbnRWYXJpYW50JywgTk9STUFMKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBmb250IHZhcmlhbnQuICBDYW4gYmUgJ25vcm1hbCcgb3IgJ3NtYWxsLWNhcHMnLiAgJ25vcm1hbCcgaXMgdGhlIGRlZmF1bHQuXG4gICAgICogQG5hbWUgZm9udFZhcmlhbnRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGZvbnRWYXJpYW50XG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmb250IHZhcmlhbnRcbiAgICAgKiB2YXIgZm9udFZhcmlhbnQgPSB0ZXh0LmZvbnRWYXJpYW50KCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgZm9udCB2YXJpYW50XG4gICAgICogdGV4dC5mb250VmFyaWFudCgnc21hbGwtY2FwcycpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dCwgJ3BhZGRpbmcnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBwYWRkaW5nXG4gICAgICogQG5hbWUgcGFkZGluZ1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dC5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcGFkZGluZ1xuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgcGFkZGluZ1xuICAgICAqIHZhciBwYWRkaW5nID0gdGV4dC5wYWRkaW5nKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgcGFkZGluZyB0byAxMCBwaXhlbHNcbiAgICAgKiB0ZXh0LnBhZGRpbmcoMTApO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dCwgJ2FsaWduJywgTEVGVCk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGhvcml6b250YWwgYWxpZ24gb2YgdGV4dC4gIENhbiBiZSAnbGVmdCcsICdjZW50ZXInLCBvciAncmlnaHQnXG4gICAgICogQG5hbWUgYWxpZ25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGFsaWduXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB0ZXh0IGFsaWduXG4gICAgICogdmFyIGFsaWduID0gdGV4dC5hbGlnbigpO1xuICAgICAqXG4gICAgICogLy8gY2VudGVyIHRleHRcbiAgICAgKiB0ZXh0LmFsaWduKCdjZW50ZXInKTtcbiAgICAgKlxuICAgICAqIC8vIGFsaWduIHRleHQgdG8gcmlnaHRcbiAgICAgKiB0ZXh0LmFsaWduKCdyaWdodCcpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dCwgJ2xpbmVIZWlnaHQnLCAxKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgbGluZSBoZWlnaHQuICBUaGUgZGVmYXVsdCBpcyAxLlxuICAgICAqIEBuYW1lIGxpbmVIZWlnaHRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHQucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxpbmVIZWlnaHRcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGxpbmUgaGVpZ2h0XG4gICAgICogdmFyIGxpbmVIZWlnaHQgPSB0ZXh0LmxpbmVIZWlnaHQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB0aGUgbGluZSBoZWlnaHRcbiAgICAgKiB0ZXh0LmxpbmVIZWlnaHQoMik7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5UZXh0LCAnd3JhcCcsIFdPUkQpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0L3NldCB3cmFwLiAgQ2FuIGJlIHdvcmQsIGNoYXIsIG9yIG5vbmUuIERlZmF1bHQgaXMgd29yZC5cbiAgICAgKiBAbmFtZSB3cmFwXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0LnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB3cmFwXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB3cmFwXG4gICAgICogdmFyIHdyYXAgPSB0ZXh0LndyYXAoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB3cmFwXG4gICAgICogdGV4dC53cmFwKCd3b3JkJyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlcihLb252YS5UZXh0LCAndGV4dCcsIEVNUFRZX1NUUklORyk7XG4gICAgS29udmEuRmFjdG9yeS5hZGRPdmVybG9hZGVkR2V0dGVyU2V0dGVyKEtvbnZhLlRleHQsICd0ZXh0Jyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IHRleHRcbiAgICAgKiBAbmFtZSBnZXRUZXh0XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0LnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0XG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB0ZXh0XG4gICAgICogdmFyIHRleHQgPSB0ZXh0LnRleHQoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB0ZXh0XG4gICAgICogdGV4dC50ZXh0KCdIZWxsbyB3b3JsZCEnKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5UZXh0KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIExpbmUgY29uc3RydWN0b3IuJm5ic3A7IExpbmVzIGFyZSBkZWZpbmVkIGJ5IGFuIGFycmF5IG9mIHBvaW50cyBhbmRcbiAgICAgKiAgYSB0ZW5zaW9uXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLlNoYXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvbmZpZy5wb2ludHNcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy50ZW5zaW9uXSBIaWdoZXIgdmFsdWVzIHdpbGwgcmVzdWx0IGluIGEgbW9yZSBjdXJ2eSBsaW5lLiAgQSB2YWx1ZSBvZiAwIHdpbGwgcmVzdWx0IGluIG5vIGludGVycG9sYXRpb24uXG4gICAgICogICBUaGUgZGVmYXVsdCBpcyAwXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmNsb3NlZF0gZGVmaW5lcyB3aGV0aGVyIG9yIG5vdCB0aGUgbGluZSBzaGFwZSBpcyBjbG9zZWQsIGNyZWF0aW5nIGEgcG9seWdvbiBvciBibG9iXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbF0gZmlsbCBjb2xvclxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IFtjb25maWcuZmlsbFBhdHRlcm5JbWFnZV0gZmlsbCBwYXR0ZXJuIGltYWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5YXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WV0gXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZV0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblJvdGF0aW9uXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQYXR0ZXJuUmVwZWF0XSBjYW4gYmUgXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIG9yIFwibm8tcmVwZWF0XCIuICBUaGUgZGVmYXVsdCBpcyBcIm5vLXJlcGVhdFwiXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5maWxsRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBmaWxsLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQcmlvcml0eV0gY2FuIGJlIGNvbG9yLCBsaW5lYXItZ3JhZGllbnQsIHJhZGlhbC1ncmFpZGVudCwgb3IgcGF0dGVybi4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGNvbG9yLiAgVGhlIGZpbGxQcmlvcml0eSBwcm9wZXJ0eSBtYWtlcyBpdCByZWFsbHkgZWFzeSB0byB0b2dnbGUgYmV0d2VlbiBkaWZmZXJlbnQgZmlsbCB0eXBlcy4gIEZvciBleGFtcGxlLCBpZiB5b3Ugd2FudCB0byB0b2dnbGUgYmV0d2VlbiBhIGZpbGwgY29sb3Igc3R5bGUgYW5kIGEgZmlsbCBwYXR0ZXJuIHN0eWxlLCBzaW1wbHkgc2V0IHRoZSBmaWxsIHByb3BlcnR5IGFuZCB0aGUgZmlsbFBhdHRlcm4gcHJvcGVydGllcywgYW5kIHRoZW4gdXNlIHNldEZpbGxQcmlvcml0eSgnY29sb3InKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggYSBjb2xvciBmaWxsLCBvciB1c2Ugc2V0RmlsbFByaW9yaXR5KCdwYXR0ZXJuJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIHRoZSBwYXR0ZXJuIGZpbGwgY29uZmlndXJhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnN0cm9rZV0gc3Ryb2tlIGNvbG9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc3Ryb2tlV2lkdGhdIHN0cm9rZSB3aWR0aFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VIaXRFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIGhpdCByZWdpb24uICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnBlcmZlY3REcmF3RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHVzaW5nIGJ1ZmZlciBjYW52YXMuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzaGFzb3cgZm9yIHN0cm9rZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlU2NhbGVFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIHNjYWxlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHN0cm9rZS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lSm9pbl0gY2FuIGJlIG1pdGVyLCByb3VuZCwgb3IgYmV2ZWwuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBtaXRlclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVDYXBdIGNhbiBiZSBidXR0LCByb3VuZCwgb3Igc3FhcmUuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBidXR0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc2hhZG93Q29sb3JdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93Qmx1cl1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zaGFkb3dPZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09wYWNpdHldIHNoYWRvdyBvcGFjaXR5LiAgQ2FuIGJlIGFueSByZWFsIG51bWJlclxuICAgICAqICBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzaGFkb3cuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5kYXNoXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kYXNoRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBkYXNoQXJyYXkuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBsaW5lID0gbmV3IEtvbnZhLkxpbmUoe1xuICAgICAqICAgeDogMTAwLFxuICAgICAqICAgeTogNTAsXG4gICAgICogICBwb2ludHM6IFs3MywgNzAsIDM0MCwgMjMsIDQ1MCwgNjAsIDUwMCwgMjBdLFxuICAgICAqICAgc3Ryb2tlOiAncmVkJyxcbiAgICAgKiAgIHRlbnNpb246IDFcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5MaW5lID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuTGluZS5wcm90b3R5cGUgPSB7XG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgY29uc3RydWN0b3JcbiAgICAgICAgICAgIEtvbnZhLlNoYXBlLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJ0xpbmUnO1xuXG4gICAgICAgICAgICB0aGlzLm9uKCdwb2ludHNDaGFuZ2Uua29udmEgdGVuc2lvbkNoYW5nZS5rb252YSBjbG9zZWRDaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2xlYXJDYWNoZSgndGVuc2lvblBvaW50cycpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2NlbmVGdW5jKHRoaXMuX3NjZW5lRnVuYyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY2VuZUZ1bmM6IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgcG9pbnRzID0gdGhpcy5nZXRQb2ludHMoKSxcbiAgICAgICAgICAgICAgICBsZW5ndGggPSBwb2ludHMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIHRlbnNpb24gPSB0aGlzLmdldFRlbnNpb24oKSxcbiAgICAgICAgICAgICAgICBjbG9zZWQgPSB0aGlzLmdldENsb3NlZCgpLFxuICAgICAgICAgICAgICAgIHRwLCBsZW4sIG47XG5cbiAgICAgICAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8ocG9pbnRzWzBdLCBwb2ludHNbMV0pO1xuXG4gICAgICAgICAgICAvLyB0ZW5zaW9uXG4gICAgICAgICAgICBpZiAodGVuc2lvbiAhPT0gMCAmJiBsZW5ndGggPiA0KSB7XG4gICAgICAgICAgICAgICAgdHAgPSB0aGlzLmdldFRlbnNpb25Qb2ludHMoKTtcbiAgICAgICAgICAgICAgICBsZW4gPSB0cC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgbiA9IGNsb3NlZCA/IDAgOiA0O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKHRwWzBdLCB0cFsxXSwgdHBbMl0sIHRwWzNdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IGxlbiAtIDIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10sIHRwW24rK10pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyh0cFtsZW4gLSAyXSwgdHBbbGVuIC0gMV0sIHBvaW50c1tsZW5ndGggLSAyXSwgcG9pbnRzW2xlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBubyB0ZW5zaW9uXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKG4gPSAyOyBuIDwgbGVuZ3RoOyBuICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8ocG9pbnRzW25dLCBwb2ludHNbbiArIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNsb3NlZCBlLmcuIHBvbHlnb25zIGFuZCBibG9ic1xuICAgICAgICAgICAgaWYgKGNsb3NlZCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBvcGVuIGUuZy4gbGluZXMgYW5kIHNwbGluZXNcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldFRlbnNpb25Qb2ludHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDYWNoZSgndGVuc2lvblBvaW50cycsIHRoaXMuX2dldFRlbnNpb25Qb2ludHMpO1xuICAgICAgICB9LFxuICAgICAgICBfZ2V0VGVuc2lvblBvaW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0Q2xvc2VkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VGVuc2lvblBvaW50c0Nsb3NlZCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gS29udmEuVXRpbC5fZXhwYW5kUG9pbnRzKHRoaXMuZ2V0UG9pbnRzKCksIHRoaXMuZ2V0VGVuc2lvbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2dldFRlbnNpb25Qb2ludHNDbG9zZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5nZXRQb2ludHMoKSxcbiAgICAgICAgICAgICAgICBsZW4gPSBwLmxlbmd0aCxcbiAgICAgICAgICAgICAgICB0ZW5zaW9uID0gdGhpcy5nZXRUZW5zaW9uKCksXG4gICAgICAgICAgICAgICAgdXRpbCA9IEtvbnZhLlV0aWwsXG4gICAgICAgICAgICAgICAgZmlyc3RDb250cm9sUG9pbnRzID0gdXRpbC5fZ2V0Q29udHJvbFBvaW50cyhcbiAgICAgICAgICAgICAgICAgICAgcFtsZW4gLSAyXSxcbiAgICAgICAgICAgICAgICAgICAgcFtsZW4gLSAxXSxcbiAgICAgICAgICAgICAgICAgICAgcFswXSxcbiAgICAgICAgICAgICAgICAgICAgcFsxXSxcbiAgICAgICAgICAgICAgICAgICAgcFsyXSxcbiAgICAgICAgICAgICAgICAgICAgcFszXSxcbiAgICAgICAgICAgICAgICAgICAgdGVuc2lvblxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgbGFzdENvbnRyb2xQb2ludHMgPSB1dGlsLl9nZXRDb250cm9sUG9pbnRzKFxuICAgICAgICAgICAgICAgICAgICBwW2xlbiAtIDRdLFxuICAgICAgICAgICAgICAgICAgICBwW2xlbiAtIDNdLFxuICAgICAgICAgICAgICAgICAgICBwW2xlbiAtIDJdLFxuICAgICAgICAgICAgICAgICAgICBwW2xlbiAtIDFdLFxuICAgICAgICAgICAgICAgICAgICBwWzBdLFxuICAgICAgICAgICAgICAgICAgICBwWzFdLFxuICAgICAgICAgICAgICAgICAgICB0ZW5zaW9uXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBtaWRkbGUgPSBLb252YS5VdGlsLl9leHBhbmRQb2ludHMocCwgdGVuc2lvbiksXG4gICAgICAgICAgICAgICAgdHAgPSBbXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0Q29udHJvbFBvaW50c1syXSxcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RDb250cm9sUG9pbnRzWzNdXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIC5jb25jYXQobWlkZGxlKVxuICAgICAgICAgICAgICAgIC5jb25jYXQoW1xuICAgICAgICAgICAgICAgICAgICBsYXN0Q29udHJvbFBvaW50c1swXSxcbiAgICAgICAgICAgICAgICAgICAgbGFzdENvbnRyb2xQb2ludHNbMV0sXG4gICAgICAgICAgICAgICAgICAgIHBbbGVuIC0gMl0sXG4gICAgICAgICAgICAgICAgICAgIHBbbGVuIC0gMV0sXG4gICAgICAgICAgICAgICAgICAgIGxhc3RDb250cm9sUG9pbnRzWzJdLFxuICAgICAgICAgICAgICAgICAgICBsYXN0Q29udHJvbFBvaW50c1szXSxcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RDb250cm9sUG9pbnRzWzBdLFxuICAgICAgICAgICAgICAgICAgICBmaXJzdENvbnRyb2xQb2ludHNbMV0sXG4gICAgICAgICAgICAgICAgICAgIHBbMF0sXG4gICAgICAgICAgICAgICAgICAgIHBbMV1cbiAgICAgICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRwO1xuICAgICAgICB9LFxuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2VsZlJlY3QoKS53aWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0SGVpZ2h0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTZWxmUmVjdCgpLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gb3ZlcmxvYWQgc2l6ZSBkZXRlY3Rpb25cbiAgICAgICAgZ2V0U2VsZlJlY3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwb2ludHM7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRUZW5zaW9uKCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICBwb2ludHMgPSB0aGlzLl9nZXRUZW5zaW9uUG9pbnRzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBvaW50cyA9IHRoaXMuZ2V0UG9pbnRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbWluWCA9IHBvaW50c1swXTtcbiAgICAgICAgICAgIHZhciBtYXhYID0gcG9pbnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1pblkgPSBwb2ludHNbMV07XG4gICAgICAgICAgICB2YXIgbWF4WSA9IHBvaW50c1sxXTtcbiAgICAgICAgICAgIHZhciB4LCB5O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgeCA9IHBvaW50c1tpICogMl07XG4gICAgICAgICAgICAgICAgeSA9IHBvaW50c1tpICogMiArIDFdO1xuICAgICAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCB4KTtcbiAgICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgeCk7XG4gICAgICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIHkpO1xuICAgICAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogTWF0aC5yb3VuZChtaW5YKSxcbiAgICAgICAgICAgICAgICB5OiBNYXRoLnJvdW5kKG1pblkpLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBNYXRoLnJvdW5kKG1heFggLSBtaW5YKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IE1hdGgucm91bmQobWF4WSAtIG1pblkpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5MaW5lLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTGluZSwgJ2Nsb3NlZCcsIGZhbHNlKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgY2xvc2VkIGZsYWcuICBUaGUgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAqIEBuYW1lIGNsb3NlZFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuTGluZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGNsb3NlZFxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGNsb3NlZCBmbGFnXG4gICAgICogdmFyIGNsb3NlZCA9IGxpbmUuY2xvc2VkKCk7XG4gICAgICpcbiAgICAgKiAvLyBjbG9zZSB0aGUgc2hhcGVcbiAgICAgKiBsaW5lLmNsb3NlZCh0cnVlKTtcbiAgICAgKlxuICAgICAqIC8vIG9wZW4gdGhlIHNoYXBlXG4gICAgICogbGluZS5jbG9zZWQoZmFsc2UpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuTGluZSwgJ3RlbnNpb24nLCAwKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgdGVuc2lvblxuICAgICAqIEBuYW1lIHRlbnNpb25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkxpbmUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IEhpZ2hlciB2YWx1ZXMgd2lsbCByZXN1bHQgaW4gYSBtb3JlIGN1cnZ5IGxpbmUuICBBIHZhbHVlIG9mIDAgd2lsbCByZXN1bHQgaW4gbm8gaW50ZXJwb2xhdGlvbi5cbiAgICAgKiAgIFRoZSBkZWZhdWx0IGlzIDBcbiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHRlbnNpb25cbiAgICAgKiB2YXIgdGVuc2lvbiA9IGxpbmUudGVuc2lvbigpO1xuICAgICAqXG4gICAgICogLy8gc2V0IHRlbnNpb25cbiAgICAgKiBsaW5lLnRlbnNpb24oMyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5MaW5lLCAncG9pbnRzJywgW10pO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgcG9pbnRzIGFycmF5XG4gICAgICogQG5hbWUgcG9pbnRzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5MaW5lLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBvaW50c1xuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBwb2ludHNcbiAgICAgKiB2YXIgcG9pbnRzID0gbGluZS5wb2ludHMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBwb2ludHNcbiAgICAgKiBsaW5lLnBvaW50cyhbMTAsIDIwLCAzMCwgNDAsIDUwLCA2MF0pO1xuICAgICAqXG4gICAgICogLy8gcHVzaCBhIG5ldyBwb2ludFxuICAgICAqIGxpbmUucG9pbnRzKGxpbmUucG9pbnRzKCkuY29uY2F0KFs3MCwgODBdKSk7XG4gICAgICovXG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuTGluZSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIFNwcml0ZSBjb25zdHJ1Y3RvclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBhdWdtZW50cyBLb252YS5TaGFwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29uZmlnLmFuaW1hdGlvbiBhbmltYXRpb24ga2V5XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZy5hbmltYXRpb25zIGFuaW1hdGlvbiBtYXBcbiAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IFtjb25maWcuZnJhbWVJbmRleF0gYW5pbWF0aW9uIGZyYW1lIGluZGV4XG4gICAgICogQHBhcmFtIHtJbWFnZX0gY29uZmlnLmltYWdlIGltYWdlIG9iamVjdFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgaW1hZ2VPYmogPSBuZXcgSW1hZ2UoKTtcbiAgICAgKiBpbWFnZU9iai5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgKiAgIHZhciBzcHJpdGUgPSBuZXcgS29udmEuU3ByaXRlKHtcbiAgICAgKiAgICAgeDogMjAwLFxuICAgICAqICAgICB5OiAxMDAsXG4gICAgICogICAgIGltYWdlOiBpbWFnZU9iaixcbiAgICAgKiAgICAgYW5pbWF0aW9uOiAnc3RhbmRpbmcnLFxuICAgICAqICAgICBhbmltYXRpb25zOiB7XG4gICAgICogICAgICAgc3RhbmRpbmc6IFtcbiAgICAgKiAgICAgICAgIC8vIHgsIHksIHdpZHRoLCBoZWlnaHQgKDYgZnJhbWVzKVxuICAgICAqICAgICAgICAgMCwgMCwgNDksIDEwOSxcbiAgICAgKiAgICAgICAgIDUyLCAwLCA0OSwgMTA5LFxuICAgICAqICAgICAgICAgMTA1LCAwLCA0OSwgMTA5LFxuICAgICAqICAgICAgICAgMTU4LCAwLCA0OSwgMTA5LFxuICAgICAqICAgICAgICAgMjEwLCAwLCA0OSwgMTA5LFxuICAgICAqICAgICAgICAgMjYyLCAwLCA0OSwgMTA5XG4gICAgICogICAgICAgXSxcbiAgICAgKiAgICAgICBraWNraW5nOiBbXG4gICAgICogICAgICAgICAvLyB4LCB5LCB3aWR0aCwgaGVpZ2h0ICg2IGZyYW1lcylcbiAgICAgKiAgICAgICAgIDAsIDEwOSwgNDUsIDk4LFxuICAgICAqICAgICAgICAgNDUsIDEwOSwgNDUsIDk4LFxuICAgICAqICAgICAgICAgOTUsIDEwOSwgNjMsIDk4LFxuICAgICAqICAgICAgICAgMTU2LCAxMDksIDcwLCA5OCxcbiAgICAgKiAgICAgICAgIDIyOSwgMTA5LCA2MCwgOTgsXG4gICAgICogICAgICAgICAyODcsIDEwOSwgNDEsIDk4XG4gICAgICogICAgICAgXVxuICAgICAqICAgICB9LFxuICAgICAqICAgICBmcmFtZVJhdGU6IDcsXG4gICAgICogICAgIGZyYW1lSW5kZXg6IDBcbiAgICAgKiAgIH0pO1xuICAgICAqIH07XG4gICAgICogaW1hZ2VPYmouc3JjID0gJy9wYXRoL3RvL2ltYWdlLmpwZydcbiAgICAgKi9cbiAgICBLb252YS5TcHJpdGUgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLlNwcml0ZS5wcm90b3R5cGUgPSB7XG4gICAgICAgIF9fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSAnU3ByaXRlJztcblxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmFuaW0gPSBuZXcgS29udmEuQW5pbWF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IG5lZWQgdG8gcmVkcmF3IGxheWVyIHdlIHNob3VsZCByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IHRoYXQuX3VwZGF0ZWQ7XG4gICAgICAgICAgICAgICAgdGhhdC5fdXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm9uKCdhbmltYXRpb25DaGFuZ2Uua29udmEnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyByZXNldCBpbmRleCB3aGVuIGFuaW1hdGlvbiBjaGFuZ2VzXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4KDApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm9uKCdmcmFtZUluZGV4Q2hhbmdlLmtvbnZhJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHNtb290aCBjaGFuZ2UgZm9yIGZyYW1lUmF0ZVxuICAgICAgICAgICAgdGhpcy5vbignZnJhbWVSYXRlQ2hhbmdlLmtvbnZhJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmFuaW0uaXNSdW5uaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldEludGVydmFsKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgICAgIHRoaXMuaGl0RnVuYyh0aGlzLl9oaXRGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmdldEFuaW1hdGlvbigpLFxuICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5mcmFtZUluZGV4KCksXG4gICAgICAgICAgICAgICAgaXg0ID0gaW5kZXggKiA0LFxuICAgICAgICAgICAgICAgIHNldCA9IHRoaXMuZ2V0QW5pbWF0aW9ucygpW2FuaW1dLFxuICAgICAgICAgICAgICAgIG9mZnNldHMgPSB0aGlzLmZyYW1lT2Zmc2V0cygpLFxuICAgICAgICAgICAgICAgIHggPSBzZXRbaXg0ICsgMF0sXG4gICAgICAgICAgICAgICAgeSA9IHNldFtpeDQgKyAxXSxcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHNldFtpeDQgKyAyXSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBzZXRbaXg0ICsgM10sXG4gICAgICAgICAgICAgICAgaW1hZ2UgPSB0aGlzLmdldEltYWdlKCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmhhc0ZpbGwoKSB8fCB0aGlzLmhhc1N0cm9rZSgpKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHJva2VTaGFwZSh0aGlzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0c1thbmltXSxcbiAgICAgICAgICAgICAgICAgICAgaXgyID0gaW5kZXggKiAyO1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgeCwgeSwgd2lkdGgsIGhlaWdodCwgb2Zmc2V0W2l4MiArIDBdLCBvZmZzZXRbaXgyICsgMV0sIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9oaXRGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgYW5pbSA9IHRoaXMuZ2V0QW5pbWF0aW9uKCksXG4gICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLmZyYW1lSW5kZXgoKSxcbiAgICAgICAgICAgICAgICBpeDQgPSBpbmRleCAqIDQsXG4gICAgICAgICAgICAgICAgc2V0ID0gdGhpcy5nZXRBbmltYXRpb25zKClbYW5pbV0sXG4gICAgICAgICAgICAgICAgb2Zmc2V0cyA9IHRoaXMuZnJhbWVPZmZzZXRzKCksXG4gICAgICAgICAgICAgICAgd2lkdGggPSBzZXRbaXg0ICsgMl0sXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gc2V0W2l4NCArIDNdO1xuXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgaWYgKG9mZnNldHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0c1thbmltXTtcbiAgICAgICAgICAgICAgICB2YXIgaXgyID0gaW5kZXggKiAyO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdChvZmZzZXRbaXgyICsgMF0sIG9mZnNldFtpeDIgKyAxXSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGxTaGFwZSh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3VzZUJ1ZmZlckNhbnZhczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuaGFzU2hhZG93KCkgfHwgdGhpcy5nZXRBYnNvbHV0ZU9wYWNpdHkoKSAhPT0gMSkgJiYgdGhpcy5oYXNTdHJva2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NldEludGVydmFsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGF0Ll91cGRhdGVJbmRleCgpO1xuICAgICAgICAgICAgfSwgMTAwMCAvIHRoaXMuZ2V0RnJhbWVSYXRlKCkpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogc3RhcnQgc3ByaXRlIGFuaW1hdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TcHJpdGUucHJvdG90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbGF5ZXIgPSB0aGlzLmdldExheWVyKCk7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBhbmltYXRpb24gb2JqZWN0IGhhcyBubyBleGVjdXRhYmxlIGZ1bmN0aW9uIGJlY2F1c2VcbiAgICAgICAgICAgICAqICB0aGUgdXBkYXRlcyBhcmUgZG9uZSB3aXRoIGEgZml4ZWQgRlBTIHdpdGggdGhlIHNldEludGVydmFsXG4gICAgICAgICAgICAgKiAgYmVsb3cuICBUaGUgYW5pbSBvYmplY3Qgb25seSBuZWVkcyB0aGUgbGF5ZXIgcmVmZXJlbmNlIGZvclxuICAgICAgICAgICAgICogIHJlZHJhd1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLmFuaW0uc2V0TGF5ZXJzKGxheWVyKTtcbiAgICAgICAgICAgIHRoaXMuX3NldEludGVydmFsKCk7XG4gICAgICAgICAgICB0aGlzLmFuaW0uc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHN0b3Agc3ByaXRlIGFuaW1hdGlvblxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5TcHJpdGUucHJvdG90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbS5zdG9wKCk7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZGV0ZXJtaW5lIGlmIGFuaW1hdGlvbiBvZiBzcHJpdGUgaXMgcnVubmluZyBvciBub3QuICByZXR1cm5zIHRydWUgb3IgZmFsc2VcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuQW5pbWF0aW9uLnByb3RvdHlwZVxuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGlzUnVubmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbmltLmlzUnVubmluZygpO1xuICAgICAgICB9LFxuICAgICAgICBfdXBkYXRlSW5kZXg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5mcmFtZUluZGV4KCksXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5nZXRBbmltYXRpb24oKSxcbiAgICAgICAgICAgICAgICBhbmltYXRpb25zID0gdGhpcy5nZXRBbmltYXRpb25zKCksXG4gICAgICAgICAgICAgICAgYW5pbSA9IGFuaW1hdGlvbnNbYW5pbWF0aW9uXSxcbiAgICAgICAgICAgICAgICBsZW4gPSBhbmltLmxlbmd0aCAvIDQ7XG5cbiAgICAgICAgICAgIGlmKGluZGV4IDwgbGVuIC0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVJbmRleChpbmRleCArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZUluZGV4KDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5TcHJpdGUsIEtvbnZhLlNoYXBlKTtcblxuICAgIC8vIGFkZCBnZXR0ZXJzIHNldHRlcnNcbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TcHJpdGUsICdhbmltYXRpb24nKTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgYW5pbWF0aW9uIGtleVxuICAgICAqIEBuYW1lIGFuaW1hdGlvblxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU3ByaXRlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBhbmltIGFuaW1hdGlvbiBrZXlcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGFuaW1hdGlvbiBrZXlcbiAgICAgKiB2YXIgYW5pbWF0aW9uID0gc3ByaXRlLmFuaW1hdGlvbigpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGFuaW1hdGlvbiBrZXlcbiAgICAgKiBzcHJpdGUuYW5pbWF0aW9uKCdraWNraW5nJyk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TcHJpdGUsICdhbmltYXRpb25zJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGFuaW1hdGlvbnMgbWFwXG4gICAgICogQG5hbWUgYW5pbWF0aW9uc1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU3ByaXRlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhbmltYXRpb25zXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBhbmltYXRpb25zIG1hcFxuICAgICAqIHZhciBhbmltYXRpb25zID0gc3ByaXRlLmFuaW1hdGlvbnMoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBhbmltYXRpb25zIG1hcFxuICAgICAqIHNwcml0ZS5hbmltYXRpb25zKHtcbiAgICAgKiAgIHN0YW5kaW5nOiBbXG4gICAgICogICAgIC8vIHgsIHksIHdpZHRoLCBoZWlnaHQgKDYgZnJhbWVzKVxuICAgICAqICAgICAwLCAwLCA0OSwgMTA5LFxuICAgICAqICAgICA1MiwgMCwgNDksIDEwOSxcbiAgICAgKiAgICAgMTA1LCAwLCA0OSwgMTA5LFxuICAgICAqICAgICAxNTgsIDAsIDQ5LCAxMDksXG4gICAgICogICAgIDIxMCwgMCwgNDksIDEwOSxcbiAgICAgKiAgICAgMjYyLCAwLCA0OSwgMTA5XG4gICAgICogICBdLFxuICAgICAqICAga2lja2luZzogW1xuICAgICAqICAgICAvLyB4LCB5LCB3aWR0aCwgaGVpZ2h0ICg2IGZyYW1lcylcbiAgICAgKiAgICAgMCwgMTA5LCA0NSwgOTgsXG4gICAgICogICAgIDQ1LCAxMDksIDQ1LCA5OCxcbiAgICAgKiAgICAgOTUsIDEwOSwgNjMsIDk4LFxuICAgICAqICAgICAxNTYsIDEwOSwgNzAsIDk4LFxuICAgICAqICAgICAyMjksIDEwOSwgNjAsIDk4LFxuICAgICAqICAgICAyODcsIDEwOSwgNDEsIDk4XG4gICAgICogICBdXG4gICAgICogfSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TcHJpdGUsICdmcmFtZU9mZnNldHMnKTtcblxuICAgIC8qKlxuICAgICogZ2V0L3NldCBvZmZzZXRzIG1hcFxuICAgICogQG5hbWUgb2Zmc2V0c1xuICAgICogQG1ldGhvZFxuICAgICogQG1lbWJlcm9mIEtvbnZhLlNwcml0ZS5wcm90b3R5cGVcbiAgICAqIEBwYXJhbSB7T2JqZWN0fSBvZmZzZXRzXG4gICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICogQGV4YW1wbGVcbiAgICAqIC8vIGdldCBvZmZzZXRzIG1hcFxuICAgICogdmFyIG9mZnNldHMgPSBzcHJpdGUub2Zmc2V0cygpO1xuICAgICpcbiAgICAqIC8vIHNldCBvZmZzZXRzIG1hcFxuICAgICogc3ByaXRlLm9mZnNldHMoe1xuICAgICogICBzdGFuZGluZzogW1xuICAgICogICAgIC8vIHgsIHkgKDYgZnJhbWVzKVxuICAgICogICAgIDAsIDAsXG4gICAgKiAgICAgMCwgMCxcbiAgICAqICAgICA1LCAwLFxuICAgICogICAgIDAsIDAsXG4gICAgKiAgICAgMCwgMyxcbiAgICAqICAgICAyLCAwXG4gICAgKiAgIF0sXG4gICAgKiAgIGtpY2tpbmc6IFtcbiAgICAqICAgICAvLyB4LCB5ICg2IGZyYW1lcylcbiAgICAqICAgICAwLCA1LFxuICAgICogICAgIDUsIDAsXG4gICAgKiAgICAgMTAsIDAsXG4gICAgKiAgICAgMCwgMCxcbiAgICAqICAgICAyLCAxLFxuICAgICogICAgIDAsIDBcbiAgICAqICAgXVxuICAgICogfSk7XG4gICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNwcml0ZSwgJ2ltYWdlJyk7XG5cbiAgICAvKipcbiAgICAgKiBnZXQvc2V0IGltYWdlXG4gICAgICogQG5hbWUgaW1hZ2VcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlNwcml0ZS5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBpbWFnZVxuICAgICAqIEByZXR1cm5zIHtJbWFnZX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBpbWFnZVxuICAgICAqIHZhciBpbWFnZSA9IHNwcml0ZS5pbWFnZSgpO1xuICAgICAqXG4gICAgICogLy8gc2V0IGltYWdlXG4gICAgICogc3ByaXRlLmltYWdlKGltYWdlT2JqKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNwcml0ZSwgJ2ZyYW1lSW5kZXgnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldC9zZXQgYW5pbWF0aW9uIGZyYW1lIGluZGV4XG4gICAgICogQG5hbWUgZnJhbWVJbmRleFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU3ByaXRlLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gZnJhbWVJbmRleFxuICAgICAqIEByZXR1cm5zIHtJbnRlZ2VyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IGFuaW1hdGlvbiBmcmFtZSBpbmRleFxuICAgICAqIHZhciBmcmFtZUluZGV4ID0gc3ByaXRlLmZyYW1lSW5kZXgoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBhbmltYXRpb24gZnJhbWUgaW5kZXhcbiAgICAgKiBzcHJpdGUuZnJhbWVJbmRleCgzKTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlNwcml0ZSwgJ2ZyYW1lUmF0ZScsIDE3KTtcblxuICAgIC8qKlxuICAgICAqIGdldC9zZXQgZnJhbWUgcmF0ZSBpbiBmcmFtZXMgcGVyIHNlY29uZC4gIEluY3JlYXNlIHRoaXMgbnVtYmVyIHRvIG1ha2UgdGhlIHNwcml0ZVxuICAgICAqICBhbmltYXRpb24gcnVuIGZhc3RlciwgYW5kIGRlY3JlYXNlIHRoZSBudW1iZXIgdG8gbWFrZSB0aGUgc3ByaXRlIGFuaW1hdGlvbiBydW4gc2xvd2VyXG4gICAgICogIFRoZSBkZWZhdWx0IGlzIDE3IGZyYW1lcyBwZXIgc2Vjb25kXG4gICAgICogQG5hbWUgZnJhbWVSYXRlXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TcHJpdGUucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfSBmcmFtZVJhdGVcbiAgICAgKiBAcmV0dXJucyB7SW50ZWdlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCBmcmFtZSByYXRlXG4gICAgICogdmFyIGZyYW1lUmF0ZSA9IHNwcml0ZS5mcmFtZVJhdGUoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCBmcmFtZSByYXRlIHRvIDIgZnJhbWVzIHBlciBzZWNvbmRcbiAgICAgKiBzcHJpdGUuZnJhbWVSYXRlKDIpO1xuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5iYWNrQ29tcGF0KEtvbnZhLlNwcml0ZSwge1xuICAgICAgICBpbmRleDogJ2ZyYW1lSW5kZXgnLFxuICAgICAgICBnZXRJbmRleDogJ2dldEZyYW1lSW5kZXgnLFxuICAgICAgICBzZXRJbmRleDogJ3NldEZyYW1lSW5kZXgnXG4gICAgfSk7XG5cbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuU3ByaXRlKTtcbn0pKCk7XG5cbi8qZXNsaW50LWRpc2FibGUgIG5vLXNoYWRvdywgbWF4LWxlbiwgbWF4LWRlcHRoICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBQYXRoIGNvbnN0cnVjdG9yLlxuICAgICAqIEBhdXRob3IgSmFzb24gRm9sbGFzXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLlNoYXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb25maWcuZGF0YSBTVkcgZGF0YSBzdHJpbmdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsXSBmaWxsIGNvbG9yXG4gICAgICogQHBhcmFtIHtJbWFnZX0gW2NvbmZpZy5maWxsUGF0dGVybkltYWdlXSBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5ZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRZXSBcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlXSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuUm90YXRpb25dXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFBhdHRlcm5SZXBlYXRdIGNhbiBiZSBcInJlcGVhdFwiLCBcInJlcGVhdC14XCIsIFwicmVwZWF0LXlcIiwgb3IgXCJuby1yZXBlYXRcIi4gIFRoZSBkZWZhdWx0IGlzIFwibm8tcmVwZWF0XCJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFldXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFldIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmZpbGxFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGZpbGwuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFByaW9yaXR5XSBjYW4gYmUgY29sb3IsIGxpbmVhci1ncmFkaWVudCwgcmFkaWFsLWdyYWlkZW50LCBvciBwYXR0ZXJuLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgY29sb3IuICBUaGUgZmlsbFByaW9yaXR5IHByb3BlcnR5IG1ha2VzIGl0IHJlYWxseSBlYXN5IHRvIHRvZ2dsZSBiZXR3ZWVuIGRpZmZlcmVudCBmaWxsIHR5cGVzLiAgRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIHRvZ2dsZSBiZXR3ZWVuIGEgZmlsbCBjb2xvciBzdHlsZSBhbmQgYSBmaWxsIHBhdHRlcm4gc3R5bGUsIHNpbXBseSBzZXQgdGhlIGZpbGwgcHJvcGVydHkgYW5kIHRoZSBmaWxsUGF0dGVybiBwcm9wZXJ0aWVzLCBhbmQgdGhlbiB1c2Ugc2V0RmlsbFByaW9yaXR5KCdjb2xvcicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCBhIGNvbG9yIGZpbGwsIG9yIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ3BhdHRlcm4nKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggdGhlIHBhdHRlcm4gZmlsbCBjb25maWd1cmF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc3Ryb2tlXSBzdHJva2UgY29sb3JcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zdHJva2VXaWR0aF0gc3Ryb2tlIHdpZHRoXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUhpdEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2UgaGl0IHJlZ2lvbi4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcucGVyZmVjdERyYXdFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdXNpbmcgYnVmZmVyIGNhbnZhcy4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHNoYXNvdyBmb3Igc3Ryb2tlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VTY2FsZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2Ugc2NhbGUuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc3Ryb2tlLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVKb2luXSBjYW4gYmUgbWl0ZXIsIHJvdW5kLCBvciBiZXZlbC4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIG1pdGVyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUNhcF0gY2FuIGJlIGJ1dHQsIHJvdW5kLCBvciBzcWFyZS4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIGJ1dHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zaGFkb3dDb2xvcl1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dCbHVyXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNoYWRvd09mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T3BhY2l0eV0gc2hhZG93IG9wYWNpdHkuICBDYW4gYmUgYW55IHJlYWwgbnVtYmVyXG4gICAgICogIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHNoYWRvdy4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmRhc2hdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRhc2hFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGRhc2hBcnJheS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIHBhdGggPSBuZXcgS29udmEuUGF0aCh7XG4gICAgICogICB4OiAyNDAsXG4gICAgICogICB5OiA0MCxcbiAgICAgKiAgIGRhdGE6ICdNMTIuNTgyLDkuNTUxQzMuMjUxLDE2LjIzNywwLjkyMSwyOS4wMjEsNy4wOCwzOC41NjRsLTIuMzYsMS42ODlsNC44OTMsMi4yNjJsNC44OTMsMi4yNjJsLTAuNTY4LTUuMzZsLTAuNTY3LTUuMzU5bC0yLjM2NSwxLjY5NGMtNC42NTctNy4zNzUtMi44My0xNy4xODUsNC4zNTItMjIuMzNjNy40NTEtNS4zMzgsMTcuODE3LTMuNjI1LDIzLjE1NiwzLjgyNGM1LjMzNyw3LjQ0OSwzLjYyNSwxNy44MTMtMy44MjEsMjMuMTUybDIuODU3LDMuOTg4YzkuNjE3LTYuODkzLDExLjgyNy0yMC4yNzcsNC45MzUtMjkuODk2QzM1LjU5MSw0Ljg3LDIyLjIwNCwyLjY1OCwxMi41ODIsOS41NTF6JyxcbiAgICAgKiAgIGZpbGw6ICdncmVlbicsXG4gICAgICogICBzY2FsZTogMlxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLlBhdGggPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5QYXRoLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSAnUGF0aCc7XG5cbiAgICAgICAgICAgIHRoaXMuZGF0YUFycmF5ID0gS29udmEuUGF0aC5wYXJzZVBhdGhEYXRhKHRoaXMuZ2V0RGF0YSgpKTtcbiAgICAgICAgICAgIHRoaXMub24oJ2RhdGFDaGFuZ2Uua29udmEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5kYXRhQXJyYXkgPSBLb252YS5QYXRoLnBhcnNlUGF0aERhdGEodGhpcy5nZXREYXRhKCkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2NlbmVGdW5jKHRoaXMuX3NjZW5lRnVuYyk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY2VuZUZ1bmM6IGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciBjYSA9IHRoaXMuZGF0YUFycmF5O1xuXG4gICAgICAgICAgICAvLyBjb250ZXh0IHBvc2l0aW9uXG4gICAgICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBjYS5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBjID0gY2Fbbl0uY29tbWFuZDtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IGNhW25dLnBvaW50cztcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwWzBdLCBwWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdNJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKHBbMF0sIHBbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iZXppZXJDdXJ2ZVRvKHBbMF0sIHBbMV0sIHBbMl0sIHBbM10sIHBbNF0sIHBbNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKHBbMF0sIHBbMV0sIHBbMl0sIHBbM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN4ID0gcFswXSwgY3kgPSBwWzFdLCByeCA9IHBbMl0sIHJ5ID0gcFszXSwgdGhldGEgPSBwWzRdLCBkVGhldGEgPSBwWzVdLCBwc2kgPSBwWzZdLCBmcyA9IHBbN107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gKHJ4ID4gcnkpID8gcnggOiByeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZVggPSAocnggPiByeSkgPyAxIDogcnggLyByeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY2FsZVkgPSAocnggPiByeSkgPyByeSAvIHJ4IDogMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC50cmFuc2xhdGUoY3gsIGN5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQucm90YXRlKHBzaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnNjYWxlKHNjYWxlWCwgc2NhbGVZKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKDAsIDAsIHIsIHRoZXRhLCB0aGV0YSArIGRUaGV0YSwgMSAtIGZzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2NhbGUoMSAvIHNjYWxlWCwgMSAvIHNjYWxlWSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJvdGF0ZSgtcHNpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKC1jeCwgLWN5KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3onOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFNlbGZSZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBwb2ludHMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZGF0YUFycmF5LmZvckVhY2goZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHBvaW50cyA9IHBvaW50cy5jb25jYXQoZGF0YS5wb2ludHMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgbWluWCA9IHBvaW50c1swXTtcbiAgICAgICAgICAgIHZhciBtYXhYID0gcG9pbnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1pblkgPSBwb2ludHNbMV07XG4gICAgICAgICAgICB2YXIgbWF4WSA9IHBvaW50c1sxXTtcbiAgICAgICAgICAgIHZhciB4LCB5O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgeCA9IHBvaW50c1tpICogMl07IHkgPSBwb2ludHNbaSAqIDIgKyAxXTtcbiAgICAgICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgeCk7XG4gICAgICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHgpO1xuICAgICAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB5KTtcbiAgICAgICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IE1hdGgucm91bmQobWluWCksXG4gICAgICAgICAgICAgICAgeTogTWF0aC5yb3VuZChtaW5ZKSxcbiAgICAgICAgICAgICAgICB3aWR0aDogTWF0aC5yb3VuZChtYXhYIC0gbWluWCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKG1heFkgLSBtaW5ZKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuUGF0aCwgS29udmEuU2hhcGUpO1xuXG4gICAgS29udmEuUGF0aC5nZXRMaW5lTGVuZ3RoID0gZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCgoeDIgLSB4MSkgKiAoeDIgLSB4MSkgKyAoeTIgLSB5MSkgKiAoeTIgLSB5MSkpO1xuICAgIH07XG4gICAgS29udmEuUGF0aC5nZXRQb2ludE9uTGluZSA9IGZ1bmN0aW9uKGRpc3QsIFAxeCwgUDF5LCBQMngsIFAyeSwgZnJvbVgsIGZyb21ZKSB7XG4gICAgICAgIGlmKGZyb21YID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZyb21YID0gUDF4O1xuICAgICAgICB9XG4gICAgICAgIGlmKGZyb21ZID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZyb21ZID0gUDF5O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG0gPSAoUDJ5IC0gUDF5KSAvICgoUDJ4IC0gUDF4KSArIDAuMDAwMDAwMDEpO1xuICAgICAgICB2YXIgcnVuID0gTWF0aC5zcXJ0KGRpc3QgKiBkaXN0IC8gKDEgKyBtICogbSkpO1xuICAgICAgICBpZihQMnggPCBQMXgpIHtcbiAgICAgICAgICAgIHJ1biAqPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmlzZSA9IG0gKiBydW47XG4gICAgICAgIHZhciBwdDtcblxuICAgICAgICBpZiAoUDJ4ID09PSBQMXgpIHsgLy8gdmVydGljYWwgbGluZVxuICAgICAgICAgICAgcHQgPSB7XG4gICAgICAgICAgICAgICAgeDogZnJvbVgsXG4gICAgICAgICAgICAgICAgeTogZnJvbVkgKyByaXNlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2UgaWYoKGZyb21ZIC0gUDF5KSAvICgoZnJvbVggLSBQMXgpICsgMC4wMDAwMDAwMSkgPT09IG0pIHtcbiAgICAgICAgICAgIHB0ID0ge1xuICAgICAgICAgICAgICAgIHg6IGZyb21YICsgcnVuLFxuICAgICAgICAgICAgICAgIHk6IGZyb21ZICsgcmlzZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpeCwgaXk7XG5cbiAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLmdldExpbmVMZW5ndGgoUDF4LCBQMXksIFAyeCwgUDJ5KTtcbiAgICAgICAgICAgIGlmKGxlbiA8IDAuMDAwMDAwMDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHUgPSAoKChmcm9tWCAtIFAxeCkgKiAoUDJ4IC0gUDF4KSkgKyAoKGZyb21ZIC0gUDF5KSAqIChQMnkgLSBQMXkpKSk7XG4gICAgICAgICAgICB1ID0gdSAvIChsZW4gKiBsZW4pO1xuICAgICAgICAgICAgaXggPSBQMXggKyB1ICogKFAyeCAtIFAxeCk7XG4gICAgICAgICAgICBpeSA9IFAxeSArIHUgKiAoUDJ5IC0gUDF5KTtcblxuICAgICAgICAgICAgdmFyIHBSaXNlID0gdGhpcy5nZXRMaW5lTGVuZ3RoKGZyb21YLCBmcm9tWSwgaXgsIGl5KTtcbiAgICAgICAgICAgIHZhciBwUnVuID0gTWF0aC5zcXJ0KGRpc3QgKiBkaXN0IC0gcFJpc2UgKiBwUmlzZSk7XG4gICAgICAgICAgICBydW4gPSBNYXRoLnNxcnQocFJ1biAqIHBSdW4gLyAoMSArIG0gKiBtKSk7XG4gICAgICAgICAgICBpZihQMnggPCBQMXgpIHtcbiAgICAgICAgICAgICAgICBydW4gKj0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByaXNlID0gbSAqIHJ1bjtcbiAgICAgICAgICAgIHB0ID0ge1xuICAgICAgICAgICAgICAgIHg6IGl4ICsgcnVuLFxuICAgICAgICAgICAgICAgIHk6IGl5ICsgcmlzZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwdDtcbiAgICB9O1xuXG4gICAgS29udmEuUGF0aC5nZXRQb2ludE9uQ3ViaWNCZXppZXIgPSBmdW5jdGlvbihwY3QsIFAxeCwgUDF5LCBQMngsIFAyeSwgUDN4LCBQM3ksIFA0eCwgUDR5KSB7XG4gICAgICAgIGZ1bmN0aW9uIENCMSh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdCAqIHQgKiB0O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIENCMih0KSB7XG4gICAgICAgICAgICByZXR1cm4gMyAqIHQgKiB0ICogKDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBDQjModCkge1xuICAgICAgICAgICAgcmV0dXJuIDMgKiB0ICogKDEgLSB0KSAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gQ0I0KHQpIHtcbiAgICAgICAgICAgIHJldHVybiAoMSAtIHQpICogKDEgLSB0KSAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHggPSBQNHggKiBDQjEocGN0KSArIFAzeCAqIENCMihwY3QpICsgUDJ4ICogQ0IzKHBjdCkgKyBQMXggKiBDQjQocGN0KTtcbiAgICAgICAgdmFyIHkgPSBQNHkgKiBDQjEocGN0KSArIFAzeSAqIENCMihwY3QpICsgUDJ5ICogQ0IzKHBjdCkgKyBQMXkgKiBDQjQocGN0KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHlcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEtvbnZhLlBhdGguZ2V0UG9pbnRPblF1YWRyYXRpY0JlemllciA9IGZ1bmN0aW9uKHBjdCwgUDF4LCBQMXksIFAyeCwgUDJ5LCBQM3gsIFAzeSkge1xuICAgICAgICBmdW5jdGlvbiBRQjEodCkge1xuICAgICAgICAgICAgcmV0dXJuIHQgKiB0O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIFFCMih0KSB7XG4gICAgICAgICAgICByZXR1cm4gMiAqIHQgKiAoMSAtIHQpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIFFCMyh0KSB7XG4gICAgICAgICAgICByZXR1cm4gKDEgLSB0KSAqICgxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHggPSBQM3ggKiBRQjEocGN0KSArIFAyeCAqIFFCMihwY3QpICsgUDF4ICogUUIzKHBjdCk7XG4gICAgICAgIHZhciB5ID0gUDN5ICogUUIxKHBjdCkgKyBQMnkgKiBRQjIocGN0KSArIFAxeSAqIFFCMyhwY3QpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgeTogeVxuICAgICAgICB9O1xuICAgIH07XG4gICAgS29udmEuUGF0aC5nZXRQb2ludE9uRWxsaXB0aWNhbEFyYyA9IGZ1bmN0aW9uKGN4LCBjeSwgcngsIHJ5LCB0aGV0YSwgcHNpKSB7XG4gICAgICAgIHZhciBjb3NQc2kgPSBNYXRoLmNvcyhwc2kpLCBzaW5Qc2kgPSBNYXRoLnNpbihwc2kpO1xuICAgICAgICB2YXIgcHQgPSB7XG4gICAgICAgICAgICB4OiByeCAqIE1hdGguY29zKHRoZXRhKSxcbiAgICAgICAgICAgIHk6IHJ5ICogTWF0aC5zaW4odGhldGEpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBjeCArIChwdC54ICogY29zUHNpIC0gcHQueSAqIHNpblBzaSksXG4gICAgICAgICAgICB5OiBjeSArIChwdC54ICogc2luUHNpICsgcHQueSAqIGNvc1BzaSlcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qXG4gICAgICogZ2V0IHBhcnNlZCBkYXRhIGFycmF5IGZyb20gdGhlIGRhdGFcbiAgICAgKiAgc3RyaW5nLiAgViwgdiwgSCwgaCwgYW5kIGwgZGF0YSBhcmUgY29udmVydGVkIHRvXG4gICAgICogIEwgZGF0YSBmb3IgdGhlIHB1cnBvc2Ugb2YgaGlnaCBwZXJmb3JtYW5jZSBQYXRoXG4gICAgICogIHJlbmRlcmluZ1xuICAgICAqL1xuICAgIEtvbnZhLlBhdGgucGFyc2VQYXRoRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgLy8gUGF0aCBEYXRhIFNlZ21lbnQgbXVzdCBiZWdpbiB3aXRoIGEgbW92ZVRvXG4gICAgICAgIC8vbSAoeCB5KSsgIFJlbGF0aXZlIG1vdmVUbyAoc3Vic2VxdWVudCBwb2ludHMgYXJlIHRyZWF0ZWQgYXMgbGluZVRvKVxuICAgICAgICAvL00gKHggeSkrICBBYnNvbHV0ZSBtb3ZlVG8gKHN1YnNlcXVlbnQgcG9pbnRzIGFyZSB0cmVhdGVkIGFzIGxpbmVUbylcbiAgICAgICAgLy9sICh4IHkpKyAgUmVsYXRpdmUgbGluZVRvXG4gICAgICAgIC8vTCAoeCB5KSsgIEFic29sdXRlIExpbmVUb1xuICAgICAgICAvL2ggKHgpKyAgICBSZWxhdGl2ZSBob3Jpem9udGFsIGxpbmVUb1xuICAgICAgICAvL0ggKHgpKyAgICBBYnNvbHV0ZSBob3Jpem9udGFsIGxpbmVUb1xuICAgICAgICAvL3YgKHkpKyAgICBSZWxhdGl2ZSB2ZXJ0aWNhbCBsaW5lVG9cbiAgICAgICAgLy9WICh5KSsgICAgQWJzb2x1dGUgdmVydGljYWwgbGluZVRvXG4gICAgICAgIC8veiAoY2xvc2VwYXRoKVxuICAgICAgICAvL1ogKGNsb3NlcGF0aClcbiAgICAgICAgLy9jICh4MSB5MSB4MiB5MiB4IHkpKyBSZWxhdGl2ZSBCZXppZXIgY3VydmVcbiAgICAgICAgLy9DICh4MSB5MSB4MiB5MiB4IHkpKyBBYnNvbHV0ZSBCZXppZXIgY3VydmVcbiAgICAgICAgLy9xICh4MSB5MSB4IHkpKyAgICAgICBSZWxhdGl2ZSBRdWFkcmF0aWMgQmV6aWVyXG4gICAgICAgIC8vUSAoeDEgeTEgeCB5KSsgICAgICAgQWJzb2x1dGUgUXVhZHJhdGljIEJlemllclxuICAgICAgICAvL3QgKHggeSkrICAgIFNob3J0aGFuZC9TbW9vdGggUmVsYXRpdmUgUXVhZHJhdGljIEJlemllclxuICAgICAgICAvL1QgKHggeSkrICAgIFNob3J0aGFuZC9TbW9vdGggQWJzb2x1dGUgUXVhZHJhdGljIEJlemllclxuICAgICAgICAvL3MgKHgyIHkyIHggeSkrICAgICAgIFNob3J0aGFuZC9TbW9vdGggUmVsYXRpdmUgQmV6aWVyIGN1cnZlXG4gICAgICAgIC8vUyAoeDIgeTIgeCB5KSsgICAgICAgU2hvcnRoYW5kL1Ntb290aCBBYnNvbHV0ZSBCZXppZXIgY3VydmVcbiAgICAgICAgLy9hIChyeCByeSB4LWF4aXMtcm90YXRpb24gbGFyZ2UtYXJjLWZsYWcgc3dlZXAtZmxhZyB4IHkpKyAgICAgUmVsYXRpdmUgRWxsaXB0aWNhbCBBcmNcbiAgICAgICAgLy9BIChyeCByeSB4LWF4aXMtcm90YXRpb24gbGFyZ2UtYXJjLWZsYWcgc3dlZXAtZmxhZyB4IHkpKyAgQWJzb2x1dGUgRWxsaXB0aWNhbCBBcmNcblxuICAgICAgICAvLyByZXR1cm4gZWFybHkgaWYgZGF0YSBpcyBub3QgZGVmaW5lZFxuICAgICAgICBpZighZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29tbWFuZCBzdHJpbmdcbiAgICAgICAgdmFyIGNzID0gZGF0YTtcblxuICAgICAgICAvLyBjb21tYW5kIGNoYXJzXG4gICAgICAgIHZhciBjYyA9IFsnbScsICdNJywgJ2wnLCAnTCcsICd2JywgJ1YnLCAnaCcsICdIJywgJ3onLCAnWicsICdjJywgJ0MnLCAncScsICdRJywgJ3QnLCAnVCcsICdzJywgJ1MnLCAnYScsICdBJ107XG4gICAgICAgIC8vIGNvbnZlcnQgd2hpdGUgc3BhY2VzIHRvIGNvbW1hc1xuICAgICAgICBjcyA9IGNzLnJlcGxhY2UobmV3IFJlZ0V4cCgnICcsICdnJyksICcsJyk7XG4gICAgICAgIC8vIGNyZWF0ZSBwaXBlcyBzbyB0aGF0IHdlIGNhbiBzcGxpdCB0aGUgZGF0YVxuICAgICAgICBmb3IodmFyIG4gPSAwOyBuIDwgY2MubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIGNzID0gY3MucmVwbGFjZShuZXcgUmVnRXhwKGNjW25dLCAnZycpLCAnfCcgKyBjY1tuXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gY3JlYXRlIGFycmF5XG4gICAgICAgIHZhciBhcnIgPSBjcy5zcGxpdCgnfCcpO1xuICAgICAgICB2YXIgY2EgPSBbXTtcbiAgICAgICAgLy8gaW5pdCBjb250ZXh0IHBvaW50XG4gICAgICAgIHZhciBjcHggPSAwO1xuICAgICAgICB2YXIgY3B5ID0gMDtcbiAgICAgICAgZm9yKCBuID0gMTsgbiA8IGFyci5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgdmFyIHN0ciA9IGFycltuXTtcbiAgICAgICAgICAgIHZhciBjID0gc3RyLmNoYXJBdCgwKTtcbiAgICAgICAgICAgIHN0ciA9IHN0ci5zbGljZSgxKTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSAsLSBmb3IgY29uc2lzdGVuY3lcbiAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG5ldyBSZWdFeHAoJywtJywgJ2cnKSwgJy0nKTtcbiAgICAgICAgICAgIC8vIGFkZCBjb21tYXMgc28gdGhhdCBpdCdzIGVhc3kgdG8gc3BsaXRcbiAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG5ldyBSZWdFeHAoJy0nLCAnZycpLCAnLC0nKTtcbiAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG5ldyBSZWdFeHAoJ2UsLScsICdnJyksICdlLScpO1xuICAgICAgICAgICAgdmFyIHAgPSBzdHIuc3BsaXQoJywnKTtcbiAgICAgICAgICAgIGlmKHAubGVuZ3RoID4gMCAmJiBwWzBdID09PSAnJykge1xuICAgICAgICAgICAgICAgIHAuc2hpZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNvbnZlcnQgc3RyaW5ncyB0byBmbG9hdHNcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcFtpXSA9IHBhcnNlRmxvYXQocFtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZShwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZihpc05hTihwWzBdKSkgey8vIGNhc2UgZm9yIGEgdHJhaWxpbmcgY29tbWEgYmVmb3JlIG5leHQgY29tbWFuZFxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY21kID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0WCA9IGNweCwgc3RhcnRZID0gY3B5O1xuICAgICAgICAgICAgICAgIC8vIE1vdmUgdmFyIGZyb20gd2l0aGluIHRoZSBzd2l0Y2ggdG8gdXAgaGVyZSAoanNoaW50KVxuICAgICAgICAgICAgICAgIHZhciBwcmV2Q21kLCBjdGxQdHgsIGN0bFB0eTsgICAgIC8vIFNzLCBUdFxuICAgICAgICAgICAgICAgIHZhciByeCwgcnksIHBzaSwgZmEsIGZzLCB4MSwgeTE7IC8vIEFhXG5cblxuICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgbCwgSCwgaCwgViwgYW5kIHYgdG8gTFxuICAgICAgICAgICAgICAgIHN3aXRjaCAoYykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vdGU6IEtlZXAgdGhlIGxpbmVUbydzIGFib3ZlIHRoZSBtb3ZlVG8ncyBpbiB0aGlzIHN3aXRjaFxuICAgICAgICAgICAgICAgICAgICBjYXNlICdsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ0wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0wnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogbGluZVRvIGhhbmRsZXJzIG5lZWQgdG8gYmUgYWJvdmUgdGhpcyBwb2ludFxuICAgICAgICAgICAgICAgICAgICBjYXNlICdtJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkeCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkeSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBkeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSArPSBkeTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdNJztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFmdGVyIGNsb3NpbmcgdGhlIHBhdGggbW92ZSB0aGUgY3VycmVudCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gdGhlIHRoZSBmaXJzdCBwb2ludCBvZiB0aGUgcGF0aCAoaWYgYW55KS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNhLmxlbmd0aCA+IDIgJiYgY2FbY2EubGVuZ3RoIC0gMV0uY29tbWFuZCA9PT0gJ3onKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGlkeCA9IGNhLmxlbmd0aCAtIDI7IGlkeCA+PSAwOyBpZHgtLSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNhW2lkeF0uY29tbWFuZCA9PT0gJ00nKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IGNhW2lkeF0ucG9pbnRzWzBdICsgZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcHkgPSBjYVtpZHhdLnBvaW50c1sxXSArIGR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gJ2wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Vic2VxdWVudCBwb2ludHMgYXJlIHRyZWF0ZWQgYXMgcmVsYXRpdmUgbGluZVRvXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gJ0wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Vic2VxdWVudCBwb2ludHMgYXJlIHRyZWF0ZWQgYXMgYWJzb2x1dGUgbGluZVRvXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnSCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnTCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ0wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1YnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ0wnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2gocC5zaGlmdCgpLCBwLnNoaWZ0KCksIHAuc2hpZnQoKSwgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCArIHAuc2hpZnQoKSwgY3B5ICsgcC5zaGlmdCgpLCBjcHggKyBwLnNoaWZ0KCksIGNweSArIHAuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHggKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdDJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdTJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDbWQgPSBjYVtjYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHByZXZDbWQuY29tbWFuZCA9PT0gJ0MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4ICsgKGNweCAtIHByZXZDbWQucG9pbnRzWzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHkgKyAoY3B5IC0gcHJldkNtZC5wb2ludHNbM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIHAuc2hpZnQoKSwgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdDJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZDbWQgPSBjYVtjYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHByZXZDbWQuY29tbWFuZCA9PT0gJ0MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR4ID0gY3B4ICsgKGNweCAtIHByZXZDbWQucG9pbnRzWzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHkgKyAoY3B5IC0gcHJldkNtZC5wb2ludHNbM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIGNweCArIHAuc2hpZnQoKSwgY3B5ICsgcC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ0MnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2gocC5zaGlmdCgpLCBwLnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4LCBjcHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3B4ICsgcC5zaGlmdCgpLCBjcHkgKyBwLnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B4ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQgPSAnUSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMucHVzaChjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnVCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHggPSBjcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q21kID0gY2FbY2EubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwcmV2Q21kLmNvbW1hbmQgPT09ICdRJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweCArIChjcHggLSBwcmV2Q21kLnBvaW50c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5ICsgKGNweSAtIHByZXZDbWQucG9pbnRzWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdRJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGN0bFB0eCwgY3RsUHR5LCBjcHgsIGNweSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHggPSBjcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdGxQdHkgPSBjcHk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2Q21kID0gY2FbY2EubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwcmV2Q21kLmNvbW1hbmQgPT09ICdRJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0bFB0eCA9IGNweCArIChjcHggLSBwcmV2Q21kLnBvaW50c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RsUHR5ID0gY3B5ICsgKGNweSAtIHByZXZDbWQucG9pbnRzWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCArPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcHkgKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY21kID0gJ1EnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goY3RsUHR4LCBjdGxQdHksIGNweCwgY3B5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ4ID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcnkgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwc2kgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZzID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeDEgPSBjcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB5MSA9IGNweTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweCA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNweSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdBJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IHRoaXMuY29udmVydEVuZHBvaW50VG9DZW50ZXJQYXJhbWV0ZXJpemF0aW9uKHgxLCB5MSwgY3B4LCBjcHksIGZhLCBmcywgcngsIHJ5LCBwc2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2EnOlxuICAgICAgICAgICAgICAgICAgICAgICAgcnggPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByeSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBzaSA9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMgPSBwLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4MSA9IGNweDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHkxID0gY3B5OyBjcHggKz0gcC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3B5ICs9IHAuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZCA9ICdBJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IHRoaXMuY29udmVydEVuZHBvaW50VG9DZW50ZXJQYXJhbWV0ZXJpemF0aW9uKHgxLCB5MSwgY3B4LCBjcHksIGZhLCBmcywgcngsIHJ5LCBwc2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2EucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6IGNtZCB8fCBjLFxuICAgICAgICAgICAgICAgICAgICBwb2ludHM6IHBvaW50cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHN0YXJ0WCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IHN0YXJ0WVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwYXRoTGVuZ3RoOiB0aGlzLmNhbGNMZW5ndGgoc3RhcnRYLCBzdGFydFksIGNtZCB8fCBjLCBwb2ludHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKGMgPT09ICd6JyB8fCBjID09PSAnWicpIHtcbiAgICAgICAgICAgICAgICBjYS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZDogJ3onLFxuICAgICAgICAgICAgICAgICAgICBwb2ludHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBzdGFydDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBwYXRoTGVuZ3RoOiAwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2E7XG4gICAgfTtcbiAgICBLb252YS5QYXRoLmNhbGNMZW5ndGggPSBmdW5jdGlvbih4LCB5LCBjbWQsIHBvaW50cykge1xuICAgICAgICB2YXIgbGVuLCBwMSwgcDIsIHQ7XG4gICAgICAgIHZhciBwYXRoID0gS29udmEuUGF0aDtcblxuICAgICAgICBzd2l0Y2ggKGNtZCkge1xuICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGguZ2V0TGluZUxlbmd0aCh4LCB5LCBwb2ludHNbMF0sIHBvaW50c1sxXSk7XG4gICAgICAgICAgICBjYXNlICdDJzpcbiAgICAgICAgICAgICAgICAvLyBBcHByb3hpbWF0ZXMgYnkgYnJlYWtpbmcgY3VydmUgaW50byAxMDAgbGluZSBzZWdtZW50c1xuICAgICAgICAgICAgICAgIGxlbiA9IDAuMDtcbiAgICAgICAgICAgICAgICBwMSA9IHBhdGguZ2V0UG9pbnRPbkN1YmljQmV6aWVyKDAsIHgsIHksIHBvaW50c1swXSwgcG9pbnRzWzFdLCBwb2ludHNbMl0sIHBvaW50c1szXSwgcG9pbnRzWzRdLCBwb2ludHNbNV0pO1xuICAgICAgICAgICAgICAgIGZvciggdCA9IDAuMDE7IHQgPD0gMTsgdCArPSAwLjAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHAyID0gcGF0aC5nZXRQb2ludE9uQ3ViaWNCZXppZXIodCwgeCwgeSwgcG9pbnRzWzBdLCBwb2ludHNbMV0sIHBvaW50c1syXSwgcG9pbnRzWzNdLCBwb2ludHNbNF0sIHBvaW50c1s1XSk7XG4gICAgICAgICAgICAgICAgICAgIGxlbiArPSBwYXRoLmdldExpbmVMZW5ndGgocDEueCwgcDEueSwgcDIueCwgcDIueSk7XG4gICAgICAgICAgICAgICAgICAgIHAxID0gcDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBsZW47XG4gICAgICAgICAgICBjYXNlICdRJzpcbiAgICAgICAgICAgICAgICAvLyBBcHByb3hpbWF0ZXMgYnkgYnJlYWtpbmcgY3VydmUgaW50byAxMDAgbGluZSBzZWdtZW50c1xuICAgICAgICAgICAgICAgIGxlbiA9IDAuMDtcbiAgICAgICAgICAgICAgICBwMSA9IHBhdGguZ2V0UG9pbnRPblF1YWRyYXRpY0JlemllcigwLCB4LCB5LCBwb2ludHNbMF0sIHBvaW50c1sxXSwgcG9pbnRzWzJdLCBwb2ludHNbM10pO1xuICAgICAgICAgICAgICAgIGZvciggdCA9IDAuMDE7IHQgPD0gMTsgdCArPSAwLjAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHAyID0gcGF0aC5nZXRQb2ludE9uUXVhZHJhdGljQmV6aWVyKHQsIHgsIHksIHBvaW50c1swXSwgcG9pbnRzWzFdLCBwb2ludHNbMl0sIHBvaW50c1szXSk7XG4gICAgICAgICAgICAgICAgICAgIGxlbiArPSBwYXRoLmdldExpbmVMZW5ndGgocDEueCwgcDEueSwgcDIueCwgcDIueSk7XG4gICAgICAgICAgICAgICAgICAgIHAxID0gcDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBsZW47XG4gICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICAvLyBBcHByb3hpbWF0ZXMgYnkgYnJlYWtpbmcgY3VydmUgaW50byBsaW5lIHNlZ21lbnRzXG4gICAgICAgICAgICAgICAgbGVuID0gMC4wO1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHBvaW50c1s0XTtcbiAgICAgICAgICAgICAgICAvLyA0ID0gdGhldGFcbiAgICAgICAgICAgICAgICB2YXIgZFRoZXRhID0gcG9pbnRzWzVdO1xuICAgICAgICAgICAgICAgIC8vIDUgPSBkVGhldGFcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gcG9pbnRzWzRdICsgZFRoZXRhO1xuICAgICAgICAgICAgICAgIHZhciBpbmMgPSBNYXRoLlBJIC8gMTgwLjA7XG4gICAgICAgICAgICAgICAgLy8gMSBkZWdyZWUgcmVzb2x1dGlvblxuICAgICAgICAgICAgICAgIGlmKE1hdGguYWJzKHN0YXJ0IC0gZW5kKSA8IGluYykge1xuICAgICAgICAgICAgICAgICAgICBpbmMgPSBNYXRoLmFicyhzdGFydCAtIGVuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IGZvciBwdXJwb3NlIG9mIGNhbGN1bGF0aW5nIGFyYyBsZW5ndGgsIG5vdCBnb2luZyB0byB3b3JyeSBhYm91dCByb3RhdGluZyBYLWF4aXMgYnkgYW5nbGUgcHNpXG4gICAgICAgICAgICAgICAgcDEgPSBwYXRoLmdldFBvaW50T25FbGxpcHRpY2FsQXJjKHBvaW50c1swXSwgcG9pbnRzWzFdLCBwb2ludHNbMl0sIHBvaW50c1szXSwgc3RhcnQsIDApO1xuICAgICAgICAgICAgICAgIGlmKGRUaGV0YSA8IDApIHsvLyBjbG9ja3dpc2VcbiAgICAgICAgICAgICAgICAgICAgZm9yKCB0ID0gc3RhcnQgLSBpbmM7IHQgPiBlbmQ7IHQgLT0gaW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwMiA9IHBhdGguZ2V0UG9pbnRPbkVsbGlwdGljYWxBcmMocG9pbnRzWzBdLCBwb2ludHNbMV0sIHBvaW50c1syXSwgcG9pbnRzWzNdLCB0LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlbiArPSBwYXRoLmdldExpbmVMZW5ndGgocDEueCwgcDEueSwgcDIueCwgcDIueSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwMSA9IHAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Ugey8vIGNvdW50ZXItY2xvY2t3aXNlXG4gICAgICAgICAgICAgICAgICAgIGZvciggdCA9IHN0YXJ0ICsgaW5jOyB0IDwgZW5kOyB0ICs9IGluYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcDIgPSBwYXRoLmdldFBvaW50T25FbGxpcHRpY2FsQXJjKHBvaW50c1swXSwgcG9pbnRzWzFdLCBwb2ludHNbMl0sIHBvaW50c1szXSwgdCwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW4gKz0gcGF0aC5nZXRMaW5lTGVuZ3RoKHAxLngsIHAxLnksIHAyLngsIHAyLnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcDEgPSBwMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwMiA9IHBhdGguZ2V0UG9pbnRPbkVsbGlwdGljYWxBcmMocG9pbnRzWzBdLCBwb2ludHNbMV0sIHBvaW50c1syXSwgcG9pbnRzWzNdLCBlbmQsIDApO1xuICAgICAgICAgICAgICAgIGxlbiArPSBwYXRoLmdldExpbmVMZW5ndGgocDEueCwgcDEueSwgcDIueCwgcDIueSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbGVuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBLb252YS5QYXRoLmNvbnZlcnRFbmRwb2ludFRvQ2VudGVyUGFyYW1ldGVyaXphdGlvbiA9IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBmYSwgZnMsIHJ4LCByeSwgcHNpRGVnKSB7XG4gICAgICAgIC8vIERlcml2ZWQgZnJvbTogaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHL2ltcGxub3RlLmh0bWwjQXJjSW1wbGVtZW50YXRpb25Ob3Rlc1xuICAgICAgICB2YXIgcHNpID0gcHNpRGVnICogKE1hdGguUEkgLyAxODAuMCk7XG4gICAgICAgIHZhciB4cCA9IE1hdGguY29zKHBzaSkgKiAoeDEgLSB4MikgLyAyLjAgKyBNYXRoLnNpbihwc2kpICogKHkxIC0geTIpIC8gMi4wO1xuICAgICAgICB2YXIgeXAgPSAtMSAqIE1hdGguc2luKHBzaSkgKiAoeDEgLSB4MikgLyAyLjAgKyBNYXRoLmNvcyhwc2kpICogKHkxIC0geTIpIC8gMi4wO1xuXG4gICAgICAgIHZhciBsYW1iZGEgPSAoeHAgKiB4cCkgLyAocnggKiByeCkgKyAoeXAgKiB5cCkgLyAocnkgKiByeSk7XG5cbiAgICAgICAgaWYobGFtYmRhID4gMSkge1xuICAgICAgICAgICAgcnggKj0gTWF0aC5zcXJ0KGxhbWJkYSk7XG4gICAgICAgICAgICByeSAqPSBNYXRoLnNxcnQobGFtYmRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmID0gTWF0aC5zcXJ0KCgoKHJ4ICogcngpICogKHJ5ICogcnkpKSAtICgocnggKiByeCkgKiAoeXAgKiB5cCkpIC0gKChyeSAqIHJ5KSAqICh4cCAqIHhwKSkpIC8gKChyeCAqIHJ4KSAqICh5cCAqIHlwKSArIChyeSAqIHJ5KSAqICh4cCAqIHhwKSkpO1xuXG4gICAgICAgIGlmKGZhID09PSBmcykge1xuICAgICAgICAgICAgZiAqPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZihpc05hTihmKSkge1xuICAgICAgICAgICAgZiA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY3hwID0gZiAqIHJ4ICogeXAgLyByeTtcbiAgICAgICAgdmFyIGN5cCA9IGYgKiAtcnkgKiB4cCAvIHJ4O1xuXG4gICAgICAgIHZhciBjeCA9ICh4MSArIHgyKSAvIDIuMCArIE1hdGguY29zKHBzaSkgKiBjeHAgLSBNYXRoLnNpbihwc2kpICogY3lwO1xuICAgICAgICB2YXIgY3kgPSAoeTEgKyB5MikgLyAyLjAgKyBNYXRoLnNpbihwc2kpICogY3hwICsgTWF0aC5jb3MocHNpKSAqIGN5cDtcblxuICAgICAgICB2YXIgdk1hZyA9IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnNxcnQodlswXSAqIHZbMF0gKyB2WzFdICogdlsxXSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB2UmF0aW8gPSBmdW5jdGlvbih1LCB2KSB7XG4gICAgICAgICAgICByZXR1cm4gKHVbMF0gKiB2WzBdICsgdVsxXSAqIHZbMV0pIC8gKHZNYWcodSkgKiB2TWFnKHYpKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHZBbmdsZSA9IGZ1bmN0aW9uKHUsIHYpIHtcbiAgICAgICAgICAgIHJldHVybiAodVswXSAqIHZbMV0gPCB1WzFdICogdlswXSA/IC0xIDogMSkgKiBNYXRoLmFjb3ModlJhdGlvKHUsIHYpKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoZXRhID0gdkFuZ2xlKFsxLCAwXSwgWyh4cCAtIGN4cCkgLyByeCwgKHlwIC0gY3lwKSAvIHJ5XSk7XG4gICAgICAgIHZhciB1ID0gWyh4cCAtIGN4cCkgLyByeCwgKHlwIC0gY3lwKSAvIHJ5XTtcbiAgICAgICAgdmFyIHYgPSBbKC0xICogeHAgLSBjeHApIC8gcngsICgtMSAqIHlwIC0gY3lwKSAvIHJ5XTtcbiAgICAgICAgdmFyIGRUaGV0YSA9IHZBbmdsZSh1LCB2KTtcblxuICAgICAgICBpZih2UmF0aW8odSwgdikgPD0gLTEpIHtcbiAgICAgICAgICAgIGRUaGV0YSA9IE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodlJhdGlvKHUsIHYpID49IDEpIHtcbiAgICAgICAgICAgIGRUaGV0YSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYoZnMgPT09IDAgJiYgZFRoZXRhID4gMCkge1xuICAgICAgICAgICAgZFRoZXRhID0gZFRoZXRhIC0gMiAqIE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoZnMgPT09IDEgJiYgZFRoZXRhIDwgMCkge1xuICAgICAgICAgICAgZFRoZXRhID0gZFRoZXRhICsgMiAqIE1hdGguUEk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtjeCwgY3ksIHJ4LCByeSwgdGhldGEsIGRUaGV0YSwgcHNpLCBmc107XG4gICAgfTtcbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuUGF0aCwgJ2RhdGEnKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBTVkcgcGF0aCBkYXRhIHN0cmluZy4gIFRoaXMgbWV0aG9kXG4gICAgICogIGFsc28gYXV0b21hdGljYWxseSBwYXJzZXMgdGhlIGRhdGEgc3RyaW5nXG4gICAgICogIGludG8gYSBkYXRhIGFycmF5LiAgQ3VycmVudGx5IHN1cHBvcnRlZCBTVkcgZGF0YTpcbiAgICAgKiAgTSwgbSwgTCwgbCwgSCwgaCwgViwgdiwgUSwgcSwgVCwgdCwgQywgYywgUywgcywgQSwgYSwgWiwgelxuICAgICAqIEBuYW1lIHNldERhdGFcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlBhdGgucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFNWRyBwYXRoIGNvbW1hbmQgc3RyaW5nXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBnZXQgU1ZHIHBhdGggZGF0YSBzdHJpbmdcbiAgICAgKiBAbmFtZSBnZXREYXRhXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5QYXRoLnByb3RvdHlwZVxuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLlBhdGgpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgRU1QVFlfU1RSSU5HID0gJycsXG4gICAgICAgIC8vQ0FMSUJSSSA9ICdDYWxpYnJpJyxcbiAgICAgICAgTk9STUFMID0gJ25vcm1hbCc7XG5cbiAgICAvKipcbiAgICAgKiBQYXRoIGNvbnN0cnVjdG9yLlxuICAgICAqIEBhdXRob3IgSmFzb24gRm9sbGFzXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQGF1Z21lbnRzIEtvbnZhLlNoYXBlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZvbnRGYW1pbHldIGRlZmF1bHQgaXMgQ2FsaWJyaVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZvbnRTaXplXSBkZWZhdWx0IGlzIDEyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZm9udFN0eWxlXSBjYW4gYmUgbm9ybWFsLCBib2xkLCBvciBpdGFsaWMuICBEZWZhdWx0IGlzIG5vcm1hbFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZvbnRWYXJpYW50XSBjYW4gYmUgbm9ybWFsIG9yIHNtYWxsLWNhcHMuICBEZWZhdWx0IGlzIG5vcm1hbFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb25maWcudGV4dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb25maWcuZGF0YSBTVkcgZGF0YSBzdHJpbmdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsXSBmaWxsIGNvbG9yXG4gICAgICogQHBhcmFtIHtJbWFnZX0gW2NvbmZpZy5maWxsUGF0dGVybkltYWdlXSBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5ZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRZXSBcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlXSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuUm90YXRpb25dXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFBhdHRlcm5SZXBlYXRdIGNhbiBiZSBcInJlcGVhdFwiLCBcInJlcGVhdC14XCIsIFwicmVwZWF0LXlcIiwgb3IgXCJuby1yZXBlYXRcIi4gIFRoZSBkZWZhdWx0IGlzIFwibm8tcmVwZWF0XCJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFldXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFldIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmZpbGxFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGZpbGwuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFByaW9yaXR5XSBjYW4gYmUgY29sb3IsIGxpbmVhci1ncmFkaWVudCwgcmFkaWFsLWdyYWlkZW50LCBvciBwYXR0ZXJuLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgY29sb3IuICBUaGUgZmlsbFByaW9yaXR5IHByb3BlcnR5IG1ha2VzIGl0IHJlYWxseSBlYXN5IHRvIHRvZ2dsZSBiZXR3ZWVuIGRpZmZlcmVudCBmaWxsIHR5cGVzLiAgRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIHRvZ2dsZSBiZXR3ZWVuIGEgZmlsbCBjb2xvciBzdHlsZSBhbmQgYSBmaWxsIHBhdHRlcm4gc3R5bGUsIHNpbXBseSBzZXQgdGhlIGZpbGwgcHJvcGVydHkgYW5kIHRoZSBmaWxsUGF0dGVybiBwcm9wZXJ0aWVzLCBhbmQgdGhlbiB1c2Ugc2V0RmlsbFByaW9yaXR5KCdjb2xvcicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCBhIGNvbG9yIGZpbGwsIG9yIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ3BhdHRlcm4nKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggdGhlIHBhdHRlcm4gZmlsbCBjb25maWd1cmF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc3Ryb2tlXSBzdHJva2UgY29sb3JcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zdHJva2VXaWR0aF0gc3Ryb2tlIHdpZHRoXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUhpdEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2UgaGl0IHJlZ2lvbi4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcucGVyZmVjdERyYXdFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdXNpbmcgYnVmZmVyIGNhbnZhcy4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHNoYXNvdyBmb3Igc3Ryb2tlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VTY2FsZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2Ugc2NhbGUuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc3Ryb2tlLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVKb2luXSBjYW4gYmUgbWl0ZXIsIHJvdW5kLCBvciBiZXZlbC4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIG1pdGVyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUNhcF0gY2FuIGJlIGJ1dHQsIHJvdW5kLCBvciBzcWFyZS4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIGJ1dHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zaGFkb3dDb2xvcl1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dCbHVyXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNoYWRvd09mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T3BhY2l0eV0gc2hhZG93IG9wYWNpdHkuICBDYW4gYmUgYW55IHJlYWwgbnVtYmVyXG4gICAgICogIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHNoYWRvdy4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmRhc2hdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRhc2hFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGRhc2hBcnJheS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIHRleHRwYXRoID0gbmV3IEtvbnZhLlRleHRQYXRoKHtcbiAgICAgKiAgIHg6IDEwMCxcbiAgICAgKiAgIHk6IDUwLFxuICAgICAqICAgZmlsbDogJyMzMzMnLFxuICAgICAqICAgZm9udFNpemU6ICcyNCcsXG4gICAgICogICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICAgICAqICAgdGV4dDogJ0FsbCB0aGUgd29ybGRcXCdzIGEgc3RhZ2UsIGFuZCBhbGwgdGhlIG1lbiBhbmQgd29tZW4gbWVyZWx5IHBsYXllcnMuJyxcbiAgICAgKiAgIGRhdGE6ICdNMTAsMTAgQzAsMCAxMCwxNTAgMTAwLDEwMCBTMzAwLDE1MCA0MDAsNTAnXG4gICAgICogfSk7XG4gICAgICovXG4gICAgS29udmEuVGV4dFBhdGggPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgdGhpcy5fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIF9maWxsRnVuYyhjb250ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuZmlsbFRleHQodGhpcy5wYXJ0aWFsVGV4dCwgMCwgMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9zdHJva2VGdW5jKGNvbnRleHQpIHtcbiAgICAgICAgY29udGV4dC5zdHJva2VUZXh0KHRoaXMucGFydGlhbFRleHQsIDAsIDApO1xuICAgIH1cblxuICAgIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmR1bW15Q2FudmFzID0gS29udmEuVXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7XG4gICAgICAgICAgICB0aGlzLmRhdGFBcnJheSA9IFtdO1xuXG4gICAgICAgICAgICAvLyBjYWxsIHN1cGVyIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICBLb252YS5TaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG5cbiAgICAgICAgICAgIC8vIG92ZXJyaWRlc1xuICAgICAgICAgICAgLy8gVE9ETzogc2hvdWxkbid0IHRoaXMgYmUgb24gdGhlIHByb3RvdHlwZT9cbiAgICAgICAgICAgIHRoaXMuX2ZpbGxGdW5jID0gX2ZpbGxGdW5jO1xuICAgICAgICAgICAgdGhpcy5fc3Ryb2tlRnVuYyA9IF9zdHJva2VGdW5jO1xuICAgICAgICAgICAgdGhpcy5fZmlsbEZ1bmNIaXQgPSBfZmlsbEZ1bmM7XG4gICAgICAgICAgICB0aGlzLl9zdHJva2VGdW5jSGl0ID0gX3N0cm9rZUZ1bmM7XG5cbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJ1RleHRQYXRoJztcblxuICAgICAgICAgICAgdGhpcy5kYXRhQXJyYXkgPSBLb252YS5QYXRoLnBhcnNlUGF0aERhdGEodGhpcy5hdHRycy5kYXRhKTtcbiAgICAgICAgICAgIHRoaXMub24oJ2RhdGFDaGFuZ2Uua29udmEnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGF0LmRhdGFBcnJheSA9IEtvbnZhLlBhdGgucGFyc2VQYXRoRGF0YSh0aGlzLmF0dHJzLmRhdGEpO1xuICAgICAgICAgICAgICAgIHRoYXQuX3NldFRleHREYXRhKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIHRleHQgZGF0YSBmb3IgY2VydGFpbiBhdHRyIGNoYW5nZXNcbiAgICAgICAgICAgIHRoaXMub24oJ3RleHRDaGFuZ2Uua29udmEgdGV4dFN0cm9rZS5rb252YSB0ZXh0U3Ryb2tlV2lkdGgua29udmEnLCB0aGF0Ll9zZXRUZXh0RGF0YSk7XG4gICAgICAgICAgICB0aGF0Ll9zZXRUZXh0RGF0YSgpO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgICAgIHRoaXMuaGl0RnVuYyh0aGlzLl9oaXRGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgY29udGV4dC5zZXRBdHRyKCdmb250JywgdGhpcy5fZ2V0Q29udGV4dEZvbnQoKSk7XG4gICAgICAgICAgICBjb250ZXh0LnNldEF0dHIoJ3RleHRCYXNlbGluZScsICdtaWRkbGUnKTtcbiAgICAgICAgICAgIGNvbnRleHQuc2V0QXR0cigndGV4dEFsaWduJywgJ2xlZnQnKTtcbiAgICAgICAgICAgIGNvbnRleHQuc2F2ZSgpO1xuXG4gICAgICAgICAgICB2YXIgZ2x5cGhJbmZvID0gdGhpcy5nbHlwaEluZm87XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZ2x5cGhJbmZvLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5zYXZlKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcDAgPSBnbHlwaEluZm9baV0ucDA7XG5cbiAgICAgICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShwMC54LCBwMC55KTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnJvdGF0ZShnbHlwaEluZm9baV0ucm90YXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMucGFydGlhbFRleHQgPSBnbHlwaEluZm9baV0udGV4dDtcblxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8vLyBUbyBhc3Npc3Qgd2l0aCBkZWJ1Z2dpbmcgdmlzdWFsbHksIHVuY29tbWVudCBmb2xsb3dpbmdcbiAgICAgICAgICAgICAgICAvLyBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgIC8vIGlmIChpICUgMilcbiAgICAgICAgICAgICAgICAvLyBjb250ZXh0LnN0cm9rZVN0eWxlID0gJ2N5YW4nO1xuICAgICAgICAgICAgICAgIC8vIGVsc2VcbiAgICAgICAgICAgICAgICAvLyBjb250ZXh0LnN0cm9rZVN0eWxlID0gJ2dyZWVuJztcbiAgICAgICAgICAgICAgICAvLyB2YXIgcDEgPSBnbHlwaEluZm9baV0ucDE7XG4gICAgICAgICAgICAgICAgLy8gY29udGV4dC5tb3ZlVG8ocDAueCwgcDAueSk7XG4gICAgICAgICAgICAgICAgLy8gY29udGV4dC5saW5lVG8ocDEueCwgcDEueSk7XG4gICAgICAgICAgICAgICAgLy8gY29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xuICAgICAgICB9LFxuICAgICAgICBfaGl0RnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG5cbiAgICAgICAgICB2YXIgZ2x5cGhJbmZvID0gdGhpcy5nbHlwaEluZm87XG4gICAgICAgICAgaWYgKGdseXBoSW5mby5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgdmFyIHAwID0gZ2x5cGhJbmZvWzBdLnAwO1xuICAgICAgICAgICAgY29udGV4dC5tb3ZlVG8ocDAueCwgcDAueSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBnbHlwaEluZm8ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgdmFyIHAxID0gZ2x5cGhJbmZvW2ldLnAxO1xuICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhwMS54LCBwMS55KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGV4dC5zZXRBdHRyKCdsaW5lV2lkdGgnLCB0aGlzLmdldEZvbnRTaXplKCkpO1xuICAgICAgICAgIGNvbnRleHQuc2V0QXR0cignc3Ryb2tlU3R5bGUnLCB0aGlzLmNvbG9yS2V5KTtcbiAgICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IHRleHQgd2lkdGggaW4gcGl4ZWxzXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0VGV4dFdpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGdldCB0ZXh0IGhlaWdodCBpbiBwaXhlbHNcbiAgICAgICAgICogQG1ldGhvZFxuICAgICAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dFBhdGgucHJvdG90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBnZXRUZXh0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgdGV4dFxuICAgICAgICAgKiBAbWV0aG9kXG4gICAgICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0UGF0aC5wcm90b3R5cGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHRleHRcbiAgICAgICAgICovXG4gICAgICAgIHNldFRleHQ6IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgICAgIEtvbnZhLlRleHQucHJvdG90eXBlLnNldFRleHQuY2FsbCh0aGlzLCB0ZXh0KTtcbiAgICAgICAgfSxcbiAgICAgICAgX2dldFRleHRTaXplOiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgZHVtbXlDYW52YXMgPSB0aGlzLmR1bW15Q2FudmFzO1xuICAgICAgICAgICAgdmFyIF9jb250ZXh0ID0gZHVtbXlDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgICAgICAgX2NvbnRleHQuc2F2ZSgpO1xuXG4gICAgICAgICAgICBfY29udGV4dC5mb250ID0gdGhpcy5fZ2V0Q29udGV4dEZvbnQoKTtcbiAgICAgICAgICAgIHZhciBtZXRyaWNzID0gX2NvbnRleHQubWVhc3VyZVRleHQodGV4dCk7XG5cbiAgICAgICAgICAgIF9jb250ZXh0LnJlc3RvcmUoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogbWV0cmljcy53aWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KHRoaXMuYXR0cnMuZm9udFNpemUsIDEwKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NldFRleHREYXRhOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHNpemUgPSB0aGlzLl9nZXRUZXh0U2l6ZSh0aGlzLmF0dHJzLnRleHQpO1xuICAgICAgICAgICAgdGhpcy50ZXh0V2lkdGggPSBzaXplLndpZHRoO1xuICAgICAgICAgICAgdGhpcy50ZXh0SGVpZ2h0ID0gc2l6ZS5oZWlnaHQ7XG5cbiAgICAgICAgICAgIHRoaXMuZ2x5cGhJbmZvID0gW107XG5cbiAgICAgICAgICAgIHZhciBjaGFyQXJyID0gdGhpcy5nZXRUZXh0KCkuc3BsaXQoJycpO1xuXG4gICAgICAgICAgICB2YXIgcDAsIHAxLCBwYXRoQ21kO1xuXG4gICAgICAgICAgICB2YXIgcEluZGV4ID0gLTE7XG4gICAgICAgICAgICB2YXIgY3VycmVudFQgPSAwO1xuXG4gICAgICAgICAgICB2YXIgZ2V0TmV4dFBhdGhTZWdtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoRGF0YSA9IHRoYXQuZGF0YUFycmF5O1xuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBqID0gcEluZGV4ICsgMTsgaiA8IHBhdGhEYXRhLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBhdGhEYXRhW2pdLnBhdGhMZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwSW5kZXggPSBqO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aERhdGFbal07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXRoRGF0YVtqXS5jb21tYW5kID09PSAnTScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAwID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBhdGhEYXRhW2pdLnBvaW50c1swXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBwYXRoRGF0YVtqXS5wb2ludHNbMV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGZpbmRTZWdtZW50VG9GaXRDaGFyYWN0ZXIgPSBmdW5jdGlvbihjKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2x5cGhXaWR0aCA9IHRoYXQuX2dldFRleHRTaXplKGMpLndpZHRoO1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJMZW4gPSAwO1xuICAgICAgICAgICAgICAgIHZhciBhdHRlbXB0cyA9IDA7XG5cbiAgICAgICAgICAgICAgICBwMSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB3aGlsZShNYXRoLmFicyhnbHlwaFdpZHRoIC0gY3VyckxlbikgLyBnbHlwaFdpZHRoID4gMC4wMSAmJiBhdHRlbXB0cyA8IDI1KSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dGVtcHRzKys7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdW11bGF0aXZlUGF0aExlbmd0aCA9IGN1cnJMZW47XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlKHBhdGhDbWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aENtZCA9IGdldE5leHRQYXRoU2VnbWVudCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwYXRoQ21kICYmIGN1bXVsYXRpdmVQYXRoTGVuZ3RoICsgcGF0aENtZC5wYXRoTGVuZ3RoIDwgZ2x5cGhXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1bXVsYXRpdmVQYXRoTGVuZ3RoICs9IHBhdGhDbWQucGF0aExlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoQ21kID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYocGF0aENtZCA9PT0ge30gfHwgcDAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZWVkTmV3U2VnbWVudCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGF0aENtZC5jb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdMJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihLb252YS5QYXRoLmdldExpbmVMZW5ndGgocDAueCwgcDAueSwgcGF0aENtZC5wb2ludHNbMF0sIHBhdGhDbWQucG9pbnRzWzFdKSA+IGdseXBoV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDEgPSBLb252YS5QYXRoLmdldFBvaW50T25MaW5lKGdseXBoV2lkdGgsIHAwLngsIHAwLnksIHBhdGhDbWQucG9pbnRzWzBdLCBwYXRoQ21kLnBvaW50c1sxXSwgcDAueCwgcDAueSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoQ21kID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0EnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gcGF0aENtZC5wb2ludHNbNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gNCA9IHRoZXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRUaGV0YSA9IHBhdGhDbWQucG9pbnRzWzVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDUgPSBkVGhldGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gcGF0aENtZC5wb2ludHNbNF0gKyBkVGhldGE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjdXJyZW50VCA9PT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUID0gc3RhcnQgKyAwLjAwMDAwMDAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBKdXN0IGluIGNhc2Ugc3RhcnQgaXMgMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZ2x5cGhXaWR0aCA+IGN1cnJMZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFQgKz0gKE1hdGguUEkgLyAxODAuMCkgKiBkVGhldGEgLyBNYXRoLmFicyhkVGhldGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFQgLT0gTWF0aC5QSSAvIDM2MC4wICogZFRoZXRhIC8gTWF0aC5hYnMoZFRoZXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVkaXQgZm9yIGJ1ZyBmaXg6IEB0aGVydGggaHR0cHM6Ly9naXRodWIuY29tL2VyaWNkcm93ZWxsL0tvbnZhSlMvaXNzdWVzLzI0OVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9sZCBjb2RlIGZhaWxlZCB0byByZW5kZXIgdGV4dCBhbG9uZyBhcmMgb2YgdGhpcyBwYXRoOiBcIk0gNTAgNTAgYSAxNTAgNTAgMCAwIDEgMjUwIDUwIGwgNTAgMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZFRoZXRhIDwgMCAmJiBjdXJyZW50VCA8IGVuZCB8fCBkVGhldGEgPj0gMCAmJiBjdXJyZW50VCA+IGVuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCA9IGVuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZE5ld1NlZ21lbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMSA9IEtvbnZhLlBhdGguZ2V0UG9pbnRPbkVsbGlwdGljYWxBcmMocGF0aENtZC5wb2ludHNbMF0sIHBhdGhDbWQucG9pbnRzWzFdLCBwYXRoQ21kLnBvaW50c1syXSwgcGF0aENtZC5wb2ludHNbM10sIGN1cnJlbnRULCBwYXRoQ21kLnBvaW50c1s2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdDJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjdXJyZW50VCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihnbHlwaFdpZHRoID4gcGF0aENtZC5wYXRoTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCA9IDAuMDAwMDAwMDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCA9IGdseXBoV2lkdGggLyBwYXRoQ21kLnBhdGhMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihnbHlwaFdpZHRoID4gY3Vyckxlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCArPSAoZ2x5cGhXaWR0aCAtIGN1cnJMZW4pIC8gcGF0aENtZC5wYXRoTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFQgLT0gKGN1cnJMZW4gLSBnbHlwaFdpZHRoKSAvIHBhdGhDbWQucGF0aExlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjdXJyZW50VCA+IDEuMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCA9IDEuMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZE5ld1NlZ21lbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwMSA9IEtvbnZhLlBhdGguZ2V0UG9pbnRPbkN1YmljQmV6aWVyKGN1cnJlbnRULCBwYXRoQ21kLnN0YXJ0LngsIHBhdGhDbWQuc3RhcnQueSwgcGF0aENtZC5wb2ludHNbMF0sIHBhdGhDbWQucG9pbnRzWzFdLCBwYXRoQ21kLnBvaW50c1syXSwgcGF0aENtZC5wb2ludHNbM10sIHBhdGhDbWQucG9pbnRzWzRdLCBwYXRoQ21kLnBvaW50c1s1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdRJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjdXJyZW50VCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VCA9IGdseXBoV2lkdGggLyBwYXRoQ21kLnBhdGhMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZ2x5cGhXaWR0aCA+IGN1cnJMZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFQgKz0gKGdseXBoV2lkdGggLSBjdXJyTGVuKSAvIHBhdGhDbWQucGF0aExlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUIC09IChjdXJyTGVuIC0gZ2x5cGhXaWR0aCkgLyBwYXRoQ21kLnBhdGhMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VycmVudFQgPiAxLjApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFQgPSAxLjA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWROZXdTZWdtZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcDEgPSBLb252YS5QYXRoLmdldFBvaW50T25RdWFkcmF0aWNCZXppZXIoY3VycmVudFQsIHBhdGhDbWQuc3RhcnQueCwgcGF0aENtZC5zdGFydC55LCBwYXRoQ21kLnBvaW50c1swXSwgcGF0aENtZC5wb2ludHNbMV0sIHBhdGhDbWQucG9pbnRzWzJdLCBwYXRoQ21kLnBvaW50c1szXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmKHAxICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJMZW4gPSBLb252YS5QYXRoLmdldExpbmVMZW5ndGgocDAueCwgcDAueSwgcDEueCwgcDEueSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZihuZWVkTmV3U2VnbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVlZE5ld1NlZ21lbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhDbWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGNoYXJBcnIubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIC8vIEZpbmQgcDEgc3VjaCB0aGF0IGxpbmUgc2VnbWVudCBiZXR3ZWVuIHAwIGFuZCBwMSBpcyBhcHByb3guIHdpZHRoIG9mIGdseXBoXG4gICAgICAgICAgICAgICAgZmluZFNlZ21lbnRUb0ZpdENoYXJhY3RlcihjaGFyQXJyW2ldKTtcblxuICAgICAgICAgICAgICAgIGlmKHAwID09PSB1bmRlZmluZWQgfHwgcDEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBLb252YS5QYXRoLmdldExpbmVMZW5ndGgocDAueCwgcDAueSwgcDEueCwgcDEueSk7XG5cbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBTaW5jZSBnbHlwaHMgYXJlIHJlbmRlcmVkIG9uZSBhdCBhIHRpbWUsIGFueSBrZXJuaW5nIHBhaXIgZGF0YSBidWlsdCBpbnRvIHRoZSBmb250IHdpbGwgbm90IGJlIHVzZWQuXG4gICAgICAgICAgICAgICAgLy8gQ2FuIGZvcmVzZWUgaGF2aW5nIGEgcm91Z2ggcGFpciB0YWJsZSBidWlsdCBpbiB0aGF0IHRoZSBkZXZlbG9wZXIgY2FuIG92ZXJyaWRlIGFzIG5lZWRlZC5cblxuICAgICAgICAgICAgICAgIHZhciBrZXJuID0gMDtcbiAgICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlciBmb3IgZnV0dXJlIGltcGxlbWVudGF0aW9uXG5cbiAgICAgICAgICAgICAgICB2YXIgbWlkcG9pbnQgPSBLb252YS5QYXRoLmdldFBvaW50T25MaW5lKGtlcm4gKyB3aWR0aCAvIDIuMCwgcDAueCwgcDAueSwgcDEueCwgcDEueSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcm90YXRpb24gPSBNYXRoLmF0YW4yKChwMS55IC0gcDAueSksIChwMS54IC0gcDAueCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2x5cGhJbmZvLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0cmFuc3Bvc2VYOiBtaWRwb2ludC54LFxuICAgICAgICAgICAgICAgICAgICB0cmFuc3Bvc2VZOiBtaWRwb2ludC55LFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjaGFyQXJyW2ldLFxuICAgICAgICAgICAgICAgICAgICByb3RhdGlvbjogcm90YXRpb24sXG4gICAgICAgICAgICAgICAgICAgIHAwOiBwMCxcbiAgICAgICAgICAgICAgICAgICAgcDE6IHAxXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcDAgPSBwMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0U2VsZlJlY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHBvaW50cyA9IFtdO1xuICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gdGhpcy5mb250U2l6ZSgpO1xuXG4gICAgICAgICAgICB0aGlzLmdseXBoSW5mby5mb3JFYWNoKGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgICAgICBwb2ludHMucHVzaChpbmZvLnAwLngpO1xuICAgICAgICAgICAgICAgIHBvaW50cy5wdXNoKGluZm8ucDAueSk7XG4gICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goaW5mby5wMS54KTtcbiAgICAgICAgICAgICAgICBwb2ludHMucHVzaChpbmZvLnAxLnkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgbWluWCA9IHBvaW50c1swXTtcbiAgICAgICAgICAgIHZhciBtYXhYID0gcG9pbnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1pblkgPSBwb2ludHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4WSA9IHBvaW50c1swXTtcbiAgICAgICAgICAgIHZhciB4LCB5O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC8gMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgeCA9IHBvaW50c1tpICogMl07IHkgPSBwb2ludHNbaSAqIDIgKyAxXTtcbiAgICAgICAgICAgICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgeCk7XG4gICAgICAgICAgICAgICAgbWF4WCA9IE1hdGgubWF4KG1heFgsIHgpO1xuICAgICAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCB5KTtcbiAgICAgICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHg6IE1hdGgucm91bmQobWluWCkgLSBmb250U2l6ZSxcbiAgICAgICAgICAgICAgICB5OiBNYXRoLnJvdW5kKG1pblkpIC0gZm9udFNpemUsXG4gICAgICAgICAgICAgICAgd2lkdGg6IE1hdGgucm91bmQobWF4WCAtIG1pblgpICsgZm9udFNpemUgKiAyLFxuICAgICAgICAgICAgICAgIGhlaWdodDogTWF0aC5yb3VuZChtYXhZIC0gbWluWSkgKyBmb250U2l6ZSAqIDJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gbWFwIFRleHRQYXRoIG1ldGhvZHMgdG8gVGV4dFxuICAgIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZS5fZ2V0Q29udGV4dEZvbnQgPSBLb252YS5UZXh0LnByb3RvdHlwZS5fZ2V0Q29udGV4dEZvbnQ7XG5cbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5UZXh0UGF0aCwgS29udmEuU2hhcGUpO1xuXG4gICAgLy8gYWRkIHNldHRlcnMgYW5kIGdldHRlcnNcbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5UZXh0UGF0aCwgJ2ZvbnRGYW1pbHknLCAnQXJpYWwnKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBmb250IGZhbWlseVxuICAgICAqIEBuYW1lIHNldEZvbnRGYW1pbHlcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBmb250RmFtaWx5XG4gICAgICovXG5cbiAgICAgLyoqXG4gICAgICogZ2V0IGZvbnQgZmFtaWx5XG4gICAgICogQG5hbWUgZ2V0Rm9udEZhbWlseVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dFBhdGgucHJvdG90eXBlXG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5UZXh0UGF0aCwgJ2ZvbnRTaXplJywgMTIpO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGZvbnQgc2l6ZVxuICAgICAqIEBuYW1lIHNldEZvbnRTaXplXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0UGF0aC5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge2ludH0gZm9udFNpemVcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgKiBnZXQgZm9udCBzaXplXG4gICAgICogQG5hbWUgZ2V0Rm9udFNpemVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZVxuICAgICAqL1xuXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuVGV4dFBhdGgsICdmb250U3R5bGUnLCBOT1JNQUwpO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGZvbnQgc3R5bGUuICBDYW4gYmUgJ25vcm1hbCcsICdpdGFsaWMnLCBvciAnYm9sZCcuICAnbm9ybWFsJyBpcyB0aGUgZGVmYXVsdC5cbiAgICAgKiBAbmFtZSBzZXRGb250U3R5bGVcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBmb250U3R5bGVcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgKiBnZXQgZm9udCBzdHlsZVxuICAgICAqIEBuYW1lIGdldEZvbnRTdHlsZVxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dFBhdGgucHJvdG90eXBlXG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5UZXh0UGF0aCwgJ2ZvbnRWYXJpYW50JywgTk9STUFMKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBmb250IHZhcmlhbnQuICBDYW4gYmUgJ25vcm1hbCcgb3IgJ3NtYWxsLWNhcHMnLiAgJ25vcm1hbCcgaXMgdGhlIGRlZmF1bHQuXG4gICAgICogQG5hbWUgc2V0Rm9udFZhcmlhbnRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRleHRQYXRoLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBmb250VmFyaWFudFxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogQGdldCBmb250IHZhcmlhbnRcbiAgICAgKiBAbmFtZSBnZXRGb250VmFyaWFudFxuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuVGV4dFBhdGgucHJvdG90eXBlXG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlcihLb252YS5UZXh0UGF0aCwgJ3RleHQnLCBFTVBUWV9TVFJJTkcpO1xuXG4gICAgLyoqXG4gICAgICogZ2V0IHRleHRcbiAgICAgKiBAbmFtZSBnZXRUZXh0XG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5UZXh0UGF0aC5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5UZXh0UGF0aCk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIFJlZ3VsYXJQb2x5Z29uIGNvbnN0cnVjdG9yLiZuYnNwOyBFeGFtcGxlcyBpbmNsdWRlIHRyaWFuZ2xlcywgc3F1YXJlcywgcGVudGFnb25zLCBoZXhhZ29ucywgZXRjLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBhdWdtZW50cyBLb252YS5TaGFwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29uZmlnLnNpZGVzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5yYWRpdXNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsXSBmaWxsIGNvbG9yXG4gICAgICogQHBhcmFtIHtJbWFnZX0gW2NvbmZpZy5maWxsUGF0dGVybkltYWdlXSBmaWxsIHBhdHRlcm4gaW1hZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5ZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRZXSBcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlXSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuUm90YXRpb25dXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFBhdHRlcm5SZXBlYXRdIGNhbiBiZSBcInJlcGVhdFwiLCBcInJlcGVhdC14XCIsIFwicmVwZWF0LXlcIiwgb3IgXCJuby1yZXBlYXRcIi4gIFRoZSBkZWZhdWx0IGlzIFwibm8tcmVwZWF0XCJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFldXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFldIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UmFkaXVzXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmZpbGxFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGZpbGwuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbFByaW9yaXR5XSBjYW4gYmUgY29sb3IsIGxpbmVhci1ncmFkaWVudCwgcmFkaWFsLWdyYWlkZW50LCBvciBwYXR0ZXJuLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgY29sb3IuICBUaGUgZmlsbFByaW9yaXR5IHByb3BlcnR5IG1ha2VzIGl0IHJlYWxseSBlYXN5IHRvIHRvZ2dsZSBiZXR3ZWVuIGRpZmZlcmVudCBmaWxsIHR5cGVzLiAgRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIHRvZ2dsZSBiZXR3ZWVuIGEgZmlsbCBjb2xvciBzdHlsZSBhbmQgYSBmaWxsIHBhdHRlcm4gc3R5bGUsIHNpbXBseSBzZXQgdGhlIGZpbGwgcHJvcGVydHkgYW5kIHRoZSBmaWxsUGF0dGVybiBwcm9wZXJ0aWVzLCBhbmQgdGhlbiB1c2Ugc2V0RmlsbFByaW9yaXR5KCdjb2xvcicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCBhIGNvbG9yIGZpbGwsIG9yIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ3BhdHRlcm4nKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggdGhlIHBhdHRlcm4gZmlsbCBjb25maWd1cmF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc3Ryb2tlXSBzdHJva2UgY29sb3JcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zdHJva2VXaWR0aF0gc3Ryb2tlIHdpZHRoXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUhpdEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2UgaGl0IHJlZ2lvbi4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcucGVyZmVjdERyYXdFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdXNpbmcgYnVmZmVyIGNhbnZhcy4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93Rm9yU3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHNoYXNvdyBmb3Igc3Ryb2tlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VTY2FsZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzdHJva2Ugc2NhbGUuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc3Ryb2tlLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVKb2luXSBjYW4gYmUgbWl0ZXIsIHJvdW5kLCBvciBiZXZlbC4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIG1pdGVyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUNhcF0gY2FuIGJlIGJ1dHQsIHJvdW5kLCBvciBzcWFyZS4gIFRoZSBkZWZhdWx0XG4gICAgICogIGlzIGJ1dHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zaGFkb3dDb2xvcl1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dCbHVyXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNoYWRvd09mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T3BhY2l0eV0gc2hhZG93IG9wYWNpdHkuICBDYW4gYmUgYW55IHJlYWwgbnVtYmVyXG4gICAgICogIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHNoYWRvdy4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmRhc2hdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRhc2hFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIGRhc2hBcnJheS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGhleGFnb24gPSBuZXcgS29udmEuUmVndWxhclBvbHlnb24oe1xuICAgICAqICAgeDogMTAwLFxuICAgICAqICAgeTogMjAwLFxuICAgICAqICAgc2lkZXM6IDYsXG4gICAgICogICByYWRpdXM6IDcwLFxuICAgICAqICAgZmlsbDogJ3JlZCcsXG4gICAgICogICBzdHJva2U6ICdibGFjaycsXG4gICAgICogICBzdHJva2VXaWR0aDogNFxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIEtvbnZhLlJlZ3VsYXJQb2x5Z29uID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5SZWd1bGFyUG9seWdvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIF9jZW50cm9pZDogdHJ1ZSxcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICAvLyBjYWxsIHN1cGVyIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICBLb252YS5TaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9ICdSZWd1bGFyUG9seWdvbic7XG4gICAgICAgICAgICB0aGlzLnNjZW5lRnVuYyh0aGlzLl9zY2VuZUZ1bmMpO1xuICAgICAgICB9LFxuICAgICAgICBfc2NlbmVGdW5jOiBmdW5jdGlvbihjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgc2lkZXMgPSB0aGlzLmF0dHJzLnNpZGVzLFxuICAgICAgICAgICAgICAgIHJhZGl1cyA9IHRoaXMuYXR0cnMucmFkaXVzLFxuICAgICAgICAgICAgICAgIG4sIHgsIHk7XG5cbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbygwLCAwIC0gcmFkaXVzKTtcblxuICAgICAgICAgICAgZm9yKG4gPSAxOyBuIDwgc2lkZXM7IG4rKykge1xuICAgICAgICAgICAgICAgIHggPSByYWRpdXMgKiBNYXRoLnNpbihuICogMiAqIE1hdGguUEkgLyBzaWRlcyk7XG4gICAgICAgICAgICAgICAgeSA9IC0xICogcmFkaXVzICogTWF0aC5jb3MobiAqIDIgKiBNYXRoLlBJIC8gc2lkZXMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHgsIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0cm9rZVNoYXBlKHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSYWRpdXMoKSAqIDI7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldEhlaWdodCgpXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSYWRpdXMoKSAqIDI7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLnNldFdpZHRoKClcbiAgICAgICAgc2V0V2lkdGg6IGZ1bmN0aW9uKHdpZHRoKSB7XG4gICAgICAgICAgICBLb252YS5Ob2RlLnByb3RvdHlwZS5zZXRXaWR0aC5jYWxsKHRoaXMsIHdpZHRoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJhZGl1cygpICE9PSB3aWR0aCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFJhZGl1cyh3aWR0aCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5zZXRIZWlnaHQoKVxuICAgICAgICBzZXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0SGVpZ2h0LmNhbGwodGhpcywgaGVpZ2h0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJhZGl1cygpICE9PSBoZWlnaHQgLyAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSYWRpdXMoaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLlJlZ3VsYXJQb2x5Z29uLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuUmVndWxhclBvbHlnb24sICdyYWRpdXMnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldCByYWRpdXNcbiAgICAgKiBAbmFtZSBzZXRSYWRpdXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlJlZ3VsYXJQb2x5Z29uLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByYWRpdXNcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgKiBnZXQgcmFkaXVzXG4gICAgICogQG5hbWUgZ2V0UmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5SZWd1bGFyUG9seWdvbi5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlJlZ3VsYXJQb2x5Z29uLCAnc2lkZXMnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBudW1iZXIgb2Ygc2lkZXNcbiAgICAgKiBAbmFtZSBzZXRTaWRlc1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuUmVndWxhclBvbHlnb24ucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtpbnR9IHNpZGVzXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBnZXQgbnVtYmVyIG9mIHNpZGVzXG4gICAgICogQG5hbWUgZ2V0U2lkZXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlJlZ3VsYXJQb2x5Z29uLnByb3RvdHlwZVxuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLlJlZ3VsYXJQb2x5Z29uKTtcbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgLyoqXG4gICAgICogU3RhciBjb25zdHJ1Y3RvclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBhdWdtZW50cyBLb252YS5TaGFwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGNvbmZpZy5udW1Qb2ludHNcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29uZmlnLmlubmVyUmFkaXVzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvbmZpZy5vdXRlclJhZGl1c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxdIGZpbGwgY29sb3JcbiAgICAgKiBAcGFyYW0ge0ltYWdlfSBbY29uZmlnLmZpbGxQYXR0ZXJuSW1hZ2VdIGZpbGwgcGF0dGVybiBpbWFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5PZmZzZXRYXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFldIFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxQYXR0ZXJuU2NhbGVdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZVldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5Sb3RhdGlvbl1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUGF0dGVyblJlcGVhdF0gY2FuIGJlIFwicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBvciBcIm5vLXJlcGVhdFwiLiAgVGhlIGRlZmF1bHQgaXMgXCJuby1yZXBlYXRcIlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudFN0YXJ0UG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludFldXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudEVuZFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbY29uZmlnLmZpbGxMaW5lYXJHcmFkaWVudENvbG9yU3RvcHNdIGFycmF5IG9mIGNvbG9yIHN0b3BzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRQb2ludFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WV0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50U3RhcnRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUmFkaXVzXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZmlsbEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZmlsbC4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5maWxsUHJpb3JpdHldIGNhbiBiZSBjb2xvciwgbGluZWFyLWdyYWRpZW50LCByYWRpYWwtZ3JhaWRlbnQsIG9yIHBhdHRlcm4uICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyBjb2xvci4gIFRoZSBmaWxsUHJpb3JpdHkgcHJvcGVydHkgbWFrZXMgaXQgcmVhbGx5IGVhc3kgdG8gdG9nZ2xlIGJldHdlZW4gZGlmZmVyZW50IGZpbGwgdHlwZXMuICBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnQgdG8gdG9nZ2xlIGJldHdlZW4gYSBmaWxsIGNvbG9yIHN0eWxlIGFuZCBhIGZpbGwgcGF0dGVybiBzdHlsZSwgc2ltcGx5IHNldCB0aGUgZmlsbCBwcm9wZXJ0eSBhbmQgdGhlIGZpbGxQYXR0ZXJuIHByb3BlcnRpZXMsIGFuZCB0aGVuIHVzZSBzZXRGaWxsUHJpb3JpdHkoJ2NvbG9yJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIGEgY29sb3IgZmlsbCwgb3IgdXNlIHNldEZpbGxQcmlvcml0eSgncGF0dGVybicpIHRvIHJlbmRlciB0aGUgc2hhcGUgd2l0aCB0aGUgcGF0dGVybiBmaWxsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5zdHJva2VdIHN0cm9rZSBjb2xvclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnN0cm9rZVdpZHRoXSBzdHJva2Ugd2lkdGhcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlSGl0RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBoaXQgcmVnaW9uLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5wZXJmZWN0RHJhd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB1c2luZyBidWZmZXIgY2FudmFzLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zaGFkb3dGb3JTdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc2hhc293IGZvciBzdHJva2UuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnN0cm9rZVNjYWxlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHN0cm9rZSBzY2FsZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzdHJva2UuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubGluZUpvaW5dIGNhbiBiZSBtaXRlciwgcm91bmQsIG9yIGJldmVsLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgbWl0ZXJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lQ2FwXSBjYW4gYmUgYnV0dCwgcm91bmQsIG9yIHNxYXJlLiAgVGhlIGRlZmF1bHRcbiAgICAgKiAgaXMgYnV0dFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnNoYWRvd0NvbG9yXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd0JsdXJdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2hhZG93T2Zmc2V0XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09mZnNldFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPcGFjaXR5XSBzaGFkb3cgb3BhY2l0eS4gIENhbiBiZSBhbnkgcmVhbCBudW1iZXJcbiAgICAgKiAgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0VuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgc2hhZG93LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZGFzaF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZGFzaEVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgZGFzaEFycmF5LiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy53aWR0aF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5oZWlnaHRdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnZpc2libGVdXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmxpc3RlbmluZ10gd2hldGhlciBvciBub3QgdGhlIG5vZGUgaXMgbGlzdGVuaW5nIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5pZF0gdW5pcXVlIGlkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcubmFtZV0gbm9uLXVuaXF1ZSBuYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub3BhY2l0eV0gZGV0ZXJtaW5lcyBub2RlIG9wYWNpdHkuICBDYW4gYmUgYW55IG51bWJlciBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zY2FsZV0gc2V0IHNjYWxlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVYXSBzZXQgc2NhbGUgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWV0gc2V0IHNjYWxlIHlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5yb3RhdGlvbl0gcm90YXRpb24gaW4gZGVncmVlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLm9mZnNldF0gb2Zmc2V0IGZyb20gY2VudGVyIHBvaW50IGFuZCByb3RhdGlvbiBwb2ludFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFhdIHNldCBvZmZzZXQgeFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9mZnNldFldIHNldCBvZmZzZXQgeVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kcmFnZ2FibGVdIG1ha2VzIHRoZSBub2RlIGRyYWdnYWJsZS4gIFdoZW4gc3RhZ2VzIGFyZSBkcmFnZ2FibGUsIHlvdSBjYW4gZHJhZyBhbmQgZHJvcFxuICAgICAqICB0aGUgZW50aXJlIHN0YWdlIGJ5IGRyYWdnaW5nIGFueSBwb3J0aW9uIG9mIHRoZSBzdGFnZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmRyYWdEaXN0YW5jZV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29uZmlnLmRyYWdCb3VuZEZ1bmNdXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgc3RhciA9IG5ldyBLb252YS5TdGFyKHtcbiAgICAgKiAgIHg6IDEwMCxcbiAgICAgKiAgIHk6IDIwMCxcbiAgICAgKiAgIG51bVBvaW50czogNSxcbiAgICAgKiAgIGlubmVyUmFkaXVzOiA3MCxcbiAgICAgKiAgIG91dGVyUmFkaXVzOiA3MCxcbiAgICAgKiAgIGZpbGw6ICdyZWQnLFxuICAgICAqICAgc3Ryb2tlOiAnYmxhY2snLFxuICAgICAqICAgc3Ryb2tlV2lkdGg6IDRcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5TdGFyID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19faW5pdChjb25maWcpO1xuICAgIH07XG5cbiAgICBLb252YS5TdGFyLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX2NlbnRyb2lkOiB0cnVlLFxuICAgICAgICBfX19pbml0OiBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgICAgICAgIC8vIGNhbGwgc3VwZXIgY29uc3RydWN0b3JcbiAgICAgICAgICAgIEtvbnZhLlNoYXBlLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gJ1N0YXInO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIGlubmVyUmFkaXVzID0gdGhpcy5pbm5lclJhZGl1cygpLFxuICAgICAgICAgICAgICAgIG91dGVyUmFkaXVzID0gdGhpcy5vdXRlclJhZGl1cygpLFxuICAgICAgICAgICAgICAgIG51bVBvaW50cyA9IHRoaXMubnVtUG9pbnRzKCk7XG5cbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjb250ZXh0Lm1vdmVUbygwLCAwIC0gb3V0ZXJSYWRpdXMpO1xuXG4gICAgICAgICAgICBmb3IodmFyIG4gPSAxOyBuIDwgbnVtUG9pbnRzICogMjsgbisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IG4gJSAyID09PSAwID8gb3V0ZXJSYWRpdXMgOiBpbm5lclJhZGl1cztcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHJhZGl1cyAqIE1hdGguc2luKG4gKiBNYXRoLlBJIC8gbnVtUG9pbnRzKTtcbiAgICAgICAgICAgICAgICB2YXIgeSA9IC0xICogcmFkaXVzICogTWF0aC5jb3MobiAqIE1hdGguUEkgLyBudW1Qb2ludHMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHgsIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcblxuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldFdpZHRoKClcbiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3V0ZXJSYWRpdXMoKSAqIDI7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIGltcGxlbWVudHMgU2hhcGUucHJvdG90eXBlLmdldEhlaWdodCgpXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRPdXRlclJhZGl1cygpICogMjtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gaW1wbGVtZW50cyBTaGFwZS5wcm90b3R5cGUuc2V0V2lkdGgoKVxuICAgICAgICBzZXRXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICAgICAgICAgIEtvbnZhLk5vZGUucHJvdG90eXBlLnNldFdpZHRoLmNhbGwodGhpcywgd2lkdGgpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3V0ZXJSYWRpdXMoKSAhPT0gd2lkdGggLyAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRPdXRlclJhZGl1cyh3aWR0aCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyBpbXBsZW1lbnRzIFNoYXBlLnByb3RvdHlwZS5zZXRIZWlnaHQoKVxuICAgICAgICBzZXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICAgICAgS29udmEuTm9kZS5wcm90b3R5cGUuc2V0SGVpZ2h0LmNhbGwodGhpcywgaGVpZ2h0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLm91dGVyUmFkaXVzKCkgIT09IGhlaWdodCAvIDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldE91dGVyUmFkaXVzKGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLb252YS5VdGlsLmV4dGVuZChLb252YS5TdGFyLCBLb252YS5TaGFwZSk7XG5cbiAgICAvLyBhZGQgZ2V0dGVycyBzZXR0ZXJzXG4gICAgS29udmEuRmFjdG9yeS5hZGRHZXR0ZXJTZXR0ZXIoS29udmEuU3RhciwgJ251bVBvaW50cycsIDUpO1xuXG4gICAgLyoqXG4gICAgICogc2V0IG51bWJlciBvZiBwb2ludHNcbiAgICAgKiBAbmFtZSBzZXROdW1Qb2ludHNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YXIucHJvdG90eXBlXG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfSBwb2ludHNcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgKiBnZXQgbnVtYmVyIG9mIHBvaW50c1xuICAgICAqIEBuYW1lIGdldE51bVBvaW50c1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU3Rhci5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlN0YXIsICdpbm5lclJhZGl1cycsIDApO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGlubmVyIHJhZGl1c1xuICAgICAqIEBuYW1lIHNldElubmVyUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFyLnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSByYWRpdXNcbiAgICAgKi9cblxuICAgICAvKipcbiAgICAgKiBnZXQgaW5uZXIgcmFkaXVzXG4gICAgICogQG5hbWUgZ2V0SW5uZXJSYWRpdXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlN0YXIucHJvdG90eXBlXG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5TdGFyLCAnb3V0ZXJSYWRpdXMnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBvdXRlciByYWRpdXNcbiAgICAgKiBAbmFtZSBzZXRPdXRlclJhZGl1c1xuICAgICAqIEBtZXRob2RcbiAgICAgKiBAbWVtYmVyb2YgS29udmEuU3Rhci5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcmFkaXVzXG4gICAgICovXG5cbiAgICAgLyoqXG4gICAgICogZ2V0IG91dGVyIHJhZGl1c1xuICAgICAqIEBuYW1lIGdldE91dGVyUmFkaXVzXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5TdGFyLnByb3RvdHlwZVxuICAgICAqL1xuXG4gICAgS29udmEuQ29sbGVjdGlvbi5tYXBNZXRob2RzKEtvbnZhLlN0YXIpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvLyBjb25zdGFudHNcbiAgICB2YXIgQVRUUl9DSEFOR0VfTElTVCA9IFsnZm9udEZhbWlseScsICdmb250U2l6ZScsICdmb250U3R5bGUnLCAncGFkZGluZycsICdsaW5lSGVpZ2h0JywgJ3RleHQnXSxcbiAgICAgICAgQ0hBTkdFX0tPTlZBID0gJ0NoYW5nZS5rb252YScsXG4gICAgICAgIE5PTkUgPSAnbm9uZScsXG4gICAgICAgIFVQID0gJ3VwJyxcbiAgICAgICAgUklHSFQgPSAncmlnaHQnLFxuICAgICAgICBET1dOID0gJ2Rvd24nLFxuICAgICAgICBMRUZUID0gJ2xlZnQnLFxuICAgICAgICBMQUJFTCA9ICdMYWJlbCcsXG5cbiAgICAgLy8gY2FjaGVkIHZhcmlhYmxlc1xuICAgICBhdHRyQ2hhbmdlTGlzdExlbiA9IEFUVFJfQ0hBTkdFX0xJU1QubGVuZ3RoO1xuXG4gICAgLyoqXG4gICAgICogTGFiZWwgY29uc3RydWN0b3IuJm5ic3A7IExhYmVscyBhcmUgZ3JvdXBzIHRoYXQgY29udGFpbiBhIFRleHQgYW5kIFRhZyBzaGFwZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy54XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnldXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcud2lkdGhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuaGVpZ2h0XVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy52aXNpYmxlXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5saXN0ZW5pbmddIHdoZXRoZXIgb3Igbm90IHRoZSBub2RlIGlzIGxpc3RlbmluZyBmb3IgZXZlbnRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuaWRdIHVuaXF1ZSBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLm5hbWVdIG5vbi11bmlxdWUgbmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLm9wYWNpdHldIGRldGVybWluZXMgbm9kZSBvcGFjaXR5LiAgQ2FuIGJlIGFueSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuc2NhbGVdIHNldCBzY2FsZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNjYWxlWF0gc2V0IHNjYWxlIHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVldIHNldCBzY2FsZSB5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucm90YXRpb25dIHJvdGF0aW9uIGluIGRlZ3JlZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5vZmZzZXRdIG9mZnNldCBmcm9tIGNlbnRlciBwb2ludCBhbmQgcm90YXRpb24gcG9pbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRYXSBzZXQgb2Zmc2V0IHhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vZmZzZXRZXSBzZXQgb2Zmc2V0IHlcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuZHJhZ2dhYmxlXSBtYWtlcyB0aGUgbm9kZSBkcmFnZ2FibGUuICBXaGVuIHN0YWdlcyBhcmUgZHJhZ2dhYmxlLCB5b3UgY2FuIGRyYWcgYW5kIGRyb3BcbiAgICAgKiAgdGhlIGVudGlyZSBzdGFnZSBieSBkcmFnZ2luZyBhbnkgcG9ydGlvbiBvZiB0aGUgc3RhZ2VcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5kcmFnRGlzdGFuY2VdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbmZpZy5kcmFnQm91bmRGdW5jXVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gY3JlYXRlIGxhYmVsXG4gICAgICogdmFyIGxhYmVsID0gbmV3IEtvbnZhLkxhYmVsKHtcbiAgICAgKiAgIHg6IDEwMCxcbiAgICAgKiAgIHk6IDEwMCxcbiAgICAgKiAgIGRyYWdnYWJsZTogdHJ1ZVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogLy8gYWRkIGEgdGFnIHRvIHRoZSBsYWJlbFxuICAgICAqIGxhYmVsLmFkZChuZXcgS29udmEuVGFnKHtcbiAgICAgKiAgIGZpbGw6ICcjYmJiJyxcbiAgICAgKiAgIHN0cm9rZTogJyMzMzMnLFxuICAgICAqICAgc2hhZG93Q29sb3I6ICdibGFjaycsXG4gICAgICogICBzaGFkb3dCbHVyOiAxMCxcbiAgICAgKiAgIHNoYWRvd09mZnNldDogWzEwLCAxMF0sXG4gICAgICogICBzaGFkb3dPcGFjaXR5OiAwLjIsXG4gICAgICogICBsaW5lSm9pbjogJ3JvdW5kJyxcbiAgICAgKiAgIHBvaW50ZXJEaXJlY3Rpb246ICd1cCcsXG4gICAgICogICBwb2ludGVyV2lkdGg6IDIwLFxuICAgICAqICAgcG9pbnRlckhlaWdodDogMjAsXG4gICAgICogICBjb3JuZXJSYWRpdXM6IDVcbiAgICAgKiB9KSk7XG4gICAgICpcbiAgICAgKiAvLyBhZGQgdGV4dCB0byB0aGUgbGFiZWxcbiAgICAgKiBsYWJlbC5hZGQobmV3IEtvbnZhLlRleHQoe1xuICAgICAqICAgdGV4dDogJ0hlbGxvIFdvcmxkIScsXG4gICAgICogICBmb250U2l6ZTogNTAsXG4gICAgICogICBsaW5lSGVpZ2h0OiAxLjIsXG4gICAgICogICBwYWRkaW5nOiAxMCxcbiAgICAgKiAgIGZpbGw6ICdncmVlbidcbiAgICAgKiAgfSkpO1xuICAgICAqL1xuICAgIEtvbnZhLkxhYmVsID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIHRoaXMuX19fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuTGFiZWwucHJvdG90eXBlID0ge1xuICAgICAgICBfX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgICAgIEtvbnZhLkdyb3VwLmNhbGwodGhpcywgY29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gTEFCRUw7XG5cbiAgICAgICAgICAgIHRoaXMub24oJ2FkZC5rb252YScsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX2FkZExpc3RlbmVycyhldnQuY2hpbGQpO1xuICAgICAgICAgICAgICAgIHRoYXQuX3N5bmMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogZ2V0IFRleHQgc2hhcGUgZm9yIHRoZSBsYWJlbC4gIFlvdSBuZWVkIHRvIGFjY2VzcyB0aGUgVGV4dCBzaGFwZSBpbiBvcmRlciB0byB1cGRhdGVcbiAgICAgICAgICogdGhlIHRleHQgcHJvcGVydGllc1xuICAgICAgICAgKiBAbmFtZSBnZXRUZXh0XG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkxhYmVsLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0VGV4dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kKCdUZXh0JylbMF07XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBnZXQgVGFnIHNoYXBlIGZvciB0aGUgbGFiZWwuICBZb3UgbmVlZCB0byBhY2Nlc3MgdGhlIFRhZyBzaGFwZSBpbiBvcmRlciB0byB1cGRhdGVcbiAgICAgICAgICogdGhlIHBvaW50ZXIgcHJvcGVydGllcyBhbmQgdGhlIGNvcm5lciByYWRpdXNcbiAgICAgICAgICogQG5hbWUgZ2V0VGFnXG4gICAgICAgICAqIEBtZXRob2RcbiAgICAgICAgICogQG1lbWJlcm9mIEtvbnZhLkxhYmVsLnByb3RvdHlwZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0VGFnOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmQoJ1RhZycpWzBdO1xuICAgICAgICB9LFxuICAgICAgICBfYWRkTGlzdGVuZXJzOiBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgbjtcbiAgICAgICAgICAgIHZhciBmdW5jID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5fc3luYygpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSB0ZXh0IGRhdGEgZm9yIGNlcnRhaW4gYXR0ciBjaGFuZ2VzXG4gICAgICAgICAgICBmb3IobiA9IDA7IG4gPCBhdHRyQ2hhbmdlTGlzdExlbjsgbisrKSB7XG4gICAgICAgICAgICAgICAgdGV4dC5vbihBVFRSX0NIQU5HRV9MSVNUW25dICsgQ0hBTkdFX0tPTlZBLCBmdW5jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGV4dCgpLmdldFdpZHRoKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUZXh0KCkuZ2V0SGVpZ2h0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9zeW5jOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5nZXRUZXh0KCksXG4gICAgICAgICAgICAgICAgdGFnID0gdGhpcy5nZXRUYWcoKSxcbiAgICAgICAgICAgICAgICB3aWR0aCwgaGVpZ2h0LCBwb2ludGVyRGlyZWN0aW9uLCBwb2ludGVyV2lkdGgsIHgsIHksIHBvaW50ZXJIZWlnaHQ7XG5cbiAgICAgICAgICAgIGlmICh0ZXh0ICYmIHRhZykge1xuICAgICAgICAgICAgICAgIHdpZHRoID0gdGV4dC5nZXRXaWR0aCgpO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IHRleHQuZ2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgcG9pbnRlckRpcmVjdGlvbiA9IHRhZy5nZXRQb2ludGVyRGlyZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgcG9pbnRlcldpZHRoID0gdGFnLmdldFBvaW50ZXJXaWR0aCgpO1xuICAgICAgICAgICAgICAgIHBvaW50ZXJIZWlnaHQgPSB0YWcuZ2V0UG9pbnRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgIHggPSAwO1xuICAgICAgICAgICAgICAgIHkgPSAwO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoKHBvaW50ZXJEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBVUDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSB3aWR0aCAvIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gLTEgKiBwb2ludGVySGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgUklHSFQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gd2lkdGggKyBwb2ludGVyV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB5ID0gaGVpZ2h0IC8gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIERPV046XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gd2lkdGggLyAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGhlaWdodCArIHBvaW50ZXJIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMRUZUOlxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IC0xICogcG9pbnRlcldpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgeSA9IGhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0YWcuc2V0QXR0cnMoe1xuICAgICAgICAgICAgICAgICAgICB4OiAtMSAqIHgsXG4gICAgICAgICAgICAgICAgICAgIHk6IC0xICogeSxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGV4dC5zZXRBdHRycyh7XG4gICAgICAgICAgICAgICAgICAgIHg6IC0xICogeCxcbiAgICAgICAgICAgICAgICAgICAgeTogLTEgKiB5XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuTGFiZWwsIEtvbnZhLkdyb3VwKTtcblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5MYWJlbCk7XG5cbiAgICAvKipcbiAgICAgKiBUYWcgY29uc3RydWN0b3IuJm5ic3A7IEEgVGFnIGNhbiBiZSBjb25maWd1cmVkXG4gICAgICogIHRvIGhhdmUgYSBwb2ludGVyIGVsZW1lbnQgdGhhdCBwb2ludHMgdXAsIHJpZ2h0LCBkb3duLCBvciBsZWZ0XG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQG1lbWJlcm9mIEtvbnZhXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnBvaW50ZXJEaXJlY3Rpb25dIGNhbiBiZSB1cCwgcmlnaHQsIGRvd24sIGxlZnQsIG9yIG5vbmU7IHRoZSBkZWZhdWx0XG4gICAgICogIGlzIG5vbmUuICBXaGVuIGEgcG9pbnRlciBpcyBwcmVzZW50LCB0aGUgcG9zaXRpb25pbmcgb2YgdGhlIGxhYmVsIGlzIHJlbGF0aXZlIHRvIHRoZSB0aXAgb2YgdGhlIHBvaW50ZXIuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcucG9pbnRlcldpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnBvaW50ZXJIZWlnaHRdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuY29ybmVyUmFkaXVzXVxuICAgICAqL1xuICAgIEtvbnZhLlRhZyA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX2luaXQoY29uZmlnKTtcbiAgICB9O1xuXG4gICAgS29udmEuVGFnLnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19faW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgICAgICBLb252YS5TaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9ICdUYWcnO1xuICAgICAgICAgICAgdGhpcy5zY2VuZUZ1bmModGhpcy5fc2NlbmVGdW5jKTtcbiAgICAgICAgfSxcbiAgICAgICAgX3NjZW5lRnVuYzogZnVuY3Rpb24oY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5nZXRXaWR0aCgpLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuZ2V0SGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgcG9pbnRlckRpcmVjdGlvbiA9IHRoaXMuZ2V0UG9pbnRlckRpcmVjdGlvbigpLFxuICAgICAgICAgICAgICAgIHBvaW50ZXJXaWR0aCA9IHRoaXMuZ2V0UG9pbnRlcldpZHRoKCksXG4gICAgICAgICAgICAgICAgcG9pbnRlckhlaWdodCA9IHRoaXMuZ2V0UG9pbnRlckhlaWdodCgpLFxuICAgICAgICAgICAgICAgIGNvcm5lclJhZGl1cyA9IE1hdGgubWluKHRoaXMuZ2V0Q29ybmVyUmFkaXVzKCksIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG5cbiAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBpZiAoIWNvcm5lclJhZGl1cykge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubW92ZVRvKDAsIDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhjb3JuZXJSYWRpdXMsIDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocG9pbnRlckRpcmVjdGlvbiA9PT0gVVApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbygod2lkdGggLSBwb2ludGVyV2lkdGgpIC8gMiwgMCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGggLyAyLCAtMSAqIHBvaW50ZXJIZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKCh3aWR0aCArIHBvaW50ZXJXaWR0aCkgLyAyLCAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoIWNvcm5lclJhZGl1cykge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHdpZHRoLCAwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGggLSBjb3JuZXJSYWRpdXMsIDApO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKHdpZHRoIC0gY29ybmVyUmFkaXVzLCBjb3JuZXJSYWRpdXMsIGNvcm5lclJhZGl1cywgTWF0aC5QSSAqIDMgLyAyLCAwLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwb2ludGVyRGlyZWN0aW9uID09PSBSSUdIVCkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHdpZHRoLCAoaGVpZ2h0IC0gcG9pbnRlckhlaWdodCkgLyAyKTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCArIHBvaW50ZXJXaWR0aCwgaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGgsIChoZWlnaHQgKyBwb2ludGVySGVpZ2h0KSAvIDIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZighY29ybmVyUmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8od2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHdpZHRoLCBoZWlnaHQgLSBjb3JuZXJSYWRpdXMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKHdpZHRoIC0gY29ybmVyUmFkaXVzLCBoZWlnaHQgLSBjb3JuZXJSYWRpdXMsIGNvcm5lclJhZGl1cywgMCwgTWF0aC5QSSAvIDIsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBvaW50ZXJEaXJlY3Rpb24gPT09IERPV04pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbygod2lkdGggKyBwb2ludGVyV2lkdGgpIC8gMiwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyh3aWR0aCAvIDIsIGhlaWdodCArIHBvaW50ZXJIZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKCh3aWR0aCAtIHBvaW50ZXJXaWR0aCkgLyAyLCBoZWlnaHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZighY29ybmVyUmFkaXVzKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oMCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oY29ybmVyUmFkaXVzLCBoZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKGNvcm5lclJhZGl1cywgaGVpZ2h0IC0gY29ybmVyUmFkaXVzLCBjb3JuZXJSYWRpdXMsIE1hdGguUEkgLyAyLCBNYXRoLlBJLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwb2ludGVyRGlyZWN0aW9uID09PSBMRUZUKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oMCwgKGhlaWdodCArIHBvaW50ZXJIZWlnaHQpIC8gMik7XG4gICAgICAgICAgICAgICAgY29udGV4dC5saW5lVG8oLTEgKiBwb2ludGVyV2lkdGgsIGhlaWdodCAvIDIpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKDAsIChoZWlnaHQgLSBwb2ludGVySGVpZ2h0KSAvIDIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihjb3JuZXJSYWRpdXMpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbygwLCBjb3JuZXJSYWRpdXMpO1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXJjKGNvcm5lclJhZGl1cywgY29ybmVyUmFkaXVzLCBjb3JuZXJSYWRpdXMsIE1hdGguUEksIE1hdGguUEkgKiAzIC8gMiwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFNlbGZSZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB4ID0gMCxcbiAgICAgICAgICAgICAgICB5ID0gMCxcbiAgICAgICAgICAgICAgICBwb2ludGVyV2lkdGggPSB0aGlzLmdldFBvaW50ZXJXaWR0aCgpLFxuICAgICAgICAgICAgICAgIHBvaW50ZXJIZWlnaHQgPSB0aGlzLmdldFBvaW50ZXJIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSB0aGlzLnBvaW50ZXJEaXJlY3Rpb24oKSxcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpO1xuXG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBVUCkge1xuICAgICAgICAgICAgICAgIHkgLT0gcG9pbnRlckhlaWdodDtcbiAgICAgICAgICAgICAgICBoZWlnaHQgKz0gcG9pbnRlckhlaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSBET1dOKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ICs9IHBvaW50ZXJIZWlnaHQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gTEVGVCkge1xuICAgICAgICAgICAgICAgIC8vIEFSR0ghISEgSSBoYXZlIG5vIGlkZWEgd2h5IHNob3VsZCBJIHVzZWQgbWFnaWMgMS41ISEhISEhISEhXG4gICAgICAgICAgICAgICAgeCAtPSBwb2ludGVyV2lkdGggKiAxLjU7XG4gICAgICAgICAgICAgICAgd2lkdGggKz0gcG9pbnRlcldpZHRoO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09IFJJR0hUKSB7XG4gICAgICAgICAgICAgICAgd2lkdGggKz0gcG9pbnRlcldpZHRoICogMS41O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICAgIHk6IHksXG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIEtvbnZhLlV0aWwuZXh0ZW5kKEtvbnZhLlRhZywgS29udmEuU2hhcGUpO1xuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRhZywgJ3BvaW50ZXJEaXJlY3Rpb24nLCBOT05FKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBwb2ludGVyIERpcmVjdGlvblxuICAgICAqIEBuYW1lIHNldFBvaW50ZXJEaXJlY3Rpb25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcG9pbnRlckRpcmVjdGlvbiBjYW4gYmUgdXAsIHJpZ2h0LCBkb3duLCBsZWZ0LCBvciBub25lLiAgVGhlXG4gICAgICogIGRlZmF1bHQgaXMgbm9uZVxuICAgICAqL1xuXG4gICAgIC8qKlxuICAgICAqIGdldCBwb2ludGVyIERpcmVjdGlvblxuICAgICAqIEBuYW1lIGdldFBvaW50ZXJEaXJlY3Rpb25cbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRhZywgJ3BvaW50ZXJXaWR0aCcsIDApO1xuXG4gICAgLyoqXG4gICAgICogc2V0IHBvaW50ZXIgd2lkdGhcbiAgICAgKiBAbmFtZSBzZXRQb2ludGVyV2lkdGhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9pbnRlcldpZHRoXG4gICAgICovXG5cbiAgICAgLyoqXG4gICAgICogZ2V0IHBvaW50ZXIgd2lkdGhcbiAgICAgKiBAbmFtZSBnZXRQb2ludGVyV2lkdGhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRhZywgJ3BvaW50ZXJIZWlnaHQnLCAwKTtcblxuICAgIC8qKlxuICAgICAqIHNldCBwb2ludGVyIGhlaWdodFxuICAgICAqIEBuYW1lIHNldFBvaW50ZXJIZWlnaHRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcG9pbnRlckhlaWdodFxuICAgICAqL1xuXG4gICAgIC8qKlxuICAgICAqIGdldCBwb2ludGVyIGhlaWdodFxuICAgICAqIEBuYW1lIGdldFBvaW50ZXJIZWlnaHRcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLlRhZywgJ2Nvcm5lclJhZGl1cycsIDApO1xuXG4gICAgLyoqXG4gICAgICogc2V0IGNvcm5lciByYWRpdXNcbiAgICAgKiBAbmFtZSBzZXRDb3JuZXJSYWRpdXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY29ybmVyIHJhZGl1c1xuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogZ2V0IGNvcm5lciByYWRpdXNcbiAgICAgKiBAbmFtZSBnZXRDb3JuZXJSYWRpdXNcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLlRhZy5wcm90b3R5cGVcbiAgICAgKi9cblxuICAgIEtvbnZhLkNvbGxlY3Rpb24ubWFwTWV0aG9kcyhLb252YS5UYWcpO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAvKipcbiAgICAgKiBBcnJvdyBjb25zdHJ1Y3RvclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBtZW1iZXJvZiBLb252YVxuICAgICAqIEBhdWdtZW50cyBLb252YS5TaGFwZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBjb25maWcucG9pbnRzXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcudGVuc2lvbl0gSGlnaGVyIHZhbHVlcyB3aWxsIHJlc3VsdCBpbiBhIG1vcmUgY3VydnkgbGluZS4gIEEgdmFsdWUgb2YgMCB3aWxsIHJlc3VsdCBpbiBubyBpbnRlcnBvbGF0aW9uLlxuICAgICAqICAgVGhlIGRlZmF1bHQgaXMgMFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb25maWcucG9pbnRlckxlbmd0aFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb25maWcucG9pbnRlcldpZHRoXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuZmlsbF0gZmlsbCBjb2xvclxuICAgICAqIEBwYXJhbSB7SW1hZ2V9IFtjb25maWcuZmlsbFBhdHRlcm5JbWFnZV0gZmlsbCBwYXR0ZXJuIGltYWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFBhdHRlcm5YXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuWV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVybk9mZnNldFhdIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxQYXR0ZXJuT2Zmc2V0WV0gXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbFBhdHRlcm5TY2FsZV0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblNjYWxlWV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUGF0dGVyblJvdGF0aW9uXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQYXR0ZXJuUmVwZWF0XSBjYW4gYmUgXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIG9yIFwibm8tcmVwZWF0XCIuICBUaGUgZGVmYXVsdCBpcyBcIm5vLXJlcGVhdFwiXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50U3RhcnRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRTdGFydFBvaW50WV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludF0gb2JqZWN0IHdpdGggeCBhbmQgeSBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsTGluZWFyR3JhZGllbnRFbmRQb2ludFhdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50RW5kUG9pbnRZXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtjb25maWcuZmlsbExpbmVhckdyYWRpZW50Q29sb3JTdG9wc10gYXJyYXkgb2YgY29sb3Igc3RvcHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRYXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudFN0YXJ0UG9pbnRZXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50XSBvYmplY3Qgd2l0aCB4IGFuZCB5IGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmZpbGxSYWRpYWxHcmFkaWVudEVuZFBvaW50WF0gXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZmlsbFJhZGlhbEdyYWRpZW50RW5kUG9pbnRZXSBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRTdGFydFJhZGl1c11cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRFbmRSYWRpdXNdXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5maWxsUmFkaWFsR3JhZGllbnRDb2xvclN0b3BzXSBhcnJheSBvZiBjb2xvciBzdG9wc1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5maWxsRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBmaWxsLiAgVGhlIGRlZmF1bHQgdmFsdWUgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmZpbGxQcmlvcml0eV0gY2FuIGJlIGNvbG9yLCBsaW5lYXItZ3JhZGllbnQsIHJhZGlhbC1ncmFpZGVudCwgb3IgcGF0dGVybi4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGNvbG9yLiAgVGhlIGZpbGxQcmlvcml0eSBwcm9wZXJ0eSBtYWtlcyBpdCByZWFsbHkgZWFzeSB0byB0b2dnbGUgYmV0d2VlbiBkaWZmZXJlbnQgZmlsbCB0eXBlcy4gIEZvciBleGFtcGxlLCBpZiB5b3Ugd2FudCB0byB0b2dnbGUgYmV0d2VlbiBhIGZpbGwgY29sb3Igc3R5bGUgYW5kIGEgZmlsbCBwYXR0ZXJuIHN0eWxlLCBzaW1wbHkgc2V0IHRoZSBmaWxsIHByb3BlcnR5IGFuZCB0aGUgZmlsbFBhdHRlcm4gcHJvcGVydGllcywgYW5kIHRoZW4gdXNlIHNldEZpbGxQcmlvcml0eSgnY29sb3InKSB0byByZW5kZXIgdGhlIHNoYXBlIHdpdGggYSBjb2xvciBmaWxsLCBvciB1c2Ugc2V0RmlsbFByaW9yaXR5KCdwYXR0ZXJuJykgdG8gcmVuZGVyIHRoZSBzaGFwZSB3aXRoIHRoZSBwYXR0ZXJuIGZpbGwgY29uZmlndXJhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLnN0cm9rZV0gc3Ryb2tlIGNvbG9yXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc3Ryb2tlV2lkdGhdIHN0cm9rZSB3aWR0aFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VIaXRFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIGhpdCByZWdpb24uICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnBlcmZlY3REcmF3RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHVzaW5nIGJ1ZmZlciBjYW52YXMuICBUaGUgZGVmYXVsdCBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLnNoYWRvd0ZvclN0cm9rZUVuYWJsZWRdIGZsYWcgd2hpY2ggZW5hYmxlcyBvciBkaXNhYmxlcyBzaGFzb3cgZm9yIHN0cm9rZS4gIFRoZSBkZWZhdWx0IGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc3Ryb2tlU2NhbGVFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgc3Ryb2tlIHNjYWxlLiAgVGhlIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5zdHJva2VFbmFibGVkXSBmbGFnIHdoaWNoIGVuYWJsZXMgb3IgZGlzYWJsZXMgdGhlIHN0cm9rZS4gIFRoZSBkZWZhdWx0IHZhbHVlIGlzIHRydWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5saW5lSm9pbl0gY2FuIGJlIG1pdGVyLCByb3VuZCwgb3IgYmV2ZWwuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBtaXRlclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmxpbmVDYXBdIGNhbiBiZSBidXR0LCByb3VuZCwgb3Igc3FhcmUuICBUaGUgZGVmYXVsdFxuICAgICAqICBpcyBidXR0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFtjb25maWcuc2hhZG93Q29sb3JdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93Qmx1cl1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZy5zaGFkb3dPZmZzZXRdIG9iamVjdCB3aXRoIHggYW5kIHkgY29tcG9uZW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2hhZG93T2Zmc2V0WF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zaGFkb3dPZmZzZXRZXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnNoYWRvd09wYWNpdHldIHNoYWRvdyBvcGFjaXR5LiAgQ2FuIGJlIGFueSByZWFsIG51bWJlclxuICAgICAqICBiZXR3ZWVuIDAgYW5kIDFcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcuc2hhZG93RW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBzaGFkb3cuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2NvbmZpZy5kYXNoXVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbmZpZy5kYXNoRW5hYmxlZF0gZmxhZyB3aGljaCBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBkYXNoQXJyYXkuICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcueF1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy55XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLndpZHRoXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLmhlaWdodF1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcudmlzaWJsZV1cbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtjb25maWcubGlzdGVuaW5nXSB3aGV0aGVyIG9yIG5vdCB0aGUgbm9kZSBpcyBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbY29uZmlnLmlkXSB1bmlxdWUgaWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW2NvbmZpZy5uYW1lXSBub24tdW5pcXVlIG5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5vcGFjaXR5XSBkZXRlcm1pbmVzIG5vZGUgb3BhY2l0eS4gIENhbiBiZSBhbnkgbnVtYmVyIGJldHdlZW4gMCBhbmQgMVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlnLnNjYWxlXSBzZXQgc2NhbGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW2NvbmZpZy5zY2FsZVhdIHNldCBzY2FsZSB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuc2NhbGVZXSBzZXQgc2NhbGUgeVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY29uZmlnLnJvdGF0aW9uXSByb3RhdGlvbiBpbiBkZWdyZWVzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtjb25maWcub2Zmc2V0XSBvZmZzZXQgZnJvbSBjZW50ZXIgcG9pbnQgYW5kIHJvdGF0aW9uIHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WF0gc2V0IG9mZnNldCB4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcub2Zmc2V0WV0gc2V0IG9mZnNldCB5XG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbY29uZmlnLmRyYWdnYWJsZV0gbWFrZXMgdGhlIG5vZGUgZHJhZ2dhYmxlLiAgV2hlbiBzdGFnZXMgYXJlIGRyYWdnYWJsZSwgeW91IGNhbiBkcmFnIGFuZCBkcm9wXG4gICAgICogIHRoZSBlbnRpcmUgc3RhZ2UgYnkgZHJhZ2dpbmcgYW55IHBvcnRpb24gb2YgdGhlIHN0YWdlXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtjb25maWcuZHJhZ0Rpc3RhbmNlXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb25maWcuZHJhZ0JvdW5kRnVuY11cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBsaW5lID0gbmV3IEtvbnZhLkxpbmUoe1xuICAgICAqICAgcG9pbnRzOiBbNzMsIDcwLCAzNDAsIDIzLCA0NTAsIDYwLCA1MDAsIDIwXSxcbiAgICAgKiAgIHN0cm9rZTogJ3JlZCcsXG4gICAgICogICB0ZW5zaW9uOiAxLFxuICAgICAqICAgcG9pbnRlckxlbmd0aCA6IDEwLFxuICAgICAqICAgcG9pbnRlcldpZHRoIDogMTJcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBLb252YS5BcnJvdyA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICB0aGlzLl9fX19pbml0KGNvbmZpZyk7XG4gICAgfTtcblxuICAgIEtvbnZhLkFycm93LnByb3RvdHlwZSA9IHtcbiAgICAgICAgX19fX2luaXQ6IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgICAgICAgLy8gY2FsbCBzdXBlciBjb25zdHJ1Y3RvclxuICAgICAgICAgICAgS29udmEuTGluZS5jYWxsKHRoaXMsIGNvbmZpZyk7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9ICdBcnJvdyc7XG4gICAgICAgIH0sXG4gICAgICAgIF9zY2VuZUZ1bmM6IGZ1bmN0aW9uKGN0eCkge1xuICAgICAgICAgICAgS29udmEuTGluZS5wcm90b3R5cGUuX3NjZW5lRnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgdmFyIFBJMiA9IE1hdGguUEkgKiAyO1xuICAgICAgICAgICAgdmFyIHBvaW50cyA9IHRoaXMucG9pbnRzKCk7XG4gICAgICAgICAgICB2YXIgbiA9IHBvaW50cy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZHggPSBwb2ludHNbbiAtIDJdIC0gcG9pbnRzW24gLSA0XTtcbiAgICAgICAgICAgIHZhciBkeSA9IHBvaW50c1tuIC0gMV0gLSBwb2ludHNbbiAtIDNdO1xuICAgICAgICAgICAgdmFyIHJhZGlhbnMgPSAoTWF0aC5hdGFuMihkeSwgZHgpICsgUEkyKSAlIFBJMjtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLnBvaW50ZXJMZW5ndGgoKTtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMucG9pbnRlcldpZHRoKCk7XG5cbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHgudHJhbnNsYXRlKHBvaW50c1tuIC0gMl0sIHBvaW50c1tuIC0gMV0pO1xuICAgICAgICAgICAgY3R4LnJvdGF0ZShyYWRpYW5zKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgMCk7XG4gICAgICAgICAgICBjdHgubGluZVRvKC1sZW5ndGgsIHdpZHRoIC8gMik7XG4gICAgICAgICAgICBjdHgubGluZVRvKC1sZW5ndGgsIC13aWR0aCAvIDIpO1xuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMucG9pbnRlckF0QmVnaW5uaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUocG9pbnRzWzBdLCBwb2ludHNbMV0pO1xuICAgICAgICAgICAgICAgIGR4ID0gcG9pbnRzWzJdIC0gcG9pbnRzWzBdO1xuICAgICAgICAgICAgICAgIGR5ID0gcG9pbnRzWzNdIC0gcG9pbnRzWzFdO1xuICAgICAgICAgICAgICAgIGN0eC5yb3RhdGUoKE1hdGguYXRhbjIoLWR5LCAtZHgpICsgUEkyKSAlIFBJMik7XG4gICAgICAgICAgICAgICAgY3R4Lm1vdmVUbygwLCAwKTtcbiAgICAgICAgICAgICAgICBjdHgubGluZVRvKC1sZW5ndGgsIHdpZHRoIC8gMik7XG4gICAgICAgICAgICAgICAgY3R4LmxpbmVUbygtbGVuZ3RoLCAtd2lkdGggLyAyKTtcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5maWxsU3Ryb2tlU2hhcGUodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgS29udmEuVXRpbC5leHRlbmQoS29udmEuQXJyb3csIEtvbnZhLkxpbmUpO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgcG9pbnRlckxlbmd0aFxuICAgICAqIEBuYW1lIHBvaW50ZXJMZW5ndGhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkFycm93LnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBMZW5ndGggb2YgcG9pbnRlciBvZiBhcnJvdy5cbiAgICAgKiAgIFRoZSBkZWZhdWx0IGlzIDEwLlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAvLyBnZXQgdGVuc2lvblxuICAgICAqIHZhciBwb2ludGVyTGVuZ3RoID0gbGluZS5wb2ludGVyTGVuZ3RoKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgdGVuc2lvblxuICAgICAqIGxpbmUucG9pbnRlckxlbmd0aCgxNSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5BcnJvdywgJ3BvaW50ZXJMZW5ndGgnLCAxMCk7XG4gICAgLyoqXG4gICAgICogZ2V0L3NldCBwb2ludGVyV2lkdGhcbiAgICAgKiBAbmFtZSBwb2ludGVyV2lkdGhcbiAgICAgKiBAbWV0aG9kXG4gICAgICogQG1lbWJlcm9mIEtvbnZhLkFycm93LnByb3RvdHlwZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBXaWR0aCBvZiBwb2ludGVyIG9mIGFycm93LlxuICAgICAqICAgVGhlIGRlZmF1bHQgaXMgMTAuXG4gICAgICogQHJldHVybnMge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGdldCB0ZW5zaW9uXG4gICAgICogdmFyIHBvaW50ZXJXaWR0aCA9IGxpbmUucG9pbnRlcldpZHRoKCk7XG4gICAgICpcbiAgICAgKiAvLyBzZXQgdGVuc2lvblxuICAgICAqIGxpbmUucG9pbnRlcldpZHRoKDE1KTtcbiAgICAgKi9cblxuICAgIEtvbnZhLkZhY3RvcnkuYWRkR2V0dGVyU2V0dGVyKEtvbnZhLkFycm93LCAncG9pbnRlcldpZHRoJywgMTApO1xuICAgIC8qKlxuICAgICAqIGdldC9zZXQgcG9pbnRlckF0QmVnaW5uaW5nXG4gICAgICogQG5hbWUgcG9pbnRlckF0QmVnaW5uaW5nXG4gICAgICogQG1ldGhvZFxuICAgICAqIEBtZW1iZXJvZiBLb252YS5BcnJvdy5wcm90b3R5cGVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gU2hvdWxkIHBvaW50ZXIgZGlzcGxheWVkIGF0IGJlZ2lubmluZyBvZiBhcnJvdy5cbiAgICAgKiAgIFRoZSBkZWZhdWx0IGlzIGZhbHNlLlxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gZ2V0IHRlbnNpb25cbiAgICAgKiB2YXIgcG9pbnRlckF0QmVnaW5uaW5nID0gbGluZS5wb2ludGVyQXRCZWdpbm5pbmcoKTtcbiAgICAgKlxuICAgICAqIC8vIHNldCB0ZW5zaW9uXG4gICAgICogbGluZS5wb2ludGVyQXRCZWdpbm5pbmcodHJ1ZSk7XG4gICAgICovXG5cbiAgICBLb252YS5GYWN0b3J5LmFkZEdldHRlclNldHRlcihLb252YS5BcnJvdywgJ3BvaW50ZXJBdEJlZ2lubmluZycsIGZhbHNlKTtcbiAgICBLb252YS5Db2xsZWN0aW9uLm1hcE1ldGhvZHMoS29udmEuQXJyb3cpO1xuXG59KSgpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L2tvbnZhL2tvbnZhLmpzXG4gKiogbW9kdWxlIGlkID0gMzYyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 363 */
/***/ function(module, exports) {

	eval("/* (ignored) *///# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2NhbnZhcyAoaWdub3JlZCk/YTExYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiAoaWdub3JlZCkgKi9cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGNhbnZhcyAoaWdub3JlZClcbiAqKiBtb2R1bGUgaWQgPSAzNjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 364 */
/***/ function(module, exports) {

	eval("/* (ignored) *///# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2pzZG9tIChpZ25vcmVkKT85ZjRiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIChpZ25vcmVkKSAqL1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKioganNkb20gKGlnbm9yZWQpXG4gKiogbW9kdWxlIGlkID0gMzY0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9");

/***/ },
/* 365 */
/***/ function(module, exports, __webpack_require__) {

	eval("/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n */\n\n'use strict';\n\nvar emptyObject = {};\n\nif (false) {\n  Object.freeze(emptyObject);\n}\n\nmodule.exports = emptyObject;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vcmVhY3Qta29udmEvfi9mYmpzL2xpYi9lbXB0eU9iamVjdC5qcz9iNjc1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgZW1wdHlPYmplY3QgPSB7fTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgT2JqZWN0LmZyZWV6ZShlbXB0eU9iamVjdCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZW1wdHlPYmplY3Q7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuLi9+L3JlYWN0LWtvbnZhL34vZmJqcy9saWIvZW1wdHlPYmplY3QuanNcbiAqKiBtb2R1bGUgaWQgPSAzNjVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 366 */
/***/ function(module, exports) {

	eval("// removed by extract-text-webpack-plugin//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3R5bGVzL3N5c3RlbS1tYXAubGVzcz9iMGUzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHJlbW92ZWQgYnkgZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3N0eWxlcy9zeXN0ZW0tbWFwLmxlc3NcbiAqKiBtb2R1bGUgaWQgPSAzNjZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 367 */,
/* 368 */
/***/ function(module, exports, __webpack_require__) {

	eval("\n/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = __webpack_require__(369);\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  return ('WebkitAppearance' in document.documentElement.style) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (window.console && (console.firebug || (console.exception && console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  return JSON.stringify(v);\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs() {\n  var args = arguments;\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return args;\n\n  var c = 'color: ' + this.color;\n  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n  return args;\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage(){\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vZGVidWcvYnJvd3Nlci5qcz9jMTc2Il0sInNvdXJjZXNDb250ZW50IjpbIlxuLyoqXG4gKiBUaGlzIGlzIHRoZSB3ZWIgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBgZGVidWcoKWAuXG4gKlxuICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuICovXG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGVidWcnKTtcbmV4cG9ydHMubG9nID0gbG9nO1xuZXhwb3J0cy5mb3JtYXRBcmdzID0gZm9ybWF0QXJncztcbmV4cG9ydHMuc2F2ZSA9IHNhdmU7XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy51c2VDb2xvcnMgPSB1c2VDb2xvcnM7XG5leHBvcnRzLnN0b3JhZ2UgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lXG4gICAgICAgICAgICAgICAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lLnN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgID8gY2hyb21lLnN0b3JhZ2UubG9jYWxcbiAgICAgICAgICAgICAgICAgIDogbG9jYWxzdG9yYWdlKCk7XG5cbi8qKlxuICogQ29sb3JzLlxuICovXG5cbmV4cG9ydHMuY29sb3JzID0gW1xuICAnbGlnaHRzZWFncmVlbicsXG4gICdmb3Jlc3RncmVlbicsXG4gICdnb2xkZW5yb2QnLFxuICAnZG9kZ2VyYmx1ZScsXG4gICdkYXJrb3JjaGlkJyxcbiAgJ2NyaW1zb24nXG5dO1xuXG4vKipcbiAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG4gKiBhbmQgdGhlIEZpcmVidWcgZXh0ZW5zaW9uIChhbnkgRmlyZWZveCB2ZXJzaW9uKSBhcmUga25vd25cbiAqIHRvIHN1cHBvcnQgXCIlY1wiIENTUyBjdXN0b21pemF0aW9ucy5cbiAqXG4gKiBUT0RPOiBhZGQgYSBgbG9jYWxTdG9yYWdlYCB2YXJpYWJsZSB0byBleHBsaWNpdGx5IGVuYWJsZS9kaXNhYmxlIGNvbG9yc1xuICovXG5cbmZ1bmN0aW9uIHVzZUNvbG9ycygpIHtcbiAgLy8gaXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcbiAgcmV0dXJuICgnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlKSB8fFxuICAgIC8vIGlzIGZpcmVidWc/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5ODEyMC8zNzY3NzNcbiAgICAod2luZG93LmNvbnNvbGUgJiYgKGNvbnNvbGUuZmlyZWJ1ZyB8fCAoY29uc29sZS5leGNlcHRpb24gJiYgY29uc29sZS50YWJsZSkpKSB8fFxuICAgIC8vIGlzIGZpcmVmb3ggPj0gdjMxP1xuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvVG9vbHMvV2ViX0NvbnNvbGUjU3R5bGluZ19tZXNzYWdlc1xuICAgIChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSk7XG59XG5cbi8qKlxuICogTWFwICVqIHRvIGBKU09OLnN0cmluZ2lmeSgpYCwgc2luY2Ugbm8gV2ViIEluc3BlY3RvcnMgZG8gdGhhdCBieSBkZWZhdWx0LlxuICovXG5cbmV4cG9ydHMuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24odikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG59O1xuXG5cbi8qKlxuICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZm9ybWF0QXJncygpIHtcbiAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gIHZhciB1c2VDb2xvcnMgPSB0aGlzLnVzZUNvbG9ycztcblxuICBhcmdzWzBdID0gKHVzZUNvbG9ycyA/ICclYycgOiAnJylcbiAgICArIHRoaXMubmFtZXNwYWNlXG4gICAgKyAodXNlQ29sb3JzID8gJyAlYycgOiAnICcpXG4gICAgKyBhcmdzWzBdXG4gICAgKyAodXNlQ29sb3JzID8gJyVjICcgOiAnICcpXG4gICAgKyAnKycgKyBleHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7XG5cbiAgaWYgKCF1c2VDb2xvcnMpIHJldHVybiBhcmdzO1xuXG4gIHZhciBjID0gJ2NvbG9yOiAnICsgdGhpcy5jb2xvcjtcbiAgYXJncyA9IFthcmdzWzBdLCBjLCAnY29sb3I6IGluaGVyaXQnXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncywgMSkpO1xuXG4gIC8vIHRoZSBmaW5hbCBcIiVjXCIgaXMgc29tZXdoYXQgdHJpY2t5LCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG90aGVyXG4gIC8vIGFyZ3VtZW50cyBwYXNzZWQgZWl0aGVyIGJlZm9yZSBvciBhZnRlciB0aGUgJWMsIHNvIHdlIG5lZWQgdG9cbiAgLy8gZmlndXJlIG91dCB0aGUgY29ycmVjdCBpbmRleCB0byBpbnNlcnQgdGhlIENTUyBpbnRvXG4gIHZhciBpbmRleCA9IDA7XG4gIHZhciBsYXN0QyA9IDA7XG4gIGFyZ3NbMF0ucmVwbGFjZSgvJVthLXolXS9nLCBmdW5jdGlvbihtYXRjaCkge1xuICAgIGlmICgnJSUnID09PSBtYXRjaCkgcmV0dXJuO1xuICAgIGluZGV4Kys7XG4gICAgaWYgKCclYycgPT09IG1hdGNoKSB7XG4gICAgICAvLyB3ZSBvbmx5IGFyZSBpbnRlcmVzdGVkIGluIHRoZSAqbGFzdCogJWNcbiAgICAgIC8vICh0aGUgdXNlciBtYXkgaGF2ZSBwcm92aWRlZCB0aGVpciBvd24pXG4gICAgICBsYXN0QyA9IGluZGV4O1xuICAgIH1cbiAgfSk7XG5cbiAgYXJncy5zcGxpY2UobGFzdEMsIDAsIGMpO1xuICByZXR1cm4gYXJncztcbn1cblxuLyoqXG4gKiBJbnZva2VzIGBjb25zb2xlLmxvZygpYCB3aGVuIGF2YWlsYWJsZS5cbiAqIE5vLW9wIHdoZW4gYGNvbnNvbGUubG9nYCBpcyBub3QgYSBcImZ1bmN0aW9uXCIuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBsb2coKSB7XG4gIC8vIHRoaXMgaGFja2VyeSBpcyByZXF1aXJlZCBmb3IgSUU4LzksIHdoZXJlXG4gIC8vIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uIGRvZXNuJ3QgaGF2ZSAnYXBwbHknXG4gIHJldHVybiAnb2JqZWN0JyA9PT0gdHlwZW9mIGNvbnNvbGVcbiAgICAmJiBjb25zb2xlLmxvZ1xuICAgICYmIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKGNvbnNvbGUubG9nLCBjb25zb2xlLCBhcmd1bWVudHMpO1xufVxuXG4vKipcbiAqIFNhdmUgYG5hbWVzcGFjZXNgLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VzXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcbiAgdHJ5IHtcbiAgICBpZiAobnVsbCA9PSBuYW1lc3BhY2VzKSB7XG4gICAgICBleHBvcnRzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnZGVidWcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZXhwb3J0cy5zdG9yYWdlLmRlYnVnID0gbmFtZXNwYWNlcztcbiAgICB9XG4gIH0gY2F0Y2goZSkge31cbn1cblxuLyoqXG4gKiBMb2FkIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHJldHVybnMgdGhlIHByZXZpb3VzbHkgcGVyc2lzdGVkIGRlYnVnIG1vZGVzXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBsb2FkKCkge1xuICB2YXIgcjtcbiAgdHJ5IHtcbiAgICByID0gZXhwb3J0cy5zdG9yYWdlLmRlYnVnO1xuICB9IGNhdGNoKGUpIHt9XG4gIHJldHVybiByO1xufVxuXG4vKipcbiAqIEVuYWJsZSBuYW1lc3BhY2VzIGxpc3RlZCBpbiBgbG9jYWxTdG9yYWdlLmRlYnVnYCBpbml0aWFsbHkuXG4gKi9cblxuZXhwb3J0cy5lbmFibGUobG9hZCgpKTtcblxuLyoqXG4gKiBMb2NhbHN0b3JhZ2UgYXR0ZW1wdHMgdG8gcmV0dXJuIHRoZSBsb2NhbHN0b3JhZ2UuXG4gKlxuICogVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzYWZhcmkgdGhyb3dzXG4gKiB3aGVuIGEgdXNlciBkaXNhYmxlcyBjb29raWVzL2xvY2Fsc3RvcmFnZVxuICogYW5kIHlvdSBhdHRlbXB0IHRvIGFjY2VzcyBpdC5cbiAqXG4gKiBAcmV0dXJuIHtMb2NhbFN0b3JhZ2V9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBsb2NhbHN0b3JhZ2UoKXtcbiAgdHJ5IHtcbiAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZTtcbiAgfSBjYXRjaCAoZSkge31cbn1cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9kZWJ1Zy9icm93c2VyLmpzXG4gKiogbW9kdWxlIGlkID0gMzY4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ },
/* 369 */
/***/ function(module, exports, __webpack_require__) {

	eval("\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = debug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = __webpack_require__(370);\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lowercased letter, i.e. \"n\".\n */\n\nexports.formatters = {};\n\n/**\n * Previously assigned color.\n */\n\nvar prevColor = 0;\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n *\n * @return {Number}\n * @api private\n */\n\nfunction selectColor() {\n  return exports.colors[prevColor++ % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction debug(namespace) {\n\n  // define the `disabled` version\n  function disabled() {\n  }\n  disabled.enabled = false;\n\n  // define the `enabled` version\n  function enabled() {\n\n    var self = enabled;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // add the `color` if not set\n    if (null == self.useColors) self.useColors = exports.useColors();\n    if (null == self.color && self.useColors) self.color = selectColor();\n\n    var args = Array.prototype.slice.call(arguments);\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %o\n      args = ['%o'].concat(args);\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    if ('function' === typeof exports.formatArgs) {\n      args = exports.formatArgs.apply(self, args);\n    }\n    var logFn = enabled.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n  enabled.enabled = true;\n\n  var fn = exports.enabled(namespace) ? enabled : disabled;\n\n  fn.namespace = namespace;\n\n  return fn;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  var split = (namespaces || '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vZGVidWcvZGVidWcuanM/MjUwOSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qKlxuICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlclxuICogaW1wbGVtZW50YXRpb25zIG9mIGBkZWJ1ZygpYC5cbiAqXG4gKiBFeHBvc2UgYGRlYnVnKClgIGFzIHRoZSBtb2R1bGUuXG4gKi9cblxuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZGVidWc7XG5leHBvcnRzLmNvZXJjZSA9IGNvZXJjZTtcbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5leHBvcnRzLmVuYWJsZSA9IGVuYWJsZTtcbmV4cG9ydHMuZW5hYmxlZCA9IGVuYWJsZWQ7XG5leHBvcnRzLmh1bWFuaXplID0gcmVxdWlyZSgnbXMnKTtcblxuLyoqXG4gKiBUaGUgY3VycmVudGx5IGFjdGl2ZSBkZWJ1ZyBtb2RlIG5hbWVzLCBhbmQgbmFtZXMgdG8gc2tpcC5cbiAqL1xuXG5leHBvcnRzLm5hbWVzID0gW107XG5leHBvcnRzLnNraXBzID0gW107XG5cbi8qKlxuICogTWFwIG9mIHNwZWNpYWwgXCIlblwiIGhhbmRsaW5nIGZ1bmN0aW9ucywgZm9yIHRoZSBkZWJ1ZyBcImZvcm1hdFwiIGFyZ3VtZW50LlxuICpcbiAqIFZhbGlkIGtleSBuYW1lcyBhcmUgYSBzaW5nbGUsIGxvd2VyY2FzZWQgbGV0dGVyLCBpLmUuIFwiblwiLlxuICovXG5cbmV4cG9ydHMuZm9ybWF0dGVycyA9IHt9O1xuXG4vKipcbiAqIFByZXZpb3VzbHkgYXNzaWduZWQgY29sb3IuXG4gKi9cblxudmFyIHByZXZDb2xvciA9IDA7XG5cbi8qKlxuICogUHJldmlvdXMgbG9nIHRpbWVzdGFtcC5cbiAqL1xuXG52YXIgcHJldlRpbWU7XG5cbi8qKlxuICogU2VsZWN0IGEgY29sb3IuXG4gKlxuICogQHJldHVybiB7TnVtYmVyfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gc2VsZWN0Q29sb3IoKSB7XG4gIHJldHVybiBleHBvcnRzLmNvbG9yc1twcmV2Q29sb3IrKyAlIGV4cG9ydHMuY29sb3JzLmxlbmd0aF07XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgZGVidWdnZXIgd2l0aCB0aGUgZ2l2ZW4gYG5hbWVzcGFjZWAuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZVxuICogQHJldHVybiB7RnVuY3Rpb259XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmZ1bmN0aW9uIGRlYnVnKG5hbWVzcGFjZSkge1xuXG4gIC8vIGRlZmluZSB0aGUgYGRpc2FibGVkYCB2ZXJzaW9uXG4gIGZ1bmN0aW9uIGRpc2FibGVkKCkge1xuICB9XG4gIGRpc2FibGVkLmVuYWJsZWQgPSBmYWxzZTtcblxuICAvLyBkZWZpbmUgdGhlIGBlbmFibGVkYCB2ZXJzaW9uXG4gIGZ1bmN0aW9uIGVuYWJsZWQoKSB7XG5cbiAgICB2YXIgc2VsZiA9IGVuYWJsZWQ7XG5cbiAgICAvLyBzZXQgYGRpZmZgIHRpbWVzdGFtcFxuICAgIHZhciBjdXJyID0gK25ldyBEYXRlKCk7XG4gICAgdmFyIG1zID0gY3VyciAtIChwcmV2VGltZSB8fCBjdXJyKTtcbiAgICBzZWxmLmRpZmYgPSBtcztcbiAgICBzZWxmLnByZXYgPSBwcmV2VGltZTtcbiAgICBzZWxmLmN1cnIgPSBjdXJyO1xuICAgIHByZXZUaW1lID0gY3VycjtcblxuICAgIC8vIGFkZCB0aGUgYGNvbG9yYCBpZiBub3Qgc2V0XG4gICAgaWYgKG51bGwgPT0gc2VsZi51c2VDb2xvcnMpIHNlbGYudXNlQ29sb3JzID0gZXhwb3J0cy51c2VDb2xvcnMoKTtcbiAgICBpZiAobnVsbCA9PSBzZWxmLmNvbG9yICYmIHNlbGYudXNlQ29sb3JzKSBzZWxmLmNvbG9yID0gc2VsZWN0Q29sb3IoKTtcblxuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICAgIGFyZ3NbMF0gPSBleHBvcnRzLmNvZXJjZShhcmdzWzBdKTtcblxuICAgIGlmICgnc3RyaW5nJyAhPT0gdHlwZW9mIGFyZ3NbMF0pIHtcbiAgICAgIC8vIGFueXRoaW5nIGVsc2UgbGV0J3MgaW5zcGVjdCB3aXRoICVvXG4gICAgICBhcmdzID0gWyclbyddLmNvbmNhdChhcmdzKTtcbiAgICB9XG5cbiAgICAvLyBhcHBseSBhbnkgYGZvcm1hdHRlcnNgIHRyYW5zZm9ybWF0aW9uc1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgYXJnc1swXSA9IGFyZ3NbMF0ucmVwbGFjZSgvJShbYS16JV0pL2csIGZ1bmN0aW9uKG1hdGNoLCBmb3JtYXQpIHtcbiAgICAgIC8vIGlmIHdlIGVuY291bnRlciBhbiBlc2NhcGVkICUgdGhlbiBkb24ndCBpbmNyZWFzZSB0aGUgYXJyYXkgaW5kZXhcbiAgICAgIGlmIChtYXRjaCA9PT0gJyUlJykgcmV0dXJuIG1hdGNoO1xuICAgICAgaW5kZXgrKztcbiAgICAgIHZhciBmb3JtYXR0ZXIgPSBleHBvcnRzLmZvcm1hdHRlcnNbZm9ybWF0XTtcbiAgICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZm9ybWF0dGVyKSB7XG4gICAgICAgIHZhciB2YWwgPSBhcmdzW2luZGV4XTtcbiAgICAgICAgbWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpO1xuXG4gICAgICAgIC8vIG5vdyB3ZSBuZWVkIHRvIHJlbW92ZSBgYXJnc1tpbmRleF1gIHNpbmNlIGl0J3MgaW5saW5lZCBpbiB0aGUgYGZvcm1hdGBcbiAgICAgICAgYXJncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBpbmRleC0tO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuXG4gICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBleHBvcnRzLmZvcm1hdEFyZ3MpIHtcbiAgICAgIGFyZ3MgPSBleHBvcnRzLmZvcm1hdEFyZ3MuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgfVxuICAgIHZhciBsb2dGbiA9IGVuYWJsZWQubG9nIHx8IGV4cG9ydHMubG9nIHx8IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7XG4gICAgbG9nRm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gIH1cbiAgZW5hYmxlZC5lbmFibGVkID0gdHJ1ZTtcblxuICB2YXIgZm4gPSBleHBvcnRzLmVuYWJsZWQobmFtZXNwYWNlKSA/IGVuYWJsZWQgOiBkaXNhYmxlZDtcblxuICBmbi5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG5cbiAgcmV0dXJuIGZuO1xufVxuXG4vKipcbiAqIEVuYWJsZXMgYSBkZWJ1ZyBtb2RlIGJ5IG5hbWVzcGFjZXMuIFRoaXMgY2FuIGluY2x1ZGUgbW9kZXNcbiAqIHNlcGFyYXRlZCBieSBhIGNvbG9uIGFuZCB3aWxkY2FyZHMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZW5hYmxlKG5hbWVzcGFjZXMpIHtcbiAgZXhwb3J0cy5zYXZlKG5hbWVzcGFjZXMpO1xuXG4gIHZhciBzcGxpdCA9IChuYW1lc3BhY2VzIHx8ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuICB2YXIgbGVuID0gc3BsaXQubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICBpZiAoIXNwbGl0W2ldKSBjb250aW51ZTsgLy8gaWdub3JlIGVtcHR5IHN0cmluZ3NcbiAgICBuYW1lc3BhY2VzID0gc3BsaXRbaV0ucmVwbGFjZSgvXFwqL2csICcuKj8nKTtcbiAgICBpZiAobmFtZXNwYWNlc1swXSA9PT0gJy0nKSB7XG4gICAgICBleHBvcnRzLnNraXBzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzLnN1YnN0cigxKSArICckJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHBvcnRzLm5hbWVzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzICsgJyQnKSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRGlzYWJsZSBkZWJ1ZyBvdXRwdXQuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICBleHBvcnRzLmVuYWJsZSgnJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBlbmFibGVkKG5hbWUpIHtcbiAgdmFyIGksIGxlbjtcbiAgZm9yIChpID0gMCwgbGVuID0gZXhwb3J0cy5za2lwcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGlmIChleHBvcnRzLnNraXBzW2ldLnRlc3QobmFtZSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgZm9yIChpID0gMCwgbGVuID0gZXhwb3J0cy5uYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGlmIChleHBvcnRzLm5hbWVzW2ldLnRlc3QobmFtZSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQ29lcmNlIGB2YWxgLlxuICpcbiAqIEBwYXJhbSB7TWl4ZWR9IHZhbFxuICogQHJldHVybiB7TWl4ZWR9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBjb2VyY2UodmFsKSB7XG4gIGlmICh2YWwgaW5zdGFuY2VvZiBFcnJvcikgcmV0dXJuIHZhbC5zdGFjayB8fCB2YWwubWVzc2FnZTtcbiAgcmV0dXJuIHZhbDtcbn1cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi4vfi9kZWJ1Zy9kZWJ1Zy5qc1xuICoqIG1vZHVsZSBpZCA9IDM2OVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ },
/* 370 */
/***/ function(module, exports) {

	eval("/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options.long\n    ? long(val)\n    : short(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = '' + str;\n  if (str.length > 10000) return;\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction short(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction long(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL34vbXMvaW5kZXguanM/NmQwNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEhlbHBlcnMuXG4gKi9cblxudmFyIHMgPSAxMDAwO1xudmFyIG0gPSBzICogNjA7XG52YXIgaCA9IG0gKiA2MDtcbnZhciBkID0gaCAqIDI0O1xudmFyIHkgPSBkICogMzY1LjI1O1xuXG4vKipcbiAqIFBhcnNlIG9yIGZvcm1hdCB0aGUgZ2l2ZW4gYHZhbGAuXG4gKlxuICogT3B0aW9uczpcbiAqXG4gKiAgLSBgbG9uZ2AgdmVyYm9zZSBmb3JtYXR0aW5nIFtmYWxzZV1cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ3xOdW1iZXJ9IHZhbFxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAqIEByZXR1cm4ge1N0cmluZ3xOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmFsLCBvcHRpb25zKXtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGlmICgnc3RyaW5nJyA9PSB0eXBlb2YgdmFsKSByZXR1cm4gcGFyc2UodmFsKTtcbiAgcmV0dXJuIG9wdGlvbnMubG9uZ1xuICAgID8gbG9uZyh2YWwpXG4gICAgOiBzaG9ydCh2YWwpO1xufTtcblxuLyoqXG4gKiBQYXJzZSB0aGUgZ2l2ZW4gYHN0cmAgYW5kIHJldHVybiBtaWxsaXNlY29uZHMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICogQHJldHVybiB7TnVtYmVyfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gcGFyc2Uoc3RyKSB7XG4gIHN0ciA9ICcnICsgc3RyO1xuICBpZiAoc3RyLmxlbmd0aCA+IDEwMDAwKSByZXR1cm47XG4gIHZhciBtYXRjaCA9IC9eKCg/OlxcZCspP1xcLj9cXGQrKSAqKG1pbGxpc2Vjb25kcz98bXNlY3M/fG1zfHNlY29uZHM/fHNlY3M/fHN8bWludXRlcz98bWlucz98bXxob3Vycz98aHJzP3xofGRheXM/fGR8eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoc3RyKTtcbiAgaWYgKCFtYXRjaCkgcmV0dXJuO1xuICB2YXIgbiA9IHBhcnNlRmxvYXQobWF0Y2hbMV0pO1xuICB2YXIgdHlwZSA9IChtYXRjaFsyXSB8fCAnbXMnKS50b0xvd2VyQ2FzZSgpO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICd5ZWFycyc6XG4gICAgY2FzZSAneWVhcic6XG4gICAgY2FzZSAneXJzJzpcbiAgICBjYXNlICd5cic6XG4gICAgY2FzZSAneSc6XG4gICAgICByZXR1cm4gbiAqIHk7XG4gICAgY2FzZSAnZGF5cyc6XG4gICAgY2FzZSAnZGF5JzpcbiAgICBjYXNlICdkJzpcbiAgICAgIHJldHVybiBuICogZDtcbiAgICBjYXNlICdob3Vycyc6XG4gICAgY2FzZSAnaG91cic6XG4gICAgY2FzZSAnaHJzJzpcbiAgICBjYXNlICdocic6XG4gICAgY2FzZSAnaCc6XG4gICAgICByZXR1cm4gbiAqIGg7XG4gICAgY2FzZSAnbWludXRlcyc6XG4gICAgY2FzZSAnbWludXRlJzpcbiAgICBjYXNlICdtaW5zJzpcbiAgICBjYXNlICdtaW4nOlxuICAgIGNhc2UgJ20nOlxuICAgICAgcmV0dXJuIG4gKiBtO1xuICAgIGNhc2UgJ3NlY29uZHMnOlxuICAgIGNhc2UgJ3NlY29uZCc6XG4gICAgY2FzZSAnc2Vjcyc6XG4gICAgY2FzZSAnc2VjJzpcbiAgICBjYXNlICdzJzpcbiAgICAgIHJldHVybiBuICogcztcbiAgICBjYXNlICdtaWxsaXNlY29uZHMnOlxuICAgIGNhc2UgJ21pbGxpc2Vjb25kJzpcbiAgICBjYXNlICdtc2Vjcyc6XG4gICAgY2FzZSAnbXNlYyc6XG4gICAgY2FzZSAnbXMnOlxuICAgICAgcmV0dXJuIG47XG4gIH1cbn1cblxuLyoqXG4gKiBTaG9ydCBmb3JtYXQgZm9yIGBtc2AuXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IG1zXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBzaG9ydChtcykge1xuICBpZiAobXMgPj0gZCkgcmV0dXJuIE1hdGgucm91bmQobXMgLyBkKSArICdkJztcbiAgaWYgKG1zID49IGgpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gaCkgKyAnaCc7XG4gIGlmIChtcyA+PSBtKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIG0pICsgJ20nO1xuICBpZiAobXMgPj0gcykgcmV0dXJuIE1hdGgucm91bmQobXMgLyBzKSArICdzJztcbiAgcmV0dXJuIG1zICsgJ21zJztcbn1cblxuLyoqXG4gKiBMb25nIGZvcm1hdCBmb3IgYG1zYC5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gbXNcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIGxvbmcobXMpIHtcbiAgcmV0dXJuIHBsdXJhbChtcywgZCwgJ2RheScpXG4gICAgfHwgcGx1cmFsKG1zLCBoLCAnaG91cicpXG4gICAgfHwgcGx1cmFsKG1zLCBtLCAnbWludXRlJylcbiAgICB8fCBwbHVyYWwobXMsIHMsICdzZWNvbmQnKVxuICAgIHx8IG1zICsgJyBtcyc7XG59XG5cbi8qKlxuICogUGx1cmFsaXphdGlvbiBoZWxwZXIuXG4gKi9cblxuZnVuY3Rpb24gcGx1cmFsKG1zLCBuLCBuYW1lKSB7XG4gIGlmIChtcyA8IG4pIHJldHVybjtcbiAgaWYgKG1zIDwgbiAqIDEuNSkgcmV0dXJuIE1hdGguZmxvb3IobXMgLyBuKSArICcgJyArIG5hbWU7XG4gIHJldHVybiBNYXRoLmNlaWwobXMgLyBuKSArICcgJyArIG5hbWUgKyAncyc7XG59XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4uL34vbXMvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAzNzBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }
]);